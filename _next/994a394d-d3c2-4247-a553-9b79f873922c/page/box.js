module.exports=__NEXT_REGISTER_PAGE("/box",function(){var t=webpackJsonp([0],{294:function(e,t,r){e.exports=r(295)},295:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(1);var n=r.n(i);var a=r(296);var o=r.n(a);var s=r(298);var u=r.n(s);var c=r(301);var l=r.n(c);var h=r(302);var d=r.n(h);var p=r(304);var f=r.n(p);var v=r(77);var m=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(e,i.key,i)}}return function(t,r,i){r&&e(t.prototype,r);i&&e(t,i);return t}}();function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function A(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var M=function(e){A(t,e);function t(){g(this,t);return y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}m(t,[{key:"render",value:function e(){var t=void 0;t=void 0===window?n.a.createElement("div",null):n.a.createElement(o.a,{onSSR:"loading"},n.a.createElement(c["Scene"],null,n.a.createElement(c["Entity"],{geometry:{primitive:"box"},material:{color:"red"},position:{x:0,y:0,z:-5}}),n.a.createElement(c["Entity"],{"particle-system":{preset:"snow"}}),n.a.createElement(c["Entity"],{light:{type:"point"}}),n.a.createElement(c["Entity"],{"gltf-model":{src:"virtualcity.gltf"}}),n.a.createElement(c["Entity"],{text:{value:"Hello, WebVR!"}})));return n.a.createElement("div",null,"Hey Ho, Lets Go")}}]);return t}(n.a.Component);t["default"]=M},296:function(e,t,r){e.exports=r(297)},297:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(20);var n=v(i);var a=r(7);var o=v(a);var s=r(8);var u=v(s);var c=r(21);var l=v(c);var h=r(22);var d=v(h);var p=r(1);var f=v(p);function v(e){return e&&e.__esModule?e:{default:e}}var m=function e(){return f.default.createElement("span",null)};var g=function(e){(0,d.default)(t,e);function t(){var e;(0,o.default)(this,t);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var s=(0,l.default)(this,(e=(0,n.default)(t)).call.apply(e,[this].concat(i)));s.state={canRender:false};return s}(0,u.default)(t,[{key:"componentDidMount",value:function e(){this.setState({canRender:true})}},{key:"render",value:function e(){var t=this.props;var r=t.children;var i=t.onSSR;var n=void 0===i?f.default.createElement(m,null):i;var a=this.state.canRender;return a?r:n}}]);return t}(f.default.Component);t.default=g},298:function(t,r,i){(function(r,i){var n;var n;(function(e){var r;true;t.exports=e()})(function(){var t,a,o;return function(){function e(t,r,i){function a(s,u){if(!r[s]){if(!t[s]){var c="function"==typeof n&&n;if(!u&&c)return n(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=r[s]={exports:{}};t[s][0].call(h.exports,function(e){var r=t[s][1][e];return a(r||e)},h,h.exports,e,t,r,i)}return r[s].exports}var o="function"==typeof n&&n;for(var s=0;s<i.length;s++)a(i[s]);return a}return e}()({1:[function(e,r,i){(function(e){var n=function(){this._tweens={};this._tweensAddedDuringUpdate={}};n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(e){return this._tweens[e]}.bind(this))},removeAll:function(){this._tweens={}},add:function(e){this._tweens[e.getId()]=e;this._tweensAddedDuringUpdate[e.getId()]=e},remove:function(e){delete this._tweens[e.getId()];delete this._tweensAddedDuringUpdate[e.getId()]},update:function(e,t){var r=Object.keys(this._tweens);if(0===r.length)return false;e=void 0!==e?e:a.now();while(r.length>0){this._tweensAddedDuringUpdate={};for(var i=0;i<r.length;i++)if(false===this._tweens[r[i]].update(e)){this._tweens[r[i]]._isPlaying=false;t||delete this._tweens[r[i]]}r=Object.keys(this._tweensAddedDuringUpdate)}return true}};var a=new n;a.Group=n;a._nextId=0;a.nextId=function(){return a._nextId++};"undefined"===typeof window&&"undefined"!==typeof e?a.now=function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?a.now=window.performance.now.bind(window.performance):void 0!==Date.now?a.now=Date.now:a.now=function(){return(new Date).getTime()};a.Tween=function(e,t){this._object=e;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1e3;this._repeat=0;this._repeatDelayTime=void 0;this._yoyo=false;this._isPlaying=false;this._reversed=false;this._delayTime=0;this._startTime=null;this._easingFunction=a.Easing.Linear.None;this._interpolationFunction=a.Interpolation.Linear;this._chainedTweens=[];this._onStartCallback=null;this._onStartCallbackFired=false;this._onUpdateCallback=null;this._onCompleteCallback=null;this._onStopCallback=null;this._group=t||a;this._id=a.nextId()};a.Tween.prototype={getId:function e(){return this._id},isPlaying:function e(){return this._isPlaying},to:function e(t,r){this._valuesEnd=t;void 0!==r&&(this._duration=r);return this},start:function e(t){this._group.add(this);this._isPlaying=true;this._onStartCallbackFired=false;this._startTime=void 0!==t?t:a.now();this._startTime+=this._delayTime;for(var r in this._valuesEnd){if(this._valuesEnd[r]instanceof Array){if(0===this._valuesEnd[r].length)continue;this._valuesEnd[r]=[this._object[r]].concat(this._valuesEnd[r])}if(void 0===this._object[r])continue;this._valuesStart[r]=this._object[r];this._valuesStart[r]instanceof Array===false&&(this._valuesStart[r]*=1);this._valuesStartRepeat[r]=this._valuesStart[r]||0}return this},stop:function e(){if(!this._isPlaying)return this;this._group.remove(this);this._isPlaying=false;null!==this._onStopCallback&&this._onStopCallback.call(this._object,this._object);this.stopChainedTweens();return this},end:function e(){this.update(this._startTime+this._duration);return this},stopChainedTweens:function e(){for(var t=0,r=this._chainedTweens.length;t<r;t++)this._chainedTweens[t].stop()},delay:function e(t){this._delayTime=t;return this},repeat:function e(t){this._repeat=t;return this},repeatDelay:function e(t){this._repeatDelayTime=t;return this},yoyo:function e(e){this._yoyo=e;return this},easing:function e(e){this._easingFunction=e;return this},interpolation:function e(e){this._interpolationFunction=e;return this},chain:function e(){this._chainedTweens=arguments;return this},onStart:function e(t){this._onStartCallback=t;return this},onUpdate:function e(t){this._onUpdateCallback=t;return this},onComplete:function e(t){this._onCompleteCallback=t;return this},onStop:function e(t){this._onStopCallback=t;return this},update:function e(t){var r;var i;var n;if(t<this._startTime)return true;if(false===this._onStartCallbackFired){null!==this._onStartCallback&&this._onStartCallback.call(this._object,this._object);this._onStartCallbackFired=true}i=(t-this._startTime)/this._duration;i=i>1?1:i;n=this._easingFunction(i);for(r in this._valuesEnd){if(void 0===this._valuesStart[r])continue;var a=this._valuesStart[r]||0;var o=this._valuesEnd[r];if(o instanceof Array)this._object[r]=this._interpolationFunction(o,n);else{"string"===typeof o&&(o="+"===o.charAt(0)||"-"===o.charAt(0)?a+parseFloat(o):parseFloat(o));"number"===typeof o&&(this._object[r]=a+(o-a)*n)}}null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,n);if(1===i){if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(r in this._valuesStartRepeat){"string"===typeof this._valuesEnd[r]&&(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r]));if(this._yoyo){var s=this._valuesStartRepeat[r];this._valuesStartRepeat[r]=this._valuesEnd[r];this._valuesEnd[r]=s}this._valuesStart[r]=this._valuesStartRepeat[r]}this._yoyo&&(this._reversed=!this._reversed);void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime;return true}null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object,this._object);for(var u=0,c=this._chainedTweens.length;u<c;u++)this._chainedTweens[u].start(this._startTime+this._duration);return false}return true}};a.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){if((e*=2)<1)return.5*e*e;return-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){if((e*=2)<1)return.5*e*e*e;return.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){if((e*=2)<1)return.5*e*e*e*e;return-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){if((e*=2)<1)return.5*e*e*e*e*e;return.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){if(0===e)return 0;if(1===e)return 1;if((e*=2)<1)return.5*Math.pow(1024,e-1);return.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){if((e*=2)<1)return-.5*(Math.sqrt(1-e*e)-1);return.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){if(0===e)return 0;if(1===e)return 1;return-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){if(0===e)return 0;if(1===e)return 1;return Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){if(0===e)return 0;if(1===e)return 1;e*=2;if(e<1)return-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI);return.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;if((e*=2)<1)return e*e*((t+1)*e-t)*.5;return.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-a.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){if(e<.5)return.5*a.Easing.Bounce.In(2*e);return.5*a.Easing.Bounce.Out(2*e-1)+.5}}};a.Interpolation={Linear:function(e,t){var r=e.length-1;var i=r*t;var n=Math.floor(i);var o=a.Interpolation.Utils.Linear;if(t<0)return o(e[0],e[1],i);if(t>1)return o(e[r],e[r-1],r-i);return o(e[n],e[n+1>r?r:n+1],i-n)},Bezier:function(e,t){var r=0;var i=e.length-1;var n=Math.pow;var o=a.Interpolation.Utils.Bernstein;for(var s=0;s<=i;s++)r+=n(1-t,i-s)*n(t,s)*e[s]*o(i,s);return r},CatmullRom:function(e,t){var r=e.length-1;var i=r*t;var n=Math.floor(i);var o=a.Interpolation.Utils.CatmullRom;if(e[0]===e[r]){t<0&&(n=Math.floor(i=r*(1+t)));return o(e[(n-1+r)%r],e[n],e[(n+1)%r],e[(n+2)%r],i-n)}if(t<0)return e[0]-(o(e[0],e[0],e[1],e[1],-i)-e[0]);if(t>1)return e[r]-(o(e[r],e[r],e[r-1],e[r-1],i-r)-e[r]);return o(e[n?n-1:0],e[n],e[r<n+1?r:n+1],e[r<n+2?r:n+2],i-n)},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(e,t){var r=a.Interpolation.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:function(){var e=[1];return function(t){var r=1;if(e[t])return e[t];for(var i=t;i>1;i--)r*=i;e[t]=r;return r}}(),CatmullRom:function(e,t,r,i,n){var a=.5*(r-e);var o=.5*(i-t);var s=n*n;var u=n*s;return(2*t-2*r+a+o)*u+(-3*t+3*r-2*a-o)*s+a*n+t}}};(function(e){"function"===typeof t&&t.amd?t([],function(){return a}):"undefined"!==typeof r&&"object"===typeof i?r.exports=a:void 0!==e&&(e.TWEEN=a)})(this)}).call(this,e("_process"))},{_process:32}],2:[function(e,t,r){var i=Object.prototype.toString;t.exports=n;function n(e){return e.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===i.call(e.buffer)||Array.isArray(e)}},{}],3:[function(e,t,r){t.exports=function e(t,r){return"number"===typeof t?t:"number"===typeof r?r:0}},{}],4:[function(e,t,r){"use strict";r.byteLength=l;r.toByteArray=h;r.fromByteArray=f;var i=[];var n=[];var a="undefined"!==typeof Uint8Array?Uint8Array:Array;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var s=0,u=o.length;s<u;++s){i[s]=o[s];n[o.charCodeAt(s)]=s}n["-".charCodeAt(0)]=62;n["_".charCodeAt(0)]=63;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function l(e){return 3*e.length/4-c(e)}function h(e){var t,r,i,o,s;var u=e.length;o=c(e);s=new a(3*u/4-o);r=o>0?u-4:u;var l=0;for(t=0;t<r;t+=4){i=n[e.charCodeAt(t)]<<18|n[e.charCodeAt(t+1)]<<12|n[e.charCodeAt(t+2)]<<6|n[e.charCodeAt(t+3)];s[l++]=i>>16&255;s[l++]=i>>8&255;s[l++]=255&i}if(2===o){i=n[e.charCodeAt(t)]<<2|n[e.charCodeAt(t+1)]>>4;s[l++]=255&i}else if(1===o){i=n[e.charCodeAt(t)]<<10|n[e.charCodeAt(t+1)]<<4|n[e.charCodeAt(t+2)]>>2;s[l++]=i>>8&255;s[l++]=255&i}return s}function d(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function p(e,t,r){var i;var n=[];for(var a=t;a<r;a+=3){i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]);n.push(d(i))}return n.join("")}function f(e){var t;var r=e.length;var n=r%3;var a="";var o=[];var s=16383;for(var u=0,c=r-n;u<c;u+=s)o.push(p(e,u,u+s>c?c:u+s));if(1===n){t=e[r-1];a+=i[t>>2];a+=i[t<<4&63];a+="=="}else if(2===n){t=(e[r-2]<<8)+e[r-1];a+=i[t>>10];a+=i[t>>4&63];a+=i[t<<2&63];a+="="}o.push(a);return o.join("")}},{}],5:[function(e,t,r){"use strict";t.exports={createLink:function(e,t){var r=document.head||document.getElementsByTagName("head")[0];var i=document.createElement("link");i.href=e;i.rel="stylesheet";for(var n in t){if(!t.hasOwnProperty(n))continue;var a=t[n];i.setAttribute("data-"+n,a)}r.appendChild(i)},createStyle:function(e,t){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css";for(var n in t){if(!t.hasOwnProperty(n))continue;var a=t[n];i.setAttribute("data-"+n,a)}if(i.sheet){i.innerHTML=e;i.sheet.cssText=e;r.appendChild(i)}else if(i.styleSheet){r.appendChild(i);i.styleSheet.cssText=e}else{i.appendChild(document.createTextNode(e));r.appendChild(i)}}}},{}],6:[function(e,t,r){var i=e("buffer").Buffer;t.exports=function(e,t){if(!i.isBuffer(e))return;if(!i.isBuffer(t))return;if("function"===typeof e.equals)return e.equals(t);if(e.length!==t.length)return false;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return false;return true}},{buffer:7}],7:[function(e,t,i){(function(t){"use strict";var r=e("base64-js");var n=e("ieee754");var a=e("isarray");i.Buffer=c;i.SlowBuffer=A;i.INSPECT_MAX_BYTES=50;c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:o();i.kMaxLength=s();function o(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return false}}function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(s()<t)throw new RangeError("Invalid typed array length");if(c.TYPED_ARRAY_SUPPORT){e=new Uint8Array(t);e.__proto__=c.prototype}else{null===e&&(e=new c(t));e.length=t}return e}function c(e,t,r){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(e,t,r);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return p(this,e)}return l(this,e,t,r)}c.poolSize=8192;c._augment=function(e){e.__proto__=c.prototype;return e};function l(e,t,r,i){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer)return m(e,t,r,i);if("string"===typeof t)return f(e,t,r);return g(e,t)}c.from=function(e,t,r){return l(null,e,t,r)};if(c.TYPED_ARRAY_SUPPORT){c.prototype.__proto__=Uint8Array.prototype;c.__proto__=Uint8Array;"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:true})}function h(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t,r,i){h(t);if(t<=0)return u(e,t);if(void 0!==r)return"string"===typeof i?u(e,t).fill(r,i):u(e,t).fill(r);return u(e,t)}c.alloc=function(e,t,r){return d(null,e,t,r)};function p(e,t){h(t);e=u(e,t<0?0:0|y(t));if(!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}c.allocUnsafe=function(e){return p(null,e)};c.allocUnsafeSlow=function(e){return p(null,e)};function f(e,t,r){"string"===typeof r&&""!==r||(r="utf8");if(!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|M(t,r);e=u(e,i);var n=e.write(t,r);n!==i&&(e=e.slice(0,n));return e}function v(e,t){var r=t.length<0?0:0|y(t.length);e=u(e,r);for(var i=0;i<r;i+=1)e[i]=255&t[i];return e}function m(e,t,r,i){t.byteLength;if(r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,r):new Uint8Array(t,r,i);if(c.TYPED_ARRAY_SUPPORT){e=t;e.__proto__=c.prototype}else e=v(e,t);return e}function g(e,t){if(c.isBuffer(t)){var r=0|y(t.length);e=u(e,r);if(0===e.length)return e;t.copy(e,0,0,r);return e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t){if("number"!==typeof t.length||te(t.length))return u(e,0);return v(e,t)}if("Buffer"===t.type&&a(t.data))return v(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function A(e){+e!=e&&(e=0);return c.alloc(+e)}c.isBuffer=function e(t){return!!(null!=t&&t._isBuffer)};c.compare=function e(t,r){if(!c.isBuffer(t)||!c.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;var i=t.length;var n=r.length;for(var a=0,o=Math.min(i,n);a<o;++a)if(t[a]!==r[a]){i=t[a];n=r[a];break}if(i<n)return-1;if(n<i)return 1;return 0};c.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};c.concat=function e(t,r){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var i;if(void 0===r){r=0;for(i=0;i<t.length;++i)r+=t[i].length}var n=c.allocUnsafe(r);var o=0;for(i=0;i<t.length;++i){var s=t[i];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o);o+=s.length}return n};function M(e,t){if(c.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;var i=false;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return $(e).length;default:if(i)return Z(e).length;t=(""+t).toLowerCase();i=true}}c.byteLength=M;function w(e,t,r){var i=false;(void 0===t||t<0)&&(t=0);if(t>this.length)return"";(void 0===r||r>this.length)&&(r=this.length);if(r<=0)return"";r>>>=0;t>>>=0;if(r<=t)return"";e||(e="utf8");while(true)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return _(this,t,r);case"ascii":return R(this,t,r);case"latin1":case"binary":return z(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();i=true}}c.prototype._isBuffer=true;function E(e,t,r){var i=e[t];e[t]=e[r];e[r]=i}c.prototype.swap16=function e(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)E(this,r,r+1);return this};c.prototype.swap32=function e(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4){E(this,r,r+3);E(this,r+1,r+2)}return this};c.prototype.swap64=function e(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8){E(this,r,r+7);E(this,r+1,r+6);E(this,r+2,r+5);E(this,r+3,r+4)}return this};c.prototype.toString=function e(){var t=0|this.length;if(0===t)return"";if(0===arguments.length)return _(this,0,t);return w.apply(this,arguments)};c.prototype.equals=function e(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return 0===c.compare(this,t)};c.prototype.inspect=function e(){var t="";var r=i.INSPECT_MAX_BYTES;if(this.length>0){t=this.toString("hex",0,r).match(/.{2}/g).join(" ");this.length>r&&(t+=" ... ")}return"<Buffer "+t+">"};c.prototype.compare=function e(t,r,i,n,a){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");void 0===r&&(r=0);void 0===i&&(i=t?t.length:0);void 0===n&&(n=0);void 0===a&&(a=this.length);if(r<0||i>t.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&r>=i)return 0;if(n>=a)return-1;if(r>=i)return 1;r>>>=0;i>>>=0;n>>>=0;a>>>=0;if(this===t)return 0;var o=a-n;var s=i-r;var u=Math.min(o,s);var l=this.slice(n,a);var h=t.slice(r,i);for(var d=0;d<u;++d)if(l[d]!==h[d]){o=l[d];s=h[d];break}if(o<s)return-1;if(s<o)return 1;return 0};function x(e,t,r,i,n){if(0===e.length)return-1;if("string"===typeof r){i=r;r=0}else r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648);r=+r;isNaN(r)&&(r=n?0:e.length-1);r<0&&(r=e.length+r);if(r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}"string"===typeof t&&(t=c.from(t,i));if(c.isBuffer(t)){if(0===t.length)return-1;return b(e,t,r,i,n)}if("number"===typeof t){t&=255;if(c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf)return n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r);return b(e,[t],r,i,n)}throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,i,n){var a=1;var o=e.length;var s=t.length;if(void 0!==i){i=String(i).toLowerCase();if("ucs2"===i||"ucs-2"===i||"utf16le"===i||"utf-16le"===i){if(e.length<2||t.length<2)return-1;a=2;o/=2;s/=2;r/=2}}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var c;if(n){var l=-1;for(c=r;c<o;c++)if(u(e,c)===u(t,-1===l?0:c-l)){-1===l&&(l=c);if(c-l+1===s)return l*a}else{-1!==l&&(c-=c-l);l=-1}}else{r+s>o&&(r=o-s);for(c=r;c>=0;c--){var h=true;for(var d=0;d<s;d++)if(u(e,c+d)!==u(t,d)){h=false;break}if(h)return c}}return-1}c.prototype.includes=function e(t,r,i){return-1!==this.indexOf(t,r,i)};c.prototype.indexOf=function e(t,r,i){return x(this,t,r,i,true)};c.prototype.lastIndexOf=function e(t,r,i){return x(this,t,r,i,false)};function T(e,t,r,i){r=Number(r)||0;var n=e.length-r;if(i){i=Number(i);i>n&&(i=n)}else i=n;var a=t.length;if(a%2!==0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var o=0;o<i;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[r+o]=s}return o}function L(e,t,r,i){return ee(Z(t,e.length-r),e,r,i)}function N(e,t,r,i){return ee(J(t),e,r,i)}function D(e,t,r,i){return N(e,t,r,i)}function C(e,t,r,i){return ee($(t),e,r,i)}function S(e,t,r,i){return ee(K(t,e.length-r),e,r,i)}c.prototype.write=function e(t,r,i,n){if(void 0===r){n="utf8";i=this.length;r=0}else if(void 0===i&&"string"===typeof r){n=r;i=this.length;r=0}else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0;if(isFinite(i)){i|=0;void 0===n&&(n="utf8")}else{n=i;i=void 0}}var a=this.length-r;(void 0===i||i>a)&&(i=a);if(t.length>0&&(i<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");var o=false;for(;;)switch(n){case"hex":return T(this,t,r,i);case"utf8":case"utf-8":return L(this,t,r,i);case"ascii":return N(this,t,r,i);case"latin1":case"binary":return D(this,t,r,i);case"base64":return C(this,t,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,r,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase();o=true}};c.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(e,t,i){return 0===t&&i===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,i))}function _(e,t,r){r=Math.min(e.length,r);var i=[];var n=t;while(n<r){var a=e[n];var o=null;var s=a>239?4:a>223?3:a>191?2:1;if(n+s<=r){var u,c,l,h;switch(s){case 1:a<128&&(o=a);break;case 2:u=e[n+1];if(128===(192&u)){h=(31&a)<<6|63&u;h>127&&(o=h)}break;case 3:u=e[n+1];c=e[n+2];if(128===(192&u)&&128===(192&c)){h=(15&a)<<12|(63&u)<<6|63&c;h>2047&&(h<55296||h>57343)&&(o=h)}break;case 4:u=e[n+1];c=e[n+2];l=e[n+3];if(128===(192&u)&&128===(192&c)&&128===(192&l)){h=(15&a)<<18|(63&u)<<12|(63&c)<<6|63&l;h>65535&&h<1114112&&(o=h)}}}if(null===o){o=65533;s=1}else if(o>65535){o-=65536;i.push(o>>>10&1023|55296);o=56320|1023&o}i.push(o);n+=s}return j(i)}var O=4096;function j(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);var r="";var i=0;while(i<t)r+=String.fromCharCode.apply(String,e.slice(i,i+=O));return r}function R(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function z(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function k(e,t,r){var i=e.length;(!t||t<0)&&(t=0);(!r||r<0||r>i)&&(r=i);var n="";for(var a=t;a<r;++a)n+=q(e[a]);return n}function P(e,t,r){var i=e.slice(t,r);var n="";for(var a=0;a<i.length;a+=2)n+=String.fromCharCode(i[a]+256*i[a+1]);return n}c.prototype.slice=function e(t,r){var i=this.length;t=~~t;r=void 0===r?i:~~r;if(t<0){t+=i;t<0&&(t=0)}else t>i&&(t=i);if(r<0){r+=i;r<0&&(r=0)}else r>i&&(r=i);r<t&&(r=t);var n;if(c.TYPED_ARRAY_SUPPORT){n=this.subarray(t,r);n.__proto__=c.prototype}else{var a=r-t;n=new c(a,void 0);for(var o=0;o<a;++o)n[o]=this[o+t]}return n};function U(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUIntLE=function e(t,r,i){t|=0;r|=0;i||U(t,r,this.length);var n=this[t];var a=1;var o=0;while(++o<r&&(a*=256))n+=this[t+o]*a;return n};c.prototype.readUIntBE=function e(t,r,i){t|=0;r|=0;i||U(t,r,this.length);var n=this[t+--r];var a=1;while(r>0&&(a*=256))n+=this[t+--r]*a;return n};c.prototype.readUInt8=function e(t,r){r||U(t,1,this.length);return this[t]};c.prototype.readUInt16LE=function e(t,r){r||U(t,2,this.length);return this[t]|this[t+1]<<8};c.prototype.readUInt16BE=function e(t,r){r||U(t,2,this.length);return this[t]<<8|this[t+1]};c.prototype.readUInt32LE=function e(t,r){r||U(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]};c.prototype.readUInt32BE=function e(t,r){r||U(t,4,this.length);return 16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])};c.prototype.readIntLE=function e(t,r,i){t|=0;r|=0;i||U(t,r,this.length);var n=this[t];var a=1;var o=0;while(++o<r&&(a*=256))n+=this[t+o]*a;a*=128;n>=a&&(n-=Math.pow(2,8*r));return n};c.prototype.readIntBE=function e(t,r,i){t|=0;r|=0;i||U(t,r,this.length);var n=r;var a=1;var o=this[t+--n];while(n>0&&(a*=256))o+=this[t+--n]*a;a*=128;o>=a&&(o-=Math.pow(2,8*r));return o};c.prototype.readInt8=function e(t,r){r||U(t,1,this.length);if(!(128&this[t]))return this[t];return-1*(255-this[t]+1)};c.prototype.readInt16LE=function e(t,r){r||U(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i};c.prototype.readInt16BE=function e(t,r){r||U(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i};c.prototype.readInt32LE=function e(t,r){r||U(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};c.prototype.readInt32BE=function e(t,r){r||U(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};c.prototype.readFloatLE=function e(t,r){r||U(t,4,this.length);return n.read(this,t,true,23,4)};c.prototype.readFloatBE=function e(t,r){r||U(t,4,this.length);return n.read(this,t,false,23,4)};c.prototype.readDoubleLE=function e(t,r){r||U(t,8,this.length);return n.read(this,t,true,52,8)};c.prototype.readDoubleBE=function e(t,r){r||U(t,8,this.length);return n.read(this,t,false,52,8)};function B(e,t,r,i,n,a){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<a)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}c.prototype.writeUIntLE=function e(t,r,i,n){t=+t;r|=0;i|=0;if(!n){var a=Math.pow(2,8*i)-1;B(this,t,r,i,a,0)}var o=1;var s=0;this[r]=255&t;while(++s<i&&(o*=256))this[r+s]=t/o&255;return r+i};c.prototype.writeUIntBE=function e(t,r,i,n){t=+t;r|=0;i|=0;if(!n){var a=Math.pow(2,8*i)-1;B(this,t,r,i,a,0)}var o=i-1;var s=1;this[r+o]=255&t;while(--o>=0&&(s*=256))this[r+o]=t/s&255;return r+i};c.prototype.writeUInt8=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,1,255,0);c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t));this[r]=255&t;return r+1};function F(e,t,r,i){t<0&&(t=65535+t+1);for(var n=0,a=Math.min(e.length-r,2);n<a;++n)e[r+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}c.prototype.writeUInt16LE=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,2,65535,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=255&t;this[r+1]=t>>>8}else F(this,t,r,true);return r+2};c.prototype.writeUInt16BE=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,2,65535,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=255&t}else F(this,t,r,false);return r+2};function G(e,t,r,i){t<0&&(t=4294967295+t+1);for(var n=0,a=Math.min(e.length-r,4);n<a;++n)e[r+n]=t>>>8*(i?n:3-n)&255}c.prototype.writeUInt32LE=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,4,4294967295,0);if(c.TYPED_ARRAY_SUPPORT){this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=255&t}else G(this,t,r,true);return r+4};c.prototype.writeUInt32BE=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,4,4294967295,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=255&t}else G(this,t,r,false);return r+4};c.prototype.writeIntLE=function e(t,r,i,n){t=+t;r|=0;if(!n){var a=Math.pow(2,8*i-1);B(this,t,r,i,a-1,-a)}var o=0;var s=1;var u=0;this[r]=255&t;while(++o<i&&(s*=256)){t<0&&0===u&&0!==this[r+o-1]&&(u=1);this[r+o]=(t/s>>0)-u&255}return r+i};c.prototype.writeIntBE=function e(t,r,i,n){t=+t;r|=0;if(!n){var a=Math.pow(2,8*i-1);B(this,t,r,i,a-1,-a)}var o=i-1;var s=1;var u=0;this[r+o]=255&t;while(--o>=0&&(s*=256)){t<0&&0===u&&0!==this[r+o+1]&&(u=1);this[r+o]=(t/s>>0)-u&255}return r+i};c.prototype.writeInt8=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,1,127,-128);c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t));t<0&&(t=255+t+1);this[r]=255&t;return r+1};c.prototype.writeInt16LE=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,2,32767,-32768);if(c.TYPED_ARRAY_SUPPORT){this[r]=255&t;this[r+1]=t>>>8}else F(this,t,r,true);return r+2};c.prototype.writeInt16BE=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,2,32767,-32768);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=255&t}else F(this,t,r,false);return r+2};c.prototype.writeInt32LE=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,4,2147483647,-2147483648);if(c.TYPED_ARRAY_SUPPORT){this[r]=255&t;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24}else G(this,t,r,true);return r+4};c.prototype.writeInt32BE=function e(t,r,i){t=+t;r|=0;i||B(this,t,r,4,2147483647,-2147483648);t<0&&(t=4294967295+t+1);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=255&t}else G(this,t,r,false);return r+4};function H(e,t,r,i,n,a){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function V(e,t,r,i,a){a||H(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38);n.write(e,t,r,i,23,4);return r+4}c.prototype.writeFloatLE=function e(t,r,i){return V(this,t,r,true,i)};c.prototype.writeFloatBE=function e(t,r,i){return V(this,t,r,false,i)};function Q(e,t,r,i,a){a||H(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308);n.write(e,t,r,i,52,8);return r+8}c.prototype.writeDoubleLE=function e(t,r,i){return Q(this,t,r,true,i)};c.prototype.writeDoubleBE=function e(t,r,i){return Q(this,t,r,false,i)};c.prototype.copy=function e(t,r,i,n){i||(i=0);n||0===n||(n=this.length);r>=t.length&&(r=t.length);r||(r=0);n>0&&n<i&&(n=i);if(n===i)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);t.length-r<n-i&&(n=t.length-r+i);var a=n-i;var o;if(this===t&&i<r&&r<n)for(o=a-1;o>=0;--o)t[o+r]=this[o+i];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)t[o+r]=this[o+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+a),r);return a};c.prototype.fill=function e(t,r,i,n){if("string"===typeof t){if("string"===typeof r){n=r;r=0;i=this.length}else if("string"===typeof i){n=i;i=this.length}if(1===t.length){var a=t.charCodeAt(0);a<256&&(t=a)}if(void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"===typeof t&&(t&=255);if(r<0||this.length<r||this.length<i)throw new RangeError("Out of range index");if(i<=r)return this;r>>>=0;i=void 0===i?this.length:i>>>0;t||(t=0);var o;if("number"===typeof t)for(o=r;o<i;++o)this[o]=t;else{var s=c.isBuffer(t)?t:Z(new c(t,n).toString());var u=s.length;for(o=0;o<i-r;++o)this[o+r]=s[o%u]}return this};var Y=/[^+\/0-9A-Za-z-_]/g;function W(e){e=X(e).replace(Y,"");if(e.length<2)return"";while(e.length%4!==0)e+="=";return e}function X(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function q(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function Z(e,t){t=t||Infinity;var r;var i=e.length;var n=null;var a=[];for(var o=0;o<i;++o){r=e.charCodeAt(o);if(r>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&a.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189);n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&a.push(239,191,189);n=null;if(r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function J(e){var t=[];for(var r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function K(e,t){var r,i,n;var a=[];for(var o=0;o<e.length;++o){if((t-=2)<0)break;r=e.charCodeAt(o);i=r>>8;n=r%256;a.push(n);a.push(i)}return a}function $(e){return r.toByteArray(W(e))}function ee(e,t,r,i){for(var n=0;n<i;++n){if(n+r>=t.length||n>=e.length)break;t[n+r]=e[n]}return n}function te(e){return e!==e}}).call(this,"undefined"!==typeof r?r:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"base64-js":4,ieee754:16,isarray:21}],8:[function(e,t,r){r=t.exports=e("./debug");r.log=a;r.formatArgs=n;r.save=o;r.load=s;r.useColors=i;r.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u();r.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function i(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}r.formatters.j=function(e){return JSON.stringify(e)};function n(){var e=arguments;var t=this.useColors;e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ");if(!t)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0;var n=0;e[0].replace(/%[a-z%]/g,function(e){if("%%"===e)return;i++;"%c"===e&&(n=i)});e.splice(n,0,r);return e}function a(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(e){try{null==e?r.storage.removeItem("debug"):r.storage.debug=e}catch(e){}}function s(){var e;try{e=r.storage.debug}catch(e){}return e}r.enable(s());function u(){try{return window.localStorage}catch(e){}}},{"./debug":9}],9:[function(e,t,r){r=t.exports=a;r.coerce=c;r.disable=s;r.enable=o;r.enabled=u;r.names=[];r.skips=[];r.formatters={};var i=0;function n(){return r.colors[i++%r.colors.length]}function a(e){function t(){}t.enabled=false;function i(){var e=i;null==e.useColors&&(e.useColors=r.useColors());null==e.color&&e.useColors&&(e.color=n());var t=Array.prototype.slice.call(arguments);t[0]=r.coerce(t[0]);"string"!==typeof t[0]&&(t=["%o"].concat(t));var a=0;t[0]=t[0].replace(/%([a-z%])/g,function(i,n){if("%%"===i)return i;a++;var o=r.formatters[n];if("function"===typeof o){var s=t[a];i=o.call(e,s);t.splice(a,1);a--}return i});"function"===typeof r.formatArgs&&(t=r.formatArgs.apply(e,t));var o=i.log||r.log||console.log.bind(console);o.apply(e,t)}i.enabled=true;var a=r.enabled(e)?i:t;a.namespace=e;return a}function o(e){r.save(e);var t=(e||"").split(/[\s,]+/);var i=t.length;for(var n=0;n<i;n++){if(!t[n])continue;e=t[n].replace(/\*/g,".*?");"-"===e[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$"))}}function s(){r.enable("")}function u(e){var t,i;for(t=0,i=r.skips.length;t<i;t++)if(r.skips[t].test(e))return false;for(t=0,i=r.names.length;t<i;t++)if(r.names[t].test(e))return true;return false}function c(e){if(e instanceof Error)return e.stack||e.message;return e}},{}],10:[function(e,t,r){"use strict";var i=e("is-obj");var n=Object.prototype.hasOwnProperty;var a=Object.prototype.propertyIsEnumerable;function o(e){if(null===e||void 0===e)throw new TypeError("Sources cannot be null or undefined");return Object(e)}function s(e,t,r){var a=t[r];if(void 0===a||null===a)return;if(n.call(e,r)&&(void 0===e[r]||null===e[r]))throw new TypeError("Cannot convert undefined or null to object ("+r+")");n.call(e,r)&&i(a)?e[r]=u(Object(e[r]),t[r]):e[r]=a}function u(e,t){if(e===t)return e;t=Object(t);for(var r in t)n.call(t,r)&&s(e,t,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(var o=0;o<i.length;o++)a.call(t,i[o])&&s(e,t,i[o])}return e}t.exports=function e(t){t=o(t);for(var r=1;r<arguments.length;r++)u(t,arguments[r]);return t}},{"is-obj":20}],11:[function(t,r,i){(function(t,r,i,n){"use strict";function a(e,t){for(var r=0,i=e.length;r<i;r++)g(e[r],t)}function o(e){for(var t=0,r=e.length,i;t<r;t++)i=e[t],ge(i,O[u(i)])}function s(e){return function(t){J(t)&&(g(t,e),a(t.querySelectorAll(j),e))}}function u(e){var t=ee.call(e,"is"),r=e.nodeName.toUpperCase(),i=z.call(_,t?C+t.toUpperCase():D+r);return t&&-1<i&&!c(r,t)?-1:i}function c(e,t){return-1<j.indexOf(e+'[is="'+t+'"]')}function l(e){var t=e.currentTarget,r=e.attrChange,i=e.attrName,n=e.target;he&&(!n||n===t)&&t.attributeChangedCallback&&"style"!==i&&e.prevValue!==e.newValue&&t.attributeChangedCallback(i,r===e[E]?null:e.prevValue,r===e[b]?null:e.newValue)}function h(e){var t=s(e);return function(e){oe.push(t,e.target)}}function d(e){le&&(le=!1,e.currentTarget.removeEventListener(L,d)),a((e.target||r).querySelectorAll(j),e.detail===M?M:A),Z&&v()}function p(e,t){var r=this;te.call(r,e,t),de.call(r,{target:r})}function f(e,t){W(e,t),ve?ve.observe(e,ne):(ce&&(e.setAttribute=p,e[y]=fe(e),e.addEventListener(N,de)),e.addEventListener(T,l)),e.createdCallback&&he&&(e.created=!0,e.createdCallback(),e.created=!1)}function v(){for(var e,t=0,r=K.length;t<r;t++)e=K[t],R.contains(e)||(r--,K.splice(t--,1),g(e,M))}function m(e){throw new Error("A "+e+" type is already registered")}function g(e,t){var r,i=u(e);-1<i&&(me(e,O[i]),i=0,t!==A||e[A]?t===M&&!e[M]&&(e[A]=!1,e[M]=!0,i=1):(e[M]=!1,e[A]=!0,i=1,Z&&z.call(K,e)<0&&K.push(e)),i&&(r=e[t+"Callback"])&&r.call(e))}if(n in r)return;var y="__"+n+(1e5*Math.random()>>0),A="attached",M="detached",w="extends",E="ADDITION",x="MODIFICATION",b="REMOVAL",T="DOMAttrModified",L="DOMContentLoaded",N="DOMSubtreeModified",D="<",C="=",S=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,I=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],_=[],O=[],j="",R=r.documentElement,z=_.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},k=i.prototype,P=k.hasOwnProperty,U=k.isPrototypeOf,B=i.defineProperty,F=i.getOwnPropertyDescriptor,G=i.getOwnPropertyNames,H=i.getPrototypeOf,V=i.setPrototypeOf,Q=!!i.__proto__,Y=i.create||function e(t){return t?(e.prototype=t,new e):this},W=V||(Q?function(e,t){return e.__proto__=t,e}:G&&F?function(){function e(e,t){for(var r,i=G(t),n=0,a=i.length;n<a;n++)r=i[n],P.call(e,r)||B(e,r,F(t,r))}return function(t,r){do{e(t,r)}while((r=H(r))&&!U.call(r,t));return t}}():function(e,t){for(var r in t)e[r]=t[r];return e}),X=t.MutationObserver||t.WebKitMutationObserver,q=(t.HTMLElement||t.Element||t.Node).prototype,Z=!U.call(q,R),J=Z?function(e){return 1===e.nodeType}:function(e){return U.call(q,e)},K=Z&&[],$=q.cloneNode,ee=q.getAttribute,te=q.setAttribute,re=q.removeAttribute,ie=r.createElement,ne=X&&{attributes:!0,characterData:!0,attributeOldValue:!0},ae=X||function(e){ce=!1,R.removeEventListener(T,ae)},oe,se=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,10)},ue=!1,ce=!0,le=!0,he=!0,de,pe,fe,ve,me,ge;V||Q?(me=function(e,t){U.call(t,e)||f(e,t)},ge=f):(me=function(e,t){e[y]||(e[y]=i(!0),f(e,t))},ge=me),Z?(ce=!1,function(){var t=F(q,"addEventListener"),r=t.value,i=function(e){var t=new CustomEvent(T,{bubbles:!0});t.attrName=e,t.prevValue=ee.call(this,e),t.newValue=null,t[b]=t.attrChange=2,re.call(this,e),this.dispatchEvent(t)},n=function(t,r){var i=this.hasAttribute(t),n=i&&ee.call(this,t);e=new CustomEvent(T,{bubbles:!0}),te.call(this,t,r),e.attrName=t,e.prevValue=i?n:null,e.newValue=r,i?e[x]=e.attrChange=1:e[E]=e.attrChange=0,this.dispatchEvent(e)},a=function(e){var t=e.currentTarget,r=t[y],i=e.propertyName,n;r.hasOwnProperty(i)&&(r=r[i],n=new CustomEvent(T,{bubbles:!0}),n.attrName=r.name,n.prevValue=r.value||null,n.newValue=r.value=t[i]||null,null==n.prevValue?n[E]=n.attrChange=0:n[x]=n.attrChange=1,t.dispatchEvent(n))};t.value=function(e,t,o){e===T&&this.attributeChangedCallback&&this.setAttribute!==n&&(this[y]={className:{name:"class",value:this.className}},this.setAttribute=n,this.removeAttribute=i,r.call(this,"propertychange",a)),r.call(this,e,t,o)},B(q,"addEventListener",t)}()):X||(R.addEventListener(T,ae),R.setAttribute(y,1),R.removeAttribute(y),ce&&(de=function(e){var t=this,r,i,n;if(t===e.target){r=t[y],t[y]=i=fe(t);for(n in i){if(!(n in r))return pe(0,t,n,r[n],i[n],E);if(i[n]!==r[n])return pe(1,t,n,r[n],i[n],x)}for(n in r)if(!(n in i))return pe(2,t,n,r[n],i[n],b)}},pe=function(e,t,r,i,n,a){var o={attrChange:e,currentTarget:t,attrName:r,prevValue:i,newValue:n};o[a]=e,l(o)},fe=function(e){for(var t,r,i={},n=e.attributes,a=0,o=n.length;a<o;a++)t=n[a],r=t.name,"setAttribute"!==r&&(i[r]=t.value);return i})),r[n]=function(e,t){f=e.toUpperCase(),ue||(ue=!0,X?(ve=function(e,t){function r(e,t){for(var r=0,i=e.length;r<i;t(e[r++]));}return new X(function(i){for(var n,a,o,s=0,u=i.length;s<u;s++)n=i[s],"childList"===n.type?(r(n.addedNodes,e),r(n.removedNodes,t)):(a=n.target,he&&a.attributeChangedCallback&&"style"!==n.attributeName&&(o=ee.call(a,n.attributeName),o!==n.oldValue&&a.attributeChangedCallback(n.attributeName,n.oldValue,o)))})}(s(A),s(M)),ve.observe(r,{childList:!0,subtree:!0})):(oe=[],se(function e(){while(oe.length)oe.shift().call(null,oe.shift());se(e)}),r.addEventListener("DOMNodeInserted",h(A)),r.addEventListener("DOMNodeRemoved",h(M))),r.addEventListener(L,d),r.addEventListener("readystatechange",d),r.createElement=function(e,t){var i=ie.apply(r,arguments),n=""+e,a=z.call(_,(t?C:D)+(t||n).toUpperCase()),o=-1<a;return t&&(i.setAttribute("is",t=t.toLowerCase()),o&&(o=c(n.toUpperCase(),t))),he=!r.createElement.innerHTMLHelper,o&&ge(i,O[a]),i},q.cloneNode=function(e){var t=$.call(this,!!e),r=u(t);return-1<r&&ge(t,O[r]),e&&o(t.querySelectorAll(j)),t}),-2<z.call(_,C+f)+z.call(_,D+f)&&m(e);if(!S.test(f)||-1<z.call(I,f))throw new Error("The type "+e+" is invalid");var i=function(){return l?r.createElement(p,f):r.createElement(p)},n=t||k,l=P.call(n,w),p=l?t[w].toUpperCase():f,f,v;return l&&-1<z.call(_,D+p)&&m(p),v=_.push((l?C:D)+f)-1,j=j.concat(j.length?",":"",l?p+'[is="'+e.toLowerCase()+'"]':p),i.prototype=O[v]=P.call(n,"prototype")?n.prototype:Y(q),a(r.querySelectorAll(j),A),i}})(window,document,Object,"registerElement")},{}],12:[function(e,t,r){t.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],13:[function(e,t,r){var i=e("dtype");t.exports=n;function n(e,t,r){if(!e)throw new TypeError("must specify data as first parameter");r=0|+(r||0);if(Array.isArray(e)&&Array.isArray(e[0])){var n=e[0].length;var a=e.length*n;t&&"string"!==typeof t||(t=new(i(t||"float32"))(a+r));var o=t.length-r;if(a!==o)throw new Error("source length "+a+" ("+n+"x"+e.length+") does not match destination length "+o);for(var s=0,u=r;s<e.length;s++)for(var c=0;c<n;c++)t[u++]=e[s][c]}else if(t&&"string"!==typeof t)t.set(e,r);else{var l=i(t||"float32");if(0===r)t=new l(e);else{t=new l(e.length+r);t.set(e,r)}}return t}},{dtype:12}],14:[function(e,t,r){var i=e("is-function");t.exports=o;var n=Object.prototype.toString;var a=Object.prototype.hasOwnProperty;function o(e,t,r){if(!i(t))throw new TypeError("iterator must be a function");arguments.length<3&&(r=this);"[object Array]"===n.call(e)?s(e,t,r):"string"===typeof e?u(e,t,r):c(e,t,r)}function s(e,t,r){for(var i=0,n=e.length;i<n;i++)a.call(e,i)&&t.call(r,e[i],i,e)}function u(e,t,r){for(var i=0,n=e.length;i<n;i++)t.call(r,e.charAt(i),i,e)}function c(e,t,r){for(var i in e)a.call(e,i)&&t.call(r,e[i],i,e)}},{"is-function":19}],15:[function(e,t,i){(function(e){var r;r="undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{};t.exports=r}).call(this,"undefined"!==typeof r?r:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],16:[function(e,t,r){r.read=function(e,t,r,i,n){var a,o;var s=8*n-i-1;var u=(1<<s)-1;var c=u>>1;var l=-7;var h=r?n-1:0;var d=r?-1:1;var p=e[t+h];h+=d;a=p&(1<<-l)-1;p>>=-l;l+=s;for(;l>0;a=256*a+e[t+h],h+=d,l-=8);o=a&(1<<-l)-1;a>>=-l;l+=i;for(;l>0;o=256*o+e[t+h],h+=d,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:Infinity*(p?-1:1);o+=Math.pow(2,i);a-=c}return(p?-1:1)*o*Math.pow(2,a-i)};r.write=function(e,t,r,i,n,a){var o,s,u;var c=8*a-n-1;var l=(1<<c)-1;var h=l>>1;var d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0;var p=i?0:a-1;var f=i?1:-1;var v=t<0||0===t&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||Infinity===t){s=isNaN(t)?1:0;o=l}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(u=Math.pow(2,-o))<1){o--;u*=2}t+=o+h>=1?d/u:d*Math.pow(2,1-h);if(t*u>=2){o++;u/=2}if(o+h>=l){s=0;o=l}else if(o+h>=1){s=(t*u-1)*Math.pow(2,n);o+=h}else{s=t*Math.pow(2,h-1)*Math.pow(2,n);o=0}}for(;n>=8;e[r+p]=255&s,p+=f,s/=256,n-=8);o=o<<n|s;c+=n;for(;c>0;e[r+p]=255&o,p+=f,o/=256,c-=8);e[r+p-f]|=128*v}},{}],17:[function(e,t,r){"function"===typeof Object.create?t.exports=function e(t,r){t.super_=r;t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}:t.exports=function e(t,r){t.super_=r;var i=function(){};i.prototype=r.prototype;t.prototype=new i;t.prototype.constructor=t}},{}],18:[function(e,t,r){t.exports=function(e){return null!=e&&(i(e)||n(e)||!!e._isBuffer)};function i(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function n(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&i(e.slice(0,0))}},{}],19:[function(e,t,r){t.exports=n;var i=Object.prototype.toString;function n(e){var t=i.call(e);return"[object Function]"===t||"function"===typeof e&&"[object RegExp]"!==t||"undefined"!==typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}},{}],20:[function(e,t,r){"use strict";t.exports=function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}},{}],21:[function(e,t,r){var i={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},{}],22:[function(e,t,r){var i=e("word-wrapper");var n=e("xtend");var a=e("as-number");var o=["x","e","a","o","n","s","r","c","u","m","v","w","z"];var s=["m","w"];var u=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"];var c="\t".charCodeAt(0);var l=" ".charCodeAt(0);var h=0,d=1,p=2;t.exports=function e(t){return new f(t)};function f(e){this.glyphs=[];this._measure=this.computeMetrics.bind(this);this.update(e)}f.prototype.update=function(e){e=n({measure:this._measure},e);this._opt=e;this._opt.tabSize=a(this._opt.tabSize,4);if(!e.font)throw new Error("must provide a valid bitmap font");var t=this.glyphs;var r=e.text||"";var o=e.font;this._setupSpaceGlyphs(o);var s=i.lines(r,e);var u=e.width||0;t.length=0;var c=s.reduce(function(e,t){return Math.max(e,t.width,u)},0);var l=0;var h=0;var f=a(e.lineHeight,o.common.lineHeight);var v=o.common.base;var m=f-v;var g=e.letterSpacing||0;var A=f*s.length-m;var x=E(this._opt.align);h-=A;this._width=c;this._height=A;this._descender=f-v;this._baseline=v;this._xHeight=y(o);this._capHeight=M(o);this._lineHeight=f;this._ascender=f-m-this._xHeight;var b=this;s.forEach(function(e,i){var n=e.start;var a=e.end;var s=e.width;var u;for(var v=n;v<a;v++){var m=r.charCodeAt(v);var y=b.getGlyph(o,m);if(y){u&&(l+=w(o,u.id,y.id));var A=l;x===d?A+=(c-s)/2:x===p&&(A+=c-s);t.push({position:[A,h],data:y,index:v,line:i});l+=y.xadvance+g;u=y}}h+=f;l=0});this._linesTotal=s.length};f.prototype._setupSpaceGlyphs=function(e){this._fallbackSpaceGlyph=null;this._fallbackTabGlyph=null;if(!e.chars||0===e.chars.length)return;var t=g(e,l)||A(e)||e.chars[0];var r=this._opt.tabSize*t.xadvance;this._fallbackSpaceGlyph=t;this._fallbackTabGlyph=n(t,{x:0,y:0,xadvance:r,id:c,xoffset:0,yoffset:0,width:0,height:0})};f.prototype.getGlyph=function(e,t){var r=g(e,t);if(r)return r;if(t===c)return this._fallbackTabGlyph;if(t===l)return this._fallbackSpaceGlyph;return null};f.prototype.computeMetrics=function(e,t,r,i){var n=this._opt.letterSpacing||0;var a=this._opt.font;var o=0;var s=0;var u=0;var c;var l;if(!a.chars||0===a.chars.length)return{start:t,end:t,width:0};r=Math.min(e.length,r);for(var h=t;h<r;h++){var d=e.charCodeAt(h);var c=this.getGlyph(a,d);if(c){var p=c.xoffset;var f=l?w(a,l.id,c.id):0;o+=f;var v=o+c.xadvance+n;var m=o+c.width;if(m>=i||v>=i)break;o=v;s=m;l=c}u++}l&&(s+=l.xoffset);return{start:t,end:t+u,width:s}};["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(v);function v(e){Object.defineProperty(f.prototype,e,{get:m(e),configurable:true})}function m(e){return new Function(["return function "+e+"() {","  return this._"+e,"}"].join("\n"))()}function g(e,t){if(!e.chars||0===e.chars.length)return null;var r=x(e.chars,t);if(r>=0)return e.chars[r];return null}function y(e){for(var t=0;t<o.length;t++){var r=o[t].charCodeAt(0);var i=x(e.chars,r);if(i>=0)return e.chars[i].height}return 0}function A(e){for(var t=0;t<s.length;t++){var r=s[t].charCodeAt(0);var i=x(e.chars,r);if(i>=0)return e.chars[i]}return 0}function M(e){for(var t=0;t<u.length;t++){var r=u[t].charCodeAt(0);var i=x(e.chars,r);if(i>=0)return e.chars[i].height}return 0}function w(e,t,r){if(!e.kernings||0===e.kernings.length)return 0;var i=e.kernings;for(var n=0;n<i.length;n++){var a=i[n];if(a.first===t&&a.second===r)return a.amount}return 0}function E(e){if("center"===e)return d;if("right"===e)return p;return h}function x(e,t,r){r=r||0;for(var i=r;i<e.length;i++)if(e[i].id===t)return i;return-1}},{"as-number":3,"word-wrapper":47,xtend:50}],23:[function(e,t,r){(function(r){var i=e("xhr");var n=function(){};var a=e("parse-bmfont-ascii");var o=e("parse-bmfont-xml");var s=e("parse-bmfont-binary");var u=e("./lib/is-binary");var c=e("xtend");var l=function e(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();t.exports=function(e,t){t="function"===typeof t?t:n;"string"===typeof e?e={uri:e}:e||(e={});var c=e.binary;c&&(e=d(e));i(e,function(i,c,l){if(i)return t(i);if(!/^2/.test(c.statusCode))return t(new Error("http status code: "+c.statusCode));if(!l)return t(new Error("no body result"));var d=false;if(h(l)){var p=new Uint8Array(l);l=new r(p,"binary")}if(u(l)){d=true;"string"===typeof l&&(l=new r(l,"binary"))}if(!d){r.isBuffer(l)&&(l=l.toString(e.encoding));l=l.trim()}var f;try{var v=c.headers["content-type"];f=d?s(l):/json/.test(v)||"{"===l.charAt(0)?JSON.parse(l):/xml/.test(v)||"<"===l.charAt(0)?o(l):a(l)}catch(e){t(new Error("error parsing font "+e.message));t=n}t(null,f)})};function h(e){var t=Object.prototype.toString;return"[object ArrayBuffer]"===t.call(e)}function d(e){if(l)return c(e,{responseType:"arraybuffer"});if("undefined"===typeof self.XMLHttpRequest)throw new Error("your browser does not support XHR loading");var t=new self.XMLHttpRequest;t.overrideMimeType("text/plain; charset=x-user-defined");return c({xhr:t},e)}}).call(this,e("buffer").Buffer)},{"./lib/is-binary":24,buffer:7,"parse-bmfont-ascii":26,"parse-bmfont-binary":27,"parse-bmfont-xml":28,xhr:48,xtend:50}],24:[function(e,t,r){(function(r){var i=e("buffer-equal");var n=new r([66,77,70,3]);t.exports=function(e){if("string"===typeof e)return"BMF"===e.substring(0,3);return e.length>4&&i(e.slice(0,4),n)}}).call(this,e("buffer").Buffer)},{buffer:7,"buffer-equal":6}],25:[function(e,t,r){"use strict";var i=Object.getOwnPropertySymbols;var n=Object.prototype.hasOwnProperty;var a=Object.prototype.propertyIsEnumerable;function o(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function s(){try{if(!Object.assign)return false;var e=new String("abc");e[5]="de";if("5"===Object.getOwnPropertyNames(e)[0])return false;var t={};for(var r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var i=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==i.join(""))return false;var n={};"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e});if("abcdefghijklmnopqrst"!==Object.keys(Object.assign({},n)).join(""))return false;return true}catch(e){return false}}t.exports=s()?Object.assign:function(e,t){var r;var s=o(e);var u;for(var c=1;c<arguments.length;c++){r=Object(arguments[c]);for(var l in r)n.call(r,l)&&(s[l]=r[l]);if(i){u=i(r);for(var h=0;h<u.length;h++)a.call(r,u[h])&&(s[u[h]]=r[u[h]])}}return s}},{}],26:[function(e,t,r){t.exports=function e(t){if(!t)throw new Error("no data provided");t=t.toString().trim();var r={pages:[],chars:[],kernings:[]};var n=t.split(/\r\n?|\n/g);if(0===n.length)throw new Error("no data in BMFont file");for(var a=0;a<n.length;a++){var o=i(n[a],a);if(!o)continue;if("page"===o.key){if("number"!==typeof o.data.id)throw new Error("malformed file at line "+a+" -- needs page id=N");if("string"!==typeof o.data.file)throw new Error("malformed file at line "+a+' -- needs page file="path"');r.pages[o.data.id]=o.data.file}else"chars"===o.key||"kernings"===o.key||("char"===o.key?r.chars.push(o.data):"kerning"===o.key?r.kernings.push(o.data):r[o.key]=o.data)}return r};function i(e,t){e=e.replace(/\t+/g," ").trim();if(!e)return null;var r=e.indexOf(" ");if(-1===r)throw new Error("no named row at line "+t);var i=e.substring(0,r);e=e.substring(r+1);e=e.replace(/letter=[\'\"]\S+[\'\"]/gi,"");e=e.split("=");e=e.map(function(e){return e.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});var a=[];for(var o=0;o<e.length;o++){var s=e[o];if(0===o)a.push({key:s[0],data:""});else if(o===e.length-1)a[a.length-1].data=n(s[0]);else{a[a.length-1].data=n(s[0]);a.push({key:s[1],data:""})}}var u={key:i,data:{}};a.forEach(function(e){u.data[e.key]=e.data});return u}function n(e){if(!e||0===e.length)return"";if(0===e.indexOf('"')||0===e.indexOf("'"))return e.substring(1,e.length-1);if(-1!==e.indexOf(","))return a(e);return parseInt(e,10)}function a(e){return e.split(",").map(function(e){return parseInt(e,10)})}},{}],27:[function(e,t,r){var i=[66,77,70];t.exports=function e(t){if(t.length<6)throw new Error("invalid buffer length for BMFont");var r=i.every(function(e,r){return t.readUInt8(r)===e});if(!r)throw new Error("BMFont missing BMF byte header");var a=3;var o=t.readUInt8(a++);if(o>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");var s={kernings:[],chars:[]};for(var u=0;u<5;u++)a+=n(s,t,a);return s};function n(e,t,r){if(r>t.length-1)return 0;var i=t.readUInt8(r++);var n=t.readInt32LE(r);r+=4;switch(i){case 1:e.info=a(t,r);break;case 2:e.common=o(t,r);break;case 3:e.pages=s(t,r,n);break;case 4:e.chars=u(t,r,n);break;case 5:e.kernings=c(t,r,n);break}return 5+n}function a(e,t){var r={};r.size=e.readInt16LE(t);var i=e.readUInt8(t+2);r.smooth=i>>7&1;r.unicode=i>>6&1;r.italic=i>>5&1;r.bold=i>>4&1;i>>3&1&&(r.fixedHeight=1);r.charset=e.readUInt8(t+3)||"";r.stretchH=e.readUInt16LE(t+4);r.aa=e.readUInt8(t+6);r.padding=[e.readInt8(t+7),e.readInt8(t+8),e.readInt8(t+9),e.readInt8(t+10)];r.spacing=[e.readInt8(t+11),e.readInt8(t+12)];r.outline=e.readUInt8(t+13);r.face=h(e,t+14);return r}function o(e,t){var r={};r.lineHeight=e.readUInt16LE(t);r.base=e.readUInt16LE(t+2);r.scaleW=e.readUInt16LE(t+4);r.scaleH=e.readUInt16LE(t+6);r.pages=e.readUInt16LE(t+8);var i=e.readUInt8(t+10);r.packed=0;r.alphaChnl=e.readUInt8(t+11);r.redChnl=e.readUInt8(t+12);r.greenChnl=e.readUInt8(t+13);r.blueChnl=e.readUInt8(t+14);return r}function s(e,t,r){var i=[];var n=l(e,t);var a=n.length+1;var o=r/a;for(var s=0;s<o;s++){i[s]=e.slice(t,t+n.length).toString("utf8");t+=a}return i}function u(e,t,r){var i=[];var n=r/20;for(var a=0;a<n;a++){var o={};var s=20*a;o.id=e.readUInt32LE(t+0+s);o.x=e.readUInt16LE(t+4+s);o.y=e.readUInt16LE(t+6+s);o.width=e.readUInt16LE(t+8+s);o.height=e.readUInt16LE(t+10+s);o.xoffset=e.readInt16LE(t+12+s);o.yoffset=e.readInt16LE(t+14+s);o.xadvance=e.readInt16LE(t+16+s);o.page=e.readUInt8(t+18+s);o.chnl=e.readUInt8(t+19+s);i[a]=o}return i}function c(e,t,r){var i=[];var n=r/10;for(var a=0;a<n;a++){var o={};var s=10*a;o.first=e.readUInt32LE(t+0+s);o.second=e.readUInt32LE(t+4+s);o.amount=e.readInt16LE(t+8+s);i[a]=o}return i}function l(e,t){var r=t;for(;r<e.length;r++)if(0===e[r])break;return e.slice(t,r)}function h(e,t){return l(e,t).toString("utf8")}},{}],28:[function(e,t,r){var i=e("./parse-attribs");var n=e("xml-parse-from-string");var a={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};t.exports=function e(t){t=t.toString();var r=n(t);var a={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(e){var t=r.getElementsByTagName(e)[0];t&&(a[e]=i(o(t)))});var s=r.getElementsByTagName("pages")[0];if(!s)throw new Error("malformed file -- no <pages> element");var u=s.getElementsByTagName("page");for(var c=0;c<u.length;c++){var l=u[c];var h=parseInt(l.getAttribute("id"),10);var d=l.getAttribute("file");if(isNaN(h))throw new Error('malformed file -- page "id" attribute is NaN');if(!d)throw new Error('malformed file -- needs page "file" attribute');a.pages[parseInt(h,10)]=d}["chars","kernings"].forEach(function(e){var t=r.getElementsByTagName(e)[0];if(!t)return;var n=e.substring(0,e.length-1);var s=t.getElementsByTagName(n);for(var u=0;u<s.length;u++){var c=s[u];a[e].push(i(o(c)))}});return a};function o(e){var t=s(e);return t.reduce(function(e,t){var r=u(t.nodeName);e[r]=t.nodeValue;return e},{})}function s(e){var t=[];for(var r=0;r<e.attributes.length;r++)t.push(e.attributes[r]);return t}function u(e){return a[e.toLowerCase()]||e}},{"./parse-attribs":29,"xml-parse-from-string":49}],29:[function(e,t,r){var i="chasrset";t.exports=function e(t){if(i in t){t["charset"]=t[i];delete t[i]}for(var r in t){if("face"===r||"charset"===r)continue;t[r]="padding"===r||"spacing"===r?n(t[r]):parseInt(t[r],10)}return t};function n(e){return e.split(",").map(function(e){return parseInt(e,10)})}},{}],30:[function(e,t,r){var i=e("trim"),n=e("for-each"),a=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};var t={};n(i(e).split("\n"),function(e){var r=e.indexOf(":"),n=i(e.slice(0,r)).toLowerCase(),o=i(e.slice(r+1));"undefined"===typeof t[n]?t[n]=o:a(t[n])?t[n].push(o):t[n]=[t[n],o]});return t}},{"for-each":14,trim:45}],31:[function(e,t,i){(function(e){var r=e.performance||{};var i=function(){var e=["now","webkitNow","msNow","mozNow","oNow"];while(e.length){var t=e.shift();if(t in r)return r[t].bind(r)}var i=Date.now||function(){return(new Date).getTime()};var n=(r.timing||{}).navigationStart||i();return function(){return i()-n}}();i.performanceNow=r.now;i.noConflict=function(){r.now=i.performanceNow};i.conflict=function(){r.now=i};i.conflict();t.exports=i}).call(this,"undefined"!==typeof r?r:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],32:[function(e,t,r){var i=t.exports={};var n;var a;function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{n="function"===typeof setTimeout?setTimeout:o}catch(e){n=o}try{a="function"===typeof clearTimeout?clearTimeout:s}catch(e){a=s}})();function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function c(e){if(a===clearTimeout)return clearTimeout(e);if((a===s||!a)&&clearTimeout){a=clearTimeout;return clearTimeout(e)}try{return a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}var l=[];var h=false;var d;var p=-1;function f(){if(!h||!d)return;h=false;d.length?l=d.concat(l):p=-1;l.length&&v()}function v(){if(h)return;var e=u(f);h=true;var t=l.length;while(t){d=l;l=[];while(++p<t)d&&d[p].run();p=-1;t=l.length}d=null;h=false;c(e)}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new m(e,t));1!==l.length||h||u(v)};function m(e,t){this.fun=e;this.array=t}m.prototype.run=function(){this.fun.apply(null,this.array)};i.title="browser";i.browser=true;i.env={};i.argv=[];i.version="";i.versions={};function g(){}i.on=g;i.addListener=g;i.once=g;i.off=g;i.removeListener=g;i.removeAllListeners=g;i.emit=g;i.prependListener=g;i.prependOnceListener=g;i.listeners=function(e){return[]};i.binding=function(e){throw new Error("process.binding is not supported")};i.cwd=function(){return"/"};i.chdir=function(e){throw new Error("process.chdir is not supported")};i.umask=function(){return 0}},{}],33:[function(e,t,r){(function(e){var r=setTimeout;var n="function"===typeof i&&i||function(e){r(e,1)};function a(e,t){return function(){e.apply(t,arguments)}}var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function s(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("not a function");this._state=null;this._value=null;this._deferreds=[];p(e,a(c,this),a(l,this))}function u(e){var t=this;if(null===this._state){this._deferreds.push(e);return}n(function(){var r=t._state?e.onFulfilled:e.onRejected;if(null===r){(t._state?e.resolve:e.reject)(t._value);return}var i;try{i=r(t._value)}catch(t){e.reject(t);return}e.resolve(i)})}function c(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var t=e.then;if("function"===typeof t){p(a(t,e),a(c,this),a(l,this));return}}this._state=true;this._value=e;h.call(this)}catch(e){l.call(this,e)}}function l(e){this._state=false;this._value=e;h.call(this)}function h(){for(var e=0,t=this._deferreds.length;e<t;e++)u.call(this,this._deferreds[e]);this._deferreds=null}function d(e,t,r,i){this.onFulfilled="function"===typeof e?e:null;this.onRejected="function"===typeof t?t:null;this.resolve=r;this.reject=i}function p(e,t,r){var i=false;try{e(function(e){if(i)return;i=true;t(e)},function(e){if(i)return;i=true;r(e)})}catch(e){if(i)return;i=true;r(e)}}s.prototype["catch"]=function(e){return this.then(null,e)};s.prototype.then=function(e,t){var r=this;return new s(function(i,n){u.call(r,new d(e,t,i,n))})};s.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&o(arguments[0])?arguments[0]:arguments);return new s(function(t,r){if(0===e.length)return t([]);var i=e.length;function n(a,o){try{if(o&&("object"===typeof o||"function"===typeof o)){var s=o.then;if("function"===typeof s){s.call(o,function(e){n(a,e)},r);return}}e[a]=o;0===--i&&t(e)}catch(e){r(e)}}for(var a=0;a<e.length;a++)n(a,e[a])})};s.resolve=function(e){if(e&&"object"===typeof e&&e.constructor===s)return e;return new s(function(t){t(e)})};s.reject=function(e){return new s(function(t,r){r(e)})};s.race=function(e){return new s(function(t,r){for(var i=0,n=e.length;i<n;i++)e[i].then(t,r)})};s._setImmediateFn=function e(t){n=t};"undefined"!==typeof t&&t.exports?t.exports=s:e.Promise||(e.Promise=s)})(this)},{}],34:[function(e,t,r){var i=e("dtype");var n=e("an-array");var a=e("is-buffer");var o=[0,2,3];var s=[2,1,3];t.exports=function e(t,r){if(!t||!(n(t)||a(t))){r=t||{};t=null}r="number"===typeof r?{count:r}:r||{};var u="string"===typeof r.type?r.type:"uint16";var c="number"===typeof r.count?r.count:1;var l=r.start||0;var h=false!==r.clockwise?o:s,d=h[0],p=h[1],f=h[2];var v=6*c;var m=t||new(i(u))(v);for(var g=0,y=0;g<v;g+=6,y+=4){var A=g+l;m[A+0]=y+0;m[A+1]=y+1;m[A+2]=y+2;m[A+3]=y+d;m[A+4]=y+p;m[A+5]=y+f}return m}},{"an-array":2,dtype:12,"is-buffer":18}],35:[function(e,t,r){function i(e,t){t=t||{};var r=t.preserveNumbers;var i=function(e){return e.trim()};var o={};a(e).map(i).filter(Boolean).forEach(function(e){var t=e.indexOf(":");var i=e.substr(0,t).trim();var a=e.substr(t+1).trim();r&&n(a)&&(a=Number(a));o[i]=a});return o}function n(e){return!isNaN(parseFloat(e))&&isFinite(e)}function a(e){var t=[];var r=0;var i=";";var n=/url\([^\)]+$/;var a="";var o;while(r<e.length){o=e.indexOf(i,r);-1===o&&(o=e.length);a+=e.substring(r,o);if(n.test(a)){a+=";";r=o+1;continue}t.push(a);a="";r=o+1}return t}function o(e){return Object.keys(e).map(function(t){return t+":"+e[t]}).join(";")}function s(e,t){return o(i(e,t))}t.exports.parse=i;t.exports.stringify=o;t.exports.normalize=s},{}],36:[function(e,t,r){var i=e("layout-bmfont-text");var n=e("inherits");var a=e("quad-indices");var o=e("three-buffer-vertex-data");var s=e("object-assign");var u=e("./lib/vertices");var c=e("./lib/utils");var l=THREE.BufferGeometry;t.exports=function e(t){return new h(t)};function h(e){l.call(this);"string"===typeof e&&(e={text:e});this._opt=s({},e);e&&this.update(e)}n(h,l);h.prototype.update=function(e){"string"===typeof e&&(e={text:e});e=s({},this._opt,e);if(!e.font)throw new TypeError("must specify a { font } in options");this.layout=i(e);var t=false!==e.flipY;var r=e.font;var n=r.common.scaleW;var c=r.common.scaleH;var l=this.layout.glyphs.filter(function(e){var t=e.data;return t.width*t.height>0});this.visibleGlyphs=l;var h=u.positions(l);var d=u.uvs(l,n,c,t);var p=a({clockwise:true,type:"uint16",count:l.length});o.index(this,p,1,"uint16");o.attr(this,"position",h,2);o.attr(this,"uv",d,2);if(!e.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(e.multipage){var f=u.pages(l);o.attr(this,"page",f,1)}};h.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array;var t=this.attributes.position.itemSize;if(!e||!t||e.length<2){this.boundingSphere.radius=0;this.boundingSphere.center.set(0,0,0);return}c.computeSphere(e,this.boundingSphere);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')};h.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.boundingBox;var t=this.attributes.position.array;var r=this.attributes.position.itemSize;if(!t||!r||t.length<2){e.makeEmpty();return}c.computeBox(t,e)}},{"./lib/utils":37,"./lib/vertices":38,inherits:17,"layout-bmfont-text":22,"object-assign":25,"quad-indices":34,"three-buffer-vertex-data":39}],37:[function(e,t,r){var i=2;var n={min:[0,0],max:[0,0]};function a(e){var t=e.length/i;n.min[0]=e[0];n.min[1]=e[1];n.max[0]=e[0];n.max[1]=e[1];for(var r=0;r<t;r++){var a=e[r*i+0];var o=e[r*i+1];n.min[0]=Math.min(a,n.min[0]);n.min[1]=Math.min(o,n.min[1]);n.max[0]=Math.max(a,n.max[0]);n.max[1]=Math.max(o,n.max[1])}}t.exports.computeBox=function(e,t){a(e);t.min.set(n.min[0],n.min[1],0);t.max.set(n.max[0],n.max[1],0)};t.exports.computeSphere=function(e,t){a(e);var r=n.min[0];var i=n.min[1];var o=n.max[0];var s=n.max[1];var u=o-r;var c=s-i;var l=Math.sqrt(u*u+c*c);t.center.set(r+u/2,i+c/2,0);t.radius=l/2}},{}],38:[function(e,t,r){t.exports.pages=function e(t){var e=new Float32Array(4*t.length*1);var r=0;t.forEach(function(t){var i=t.data.page||0;e[r++]=i;e[r++]=i;e[r++]=i;e[r++]=i});return e};t.exports.uvs=function e(t,r,i,n){var e=new Float32Array(4*t.length*2);var a=0;t.forEach(function(t){var o=t.data;var s=o.x+o.width;var u=o.y+o.height;var c=o.x/r;var l=o.y/i;var h=s/r;var d=u/i;if(n){l=(i-o.y)/i;d=(i-u)/i}e[a++]=c;e[a++]=l;e[a++]=c;e[a++]=d;e[a++]=h;e[a++]=d;e[a++]=h;e[a++]=l});return e};t.exports.positions=function e(t){var e=new Float32Array(4*t.length*2);var r=0;t.forEach(function(t){var i=t.data;var n=t.position[0]+i.xoffset;var a=t.position[1]+i.yoffset;var o=i.width;var s=i.height;e[r++]=n;e[r++]=a;e[r++]=n;e[r++]=a+s;e[r++]=n+o;e[r++]=a+s;e[r++]=n+o;e[r++]=a});return e}},{}],39:[function(e,t,r){var i=e("flatten-vertex-data");var n=false;t.exports.attr=o;t.exports.index=a;function a(e,t,r,i){"number"!==typeof r&&(r=1);"string"!==typeof i&&(i="uint16");var n=!e.index&&"function"!==typeof e.setIndex;var a=n?e.getAttribute("index"):e.index;var o=s(a,t,r,i);o&&(n?e.addAttribute("index",o):e.index=o)}function o(e,t,r,i,n){"number"!==typeof i&&(i=3);"string"!==typeof n&&(n="float32");if(Array.isArray(r)&&Array.isArray(r[0])&&r[0].length!==i)throw new Error("Nested vertex array has unexpected size; expected "+i+" but found "+r[0].length);var a=e.getAttribute(t);var o=s(a,r,i,n);o&&e.addAttribute(t,o)}function s(e,t,r,a){t=t||[];if(!e||u(e,t,r)){t=i(t,a);var o=e&&"function"!==typeof e.setArray;if(!e||o){if(o&&!n){n=true;console.warn(["A WebGL buffer is being updated with a new size or itemSize, ","however this version of ThreeJS only supports fixed-size buffers.","\nThe old buffer may still be kept in memory.\n","To avoid memory leaks, it is recommended that you dispose ","your geometries and create new ones, or update to ThreeJS r82 or newer.\n","See here for discussion:\n","https://github.com/mrdoob/three.js/pull/9631"].join(""))}e=new THREE.BufferAttribute(t,r)}e.itemSize=r;e.needsUpdate=true;"function"===typeof e.setArray&&e.setArray(t);return e}i(t,e.array);e.needsUpdate=true;return null}function u(e,t,r){if(e.itemSize!==r)return true;if(!e.array)return true;var i=e.array.length;return Array.isArray(t)&&Array.isArray(t[0])?i!==t.length*r:i!==t.length}},{"flatten-vertex-data":13}],40:[function(e,r,i){(function(e,n){"object"===typeof i&&"undefined"!==typeof r?n(i):"function"===typeof t&&t.amd?t(["exports"],n):n(e.THREE={})})(this,function(e){"use strict";void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e});void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e});"name"in Function.prototype===false&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});void 0===Object.assign&&function(){Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");var t=Object(e);for(var r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}}();function t(){}Object.assign(t.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]);-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return false;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0===this._listeners)return;var r=this._listeners;var i=r[e];if(void 0!==i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}},dispatchEvent:function(e){if(void 0===this._listeners)return;var t=this._listeners;var r=t[e.type];if(void 0!==r){e.target=this;var i=r.slice(0);for(var n=0,a=i.length;n<a;n++)i[n].call(this,e)}}});var r="90";var i={LEFT:0,MIDDLE:1,RIGHT:2};var n=0;var a=1;var o=2;var s=3;var u=0;var c=1;var l=0;var h=1;var d=2;var p=0;var f=1;var v=2;var m=1;var g=2;var y=0;var A=1;var M=2;var w=0;var E=1;var x=2;var b=3;var T=4;var L=5;var N=100;var D=101;var C=102;var S=103;var I=104;var _=200;var O=201;var j=202;var R=203;var z=204;var k=205;var P=206;var U=207;var B=208;var F=209;var G=210;var H=0;var V=1;var Q=2;var Y=3;var W=4;var X=5;var q=6;var Z=7;var J=0;var K=1;var $=2;var ee=0;var te=1;var re=2;var ie=3;var ne=4;var ae=300;var oe=301;var se=302;var ue=303;var ce=304;var le=305;var he=306;var de=307;var pe=1e3;var fe=1001;var ve=1002;var me=1003;var ge=1004;var ye=1005;var Ae=1006;var Me=1007;var we=1008;var Ee=1009;var xe=1010;var be=1011;var Te=1012;var Le=1013;var Ne=1014;var De=1015;var Ce=1016;var Se=1017;var Ie=1018;var _e=1019;var Oe=1020;var je=1021;var Re=1022;var ze=1023;var ke=1024;var Pe=1025;var Ue=ze;var Be=1026;var Fe=1027;var Ge=33776;var He=33777;var Ve=33778;var Qe=33779;var Ye=35840;var We=35841;var Xe=35842;var qe=35843;var Ze=36196;var Je=37808;var Ke=37809;var $e=37810;var et=37811;var tt=37812;var rt=37813;var it=37814;var nt=37815;var at=37816;var ot=37817;var st=37818;var ut=37819;var ct=37820;var lt=37821;var ht=2200;var dt=2201;var pt=2202;var ft=2300;var vt=2301;var mt=2302;var gt=2400;var yt=2401;var At=2402;var Mt=0;var wt=1;var Et=2;var xt=3e3;var bt=3001;var Tt=3007;var Lt=3002;var Nt=3003;var Dt=3004;var Ct=3005;var St=3006;var It=3200;var _t=3201;var Ot={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=[];for(var t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16).toUpperCase();return function t(){var r=4294967295*Math.random()|0;var i=4294967295*Math.random()|0;var n=4294967295*Math.random()|0;var a=4294967295*Math.random()|0;return e[255&r]+e[r>>8&255]+e[r>>16&255]+e[r>>24&255]+"-"+e[255&i]+e[i>>8&255]+"-"+e[i>>16&15|64]+e[i>>24&255]+"-"+e[63&n|128]+e[n>>8&255]+"-"+e[n>>16&255]+e[n>>24&255]+e[255&a]+e[a>>8&255]+e[a>>16&255]+e[a>>24&255]}}(),clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){if(e<=t)return 0;if(e>=r)return 1;e=(e-t)/(r-t);return e*e*(3-2*e)},smootherstep:function(e,t,r){if(e<=t)return 0;if(e>=r)return 1;e=(e-t)/(r-t);return e*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Ot.DEG2RAD},radToDeg:function(e){return e*Ot.RAD2DEG},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function jt(e,t){this.x=e||0;this.y=t||0}Object.defineProperties(jt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}});Object.assign(jt.prototype,{isVector2:true,set:function(e,t){this.x=e;this.y=t;return this},setScalar:function(e){this.x=e;this.y=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){this.x=e.x;this.y=e.y;return this},add:function(e,t){if(void 0!==t){console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;return this},addScalar:function(e){this.x+=e;this.y+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;return this},sub:function(e,t){if(void 0!==t){console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;return this},subScalar:function(e){this.x-=e;this.y-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;return this},multiply:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;return this},divide:function(e){this.x/=e.x;this.y/=e.y;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,r=this.y;var i=e.elements;this.x=i[0]*t+i[3]*r+i[6];this.y=i[1]*t+i[4]*r+i[7];return this},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));return this},clampScalar:function(){var e=new jt;var t=new jt;return function r(i,n){e.set(i,i);t.set(n,n);return this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);e<0&&(e+=2*Math.PI);return e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;return this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){void 0===t&&(t=0);this.x=e[t];this.y=e[t+1];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this.x;e[t+1]=this.y;return e},fromBufferAttribute:function(e,t,r){void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute().");this.x=e.getX(t);this.y=e.getY(t);return this},rotateAround:function(e,t){var r=Math.cos(t),i=Math.sin(t);var n=this.x-e.x;var a=this.y-e.y;this.x=n*r-a*i+e.x;this.y=n*i+a*r+e.y;return this}});function Rt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Rt.prototype,{isMatrix4:true,set:function(e,t,r,i,n,a,o,s,u,c,l,h,d,p,f,v){var m=this.elements;m[0]=e;m[4]=t;m[8]=r;m[12]=i;m[1]=n;m[5]=a;m[9]=o;m[13]=s;m[2]=u;m[6]=c;m[10]=l;m[14]=h;m[3]=d;m[7]=p;m[11]=f;m[15]=v;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new Rt).fromArray(this.elements)},copy:function(e){var t=this.elements;var r=e.elements;t[0]=r[0];t[1]=r[1];t[2]=r[2];t[3]=r[3];t[4]=r[4];t[5]=r[5];t[6]=r[6];t[7]=r[7];t[8]=r[8];t[9]=r[9];t[10]=r[10];t[11]=r[11];t[12]=r[12];t[13]=r[13];t[14]=r[14];t[15]=r[15];return this},copyPosition:function(e){var t=this.elements,r=e.elements;t[12]=r[12];t[13]=r[13];t[14]=r[14];return this},extractBasis:function(e,t,r){e.setFromMatrixColumn(this,0);t.setFromMatrixColumn(this,1);r.setFromMatrixColumn(this,2);return this},makeBasis:function(e,t,r){this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1);return this},extractRotation:function(){var e=new kt;return function t(r){var i=this.elements;var n=r.elements;var a=1/e.setFromMatrixColumn(r,0).length();var o=1/e.setFromMatrixColumn(r,1).length();var s=1/e.setFromMatrixColumn(r,2).length();i[0]=n[0]*a;i[1]=n[1]*a;i[2]=n[2]*a;i[4]=n[4]*o;i[5]=n[5]*o;i[6]=n[6]*o;i[8]=n[8]*s;i[9]=n[9]*s;i[10]=n[10]*s;return this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements;var r=e.x,i=e.y,n=e.z;var a=Math.cos(r),o=Math.sin(r);var s=Math.cos(i),u=Math.sin(i);var c=Math.cos(n),l=Math.sin(n);if("XYZ"===e.order){var h=a*c,d=a*l,p=o*c,f=o*l;t[0]=s*c;t[4]=-s*l;t[8]=u;t[1]=d+p*u;t[5]=h-f*u;t[9]=-o*s;t[2]=f-h*u;t[6]=p+d*u;t[10]=a*s}else if("YXZ"===e.order){var v=s*c,m=s*l,g=u*c,y=u*l;t[0]=v+y*o;t[4]=g*o-m;t[8]=a*u;t[1]=a*l;t[5]=a*c;t[9]=-o;t[2]=m*o-g;t[6]=y+v*o;t[10]=a*s}else if("ZXY"===e.order){var v=s*c,m=s*l,g=u*c,y=u*l;t[0]=v-y*o;t[4]=-a*l;t[8]=g+m*o;t[1]=m+g*o;t[5]=a*c;t[9]=y-v*o;t[2]=-a*u;t[6]=o;t[10]=a*s}else if("ZYX"===e.order){var h=a*c,d=a*l,p=o*c,f=o*l;t[0]=s*c;t[4]=p*u-d;t[8]=h*u+f;t[1]=s*l;t[5]=f*u+h;t[9]=d*u-p;t[2]=-u;t[6]=o*s;t[10]=a*s}else if("YZX"===e.order){var A=a*s,M=a*u,w=o*s,E=o*u;t[0]=s*c;t[4]=E-A*l;t[8]=w*l+M;t[1]=l;t[5]=a*c;t[9]=-o*c;t[2]=-u*c;t[6]=M*l+w;t[10]=A-E*l}else if("XZY"===e.order){var A=a*s,M=a*u,w=o*s,E=o*u;t[0]=s*c;t[4]=-l;t[8]=u*c;t[1]=A*l+E;t[5]=a*c;t[9]=M*l-w;t[2]=w*l-M;t[6]=o*c;t[10]=E*l+A}t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},makeRotationFromQuaternion:function(e){var t=this.elements;var r=e._x,i=e._y,n=e._z,a=e._w;var o=r+r,s=i+i,u=n+n;var c=r*o,l=r*s,h=r*u;var d=i*s,p=i*u,f=n*u;var v=a*o,m=a*s,g=a*u;t[0]=1-(d+f);t[4]=l-g;t[8]=h+m;t[1]=l+g;t[5]=1-(c+f);t[9]=p-v;t[2]=h-m;t[6]=p+v;t[10]=1-(c+d);t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},lookAt:function(){var e=new kt;var t=new kt;var r=new kt;return function i(n,a,o){var s=this.elements;r.subVectors(n,a);0===r.lengthSq()&&(r.z=1);r.normalize();e.crossVectors(o,r);if(0===e.lengthSq()){1===Math.abs(o.z)?r.x+=1e-4:r.z+=1e-4;r.normalize();e.crossVectors(o,r)}e.normalize();t.crossVectors(r,e);s[0]=e.x;s[4]=t.x;s[8]=r.x;s[1]=e.y;s[5]=t.y;s[9]=r.y;s[2]=e.z;s[6]=t.z;s[10]=r.z;return this}}(),multiply:function(e,t){if(void 0!==t){console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(e,t)}return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements;var i=t.elements;var n=this.elements;var a=r[0],o=r[4],s=r[8],u=r[12];var c=r[1],l=r[5],h=r[9],d=r[13];var p=r[2],f=r[6],v=r[10],m=r[14];var g=r[3],y=r[7],A=r[11],M=r[15];var w=i[0],E=i[4],x=i[8],b=i[12];var T=i[1],L=i[5],N=i[9],D=i[13];var C=i[2],S=i[6],I=i[10],_=i[14];var O=i[3],j=i[7],R=i[11],z=i[15];n[0]=a*w+o*T+s*C+u*O;n[4]=a*E+o*L+s*S+u*j;n[8]=a*x+o*N+s*I+u*R;n[12]=a*b+o*D+s*_+u*z;n[1]=c*w+l*T+h*C+d*O;n[5]=c*E+l*L+h*S+d*j;n[9]=c*x+l*N+h*I+d*R;n[13]=c*b+l*D+h*_+d*z;n[2]=p*w+f*T+v*C+m*O;n[6]=p*E+f*L+v*S+m*j;n[10]=p*x+f*N+v*I+m*R;n[14]=p*b+f*D+v*_+m*z;n[3]=g*w+y*T+A*C+M*O;n[7]=g*E+y*L+A*S+M*j;n[11]=g*x+y*N+A*I+M*R;n[15]=g*b+y*D+A*_+M*z;return this},multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[4]*=e;t[8]*=e;t[12]*=e;t[1]*=e;t[5]*=e;t[9]*=e;t[13]*=e;t[2]*=e;t[6]*=e;t[10]*=e;t[14]*=e;t[3]*=e;t[7]*=e;t[11]*=e;t[15]*=e;return this},applyToBufferAttribute:function(){var e=new kt;return function t(r){for(var i=0,n=r.count;i<n;i++){e.x=r.getX(i);e.y=r.getY(i);e.z=r.getZ(i);e.applyMatrix4(this);r.setXYZ(i,e.x,e.y,e.z)}return r}}(),determinant:function(){var e=this.elements;var t=e[0],r=e[4],i=e[8],n=e[12];var a=e[1],o=e[5],s=e[9],u=e[13];var c=e[2],l=e[6],h=e[10],d=e[14];var p=e[3],f=e[7],v=e[11],m=e[15];return p*(+n*s*l-i*u*l-n*o*h+r*u*h+i*o*d-r*s*d)+f*(+t*s*d-t*u*h+n*a*h-i*a*d+i*u*c-n*s*c)+v*(+t*u*l-t*o*d-n*a*l+r*a*d+n*o*c-r*u*c)+m*(-i*o*c-t*s*l+t*o*h+i*a*l-r*a*h+r*s*c)},transpose:function(){var e=this.elements;var t;t=e[1];e[1]=e[4];e[4]=t;t=e[2];e[2]=e[8];e[8]=t;t=e[6];e[6]=e[9];e[9]=t;t=e[3];e[3]=e[12];e[12]=t;t=e[7];e[7]=e[13];e[13]=t;t=e[11];e[11]=e[14];e[14]=t;return this},setPosition:function(e){var t=this.elements;t[12]=e.x;t[13]=e.y;t[14]=e.z;return this},getInverse:function(e,t){var r=this.elements,i=e.elements,n=i[0],a=i[1],o=i[2],s=i[3],u=i[4],c=i[5],l=i[6],h=i[7],d=i[8],p=i[9],f=i[10],v=i[11],m=i[12],g=i[13],y=i[14],A=i[15],M=p*y*h-g*f*h+g*l*v-c*y*v-p*l*A+c*f*A,w=m*f*h-d*y*h-m*l*v+u*y*v+d*l*A-u*f*A,E=d*g*h-m*p*h+m*c*v-u*g*v-d*c*A+u*p*A,x=m*p*l-d*g*l-m*c*f+u*g*f+d*c*y-u*p*y;var b=n*M+a*w+o*E+s*x;if(0===b){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(true===t)throw new Error(T);console.warn(T);return this.identity()}var L=1/b;r[0]=M*L;r[1]=(g*f*s-p*y*s-g*o*v+a*y*v+p*o*A-a*f*A)*L;r[2]=(c*y*s-g*l*s+g*o*h-a*y*h-c*o*A+a*l*A)*L;r[3]=(p*l*s-c*f*s-p*o*h+a*f*h+c*o*v-a*l*v)*L;r[4]=w*L;r[5]=(d*y*s-m*f*s+m*o*v-n*y*v-d*o*A+n*f*A)*L;r[6]=(m*l*s-u*y*s-m*o*h+n*y*h+u*o*A-n*l*A)*L;r[7]=(u*f*s-d*l*s+d*o*h-n*f*h-u*o*v+n*l*v)*L;r[8]=E*L;r[9]=(m*p*s-d*g*s-m*a*v+n*g*v+d*a*A-n*p*A)*L;r[10]=(u*g*s-m*c*s+m*a*h-n*g*h-u*a*A+n*c*A)*L;r[11]=(d*c*s-u*p*s-d*a*h+n*p*h+u*a*v-n*c*v)*L;r[12]=x*L;r[13]=(d*g*o-m*p*o+m*a*f-n*g*f-d*a*y+n*p*y)*L;r[14]=(m*c*o-u*g*o-m*a*l+n*g*l+u*a*y-n*c*y)*L;r[15]=(u*p*o-d*c*o+d*a*l-n*p*l-u*a*f+n*c*f)*L;return this},scale:function(e){var t=this.elements;var r=e.x,i=e.y,n=e.z;t[0]*=r;t[4]*=i;t[8]*=n;t[1]*=r;t[5]*=i;t[9]*=n;t[2]*=r;t[6]*=i;t[10]*=n;t[3]*=r;t[7]*=i;t[11]*=n;return this},getMaxScaleOnAxis:function(){var e=this.elements;var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];var r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6];var i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))},makeTranslation:function(e,t,r){this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1);return this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1);return this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1);return this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(e,t){var r=Math.cos(t);var i=Math.sin(t);var n=1-r;var a=e.x,o=e.y,s=e.z;var u=n*a,c=n*o;this.set(u*a+r,u*o-i*s,u*s+i*o,0,u*o+i*s,c*o+r,c*s-i*a,0,u*s-i*o,c*s+i*a,n*s*s+r,0,0,0,0,1);return this},makeScale:function(e,t,r){this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1);return this},makeShear:function(e,t,r){this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1);return this},compose:function(e,t,r){this.makeRotationFromQuaternion(t);this.scale(r);this.setPosition(e);return this},decompose:function(){var e=new kt;var t=new Rt;return function r(i,n,a){var o=this.elements;var s=e.set(o[0],o[1],o[2]).length();var u=e.set(o[4],o[5],o[6]).length();var c=e.set(o[8],o[9],o[10]).length();var l=this.determinant();l<0&&(s=-s);i.x=o[12];i.y=o[13];i.z=o[14];t.copy(this);var h=1/s;var d=1/u;var p=1/c;t.elements[0]*=h;t.elements[1]*=h;t.elements[2]*=h;t.elements[4]*=d;t.elements[5]*=d;t.elements[6]*=d;t.elements[8]*=p;t.elements[9]*=p;t.elements[10]*=p;n.setFromRotationMatrix(t);a.x=s;a.y=u;a.z=c;return this}}(),makePerspective:function(e,t,r,i,n,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements;var s=2*n/(t-e);var u=2*n/(r-i);var c=(t+e)/(t-e);var l=(r+i)/(r-i);var h=-(a+n)/(a-n);var d=-2*a*n/(a-n);o[0]=s;o[4]=0;o[8]=c;o[12]=0;o[1]=0;o[5]=u;o[9]=l;o[13]=0;o[2]=0;o[6]=0;o[10]=h;o[14]=d;o[3]=0;o[7]=0;o[11]=-1;o[15]=0;return this},makeOrthographic:function(e,t,r,i,n,a){var o=this.elements;var s=1/(t-e);var u=1/(r-i);var c=1/(a-n);var l=(t+e)*s;var h=(r+i)*u;var d=(a+n)*c;o[0]=2*s;o[4]=0;o[8]=0;o[12]=-l;o[1]=0;o[5]=2*u;o[9]=0;o[13]=-h;o[2]=0;o[6]=0;o[10]=-2*c;o[14]=-d;o[3]=0;o[7]=0;o[11]=0;o[15]=1;return this},equals:function(e){var t=this.elements;var r=e.elements;for(var i=0;i<16;i++)if(t[i]!==r[i])return false;return true},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<16;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);var r=this.elements;e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=r[3];e[t+4]=r[4];e[t+5]=r[5];e[t+6]=r[6];e[t+7]=r[7];e[t+8]=r[8];e[t+9]=r[9];e[t+10]=r[10];e[t+11]=r[11];e[t+12]=r[12];e[t+13]=r[13];e[t+14]=r[14];e[t+15]=r[15];return e}});function zt(e,t,r,i){this._x=e||0;this._y=t||0;this._z=r||0;this._w=void 0!==i?i:1}Object.assign(zt,{slerp:function(e,t,r,i){return r.copy(e).slerp(t,i)},slerpFlat:function(e,t,r,i,n,a,o){var s=r[i+0],u=r[i+1],c=r[i+2],l=r[i+3],h=n[a+0],d=n[a+1],p=n[a+2],f=n[a+3];if(l!==f||s!==h||u!==d||c!==p){var v=1-o,m=s*h+u*d+c*p+l*f,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){var A=Math.sqrt(y),M=Math.atan2(A,m*g);v=Math.sin(v*M)/A;o=Math.sin(o*M)/A}var w=o*g;s=s*v+h*w;u=u*v+d*w;c=c*v+p*w;l=l*v+f*w;if(v===1-o){var E=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=E;u*=E;c*=E;l*=E}}e[t]=s;e[t+1]=u;e[t+2]=c;e[t+3]=l}});Object.defineProperties(zt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e;this.onChangeCallback()}}});Object.assign(zt.prototype,{set:function(e,t,r,i){this._x=e;this._y=t;this._z=r;this._w=i;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){this._x=e.x;this._y=e.y;this._z=e.z;this._w=e.w;this.onChangeCallback();return this},setFromEuler:function(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=e._x,i=e._y,n=e._z,a=e.order;var o=Math.cos;var s=Math.sin;var u=o(r/2);var c=o(i/2);var l=o(n/2);var h=s(r/2);var d=s(i/2);var p=s(n/2);if("XYZ"===a){this._x=h*c*l+u*d*p;this._y=u*d*l-h*c*p;this._z=u*c*p+h*d*l;this._w=u*c*l-h*d*p}else if("YXZ"===a){this._x=h*c*l+u*d*p;this._y=u*d*l-h*c*p;this._z=u*c*p-h*d*l;this._w=u*c*l+h*d*p}else if("ZXY"===a){this._x=h*c*l-u*d*p;this._y=u*d*l+h*c*p;this._z=u*c*p+h*d*l;this._w=u*c*l-h*d*p}else if("ZYX"===a){this._x=h*c*l-u*d*p;this._y=u*d*l+h*c*p;this._z=u*c*p-h*d*l;this._w=u*c*l+h*d*p}else if("YZX"===a){this._x=h*c*l+u*d*p;this._y=u*d*l+h*c*p;this._z=u*c*p-h*d*l;this._w=u*c*l-h*d*p}else if("XZY"===a){this._x=h*c*l-u*d*p;this._y=u*d*l-h*c*p;this._z=u*c*p+h*d*l;this._w=u*c*l+h*d*p}false!==t&&this.onChangeCallback();return this},setFromAxisAngle:function(e,t){var r=t/2,i=Math.sin(r);this._x=e.x*i;this._y=e.y*i;this._z=e.z*i;this._w=Math.cos(r);this.onChangeCallback();return this},setFromRotationMatrix:function(e){var t=e.elements,r=t[0],i=t[4],n=t[8],a=t[1],o=t[5],s=t[9],u=t[2],c=t[6],l=t[10],h=r+o+l,d;if(h>0){d=.5/Math.sqrt(h+1);this._w=.25/d;this._x=(c-s)*d;this._y=(n-u)*d;this._z=(a-i)*d}else if(r>o&&r>l){d=2*Math.sqrt(1+r-o-l);this._w=(c-s)/d;this._x=.25*d;this._y=(i+a)/d;this._z=(n+u)/d}else if(o>l){d=2*Math.sqrt(1+o-r-l);this._w=(n-u)/d;this._x=(i+a)/d;this._y=.25*d;this._z=(s+c)/d}else{d=2*Math.sqrt(1+l-r-o);this._w=(a-i)/d;this._x=(n+u)/d;this._y=(s+c)/d;this._z=.25*d}this.onChangeCallback();return this},setFromUnitVectors:function(){var e=new kt;var t;var r=1e-6;return function i(n,a){void 0===e&&(e=new kt);t=n.dot(a)+1;if(t<r){t=0;Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)}else e.crossVectors(n,a);this._x=e.x;this._y=e.y;this._z=e.z;this._w=t;return this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();if(0===e){this._x=0;this._y=0;this._z=0;this._w=1}else{e=1/e;this._x=this._x*e;this._y=this._y*e;this._z=this._z*e;this._w=this._w*e}this.onChangeCallback();return this},multiply:function(e,t){if(void 0!==t){console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(e,t)}return this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var r=e._x,i=e._y,n=e._z,a=e._w;var o=t._x,s=t._y,u=t._z,c=t._w;this._x=r*c+a*o+i*u-n*s;this._y=i*c+a*s+n*o-r*u;this._z=n*c+a*u+r*s-i*o;this._w=a*c-r*o-i*s-n*u;this.onChangeCallback();return this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,i=this._y,n=this._z,a=this._w;var o=a*e._w+r*e._x+i*e._y+n*e._z;if(o<0){this._w=-e._w;this._x=-e._x;this._y=-e._y;this._z=-e._z;o=-o}else this.copy(e);if(o>=1){this._w=a;this._x=r;this._y=i;this._z=n;return this}var s=Math.sqrt(1-o*o);if(Math.abs(s)<.001){this._w=.5*(a+this._w);this._x=.5*(r+this._x);this._y=.5*(i+this._y);this._z=.5*(n+this._z);return this}var u=Math.atan2(s,o);var c=Math.sin((1-t)*u)/s,l=Math.sin(t*u)/s;this._w=a*c+this._w*l;this._x=r*c+this._x*l;this._y=i*c+this._y*l;this._z=n*c+this._z*l;this.onChangeCallback();return this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){void 0===t&&(t=0);this._x=e[t];this._y=e[t+1];this._z=e[t+2];this._w=e[t+3];this.onChangeCallback();return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._w;return e},onChange:function(e){this.onChangeCallback=e;return this},onChangeCallback:function(){}});function kt(e,t,r){this.x=e||0;this.y=t||0;this.z=r||0}Object.assign(kt.prototype,{isVector3:true,set:function(e,t,r){this.x=e;this.y=t;this.z=r;return this},setScalar:function(e){this.x=e;this.y=e;this.z=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;return this},add:function(e,t){if(void 0!==t){console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;this.z+=e.z;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;this.z+=e.z*t;return this},sub:function(e,t){if(void 0!==t){console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;this.z-=e.z;return this},subScalar:function(e){this.x-=e;this.y-=e;this.z-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;return this},multiply:function(e,t){if(void 0!==t){console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(e,t)}this.x*=e.x;this.y*=e.y;this.z*=e.z;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;return this},multiplyVectors:function(e,t){this.x=e.x*t.x;this.y=e.y*t.y;this.z=e.z*t.z;return this},applyEuler:function(){var e=new zt;return function t(r){r&&r.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");return this.applyQuaternion(e.setFromEuler(r))}}(),applyAxisAngle:function(){var e=new zt;return function t(r,i){return this.applyQuaternion(e.setFromAxisAngle(r,i))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,i=this.z;var n=e.elements;this.x=n[0]*t+n[3]*r+n[6]*i;this.y=n[1]*t+n[4]*r+n[7]*i;this.z=n[2]*t+n[5]*r+n[8]*i;return this},applyMatrix4:function(e){var t=this.x,r=this.y,i=this.z;var n=e.elements;var a=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*a;this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*a;this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*a;return this},applyQuaternion:function(e){var t=this.x,r=this.y,i=this.z;var n=e.x,a=e.y,o=e.z,s=e.w;var u=s*t+a*i-o*r;var c=s*r+o*t-n*i;var l=s*i+n*r-a*t;var h=-n*t-a*r-o*i;this.x=u*s+h*-n+c*-o-l*-a;this.y=c*s+h*-a+l*-n-u*-o;this.z=l*s+h*-o+u*-a-c*-n;return this},project:function(){var e=new Rt;return function t(r){e.multiplyMatrices(r.projectionMatrix,e.getInverse(r.matrixWorld));return this.applyMatrix4(e)}}(),unproject:function(){var e=new Rt;return function t(r){e.multiplyMatrices(r.matrixWorld,e.getInverse(r.projectionMatrix));return this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,i=this.z;var n=e.elements;this.x=n[0]*t+n[4]*r+n[8]*i;this.y=n[1]*t+n[5]*r+n[9]*i;this.z=n[2]*t+n[6]*r+n[10]*i;return this.normalize()},divide:function(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));this.z=Math.max(e.z,Math.min(t.z,this.z));return this},clampScalar:function(){var e=new kt;var t=new kt;return function r(i,n){e.set(i,i,i);t.set(n,n,n);return this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;return this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(e,t){if(void 0!==t){console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(e,t)}return this.crossVectors(this,e)},crossVectors:function(e,t){var r=e.x,i=e.y,n=e.z;var a=t.x,o=t.y,s=t.z;this.x=i*s-n*o;this.y=n*a-r*s;this.z=r*o-i*a;return this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new kt;return function t(r){e.copy(this).projectOnVector(r);return this.sub(e)}}(),reflect:function(){var e=new kt;return function t(r){return this.sub(e.copy(r).multiplyScalar(2*this.dot(r)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Ot.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;this.x=t*Math.sin(e.theta);this.y=Math.cos(e.phi)*e.radius;this.z=t*Math.cos(e.theta);return this},setFromCylindrical:function(e){this.x=e.radius*Math.sin(e.theta);this.y=e.y;this.z=e.radius*Math.cos(e.theta);return this},setFromMatrixPosition:function(e){var t=e.elements;this.x=t[12];this.y=t[13];this.z=t[14];return this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length();var r=this.setFromMatrixColumn(e,1).length();var i=this.setFromMatrixColumn(e,2).length();this.x=t;this.y=r;this.z=i;return this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){void 0===t&&(t=0);this.x=e[t];this.y=e[t+1];this.z=e[t+2];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;return e},fromBufferAttribute:function(e,t,r){void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=e.getX(t);this.y=e.getY(t);this.z=e.getZ(t);return this}});function Pt(){this.elements=[1,0,0,0,1,0,0,0,1];arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Pt.prototype,{isMatrix3:true,set:function(e,t,r,i,n,a,o,s,u){var c=this.elements;c[0]=e;c[1]=i;c[2]=o;c[3]=t;c[4]=n;c[5]=s;c[6]=r;c[7]=a;c[8]=u;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements;var r=e.elements;t[0]=r[0];t[1]=r[1];t[2]=r[2];t[3]=r[3];t[4]=r[4];t[5]=r[5];t[6]=r[6];t[7]=r[7];t[8]=r[8];return this},setFromMatrix4:function(e){var t=e.elements;this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]);return this},applyToBufferAttribute:function(){var e=new kt;return function t(r){for(var i=0,n=r.count;i<n;i++){e.x=r.getX(i);e.y=r.getY(i);e.z=r.getZ(i);e.applyMatrix3(this);r.setXYZ(i,e.x,e.y,e.z)}return r}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements;var i=t.elements;var n=this.elements;var a=r[0],o=r[3],s=r[6];var u=r[1],c=r[4],l=r[7];var h=r[2],d=r[5],p=r[8];var f=i[0],v=i[3],m=i[6];var g=i[1],y=i[4],A=i[7];var M=i[2],w=i[5],E=i[8];n[0]=a*f+o*g+s*M;n[3]=a*v+o*y+s*w;n[6]=a*m+o*A+s*E;n[1]=u*f+c*g+l*M;n[4]=u*v+c*y+l*w;n[7]=u*m+c*A+l*E;n[2]=h*f+d*g+p*M;n[5]=h*v+d*y+p*w;n[8]=h*m+d*A+p*E;return this},multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[3]*=e;t[6]*=e;t[1]*=e;t[4]*=e;t[7]*=e;t[2]*=e;t[5]*=e;t[8]*=e;return this},determinant:function(){var e=this.elements;var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],o=e[5],s=e[6],u=e[7],c=e[8];return t*a*c-t*o*u-r*n*c+r*o*s+i*n*u-i*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=e.elements,i=this.elements,n=r[0],a=r[1],o=r[2],s=r[3],u=r[4],c=r[5],l=r[6],h=r[7],d=r[8],p=d*u-c*h,f=c*l-d*s,v=h*s-u*l,m=n*p+a*f+o*v;if(0===m){var g="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(true===t)throw new Error(g);console.warn(g);return this.identity()}var y=1/m;i[0]=p*y;i[1]=(o*h-d*a)*y;i[2]=(c*a-o*u)*y;i[3]=f*y;i[4]=(d*n-o*l)*y;i[5]=(o*s-c*n)*y;i[6]=v*y;i[7]=(a*l-h*n)*y;i[8]=(u*n-a*s)*y;return this},transpose:function(){var e,t=this.elements;e=t[1];t[1]=t[3];t[3]=e;e=t[2];t[2]=t[6];t[6]=e;e=t[5];t[5]=t[7];t[7]=e;return this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;e[0]=t[0];e[1]=t[3];e[2]=t[6];e[3]=t[1];e[4]=t[4];e[5]=t[7];e[6]=t[2];e[7]=t[5];e[8]=t[8];return this},setUvTransform:function(e,t,r,i,n,a,o){var s=Math.cos(n);var u=Math.sin(n);this.set(r*s,r*u,-r*(s*a+u*o)+a+e,-i*u,i*s,-i*(-u*a+s*o)+o+t,0,0,1)},scale:function(e,t){var r=this.elements;r[0]*=e;r[3]*=e;r[6]*=e;r[1]*=t;r[4]*=t;r[7]*=t;return this},rotate:function(e){var t=Math.cos(e);var r=Math.sin(e);var i=this.elements;var n=i[0],a=i[3],o=i[6];var s=i[1],u=i[4],c=i[7];i[0]=t*n+r*s;i[3]=t*a+r*u;i[6]=t*o+r*c;i[1]=-r*n+t*s;i[4]=-r*a+t*u;i[7]=-r*o+t*c;return this},translate:function(e,t){var r=this.elements;r[0]+=e*r[2];r[3]+=e*r[5];r[6]+=e*r[8];r[1]+=t*r[2];r[4]+=t*r[5];r[7]+=t*r[8];return this},equals:function(e){var t=this.elements;var r=e.elements;for(var i=0;i<9;i++)if(t[i]!==r[i])return false;return true},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<9;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);var r=this.elements;e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=r[3];e[t+4]=r[4];e[t+5]=r[5];e[t+6]=r[6];e[t+7]=r[7];e[t+8]=r[8];return e}});var Ut=0;function Bt(e,t,r,i,n,a,o,s,u,c){Object.defineProperty(this,"id",{value:Ut++});this.uuid=Ot.generateUUID();this.name="";this.image=void 0!==e?e:Bt.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==t?t:Bt.DEFAULT_MAPPING;this.wrapS=void 0!==r?r:fe;this.wrapT=void 0!==i?i:fe;this.magFilter=void 0!==n?n:Ae;this.minFilter=void 0!==a?a:we;this.anisotropy=void 0!==u?u:1;this.format=void 0!==o?o:ze;this.type=void 0!==s?s:Ee;this.offset=new jt(0,0);this.repeat=new jt(1,1);this.center=new jt(0,0);this.rotation=0;this.matrixAutoUpdate=true;this.matrix=new Pt;this.generateMipmaps=true;this.premultiplyAlpha=false;this.flipY=true;this.unpackAlignment=4;this.encoding=void 0!==c?c:xt;this.version=0;this.onUpdate=null}Bt.DEFAULT_IMAGE=void 0;Bt.DEFAULT_MAPPING=ae;Bt.prototype=Object.assign(Object.create(t.prototype),{constructor:Bt,isTexture:true,clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name;this.image=e.image;this.mipmaps=e.mipmaps.slice(0);this.mapping=e.mapping;this.wrapS=e.wrapS;this.wrapT=e.wrapT;this.magFilter=e.magFilter;this.minFilter=e.minFilter;this.anisotropy=e.anisotropy;this.format=e.format;this.type=e.type;this.offset.copy(e.offset);this.repeat.copy(e.repeat);this.center.copy(e.center);this.rotation=e.rotation;this.matrixAutoUpdate=e.matrixAutoUpdate;this.matrix.copy(e.matrix);this.generateMipmaps=e.generateMipmaps;this.premultiplyAlpha=e.premultiplyAlpha;this.flipY=e.flipY;this.unpackAlignment=e.unpackAlignment;this.encoding=e.encoding;return this},toJSON:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];function r(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");t.width=e.width;t.height=e.height;var r=t.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height)}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=Ot.generateUUID());t||void 0!==e.images[n.uuid]||(e.images[n.uuid]={uuid:n.uuid,url:r(n)});i.image=n.uuid}t||(e.textures[this.uuid]=i);return i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==ae)return;e.applyMatrix3(this.matrix);if(e.x<0||e.x>1)switch(this.wrapS){case pe:e.x=e.x-Math.floor(e.x);break;case fe:e.x=e.x<0?0:1;break;case ve:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case pe:e.y=e.y-Math.floor(e.y);break;case fe:e.y=e.y<0?0:1;break;case ve:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}this.flipY&&(e.y=1-e.y)}});Object.defineProperty(Bt.prototype,"needsUpdate",{set:function(e){true===e&&this.version++}});function Ft(e,t,r,i){this.x=e||0;this.y=t||0;this.z=r||0;this.w=void 0!==i?i:1}Object.assign(Ft.prototype,{isVector4:true,set:function(e,t,r,i){this.x=e;this.y=t;this.z=r;this.w=i;return this},setScalar:function(e){this.x=e;this.y=e;this.z=e;this.w=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setW:function(e){this.w=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=void 0!==e.w?e.w:1;return this},add:function(e,t){if(void 0!==t){console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(e,t)}this.x+=e.x;this.y+=e.y;this.z+=e.z;this.w+=e.w;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;this.w+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;this.w=e.w+t.w;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;this.z+=e.z*t;this.w+=e.w*t;return this},sub:function(e,t){if(void 0!==t){console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(e,t)}this.x-=e.x;this.y-=e.y;this.z-=e.z;this.w-=e.w;return this},subScalar:function(e){this.x-=e;this.y-=e;this.z-=e;this.w-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;this.w=e.w-t.w;return this},multiplyScalar:function(e){this.x*=e;this.y*=e;this.z*=e;this.w*=e;return this},applyMatrix4:function(e){var t=this.x,r=this.y,i=this.z,n=this.w;var a=e.elements;this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*n;this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*n;this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*n;this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*n;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);if(t<1e-4){this.x=1;this.y=0;this.z=0}else{this.x=e.x/t;this.y=e.y/t;this.z=e.z/t}return this},setAxisAngleFromRotationMatrix:function(e){var t,r,i,n,a=.01,o=.1,s=e.elements,u=s[0],c=s[4],l=s[8],h=s[1],d=s[5],p=s[9],f=s[2],v=s[6],m=s[10];if(Math.abs(c-h)<a&&Math.abs(l-f)<a&&Math.abs(p-v)<a){if(Math.abs(c+h)<o&&Math.abs(l+f)<o&&Math.abs(p+v)<o&&Math.abs(u+d+m-3)<o){this.set(1,0,0,0);return this}t=Math.PI;var g=(u+1)/2;var y=(d+1)/2;var A=(m+1)/2;var M=(c+h)/4;var w=(l+f)/4;var E=(p+v)/4;if(g>y&&g>A)if(g<a){r=0;i=.707106781;n=.707106781}else{r=Math.sqrt(g);i=M/r;n=w/r}else if(y>A)if(y<a){r=.707106781;i=0;n=.707106781}else{i=Math.sqrt(y);r=M/i;n=E/i}else if(A<a){r=.707106781;i=.707106781;n=0}else{n=Math.sqrt(A);r=w/n;i=E/n}this.set(r,i,n,t);return this}var x=Math.sqrt((v-p)*(v-p)+(l-f)*(l-f)+(h-c)*(h-c));Math.abs(x)<.001&&(x=1);this.x=(v-p)/x;this.y=(l-f)/x;this.z=(h-c)/x;this.w=Math.acos((u+d+m-1)/2);return this},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);this.w=Math.min(this.w,e.w);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);this.w=Math.max(this.w,e.w);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));this.z=Math.max(e.z,Math.min(t.z,this.z));this.w=Math.max(e.w,Math.min(t.w,this.w));return this},clampScalar:function(){var e,t;return function r(i,n){if(void 0===e){e=new Ft;t=new Ft}e.set(i,i,i,i);t.set(n,n,n,n);return this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;this.w+=(e.w-this.w)*t;return this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){void 0===t&&(t=0);this.x=e[t];this.y=e[t+1];this.z=e[t+2];this.w=e[t+3];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;e[t+3]=this.w;return e},fromBufferAttribute:function(e,t,r){void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute().");this.x=e.getX(t);this.y=e.getY(t);this.z=e.getZ(t);this.w=e.getW(t);return this}});function Gt(e,t,r){this.uuid=Ot.generateUUID();this.width=e;this.height=t;this.scissor=new Ft(0,0,e,t);this.scissorTest=false;this.viewport=new Ft(0,0,e,t);r=r||{};void 0===r.minFilter&&(r.minFilter=Ae);this.texture=new Bt(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding);this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer;this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer;this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}Gt.prototype=Object.assign(Object.create(t.prototype),{constructor:Gt,isWebGLRenderTarget:true,setSize:function(e,t){if(this.width!==e||this.height!==t){this.width=e;this.height=t;this.dispose()}this.viewport.set(0,0,e,t);this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.width=e.width;this.height=e.height;this.viewport.copy(e.viewport);this.texture=e.texture.clone();this.depthBuffer=e.depthBuffer;this.stencilBuffer=e.stencilBuffer;this.depthTexture=e.depthTexture;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Ht(e,t,r){Gt.call(this,e,t,r);this.activeCubeFace=0;this.activeMipMapLevel=0}Ht.prototype=Object.create(Gt.prototype);Ht.prototype.constructor=Ht;Ht.prototype.isWebGLRenderTargetCube=true;function Vt(e,t,r,i,n,a,o,s,u,c,l,h){Bt.call(this,null,a,o,s,u,c,i,n,l,h);this.image={data:e,width:t,height:r};this.magFilter=void 0!==u?u:me;this.minFilter=void 0!==c?c:me;this.generateMipmaps=false;this.flipY=false;this.unpackAlignment=1}Vt.prototype=Object.create(Bt.prototype);Vt.prototype.constructor=Vt;Vt.prototype.isDataTexture=true;function Qt(e,t,r,i,n,a,o,s,u,c){e=void 0!==e?e:[];t=void 0!==t?t:oe;Bt.call(this,e,t,r,i,n,a,o,s,u,c);this.flipY=false}Qt.prototype=Object.create(Bt.prototype);Qt.prototype.constructor=Qt;Qt.prototype.isCubeTexture=true;Object.defineProperty(Qt.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Yt=new Bt;var Wt=new Qt;function Xt(){this.seq=[];this.map={}}var qt=[];var Zt=[];var Jt=new Float32Array(16);var Kt=new Float32Array(9);function $t(e,t,r){var i=e[0];if(i<=0||i>0)return e;var n=t*r,a=qt[n];if(void 0===a){a=new Float32Array(n);qt[n]=a}if(0!==t){i.toArray(a,0);for(var o=1,s=0;o!==t;++o){s+=r;e[o].toArray(a,s)}}return a}function er(e,t){var r=Zt[t];if(void 0===r){r=new Int32Array(t);Zt[t]=r}for(var i=0;i!==t;++i)r[i]=e.allocTextureUnit();return r}function tr(e,t){e.uniform1f(this.addr,t)}function rr(e,t){e.uniform1i(this.addr,t)}function ir(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function nr(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function ar(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function or(e,t){e.uniformMatrix2fv(this.addr,false,t.elements||t)}function sr(e,t){if(void 0===t.elements)e.uniformMatrix3fv(this.addr,false,t);else{Kt.set(t.elements);e.uniformMatrix3fv(this.addr,false,Kt)}}function ur(e,t){if(void 0===t.elements)e.uniformMatrix4fv(this.addr,false,t);else{Jt.set(t.elements);e.uniformMatrix4fv(this.addr,false,Jt)}}function cr(e,t,r){var i=r.allocTextureUnit();e.uniform1i(this.addr,i);r.setTexture2D(t||Yt,i)}function lr(e,t,r){var i=r.allocTextureUnit();e.uniform1i(this.addr,i);r.setTextureCube(t||Wt,i)}function hr(e,t){e.uniform2iv(this.addr,t)}function dr(e,t){e.uniform3iv(this.addr,t)}function pr(e,t){e.uniform4iv(this.addr,t)}function fr(e){switch(e){case 5126:return tr;case 35664:return ir;case 35665:return nr;case 35666:return ar;case 35674:return or;case 35675:return sr;case 35676:return ur;case 35678:case 36198:return cr;case 35680:return lr;case 5124:case 35670:return rr;case 35667:case 35671:return hr;case 35668:case 35672:return dr;case 35669:case 35673:return pr}}function vr(e,t){e.uniform1fv(this.addr,t)}function mr(e,t){e.uniform1iv(this.addr,t)}function gr(e,t){e.uniform2fv(this.addr,$t(t,this.size,2))}function yr(e,t){e.uniform3fv(this.addr,$t(t,this.size,3))}function Ar(e,t){e.uniform4fv(this.addr,$t(t,this.size,4))}function Mr(e,t){e.uniformMatrix2fv(this.addr,false,$t(t,this.size,4))}function wr(e,t){e.uniformMatrix3fv(this.addr,false,$t(t,this.size,9))}function Er(e,t){e.uniformMatrix4fv(this.addr,false,$t(t,this.size,16))}function xr(e,t,r){var i=t.length,n=er(r,i);e.uniform1iv(this.addr,n);for(var a=0;a!==i;++a)r.setTexture2D(t[a]||Yt,n[a])}function br(e,t,r){var i=t.length,n=er(r,i);e.uniform1iv(this.addr,n);for(var a=0;a!==i;++a)r.setTextureCube(t[a]||Wt,n[a])}function Tr(e){switch(e){case 5126:return vr;case 35664:return gr;case 35665:return yr;case 35666:return Ar;case 35674:return Mr;case 35675:return wr;case 35676:return Er;case 35678:return xr;case 35680:return br;case 5124:case 35670:return mr;case 35667:case 35671:return hr;case 35668:case 35672:return dr;case 35669:case 35673:return pr}}function Lr(e,t,r){this.id=e;this.addr=r;this.setValue=fr(t.type)}function Nr(e,t,r){this.id=e;this.addr=r;this.size=t.size;this.setValue=Tr(t.type)}function Dr(e){this.id=e;Xt.call(this)}Dr.prototype.setValue=function(e,t){var r=this.seq;for(var i=0,n=r.length;i!==n;++i){var a=r[i];a.setValue(e,t[a.id])}};var Cr=/([\w\d_]+)(\])?(\[|\.)?/g;function Sr(e,t){e.seq.push(t);e.map[t.id]=t}function Ir(e,t,r){var i=e.name,n=i.length;Cr.lastIndex=0;for(;;){var a=Cr.exec(i),o=Cr.lastIndex,s=a[1],u="]"===a[2],c=a[3];u&&(s|=0);if(void 0===c||"["===c&&o+2===n){Sr(r,void 0===c?new Lr(s,e,t):new Nr(s,e,t));break}var l=r.map,h=l[s];if(void 0===h){h=new Dr(s);Sr(r,h)}r=h}}function _r(e,t,r){Xt.call(this);this.renderer=r;var i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(var n=0;n<i;++n){var a=e.getActiveUniform(t,n),o=a.name,s=e.getUniformLocation(t,o);Ir(a,s,this)}}_r.prototype.setValue=function(e,t,r){var i=this.map[t];void 0!==i&&i.setValue(e,r,this.renderer)};_r.prototype.setOptional=function(e,t,r){var i=t[r];void 0!==i&&this.setValue(e,r,i)};_r.upload=function(e,t,r,i){for(var n=0,a=t.length;n!==a;++n){var o=t[n],s=r[o.id];false!==s.needsUpdate&&o.setValue(e,s.value,i)}};_r.seqWithValue=function(e,t){var r=[];for(var i=0,n=e.length;i!==n;++i){var a=e[i];a.id in t&&r.push(a)}return r};var Or={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function jr(e,t,r){if(void 0===t&&void 0===r)return this.set(e);return this.setRGB(e,t,r)}Object.assign(jr.prototype,{isColor:true,r:1,g:1,b:1,set:function(e){e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e);return this},setScalar:function(e){this.r=e;this.g=e;this.b=e;return this},setHex:function(e){e=Math.floor(e);this.r=(e>>16&255)/255;this.g=(e>>8&255)/255;this.b=(255&e)/255;return this},setRGB:function(e,t,r){this.r=e;this.g=t;this.b=r;return this},setHSL:function(){function e(e,t,r){r<0&&(r+=1);r>1&&(r-=1);if(r<1/6)return e+6*(t-e)*r;if(r<.5)return t;if(r<2/3)return e+6*(t-e)*(2/3-r);return e}return function t(r,i,n){r=Ot.euclideanModulo(r,1);i=Ot.clamp(i,0,1);n=Ot.clamp(n,0,1);if(0===i)this.r=this.g=this.b=n;else{var a=n<=.5?n*(1+i):n+i-n*i;var o=2*n-a;this.r=e(o,a,r+1/3);this.g=e(o,a,r);this.b=e(o,a,r-1/3)}return this}}(),setStyle:function(e){function t(t){if(void 0===t)return;parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var i;var n=r[1];var a=r[2];switch(n){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){this.r=Math.min(255,parseInt(i[1],10))/255;this.g=Math.min(255,parseInt(i[2],10))/255;this.b=Math.min(255,parseInt(i[3],10))/255;t(i[5]);return this}if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){this.r=Math.min(100,parseInt(i[1],10))/100;this.g=Math.min(100,parseInt(i[2],10))/100;this.b=Math.min(100,parseInt(i[3],10))/100;t(i[5]);return this}break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(i[1])/360;var s=parseInt(i[2],10)/100;var u=parseInt(i[3],10)/100;t(i[5]);return this.setHSL(o,s,u)}break}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c=r[1];var l=c.length;if(3===l){this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255;this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255;this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255;return this}if(6===l){this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255;this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255;this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255;return this}}if(e&&e.length>0){var c=Or[e];void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+e)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){this.r=e.r;this.g=e.g;this.b=e.b;return this},copyGammaToLinear:function(e,t){void 0===t&&(t=2);this.r=Math.pow(e.r,t);this.g=Math.pow(e.g,t);this.b=Math.pow(e.b,t);return this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=t>0?1/t:1;this.r=Math.pow(e.r,r);this.g=Math.pow(e.g,r);this.b=Math.pow(e.b,r);return this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;this.r=e*e;this.g=t*t;this.b=r*r;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t=e||{h:0,s:0,l:0};var r=this.r,i=this.g,n=this.b;var a=Math.max(r,i,n);var o=Math.min(r,i,n);var s,u;var c=(o+a)/2;if(o===a){s=0;u=0}else{var l=a-o;u=c<=.5?l/(a+o):l/(2-a-o);switch(a){case r:s=(i-n)/l+(i<n?6:0);break;case i:s=(n-r)/l+2;break;case n:s=(r-i)/l+4;break}s/=6}t.h=s;t.s=u;t.l=c;return t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){var i=this.getHSL();i.h+=e;i.s+=t;i.l+=r;this.setHSL(i.h,i.s,i.l);return this},add:function(e){this.r+=e.r;this.g+=e.g;this.b+=e.b;return this},addColors:function(e,t){this.r=e.r+t.r;this.g=e.g+t.g;this.b=e.b+t.b;return this},addScalar:function(e){this.r+=e;this.g+=e;this.b+=e;return this},sub:function(e){this.r=Math.max(0,this.r-e.r);this.g=Math.max(0,this.g-e.g);this.b=Math.max(0,this.b-e.b);return this},multiply:function(e){this.r*=e.r;this.g*=e.g;this.b*=e.b;return this},multiplyScalar:function(e){this.r*=e;this.g*=e;this.b*=e;return this},lerp:function(e,t){this.r+=(e.r-this.r)*t;this.g+=(e.g-this.g)*t;this.b+=(e.b-this.b)*t;return this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){void 0===t&&(t=0);this.r=e[t];this.g=e[t+1];this.b=e[t+2];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this.r;e[t+1]=this.g;e[t+2]=this.b;return e},toJSON:function(){return this.getHex()}});var Rr={common:{diffuse:{value:new jr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Pt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new jr(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new jr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Pt}}};var zr={merge:function(e){var t={};for(var r=0;r<e.length;r++){var i=this.clone(e[r]);for(var n in i)t[n]=i[n]}return t},clone:function(e){var t={};for(var r in e){t[r]={};for(var i in e[r]){var n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}};var kr="#ifdef USE_ALPHAMAP\r\n\r\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\r\n\r\n#endif\r\n";var Pr="#ifdef USE_ALPHAMAP\r\n\r\n\tuniform sampler2D alphaMap;\r\n\r\n#endif\r\n";var Ur="#ifdef ALPHATEST\r\n\r\n\tif ( diffuseColor.a < ALPHATEST ) discard;\r\n\r\n#endif\r\n";var Br="#ifdef USE_AOMAP\r\n\r\n\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\r\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\r\n\r\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\r\n\r\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\r\n\r\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\r\n\r\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var Fr="#ifdef USE_AOMAP\r\n\r\n\tuniform sampler2D aoMap;\r\n\tuniform float aoMapIntensity;\r\n\r\n#endif";var Gr="\r\nvec3 transformed = vec3( position );\r\n";var Hr="\r\nvec3 objectNormal = vec3( normal );\r\n";var Vr='float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\r\n\r\n\tif( decayExponent > 0.0 ) {\r\n\r\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\r\n\r\n\t\t// based upon Frostbite 3 Moving to Physically-based Rendering\r\n\t\t// page 32, equation 26: E[window1]\r\n\t\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t// this is intended to be used on spot and point lights who are represented as luminous intensity\r\n\t\t// but who must be converted to luminous irradiance for surface lighting calculation\r\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\r\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\r\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\r\n\r\n#else\r\n\r\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\r\n\r\n#endif\r\n\r\n\t}\r\n\r\n\treturn 1.0;\r\n\r\n}\r\n\r\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\r\n\r\n\treturn RECIPROCAL_PI * diffuseColor;\r\n\r\n} // validated\r\n\r\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\r\n\r\n\t// Original approximation by Christophe Schlick \'94\r\n\t// float fresnel = pow( 1.0 - dotLH, 5.0 );\r\n\r\n\t// Optimized variant (presented by Epic at SIGGRAPH \'13)\r\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\r\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\r\n\r\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\r\n\r\n} // validated\r\n\r\n// Microfacet Models for Refraction through Rough Surfaces - equation (34)\r\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\r\n// alpha is "roughness squared" in Disney’s reparameterization\r\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\r\n\r\n\t// geometry term (normalized) = G(l)⋅G(v) / 4(n⋅l)(n⋅v)\r\n\t// also see #12151\r\n\r\n\tfloat a2 = pow2( alpha );\r\n\r\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\r\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\r\n\r\n\treturn 1.0 / ( gl * gv );\r\n\r\n} // validated\r\n\r\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\r\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\r\n\r\n\tfloat a2 = pow2( alpha );\r\n\r\n\t// dotNL and dotNV are explicitly swapped. This is not a mistake.\r\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\r\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\r\n\r\n\treturn 0.5 / max( gv + gl, EPSILON );\r\n\r\n}\r\n\r\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\r\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\r\n// alpha is "roughness squared" in Disney’s reparameterization\r\nfloat D_GGX( const in float alpha, const in float dotNH ) {\r\n\r\n\tfloat a2 = pow2( alpha );\r\n\r\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1\r\n\r\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\r\n\r\n}\r\n\r\n// GGX Distribution, Schlick Fresnel, GGX-Smith Visibility\r\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\r\n\r\n\tfloat alpha = pow2( roughness ); // UE4\'s roughness\r\n\r\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\r\n\r\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\r\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\r\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\r\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\r\n\r\n\tvec3 F = F_Schlick( specularColor, dotLH );\r\n\r\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\r\n\r\n\tfloat D = D_GGX( alpha, dotNH );\r\n\r\n\treturn F * ( G * D );\r\n\r\n} // validated\r\n\r\n// Rect Area Light\r\n\r\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\r\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\r\n// code: https://github.com/selfshadow/ltc_code/\r\n\r\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\r\n\r\n\tconst float LUT_SIZE  = 64.0;\r\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\r\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\r\n\r\n\tfloat dotNV = saturate( dot( N, V ) );\r\n\r\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\r\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\r\n\r\n\tuv = uv * LUT_SCALE + LUT_BIAS;\r\n\r\n\treturn uv;\r\n\r\n}\r\n\r\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\r\n\r\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\r\n\t// An approximation of the form factor of a horizon-clipped rectangle.\r\n\r\n\tfloat l = length( f );\r\n\r\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\r\n\r\n}\r\n\r\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\r\n\r\n\tfloat x = dot( v1, v2 );\r\n\r\n\tfloat y = abs( x );\r\n\r\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\r\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\r\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\r\n\tfloat v = a / b;\r\n\r\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\r\n\r\n\treturn cross( v1, v2 ) * theta_sintheta;\r\n\r\n}\r\n\r\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\r\n\r\n\t// bail if point is on back side of plane of light\r\n\t// assumes ccw winding order of light vertices\r\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\r\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\r\n\tvec3 lightNormal = cross( v1, v2 );\r\n\r\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\r\n\r\n\t// construct orthonormal basis around N\r\n\tvec3 T1, T2;\r\n\tT1 = normalize( V - N * dot( V, N ) );\r\n\tT2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system\r\n\r\n\t// compute transform\r\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\r\n\r\n\t// transform rect\r\n\tvec3 coords[ 4 ];\r\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\r\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\r\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\r\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\r\n\r\n\t// project rect onto sphere\r\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\r\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\r\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\r\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\r\n\r\n\t// calculate vector form factor\r\n\tvec3 vectorFormFactor = vec3( 0.0 );\r\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\r\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\r\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\r\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\r\n\r\n\t// adjust for horizon clipping\r\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\r\n\r\n\r\n\r\n\treturn vec3( result );\r\n\r\n}\r\n\r\n// End Rect Area Light\r\n\r\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\r\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\r\n\r\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\r\n\r\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\r\n\r\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\r\n\r\n\tvec4 r = roughness * c0 + c1;\r\n\r\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\r\n\r\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\r\n\r\n\treturn specularColor * AB.x + AB.y;\r\n\r\n} // validated\r\n\r\n\r\nfloat G_BlinnPhong_Implicit( ) {\r\n\r\n\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\r\n\treturn 0.25;\r\n\r\n}\r\n\r\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\r\n\r\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\r\n\r\n}\r\n\r\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\r\n\r\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\r\n\r\n\t//float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\r\n\t//float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\r\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\r\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\r\n\r\n\tvec3 F = F_Schlick( specularColor, dotLH );\r\n\r\n\tfloat G = G_BlinnPhong_Implicit( );\r\n\r\n\tfloat D = D_BlinnPhong( shininess, dotNH );\r\n\r\n\treturn F * ( G * D );\r\n\r\n} // validated\r\n\r\n// source: http://simonstechblog.blogspot.ca/2011/12/microfacet-brdf.html\r\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\r\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\r\n}\r\n\r\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\r\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\r\n}\r\n';var Qr="#ifdef USE_BUMPMAP\r\n\r\n\tuniform sampler2D bumpMap;\r\n\tuniform float bumpScale;\r\n\r\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\r\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\r\n\r\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\r\n\r\n\tvec2 dHdxy_fwd() {\r\n\r\n\t\tvec2 dSTdx = dFdx( vUv );\r\n\t\tvec2 dSTdy = dFdy( vUv );\r\n\r\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\r\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\r\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\r\n\r\n\t\treturn vec2( dBx, dBy );\r\n\r\n\t}\r\n\r\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\r\n\r\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\r\n\r\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\r\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\r\n\t\tvec3 vN = surf_norm;\t\t// normalized\r\n\r\n\t\tvec3 R1 = cross( vSigmaY, vN );\r\n\t\tvec3 R2 = cross( vN, vSigmaX );\r\n\r\n\t\tfloat fDet = dot( vSigmaX, R1 );\r\n\r\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\r\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\r\n\r\n\t}\r\n\r\n#endif\r\n";var Yr="#if NUM_CLIPPING_PLANES > 0\r\n\r\n\tvec4 plane;\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\r\n\r\n\t\tplane = clippingPlanes[ i ];\r\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\r\n\r\n\t}\r\n\r\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\r\n\r\n\t\tbool clipped = true;\r\n\r\n\t\t#pragma unroll_loop\r\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\r\n\r\n\t\t\tplane = clippingPlanes[ i ];\r\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\r\n\r\n\t\t}\r\n\r\n\t\tif ( clipped ) discard;\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var Wr="#if NUM_CLIPPING_PLANES > 0\r\n\r\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\r\n\t\tvarying vec3 vViewPosition;\r\n\t#endif\r\n\r\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\r\n\r\n#endif\r\n";var Xr="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\r\n\tvarying vec3 vViewPosition;\r\n#endif\r\n";var qr="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\r\n\tvViewPosition = - mvPosition.xyz;\r\n#endif\r\n\r\n";var Zr="#ifdef USE_COLOR\r\n\r\n\tdiffuseColor.rgb *= vColor;\r\n\r\n#endif";var Jr="#ifdef USE_COLOR\r\n\r\n\tvarying vec3 vColor;\r\n\r\n#endif\r\n";var Kr="#ifdef USE_COLOR\r\n\r\n\tvarying vec3 vColor;\r\n\r\n#endif";var $r="#ifdef USE_COLOR\r\n\r\n\tvColor.xyz = color.xyz;\r\n\r\n#endif";var ei="#define PI 3.14159265359\r\n#define PI2 6.28318530718\r\n#define PI_HALF 1.5707963267949\r\n#define RECIPROCAL_PI 0.31830988618\r\n#define RECIPROCAL_PI2 0.15915494\r\n#define LOG2 1.442695\r\n#define EPSILON 1e-6\r\n\r\n#define saturate(a) clamp( a, 0.0, 1.0 )\r\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\r\n\r\nfloat pow2( const in float x ) { return x*x; }\r\nfloat pow3( const in float x ) { return x*x*x; }\r\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\r\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\r\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\r\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\r\nhighp float rand( const in vec2 uv ) {\r\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\r\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\r\n\treturn fract(sin(sn) * c);\r\n}\r\n\r\nstruct IncidentLight {\r\n\tvec3 color;\r\n\tvec3 direction;\r\n\tbool visible;\r\n};\r\n\r\nstruct ReflectedLight {\r\n\tvec3 directDiffuse;\r\n\tvec3 directSpecular;\r\n\tvec3 indirectDiffuse;\r\n\tvec3 indirectSpecular;\r\n};\r\n\r\nstruct GeometricContext {\r\n\tvec3 position;\r\n\tvec3 normal;\r\n\tvec3 viewDir;\r\n};\r\n\r\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\r\n\r\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\r\n\r\n}\r\n\r\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\r\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\r\n\r\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\r\n\r\n}\r\n\r\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\r\n\r\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\r\n\r\n\treturn - distance * planeNormal + point;\r\n\r\n}\r\n\r\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\r\n\r\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\r\n\r\n}\r\n\r\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\r\n\r\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\r\n\r\n}\r\n\r\nmat3 transposeMat3( const in mat3 m ) {\r\n\r\n\tmat3 tmp;\r\n\r\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\r\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\r\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\r\n\r\n\treturn tmp;\r\n\r\n}\r\n\r\n// https://en.wikipedia.org/wiki/Relative_luminance\r\nfloat linearToRelativeLuminance( const in vec3 color ) {\r\n\r\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\r\n\r\n\treturn dot( weights, color.rgb );\r\n\r\n}\r\n";var ti="#ifdef ENVMAP_TYPE_CUBE_UV\r\n\r\n#define cubeUV_textureSize (1024.0)\r\n\r\nint getFaceFromDirection(vec3 direction) {\r\n\tvec3 absDirection = abs(direction);\r\n\tint face = -1;\r\n\tif( absDirection.x > absDirection.z ) {\r\n\t\tif(absDirection.x > absDirection.y )\r\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\r\n\t\telse\r\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\r\n\t}\r\n\telse {\r\n\t\tif(absDirection.z > absDirection.y )\r\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\r\n\t\telse\r\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\r\n\t}\r\n\treturn face;\r\n}\r\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\r\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\r\n\r\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\r\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\r\n\tfloat dxRoughness = dFdx(roughness);\r\n\tfloat dyRoughness = dFdy(roughness);\r\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\r\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\r\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\r\n\t// Clamp the value to the max mip level counts. hard coded to 6 mips\r\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\r\n\tfloat mipLevel = 0.5 * log2(d);\r\n\treturn vec2(floor(mipLevel), fract(mipLevel));\r\n}\r\n\r\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\r\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\r\n\r\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\r\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\r\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\r\n\r\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\r\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\r\n\t// float powScale = exp2(roughnessLevel + mipLevel);\r\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\r\n\t// float scale =  1.0 / exp2(roughnessLevel + 2.0 + mipLevel);\r\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\r\n\t// float mipOffset = 0.75*(1.0 - 1.0/exp2(mipLevel))/exp2(roughnessLevel);\r\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\r\n\r\n\tbool bRes = mipLevel == 0.0;\r\n\tscale =  bRes && (scale < a) ? a : scale;\r\n\r\n\tvec3 r;\r\n\tvec2 offset;\r\n\tint face = getFaceFromDirection(direction);\r\n\r\n\tfloat rcpPowScale = 1.0 / powScale;\r\n\r\n\tif( face == 0) {\r\n\t\tr = vec3(direction.x, -direction.z, direction.y);\r\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\r\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\r\n\t}\r\n\telse if( face == 1) {\r\n\t\tr = vec3(direction.y, direction.x, direction.z);\r\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\r\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\r\n\t}\r\n\telse if( face == 2) {\r\n\t\tr = vec3(direction.z, direction.x, direction.y);\r\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\r\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\r\n\t}\r\n\telse if( face == 3) {\r\n\t\tr = vec3(direction.x, direction.z, direction.y);\r\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\r\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\r\n\t}\r\n\telse if( face == 4) {\r\n\t\tr = vec3(direction.y, direction.x, -direction.z);\r\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\r\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\r\n\t}\r\n\telse {\r\n\t\tr = vec3(direction.z, -direction.x, direction.y);\r\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\r\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\r\n\t}\r\n\tr = normalize(r);\r\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\r\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\r\n\tvec2 base = offset + vec2( texelOffset );\r\n\treturn base + s * ( scale - 2.0 * texelOffset );\r\n}\r\n\r\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\r\n\r\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\r\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\r\n\tfloat r1 = floor(roughnessVal);\r\n\tfloat r2 = r1 + 1.0;\r\n\tfloat t = fract(roughnessVal);\r\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\r\n\tfloat s = mipInfo.y;\r\n\tfloat level0 = mipInfo.x;\r\n\tfloat level1 = level0 + 1.0;\r\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\r\n\r\n\t// round to nearest mipmap if we are not interpolating.\r\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\r\n\r\n\t// Tri linear interpolation.\r\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\r\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\r\n\r\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\r\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\r\n\r\n\tvec4 result = mix(color10, color20, t);\r\n\r\n\treturn vec4(result.rgb, 1.0);\r\n}\r\n\r\n#endif\r\n";var ri="vec3 transformedNormal = normalMatrix * objectNormal;\r\n\r\n#ifdef FLIP_SIDED\r\n\r\n\ttransformedNormal = - transformedNormal;\r\n\r\n#endif\r\n";var ii="#ifdef USE_DISPLACEMENTMAP\r\n\r\n\tuniform sampler2D displacementMap;\r\n\tuniform float displacementScale;\r\n\tuniform float displacementBias;\r\n\r\n#endif\r\n";var ni="#ifdef USE_DISPLACEMENTMAP\r\n\r\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\r\n\r\n#endif\r\n";var ai="#ifdef USE_EMISSIVEMAP\r\n\r\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\r\n\r\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\r\n\r\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\r\n\r\n#endif\r\n";var oi="#ifdef USE_EMISSIVEMAP\r\n\r\n\tuniform sampler2D emissiveMap;\r\n\r\n#endif\r\n";var si="  gl_FragColor = linearToOutputTexel( gl_FragColor );\r\n";var ui="// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\r\n\r\nvec4 LinearToLinear( in vec4 value ) {\r\n\treturn value;\r\n}\r\n\r\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\r\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\r\n}\r\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\r\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\r\n}\r\n\r\nvec4 sRGBToLinear( in vec4 value ) {\r\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\r\n}\r\nvec4 LinearTosRGB( in vec4 value ) {\r\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\r\n}\r\n\r\nvec4 RGBEToLinear( in vec4 value ) {\r\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\r\n}\r\nvec4 LinearToRGBE( in vec4 value ) {\r\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\r\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\r\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\r\n//  return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\r\n}\r\n\r\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\r\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\r\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\r\n}\r\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\r\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\r\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\r\n\tM            = ceil( M * 255.0 ) / 255.0;\r\n\treturn vec4( value.rgb / ( M * maxRange ), M );\r\n}\r\n\r\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\r\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\r\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\r\n}\r\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\r\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\r\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\r\n\tD            = min( floor( D ) / 255.0, 1.0 );\r\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\r\n}\r\n\r\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\r\n\r\n// M matrix, for encoding\r\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\r\nvec4 LinearToLogLuv( in vec4 value )  {\r\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\r\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\r\n\tvec4 vResult;\r\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\r\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\r\n\tvResult.w = fract(Le);\r\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\r\n\treturn vResult;\r\n}\r\n\r\n// Inverse M matrix, for decoding\r\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\r\nvec4 LogLuvToLinear( in vec4 value ) {\r\n\tfloat Le = value.z * 255.0 + value.w;\r\n\tvec3 Xp_Y_XYZp;\r\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\r\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\r\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\r\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\r\n\treturn vec4( max(vRGB, 0.0), 1.0 );\r\n}\r\n";var ci="#ifdef USE_ENVMAP\r\n\r\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\r\n\r\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\r\n\r\n\t\t// Transforming Normal Vectors with the Inverse Transformation\r\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\r\n\r\n\t\t#ifdef ENVMAP_MODE_REFLECTION\r\n\r\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\r\n\r\n\t\t#else\r\n\r\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\r\n\r\n\t\t#endif\r\n\r\n\t#else\r\n\r\n\t\tvec3 reflectVec = vReflect;\r\n\r\n\t#endif\r\n\r\n\t#ifdef ENVMAP_TYPE_CUBE\r\n\r\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\r\n\r\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\r\n\r\n\t\tvec2 sampleUV;\r\n\r\n\t\treflectVec = normalize( reflectVec );\r\n\r\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\r\n\r\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\r\n\r\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\r\n\r\n\t#elif defined( ENVMAP_TYPE_SPHERE )\r\n\r\n\t\treflectVec = normalize( reflectVec );\r\n\r\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\r\n\r\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\r\n\r\n\t#else\r\n\r\n\t\tvec4 envColor = vec4( 0.0 );\r\n\r\n\t#endif\r\n\r\n\tenvColor = envMapTexelToLinear( envColor );\r\n\r\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\r\n\r\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\r\n\r\n\t#elif defined( ENVMAP_BLENDING_MIX )\r\n\r\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\r\n\r\n\t#elif defined( ENVMAP_BLENDING_ADD )\r\n\r\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var li="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\r\n\tuniform float reflectivity;\r\n\tuniform float envMapIntensity;\r\n#endif\r\n\r\n#ifdef USE_ENVMAP\r\n\r\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\r\n\t\tvarying vec3 vWorldPosition;\r\n\t#endif\r\n\r\n\t#ifdef ENVMAP_TYPE_CUBE\r\n\t\tuniform samplerCube envMap;\r\n\t#else\r\n\t\tuniform sampler2D envMap;\r\n\t#endif\r\n\tuniform float flipEnvMap;\r\n\r\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\r\n\t\tuniform float refractionRatio;\r\n\t#else\r\n\t\tvarying vec3 vReflect;\r\n\t#endif\r\n\r\n#endif\r\n";var hi="#ifdef USE_ENVMAP\r\n\r\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\r\n\t\tvarying vec3 vWorldPosition;\r\n\r\n\t#else\r\n\r\n\t\tvarying vec3 vReflect;\r\n\t\tuniform float refractionRatio;\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var di="#ifdef USE_ENVMAP\r\n\r\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\r\n\r\n\t\tvWorldPosition = worldPosition.xyz;\r\n\r\n\t#else\r\n\r\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\r\n\r\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\r\n\r\n\t\t#ifdef ENVMAP_MODE_REFLECTION\r\n\r\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\r\n\r\n\t\t#else\r\n\r\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\r\n\r\n\t\t#endif\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var pi="\r\n#ifdef USE_FOG\r\nfogDepth = -mvPosition.z;\r\n#endif";var fi="#ifdef USE_FOG\r\n\r\n  varying float fogDepth;\r\n\r\n#endif\r\n";var vi="#ifdef USE_FOG\r\n\r\n\t#ifdef FOG_EXP2\r\n\r\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\r\n\r\n\t#else\r\n\r\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\r\n\r\n\t#endif\r\n\r\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\r\n\r\n#endif\r\n";var mi="#ifdef USE_FOG\r\n\r\n\tuniform vec3 fogColor;\r\n\tvarying float fogDepth;\r\n\r\n\t#ifdef FOG_EXP2\r\n\r\n\t\tuniform float fogDensity;\r\n\r\n\t#else\r\n\r\n\t\tuniform float fogNear;\r\n\t\tuniform float fogFar;\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var gi="#ifdef TOON\r\n\r\n\tuniform sampler2D gradientMap;\r\n\r\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\r\n\r\n\t\t// dotNL will be from -1.0 to 1.0\r\n\t\tfloat dotNL = dot( normal, lightDirection );\r\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\r\n\r\n\t\t#ifdef USE_GRADIENTMAP\r\n\r\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\r\n\r\n\t\t#else\r\n\r\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\r\n\r\n\t\t#endif\r\n\r\n\r\n\t}\r\n\r\n#endif\r\n";var yi="#ifdef USE_LIGHTMAP\r\n\r\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity; // factor of PI should not be present; included here to prevent breakage\r\n\r\n#endif\r\n";var Ai="#ifdef USE_LIGHTMAP\r\n\r\n\tuniform sampler2D lightMap;\r\n\tuniform float lightMapIntensity;\r\n\r\n#endif";var Mi="vec3 diffuse = vec3( 1.0 );\r\n\r\nGeometricContext geometry;\r\ngeometry.position = mvPosition.xyz;\r\ngeometry.normal = normalize( transformedNormal );\r\ngeometry.viewDir = normalize( -mvPosition.xyz );\r\n\r\nGeometricContext backGeometry;\r\nbackGeometry.position = geometry.position;\r\nbackGeometry.normal = -geometry.normal;\r\nbackGeometry.viewDir = geometry.viewDir;\r\n\r\nvLightFront = vec3( 0.0 );\r\n\r\n#ifdef DOUBLE_SIDED\r\n\tvLightBack = vec3( 0.0 );\r\n#endif\r\n\r\nIncidentLight directLight;\r\nfloat dotNL;\r\nvec3 directLightColor_Diffuse;\r\n\r\n#if NUM_POINT_LIGHTS > 0\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\r\n\r\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\r\n\r\n\t\tdotNL = dot( geometry.normal, directLight.direction );\r\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\r\n\r\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\r\n\r\n\t\t#ifdef DOUBLE_SIDED\r\n\r\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\r\n\r\n\t\t#endif\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#if NUM_SPOT_LIGHTS > 0\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\r\n\r\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\r\n\r\n\t\tdotNL = dot( geometry.normal, directLight.direction );\r\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\r\n\r\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\r\n\r\n\t\t#ifdef DOUBLE_SIDED\r\n\r\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\r\n\r\n\t\t#endif\r\n\t}\r\n\r\n#endif\r\n\r\n\r\n\r\n#if NUM_DIR_LIGHTS > 0\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\r\n\r\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\r\n\r\n\t\tdotNL = dot( geometry.normal, directLight.direction );\r\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\r\n\r\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\r\n\r\n\t\t#ifdef DOUBLE_SIDED\r\n\r\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\r\n\r\n\t\t#endif\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#if NUM_HEMI_LIGHTS > 0\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\r\n\r\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\r\n\r\n\t\t#ifdef DOUBLE_SIDED\r\n\r\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\r\n\r\n\t\t#endif\r\n\r\n\t}\r\n\r\n#endif\r\n";var wi="uniform vec3 ambientLightColor;\r\n\r\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\r\n\r\n\tvec3 irradiance = ambientLightColor;\r\n\r\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\r\n\r\n\t\tirradiance *= PI;\r\n\r\n\t#endif\r\n\r\n\treturn irradiance;\r\n\r\n}\r\n\r\n#if NUM_DIR_LIGHTS > 0\r\n\r\n\tstruct DirectionalLight {\r\n\t\tvec3 direction;\r\n\t\tvec3 color;\r\n\r\n\t\tint shadow;\r\n\t\tfloat shadowBias;\r\n\t\tfloat shadowRadius;\r\n\t\tvec2 shadowMapSize;\r\n\t};\r\n\r\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\r\n\r\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\r\n\r\n\t\tdirectLight.color = directionalLight.color;\r\n\t\tdirectLight.direction = directionalLight.direction;\r\n\t\tdirectLight.visible = true;\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n\r\n#if NUM_POINT_LIGHTS > 0\r\n\r\n\tstruct PointLight {\r\n\t\tvec3 position;\r\n\t\tvec3 color;\r\n\t\tfloat distance;\r\n\t\tfloat decay;\r\n\r\n\t\tint shadow;\r\n\t\tfloat shadowBias;\r\n\t\tfloat shadowRadius;\r\n\t\tvec2 shadowMapSize;\r\n\t\tfloat shadowCameraNear;\r\n\t\tfloat shadowCameraFar;\r\n\t};\r\n\r\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\r\n\r\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\r\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\r\n\r\n\t\tvec3 lVector = pointLight.position - geometry.position;\r\n\t\tdirectLight.direction = normalize( lVector );\r\n\r\n\t\tfloat lightDistance = length( lVector );\r\n\r\n\t\tdirectLight.color = pointLight.color;\r\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\r\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n\r\n#if NUM_SPOT_LIGHTS > 0\r\n\r\n\tstruct SpotLight {\r\n\t\tvec3 position;\r\n\t\tvec3 direction;\r\n\t\tvec3 color;\r\n\t\tfloat distance;\r\n\t\tfloat decay;\r\n\t\tfloat coneCos;\r\n\t\tfloat penumbraCos;\r\n\r\n\t\tint shadow;\r\n\t\tfloat shadowBias;\r\n\t\tfloat shadowRadius;\r\n\t\tvec2 shadowMapSize;\r\n\t};\r\n\r\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\r\n\r\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\r\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\r\n\r\n\t\tvec3 lVector = spotLight.position - geometry.position;\r\n\t\tdirectLight.direction = normalize( lVector );\r\n\r\n\t\tfloat lightDistance = length( lVector );\r\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\r\n\r\n\t\tif ( angleCos > spotLight.coneCos ) {\r\n\r\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\r\n\r\n\t\t\tdirectLight.color = spotLight.color;\r\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\r\n\t\t\tdirectLight.visible = true;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdirectLight.color = vec3( 0.0 );\r\n\t\t\tdirectLight.visible = false;\r\n\r\n\t\t}\r\n\t}\r\n\r\n#endif\r\n\r\n\r\n#if NUM_RECT_AREA_LIGHTS > 0\r\n\r\n\tstruct RectAreaLight {\r\n\t\tvec3 color;\r\n\t\tvec3 position;\r\n\t\tvec3 halfWidth;\r\n\t\tvec3 halfHeight;\r\n\t};\r\n\r\n\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\r\n\t// BRDF approximation Texture is 64x64\r\n\tuniform sampler2D ltc_1; // RGBA Float\r\n\tuniform sampler2D ltc_2; // RGBA Float\r\n\r\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\r\n\r\n#endif\r\n\r\n\r\n#if NUM_HEMI_LIGHTS > 0\r\n\r\n\tstruct HemisphereLight {\r\n\t\tvec3 direction;\r\n\t\tvec3 skyColor;\r\n\t\tvec3 groundColor;\r\n\t};\r\n\r\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\r\n\r\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\r\n\r\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\r\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\r\n\r\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\r\n\r\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\r\n\r\n\t\t\tirradiance *= PI;\r\n\r\n\t\t#endif\r\n\r\n\t\treturn irradiance;\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n\r\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\r\n\r\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\r\n\r\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\r\n\r\n\t\t#ifdef ENVMAP_TYPE_CUBE\r\n\r\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\r\n\r\n\t\t\t// TODO: replace with properly filtered cubemaps and access the irradiance LOD level, be it the last LOD level\r\n\t\t\t// of a specular cubemap, or just the default level of a specially created irradiance cubemap.\r\n\r\n\t\t\t#ifdef TEXTURE_LOD_EXT\r\n\r\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\r\n\r\n\t\t\t#else\r\n\r\n\t\t\t\t// force the bias high to get the last LOD level as it is the most blurred.\r\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\r\n\r\n\t\t\t#endif\r\n\r\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\r\n\r\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\r\n\r\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\r\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\r\n\r\n\t\t#else\r\n\r\n\t\t\tvec4 envMapColor = vec4( 0.0 );\r\n\r\n\t\t#endif\r\n\r\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\r\n\r\n\t}\r\n\r\n\t// taken from here: http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\r\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\r\n\r\n\t\t//float envMapWidth = pow( 2.0, maxMIPLevelScalar );\r\n\t\t//float desiredMIPLevel = log2( envMapWidth * sqrt( 3.0 ) ) - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\r\n\r\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\r\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\r\n\r\n\t\t// clamp to allowable LOD ranges.\r\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\r\n\r\n\t}\r\n\r\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\r\n\r\n\t\t#ifdef ENVMAP_MODE_REFLECTION\r\n\r\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\r\n\r\n\t\t#else\r\n\r\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\r\n\r\n\t\t#endif\r\n\r\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\r\n\r\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\r\n\r\n\t\t#ifdef ENVMAP_TYPE_CUBE\r\n\r\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\r\n\r\n\t\t\t#ifdef TEXTURE_LOD_EXT\r\n\r\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\r\n\r\n\t\t\t#else\r\n\r\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\r\n\r\n\t\t\t#endif\r\n\r\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\r\n\r\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\r\n\r\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\r\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\r\n\r\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\r\n\r\n\t\t\tvec2 sampleUV;\r\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\r\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\r\n\r\n\t\t\t#ifdef TEXTURE_LOD_EXT\r\n\r\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\r\n\r\n\t\t\t#else\r\n\r\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\r\n\r\n\t\t\t#endif\r\n\r\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\r\n\r\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\r\n\r\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\r\n\r\n\t\t\t#ifdef TEXTURE_LOD_EXT\r\n\r\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\r\n\r\n\t\t\t#else\r\n\r\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\r\n\r\n\t\t\t#endif\r\n\r\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\r\n\r\n\t\t#endif\r\n\r\n\t\treturn envMapColor.rgb * envMapIntensity;\r\n\r\n\t}\r\n\r\n#endif\r\n";var Ei="BlinnPhongMaterial material;\r\nmaterial.diffuseColor = diffuseColor.rgb;\r\nmaterial.specularColor = specular;\r\nmaterial.specularShininess = shininess;\r\nmaterial.specularStrength = specularStrength;\r\n";var xi="varying vec3 vViewPosition;\r\n\r\n#ifndef FLAT_SHADED\r\n\r\n\tvarying vec3 vNormal;\r\n\r\n#endif\r\n\r\n\r\nstruct BlinnPhongMaterial {\r\n\r\n\tvec3\tdiffuseColor;\r\n\tvec3\tspecularColor;\r\n\tfloat\tspecularShininess;\r\n\tfloat\tspecularStrength;\r\n\r\n};\r\n\r\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\r\n\r\n\t#ifdef TOON\r\n\r\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\r\n\r\n\t#else\r\n\r\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\r\n\t\tvec3 irradiance = dotNL * directLight.color;\r\n\r\n\t#endif\r\n\r\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\r\n\r\n\t\tirradiance *= PI; // punctual light\r\n\r\n\t#endif\r\n\r\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\r\n\r\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\r\n\r\n}\r\n\r\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\r\n\r\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\r\n\r\n}\r\n\r\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\r\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\r\n\r\n#define Material_LightProbeLOD( material )\t(0)\r\n";var bi="PhysicalMaterial material;\r\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\r\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\r\n#ifdef STANDARD\r\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\r\n#else\r\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\r\n\tmaterial.clearCoat = saturate( clearCoat ); // Burley clearcoat model\r\n\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\r\n#endif\r\n";var Ti="struct PhysicalMaterial {\r\n\r\n\tvec3\tdiffuseColor;\r\n\tfloat\tspecularRoughness;\r\n\tvec3\tspecularColor;\r\n\r\n\t#ifndef STANDARD\r\n\t\tfloat clearCoat;\r\n\t\tfloat clearCoatRoughness;\r\n\t#endif\r\n\r\n};\r\n\r\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\r\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\r\n\r\n// Clear coat directional hemishperical reflectance (this approximation should be improved)\r\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\r\n\r\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\r\n\r\n}\r\n\r\n#if NUM_RECT_AREA_LIGHTS > 0\r\n\r\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\r\n\r\n\t\tvec3 normal = geometry.normal;\r\n\t\tvec3 viewDir = geometry.viewDir;\r\n\t\tvec3 position = geometry.position;\r\n\t\tvec3 lightPos = rectAreaLight.position;\r\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\r\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\r\n\t\tvec3 lightColor = rectAreaLight.color;\r\n\t\tfloat roughness = material.specularRoughness;\r\n\r\n\t\tvec3 rectCoords[ 4 ];\r\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight; // counterclockwise\r\n\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\r\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\r\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\r\n\r\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\r\n\r\n\t\tvec4 t1 = texture2D( ltc_1, uv );\r\n\t\tvec4 t2 = texture2D( ltc_2, uv );\r\n\r\n\t\tmat3 mInv = mat3(\r\n\t\t\tvec3( t1.x, 0, t1.y ),\r\n\t\t\tvec3(    0, 1,    0 ),\r\n\t\t\tvec3( t1.z, 0, t1.w )\r\n\t\t);\r\n\r\n\t\t// LTC Fresnel Approximation by Stephen Hill\r\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\r\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\r\n\r\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\r\n\r\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\r\n\r\n\t}\r\n\r\n#endif\r\n\r\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\r\n\r\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\r\n\r\n\tvec3 irradiance = dotNL * directLight.color;\r\n\r\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\r\n\r\n\t\tirradiance *= PI; // punctual light\r\n\r\n\t#endif\r\n\r\n\t#ifndef STANDARD\r\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\r\n\t#else\r\n\t\tfloat clearCoatDHR = 0.0;\r\n\t#endif\r\n\r\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\r\n\r\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\r\n\r\n\t#ifndef STANDARD\r\n\r\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\r\n\r\n\t#endif\r\n\r\n}\r\n\r\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\r\n\r\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\r\n\r\n}\r\n\r\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\r\n\r\n\t#ifndef STANDARD\r\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\r\n\t\tfloat dotNL = dotNV;\r\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\r\n\t#else\r\n\t\tfloat clearCoatDHR = 0.0;\r\n\t#endif\r\n\r\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\r\n\r\n\t#ifndef STANDARD\r\n\r\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\r\n\r\n\t#endif\r\n\r\n}\r\n\r\n#define RE_Direct\t\t\t\tRE_Direct_Physical\r\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\r\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\r\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\r\n\r\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\r\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\r\n\r\n// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\r\n\r\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\r\n\r\n}\r\n";var Li="\r\n\r\nGeometricContext geometry;\r\n\r\ngeometry.position = - vViewPosition;\r\ngeometry.normal = normal;\r\ngeometry.viewDir = normalize( vViewPosition );\r\n\r\nIncidentLight directLight;\r\n\r\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\r\n\r\n\tPointLight pointLight;\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\r\n\r\n\t\tpointLight = pointLights[ i ];\r\n\r\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\r\n\r\n\t\t#ifdef USE_SHADOWMAP\r\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\r\n\t\t#endif\r\n\r\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\r\n\r\n\tSpotLight spotLight;\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\r\n\r\n\t\tspotLight = spotLights[ i ];\r\n\r\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\r\n\r\n\t\t#ifdef USE_SHADOWMAP\r\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\r\n\t\t#endif\r\n\r\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\r\n\r\n\tDirectionalLight directionalLight;\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\r\n\r\n\t\tdirectionalLight = directionalLights[ i ];\r\n\r\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\r\n\r\n\t\t#ifdef USE_SHADOWMAP\r\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\r\n\t\t#endif\r\n\r\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\r\n\r\n\tRectAreaLight rectAreaLight;\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\r\n\r\n\t\trectAreaLight = rectAreaLights[ i ];\r\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\r\n\r\n\t}\r\n\r\n#endif\r\n\r\n#if defined( RE_IndirectDiffuse )\r\n\r\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\r\n\r\n\t#ifdef USE_LIGHTMAP\r\n\r\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\r\n\r\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\r\n\r\n\t\t\tlightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\r\n\r\n\t\t#endif\r\n\r\n\t\tirradiance += lightMapIrradiance;\r\n\r\n\t#endif\r\n\r\n\t#if ( NUM_HEMI_LIGHTS > 0 )\r\n\r\n\t\t#pragma unroll_loop\r\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\r\n\r\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\r\n\r\n\t\t}\r\n\r\n\t#endif\r\n\r\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\r\n\r\n\t\t// TODO, replace 8 with the real maxMIPLevel\r\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\r\n\r\n\t#endif\r\n\r\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\r\n\r\n#endif\r\n\r\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\r\n\r\n\t// TODO, replace 8 with the real maxMIPLevel\r\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\r\n\r\n\t#ifndef STANDARD\r\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\r\n\t#else\r\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\r\n\t#endif\r\n\r\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\r\n\r\n#endif\r\n";var Ni="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\r\n\r\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\r\n\r\n#endif";var Di="#ifdef USE_LOGDEPTHBUF\r\n\r\n\tuniform float logDepthBufFC;\r\n\r\n\t#ifdef USE_LOGDEPTHBUF_EXT\r\n\r\n\t\tvarying float vFragDepth;\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var Ci="#ifdef USE_LOGDEPTHBUF\r\n\r\n\t#ifdef USE_LOGDEPTHBUF_EXT\r\n\r\n\t\tvarying float vFragDepth;\r\n\r\n\t#endif\r\n\r\n\tuniform float logDepthBufFC;\r\n\r\n#endif";var Si="#ifdef USE_LOGDEPTHBUF\r\n\r\n\t#ifdef USE_LOGDEPTHBUF_EXT\r\n\r\n\t\tvFragDepth = 1.0 + gl_Position.w;\r\n\r\n\t#else\r\n\r\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\r\n\r\n\t\tgl_Position.z *= gl_Position.w;\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var Ii="#ifdef USE_MAP\r\n\r\n\tvec4 texelColor = texture2D( map, vUv );\r\n\r\n\ttexelColor = mapTexelToLinear( texelColor );\r\n\tdiffuseColor *= texelColor;\r\n\r\n#endif\r\n";var _i="#ifdef USE_MAP\r\n\r\n\tuniform sampler2D map;\r\n\r\n#endif\r\n";var Oi="#ifdef USE_MAP\r\n\r\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\r\n\tvec4 mapTexel = texture2D( map, uv );\r\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\r\n\r\n#endif\r\n";var ji="#ifdef USE_MAP\r\n\r\n\tuniform mat3 uvTransform;\r\n\tuniform sampler2D map;\r\n\r\n#endif\r\n";var Ri="float metalnessFactor = metalness;\r\n\r\n#ifdef USE_METALNESSMAP\r\n\r\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\r\n\r\n\t// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\r\n\tmetalnessFactor *= texelMetalness.b;\r\n\r\n#endif\r\n";var zi="#ifdef USE_METALNESSMAP\r\n\r\n\tuniform sampler2D metalnessMap;\r\n\r\n#endif";var ki="#ifdef USE_MORPHNORMALS\r\n\r\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\r\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\r\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\r\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\r\n\r\n#endif\r\n";var Pi="#ifdef USE_MORPHTARGETS\r\n\r\n\t#ifndef USE_MORPHNORMALS\r\n\r\n\tuniform float morphTargetInfluences[ 8 ];\r\n\r\n\t#else\r\n\r\n\tuniform float morphTargetInfluences[ 4 ];\r\n\r\n\t#endif\r\n\r\n#endif";var Ui="#ifdef USE_MORPHTARGETS\r\n\r\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\r\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\r\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\r\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\r\n\r\n\t#ifndef USE_MORPHNORMALS\r\n\r\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\r\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\r\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\r\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var Bi="#ifdef FLAT_SHADED\r\n\r\n\t// Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\r\n\r\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\r\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\r\n\tvec3 normal = normalize( cross( fdx, fdy ) );\r\n\r\n#else\r\n\r\n\tvec3 normal = normalize( vNormal );\r\n\r\n\t#ifdef DOUBLE_SIDED\r\n\r\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\r\n\r\n\t#endif\r\n\r\n#endif\r\n\r\n#ifdef USE_NORMALMAP\r\n\r\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\r\n\r\n#elif defined( USE_BUMPMAP )\r\n\r\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\r\n\r\n#endif\r\n";var Fi="#ifdef USE_NORMALMAP\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform vec2 normalScale;\r\n\r\n\t// Per-Pixel Tangent Space Normal Mapping\r\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\r\n\r\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\r\n\r\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\r\n\r\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\r\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\r\n\t\tvec2 st0 = dFdx( vUv.st );\r\n\t\tvec2 st1 = dFdy( vUv.st );\r\n\r\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\r\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\r\n\t\tvec3 N = normalize( surf_norm );\r\n\r\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\r\n\t\tmapN.xy = normalScale * mapN.xy;\r\n\t\tmat3 tsn = mat3( S, T, N );\r\n\t\treturn normalize( tsn * mapN );\r\n\r\n\t}\r\n\r\n#endif\r\n";var Gi="vec3 packNormalToRGB( const in vec3 normal ) {\r\n\treturn normalize( normal ) * 0.5 + 0.5;\r\n}\r\n\r\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\r\n\treturn 2.0 * rgb.xyz - 1.0;\r\n}\r\n\r\nconst float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)\r\nconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\r\n\r\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\r\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\r\n\r\nconst float ShiftRight8 = 1. / 256.;\r\n\r\nvec4 packDepthToRGBA( const in float v ) {\r\n\tvec4 r = vec4( fract( v * PackFactors ), v );\r\n\tr.yzw -= r.xyz * ShiftRight8; // tidy overflow\r\n\treturn r * PackUpscale;\r\n}\r\n\r\nfloat unpackRGBAToDepth( const in vec4 v ) {\r\n\treturn dot( v, UnpackFactors );\r\n}\r\n\r\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\r\n\r\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\r\n\treturn ( viewZ + near ) / ( near - far );\r\n}\r\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\r\n\treturn linearClipZ * ( near - far ) - near;\r\n}\r\n\r\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\r\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\r\n}\r\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\r\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\r\n}\r\n";var Hi="#ifdef PREMULTIPLIED_ALPHA\r\n\r\n\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\r\n\tgl_FragColor.rgb *= gl_FragColor.a;\r\n\r\n#endif\r\n";var Vi="vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\r\n\r\ngl_Position = projectionMatrix * mvPosition;\r\n";var Qi="#if defined( DITHERING )\r\n\r\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\r\n\r\n#endif\r\n";var Yi="#if defined( DITHERING )\r\n\r\n\t// based on https://www.shadertoy.com/view/MslGR8\r\n\tvec3 dithering( vec3 color ) {\r\n\t\t//Calculate grid position\r\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\r\n\r\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\r\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\r\n\r\n\t\t//modify shift acording to grid position.\r\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\r\n\r\n\t\t//shift the color by dither_shift\r\n\t\treturn color + dither_shift_RGB;\r\n\t}\r\n\r\n#endif\r\n";var Wi="float roughnessFactor = roughness;\r\n\r\n#ifdef USE_ROUGHNESSMAP\r\n\r\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\r\n\r\n\t// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\r\n\troughnessFactor *= texelRoughness.g;\r\n\r\n#endif\r\n";var Xi="#ifdef USE_ROUGHNESSMAP\r\n\r\n\tuniform sampler2D roughnessMap;\r\n\r\n#endif";var qi="#ifdef USE_SHADOWMAP\r\n\r\n\t#if NUM_DIR_LIGHTS > 0\r\n\r\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\r\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\r\n\r\n\t#endif\r\n\r\n\t#if NUM_SPOT_LIGHTS > 0\r\n\r\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\r\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\r\n\r\n\t#endif\r\n\r\n\t#if NUM_POINT_LIGHTS > 0\r\n\r\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\r\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\r\n\r\n\t#endif\r\n\r\n\r\n\r\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\r\n\r\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\r\n\r\n\t}\r\n\r\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\r\n\r\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\r\n\r\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\r\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\r\n\r\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\r\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\r\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\r\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\r\n\r\n\t\tvec2 f = fract( uv * size + 0.5 );\r\n\r\n\t\tfloat a = mix( lb, lt, f.y );\r\n\t\tfloat b = mix( rb, rt, f.y );\r\n\t\tfloat c = mix( a, b, f.x );\r\n\r\n\t\treturn c;\r\n\r\n\t}\r\n\r\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\r\n\r\n\t\tfloat shadow = 1.0;\r\n\r\n\t\tshadowCoord.xyz /= shadowCoord.w;\r\n\t\tshadowCoord.z += shadowBias;\r\n\r\n\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\r\n\t\t// if ( all( something, something ) ) using this instead\r\n\r\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\r\n\t\tbool inFrustum = all( inFrustumVec );\r\n\r\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\r\n\r\n\t\tbool frustumTest = all( frustumTestVec );\r\n\r\n\t\tif ( frustumTest ) {\r\n\r\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\r\n\r\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\r\n\r\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\r\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\r\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\r\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\r\n\r\n\t\t\tshadow = (\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\r\n\t\t\t) * ( 1.0 / 9.0 );\r\n\r\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\r\n\r\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\r\n\r\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\r\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\r\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\r\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\r\n\r\n\t\t\tshadow = (\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\r\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\r\n\t\t\t) * ( 1.0 / 9.0 );\r\n\r\n\t\t#else // no percentage-closer filtering:\r\n\r\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\r\n\r\n\t\t#endif\r\n\r\n\t\t}\r\n\r\n\t\treturn shadow;\r\n\r\n\t}\r\n\r\n\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\r\n\t// vector suitable for 2D texture mapping. This code uses the following layout for the\r\n\t// 2D texture:\r\n\t//\r\n\t// xzXZ\r\n\t//  y Y\r\n\t//\r\n\t// Y - Positive y direction\r\n\t// y - Negative y direction\r\n\t// X - Positive x direction\r\n\t// x - Negative x direction\r\n\t// Z - Positive z direction\r\n\t// z - Negative z direction\r\n\t//\r\n\t// Source and test bed:\r\n\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\r\n\r\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\r\n\r\n\t\t// Number of texels to avoid at the edge of each square\r\n\r\n\t\tvec3 absV = abs( v );\r\n\r\n\t\t// Intersect unit cube\r\n\r\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\r\n\t\tabsV *= scaleToCube;\r\n\r\n\t\t// Apply scale to avoid seams\r\n\r\n\t\t// two texels less per square (one texel will do for NEAREST)\r\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\r\n\r\n\t\t// Unwrap\r\n\r\n\t\t// space: -1 ... 1 range for each square\r\n\t\t//\r\n\t\t// #X##\t\tdim    := ( 4 , 2 )\r\n\t\t//  # #\t\tcenter := ( 1 , 1 )\r\n\r\n\t\tvec2 planar = v.xy;\r\n\r\n\t\tfloat almostATexel = 1.5 * texelSizeY;\r\n\t\tfloat almostOne = 1.0 - almostATexel;\r\n\r\n\t\tif ( absV.z >= almostOne ) {\r\n\r\n\t\t\tif ( v.z > 0.0 )\r\n\t\t\t\tplanar.x = 4.0 - v.x;\r\n\r\n\t\t} else if ( absV.x >= almostOne ) {\r\n\r\n\t\t\tfloat signX = sign( v.x );\r\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\r\n\r\n\t\t} else if ( absV.y >= almostOne ) {\r\n\r\n\t\t\tfloat signY = sign( v.y );\r\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\r\n\t\t\tplanar.y = v.z * signY - 2.0;\r\n\r\n\t\t}\r\n\r\n\t\t// Transform to UV space\r\n\r\n\t\t// scale := 0.5 / dim\r\n\t\t// translate := ( center + 0.5 ) / dim\r\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\r\n\r\n\t}\r\n\r\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\r\n\r\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\r\n\r\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\r\n\t\t// the vector from the light to the world-space position of the fragment.\r\n\t\tvec3 lightToPosition = shadowCoord.xyz;\r\n\r\n\t\t// dp = normalized distance from light to fragment position\r\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\r\n\t\tdp += shadowBias;\r\n\r\n\t\t// bd3D = base direction 3D\r\n\t\tvec3 bd3D = normalize( lightToPosition );\r\n\r\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\r\n\r\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\r\n\r\n\t\t\treturn (\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\r\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\r\n\t\t\t) * ( 1.0 / 9.0 );\r\n\r\n\t\t#else // no percentage-closer filtering\r\n\r\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\r\n\r\n\t\t#endif\r\n\r\n\t}\r\n\r\n#endif\r\n";var Zi="#ifdef USE_SHADOWMAP\r\n\r\n\t#if NUM_DIR_LIGHTS > 0\r\n\r\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\r\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\r\n\r\n\t#endif\r\n\r\n\t#if NUM_SPOT_LIGHTS > 0\r\n\r\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\r\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\r\n\r\n\t#endif\r\n\r\n\t#if NUM_POINT_LIGHTS > 0\r\n\r\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\r\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\r\n\r\n\t#endif\r\n\r\n\r\n\r\n#endif\r\n";var Ji="#ifdef USE_SHADOWMAP\r\n\r\n\t#if NUM_DIR_LIGHTS > 0\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\r\n\r\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\r\n\r\n\t}\r\n\r\n\t#endif\r\n\r\n\t#if NUM_SPOT_LIGHTS > 0\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\r\n\r\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\r\n\r\n\t}\r\n\r\n\t#endif\r\n\r\n\t#if NUM_POINT_LIGHTS > 0\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\r\n\r\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\r\n\r\n\t}\r\n\r\n\t#endif\r\n\r\n\r\n\r\n#endif\r\n";var Ki="float getShadowMask() {\r\n\r\n\tfloat shadow = 1.0;\r\n\r\n\t#ifdef USE_SHADOWMAP\r\n\r\n\t#if NUM_DIR_LIGHTS > 0\r\n\r\n\tDirectionalLight directionalLight;\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\r\n\r\n\t\tdirectionalLight = directionalLights[ i ];\r\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\r\n\r\n\t}\r\n\r\n\t#endif\r\n\r\n\t#if NUM_SPOT_LIGHTS > 0\r\n\r\n\tSpotLight spotLight;\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\r\n\r\n\t\tspotLight = spotLights[ i ];\r\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\r\n\r\n\t}\r\n\r\n\t#endif\r\n\r\n\t#if NUM_POINT_LIGHTS > 0\r\n\r\n\tPointLight pointLight;\r\n\r\n\t#pragma unroll_loop\r\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\r\n\r\n\t\tpointLight = pointLights[ i ];\r\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\r\n\r\n\t}\r\n\r\n\t#endif\r\n\r\n\r\n\r\n\t#endif\r\n\r\n\treturn shadow;\r\n\r\n}\r\n";var $i="#ifdef USE_SKINNING\r\n\r\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\r\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\r\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\r\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\r\n\r\n#endif";var en="#ifdef USE_SKINNING\r\n\r\n\tuniform mat4 bindMatrix;\r\n\tuniform mat4 bindMatrixInverse;\r\n\r\n\t#ifdef BONE_TEXTURE\r\n\r\n\t\tuniform sampler2D boneTexture;\r\n\t\tuniform int boneTextureSize;\r\n\r\n\t\tmat4 getBoneMatrix( const in float i ) {\r\n\r\n\t\t\tfloat j = i * 4.0;\r\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\r\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\r\n\r\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\r\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\r\n\r\n\t\t\ty = dy * ( y + 0.5 );\r\n\r\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\r\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\r\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\r\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\r\n\r\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\r\n\r\n\t\t\treturn bone;\r\n\r\n\t\t}\r\n\r\n\t#else\r\n\r\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\r\n\r\n\t\tmat4 getBoneMatrix( const in float i ) {\r\n\r\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\r\n\t\t\treturn bone;\r\n\r\n\t\t}\r\n\r\n\t#endif\r\n\r\n#endif\r\n";var tn="#ifdef USE_SKINNING\r\n\r\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\r\n\r\n\tvec4 skinned = vec4( 0.0 );\r\n\tskinned += boneMatX * skinVertex * skinWeight.x;\r\n\tskinned += boneMatY * skinVertex * skinWeight.y;\r\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\r\n\tskinned += boneMatW * skinVertex * skinWeight.w;\r\n\r\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\r\n\r\n#endif\r\n";var rn="#ifdef USE_SKINNING\r\n\r\n\tmat4 skinMatrix = mat4( 0.0 );\r\n\tskinMatrix += skinWeight.x * boneMatX;\r\n\tskinMatrix += skinWeight.y * boneMatY;\r\n\tskinMatrix += skinWeight.z * boneMatZ;\r\n\tskinMatrix += skinWeight.w * boneMatW;\r\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\r\n\r\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\r\n\r\n#endif\r\n";var nn="float specularStrength;\r\n\r\n#ifdef USE_SPECULARMAP\r\n\r\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\r\n\tspecularStrength = texelSpecular.r;\r\n\r\n#else\r\n\r\n\tspecularStrength = 1.0;\r\n\r\n#endif";var an="#ifdef USE_SPECULARMAP\r\n\r\n\tuniform sampler2D specularMap;\r\n\r\n#endif";var on="#if defined( TONE_MAPPING )\r\n\r\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\r\n\r\n#endif\r\n";var sn="#ifndef saturate\r\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\r\n#endif\r\n\r\nuniform float toneMappingExposure;\r\nuniform float toneMappingWhitePoint;\r\n\r\n// exposure only\r\nvec3 LinearToneMapping( vec3 color ) {\r\n\r\n\treturn toneMappingExposure * color;\r\n\r\n}\r\n\r\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\r\nvec3 ReinhardToneMapping( vec3 color ) {\r\n\r\n\tcolor *= toneMappingExposure;\r\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\r\n\r\n}\r\n\r\n// source: http://filmicgames.com/archives/75\r\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\r\nvec3 Uncharted2ToneMapping( vec3 color ) {\r\n\r\n\t// John Hable's filmic operator from Uncharted 2 video game\r\n\tcolor *= toneMappingExposure;\r\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\r\n\r\n}\r\n\r\n// source: http://filmicgames.com/archives/75\r\nvec3 OptimizedCineonToneMapping( vec3 color ) {\r\n\r\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\r\n\tcolor *= toneMappingExposure;\r\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\r\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\r\n\r\n}\r\n";var un="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\r\n\r\n\tvarying vec2 vUv;\r\n\r\n#endif";var cn="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\r\n\r\n\tvarying vec2 vUv;\r\n\tuniform mat3 uvTransform;\r\n\r\n#endif\r\n";var ln="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\r\n\r\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\r\n\r\n#endif";var hn="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\r\n\r\n\tvarying vec2 vUv2;\r\n\r\n#endif";var dn="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\r\n\r\n\tattribute vec2 uv2;\r\n\tvarying vec2 vUv2;\r\n\r\n#endif";var pn="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\r\n\r\n\tvUv2 = uv2;\r\n\r\n#endif";var fn="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\r\n\r\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\r\n\r\n#endif\r\n";var vn="uniform samplerCube tCube;\r\nuniform float tFlip;\r\nuniform float opacity;\r\n\r\nvarying vec3 vWorldPosition;\r\n\r\nvoid main() {\r\n\r\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\r\n\tgl_FragColor.a *= opacity;\r\n\r\n}\r\n";var mn="varying vec3 vWorldPosition;\r\n\r\n#include <common>\r\n\r\nvoid main() {\r\n\r\n\tvWorldPosition = transformDirection( position, modelMatrix );\r\n\r\n\t#include <begin_vertex>\r\n\t#include <project_vertex>\r\n\r\n\tgl_Position.z = gl_Position.w; // set z to camera.far\r\n\r\n}\r\n";var gn="#if DEPTH_PACKING == 3200\r\n\r\n\tuniform float opacity;\r\n\r\n#endif\r\n\r\n#include <common>\r\n#include <packing>\r\n#include <uv_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <alphamap_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\tvec4 diffuseColor = vec4( 1.0 );\r\n\r\n\t#if DEPTH_PACKING == 3200\r\n\r\n\t\tdiffuseColor.a = opacity;\r\n\r\n\t#endif\r\n\r\n\t#include <map_fragment>\r\n\t#include <alphamap_fragment>\r\n\t#include <alphatest_fragment>\r\n\r\n\t#include <logdepthbuf_fragment>\r\n\r\n\t#if DEPTH_PACKING == 3200\r\n\r\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\r\n\r\n\t#elif DEPTH_PACKING == 3201\r\n\r\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\r\n\r\n\t#endif\r\n\r\n}\r\n";var yn="#include <common>\r\n#include <uv_pars_vertex>\r\n#include <displacementmap_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <uv_vertex>\r\n\r\n\t#include <skinbase_vertex>\r\n\r\n\t#ifdef USE_DISPLACEMENTMAP\r\n\r\n\t\t#include <beginnormal_vertex>\r\n\t\t#include <morphnormal_vertex>\r\n\t\t#include <skinnormal_vertex>\r\n\r\n\t#endif\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <displacementmap_vertex>\r\n\t#include <project_vertex>\r\n\t#include <logdepthbuf_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\r\n}\r\n";var An="#define DISTANCE\r\n\r\nuniform vec3 referencePosition;\r\nuniform float nearDistance;\r\nuniform float farDistance;\r\nvarying vec3 vWorldPosition;\r\n\r\n#include <common>\r\n#include <packing>\r\n#include <uv_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <alphamap_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main () {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\tvec4 diffuseColor = vec4( 1.0 );\r\n\r\n\t#include <map_fragment>\r\n\t#include <alphamap_fragment>\r\n\t#include <alphatest_fragment>\r\n\r\n\tfloat dist = length( vWorldPosition - referencePosition );\r\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\r\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\r\n\r\n\tgl_FragColor = packDepthToRGBA( dist );\r\n\r\n}\r\n";var Mn="#define DISTANCE\r\n\r\nvarying vec3 vWorldPosition;\r\n\r\n#include <common>\r\n#include <uv_pars_vertex>\r\n#include <displacementmap_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <uv_vertex>\r\n\r\n\t#include <skinbase_vertex>\r\n\r\n\t#ifdef USE_DISPLACEMENTMAP\r\n\r\n\t\t#include <beginnormal_vertex>\r\n\t\t#include <morphnormal_vertex>\r\n\t\t#include <skinnormal_vertex>\r\n\r\n\t#endif\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <displacementmap_vertex>\r\n\t#include <project_vertex>\r\n\t#include <worldpos_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\r\n\tvWorldPosition = worldPosition.xyz;\r\n\r\n}\r\n";var wn="uniform sampler2D tEquirect;\r\n\r\nvarying vec3 vWorldPosition;\r\n\r\n#include <common>\r\n\r\nvoid main() {\r\n\r\n\tvec3 direction = normalize( vWorldPosition );\r\n\r\n\tvec2 sampleUV;\r\n\r\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\r\n\r\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\r\n\r\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\r\n\r\n}\r\n";var En="varying vec3 vWorldPosition;\r\n\r\n#include <common>\r\n\r\nvoid main() {\r\n\r\n\tvWorldPosition = transformDirection( position, modelMatrix );\r\n\r\n\t#include <begin_vertex>\r\n\t#include <project_vertex>\r\n\r\n}\r\n";var xn="uniform vec3 diffuse;\r\nuniform float opacity;\r\n\r\nuniform float dashSize;\r\nuniform float totalSize;\r\n\r\nvarying float vLineDistance;\r\n\r\n#include <common>\r\n#include <color_pars_fragment>\r\n#include <fog_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\r\n\r\n\t\tdiscard;\r\n\r\n\t}\r\n\r\n\tvec3 outgoingLight = vec3( 0.0 );\r\n\tvec4 diffuseColor = vec4( diffuse, opacity );\r\n\r\n\t#include <logdepthbuf_fragment>\r\n\t#include <color_fragment>\r\n\r\n\toutgoingLight = diffuseColor.rgb; // simple shader\r\n\r\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\r\n\r\n\t#include <premultiplied_alpha_fragment>\r\n\t#include <tonemapping_fragment>\r\n\t#include <encodings_fragment>\r\n\t#include <fog_fragment>\r\n\r\n}\r\n";var bn="uniform float scale;\r\nattribute float lineDistance;\r\n\r\nvarying float vLineDistance;\r\n\r\n#include <common>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <color_vertex>\r\n\r\n\tvLineDistance = scale * lineDistance;\r\n\r\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\r\n\tgl_Position = projectionMatrix * mvPosition;\r\n\r\n\t#include <logdepthbuf_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\t#include <fog_vertex>\r\n\r\n}\r\n";var Tn="uniform vec3 diffuse;\r\nuniform float opacity;\r\n\r\n#ifndef FLAT_SHADED\r\n\r\n\tvarying vec3 vNormal;\r\n\r\n#endif\r\n\r\n#include <common>\r\n#include <color_pars_fragment>\r\n#include <uv_pars_fragment>\r\n#include <uv2_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <alphamap_pars_fragment>\r\n#include <aomap_pars_fragment>\r\n#include <lightmap_pars_fragment>\r\n#include <envmap_pars_fragment>\r\n#include <fog_pars_fragment>\r\n#include <specularmap_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\tvec4 diffuseColor = vec4( diffuse, opacity );\r\n\r\n\t#include <logdepthbuf_fragment>\r\n\t#include <map_fragment>\r\n\t#include <color_fragment>\r\n\t#include <alphamap_fragment>\r\n\t#include <alphatest_fragment>\r\n\t#include <specularmap_fragment>\r\n\r\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\r\n\r\n\t// accumulation (baked indirect lighting only)\r\n\t#ifdef USE_LIGHTMAP\r\n\r\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\r\n\r\n\t#else\r\n\r\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\r\n\r\n\t#endif\r\n\r\n\t// modulation\r\n\t#include <aomap_fragment>\r\n\r\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\r\n\r\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\r\n\r\n\t#include <envmap_fragment>\r\n\r\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\r\n\r\n\t#include <premultiplied_alpha_fragment>\r\n\t#include <tonemapping_fragment>\r\n\t#include <encodings_fragment>\r\n\t#include <fog_fragment>\r\n\r\n}\r\n";var Ln="#include <common>\r\n#include <uv_pars_vertex>\r\n#include <uv2_pars_vertex>\r\n#include <envmap_pars_vertex>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <uv_vertex>\r\n\t#include <uv2_vertex>\r\n\t#include <color_vertex>\r\n\t#include <skinbase_vertex>\r\n\r\n\t#ifdef USE_ENVMAP\r\n\r\n\t#include <beginnormal_vertex>\r\n\t#include <morphnormal_vertex>\r\n\t#include <skinnormal_vertex>\r\n\t#include <defaultnormal_vertex>\r\n\r\n\t#endif\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <project_vertex>\r\n\t#include <logdepthbuf_vertex>\r\n\r\n\t#include <worldpos_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\t#include <envmap_vertex>\r\n\t#include <fog_vertex>\r\n\r\n}\r\n";var Nn="uniform vec3 diffuse;\r\nuniform vec3 emissive;\r\nuniform float opacity;\r\n\r\nvarying vec3 vLightFront;\r\n\r\n#ifdef DOUBLE_SIDED\r\n\r\n\tvarying vec3 vLightBack;\r\n\r\n#endif\r\n\r\n#include <common>\r\n#include <packing>\r\n#include <dithering_pars_fragment>\r\n#include <color_pars_fragment>\r\n#include <uv_pars_fragment>\r\n#include <uv2_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <alphamap_pars_fragment>\r\n#include <aomap_pars_fragment>\r\n#include <lightmap_pars_fragment>\r\n#include <emissivemap_pars_fragment>\r\n#include <envmap_pars_fragment>\r\n#include <bsdfs>\r\n#include <lights_pars>\r\n#include <fog_pars_fragment>\r\n#include <shadowmap_pars_fragment>\r\n#include <shadowmask_pars_fragment>\r\n#include <specularmap_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\tvec4 diffuseColor = vec4( diffuse, opacity );\r\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\r\n\tvec3 totalEmissiveRadiance = emissive;\r\n\r\n\t#include <logdepthbuf_fragment>\r\n\t#include <map_fragment>\r\n\t#include <color_fragment>\r\n\t#include <alphamap_fragment>\r\n\t#include <alphatest_fragment>\r\n\t#include <specularmap_fragment>\r\n\t#include <emissivemap_fragment>\r\n\r\n\t// accumulation\r\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\r\n\r\n\t#include <lightmap_fragment>\r\n\r\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\r\n\r\n\t#ifdef DOUBLE_SIDED\r\n\r\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\r\n\r\n\t#else\r\n\r\n\t\treflectedLight.directDiffuse = vLightFront;\r\n\r\n\t#endif\r\n\r\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\r\n\r\n\t// modulation\r\n\t#include <aomap_fragment>\r\n\r\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\r\n\r\n\t#include <envmap_fragment>\r\n\r\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\r\n\r\n\t#include <tonemapping_fragment>\r\n\t#include <encodings_fragment>\r\n\t#include <fog_fragment>\r\n\t#include <premultiplied_alpha_fragment>\r\n\t#include <dithering_fragment>\r\n\r\n}\r\n";var Dn="#define LAMBERT\r\n\r\nvarying vec3 vLightFront;\r\n\r\n#ifdef DOUBLE_SIDED\r\n\r\n\tvarying vec3 vLightBack;\r\n\r\n#endif\r\n\r\n#include <common>\r\n#include <uv_pars_vertex>\r\n#include <uv2_pars_vertex>\r\n#include <envmap_pars_vertex>\r\n#include <bsdfs>\r\n#include <lights_pars>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <shadowmap_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <uv_vertex>\r\n\t#include <uv2_vertex>\r\n\t#include <color_vertex>\r\n\r\n\t#include <beginnormal_vertex>\r\n\t#include <morphnormal_vertex>\r\n\t#include <skinbase_vertex>\r\n\t#include <skinnormal_vertex>\r\n\t#include <defaultnormal_vertex>\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <project_vertex>\r\n\t#include <logdepthbuf_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\r\n\t#include <worldpos_vertex>\r\n\t#include <envmap_vertex>\r\n\t#include <lights_lambert_vertex>\r\n\t#include <shadowmap_vertex>\r\n\t#include <fog_vertex>\r\n\r\n}\r\n";var Cn="#define PHONG\r\n\r\nuniform vec3 diffuse;\r\nuniform vec3 emissive;\r\nuniform vec3 specular;\r\nuniform float shininess;\r\nuniform float opacity;\r\n\r\n#include <common>\r\n#include <packing>\r\n#include <dithering_pars_fragment>\r\n#include <color_pars_fragment>\r\n#include <uv_pars_fragment>\r\n#include <uv2_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <alphamap_pars_fragment>\r\n#include <aomap_pars_fragment>\r\n#include <lightmap_pars_fragment>\r\n#include <emissivemap_pars_fragment>\r\n#include <envmap_pars_fragment>\r\n#include <gradientmap_pars_fragment>\r\n#include <fog_pars_fragment>\r\n#include <bsdfs>\r\n#include <lights_pars>\r\n#include <lights_phong_pars_fragment>\r\n#include <shadowmap_pars_fragment>\r\n#include <bumpmap_pars_fragment>\r\n#include <normalmap_pars_fragment>\r\n#include <specularmap_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\tvec4 diffuseColor = vec4( diffuse, opacity );\r\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\r\n\tvec3 totalEmissiveRadiance = emissive;\r\n\r\n\t#include <logdepthbuf_fragment>\r\n\t#include <map_fragment>\r\n\t#include <color_fragment>\r\n\t#include <alphamap_fragment>\r\n\t#include <alphatest_fragment>\r\n\t#include <specularmap_fragment>\r\n\t#include <normal_fragment>\r\n\t#include <emissivemap_fragment>\r\n\r\n\t// accumulation\r\n\t#include <lights_phong_fragment>\r\n\t#include <lights_template>\r\n\r\n\t// modulation\r\n\t#include <aomap_fragment>\r\n\r\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\r\n\r\n\t#include <envmap_fragment>\r\n\r\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\r\n\r\n\t#include <tonemapping_fragment>\r\n\t#include <encodings_fragment>\r\n\t#include <fog_fragment>\r\n\t#include <premultiplied_alpha_fragment>\r\n\t#include <dithering_fragment>\r\n\r\n}\r\n";var Sn="#define PHONG\r\n\r\nvarying vec3 vViewPosition;\r\n\r\n#ifndef FLAT_SHADED\r\n\r\n\tvarying vec3 vNormal;\r\n\r\n#endif\r\n\r\n#include <common>\r\n#include <uv_pars_vertex>\r\n#include <uv2_pars_vertex>\r\n#include <displacementmap_pars_vertex>\r\n#include <envmap_pars_vertex>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <shadowmap_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <uv_vertex>\r\n\t#include <uv2_vertex>\r\n\t#include <color_vertex>\r\n\r\n\t#include <beginnormal_vertex>\r\n\t#include <morphnormal_vertex>\r\n\t#include <skinbase_vertex>\r\n\t#include <skinnormal_vertex>\r\n\t#include <defaultnormal_vertex>\r\n\r\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\r\n\r\n\tvNormal = normalize( transformedNormal );\r\n\r\n#endif\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <displacementmap_vertex>\r\n\t#include <project_vertex>\r\n\t#include <logdepthbuf_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\r\n\tvViewPosition = - mvPosition.xyz;\r\n\r\n\t#include <worldpos_vertex>\r\n\t#include <envmap_vertex>\r\n\t#include <shadowmap_vertex>\r\n\t#include <fog_vertex>\r\n\r\n}\r\n";var In="#define PHYSICAL\r\n\r\nuniform vec3 diffuse;\r\nuniform vec3 emissive;\r\nuniform float roughness;\r\nuniform float metalness;\r\nuniform float opacity;\r\n\r\n#ifndef STANDARD\r\n\tuniform float clearCoat;\r\n\tuniform float clearCoatRoughness;\r\n#endif\r\n\r\nvarying vec3 vViewPosition;\r\n\r\n#ifndef FLAT_SHADED\r\n\r\n\tvarying vec3 vNormal;\r\n\r\n#endif\r\n\r\n#include <common>\r\n#include <packing>\r\n#include <dithering_pars_fragment>\r\n#include <color_pars_fragment>\r\n#include <uv_pars_fragment>\r\n#include <uv2_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <alphamap_pars_fragment>\r\n#include <aomap_pars_fragment>\r\n#include <lightmap_pars_fragment>\r\n#include <emissivemap_pars_fragment>\r\n#include <envmap_pars_fragment>\r\n#include <fog_pars_fragment>\r\n#include <bsdfs>\r\n#include <cube_uv_reflection_fragment>\r\n#include <lights_pars>\r\n#include <lights_physical_pars_fragment>\r\n#include <shadowmap_pars_fragment>\r\n#include <bumpmap_pars_fragment>\r\n#include <normalmap_pars_fragment>\r\n#include <roughnessmap_pars_fragment>\r\n#include <metalnessmap_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\tvec4 diffuseColor = vec4( diffuse, opacity );\r\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\r\n\tvec3 totalEmissiveRadiance = emissive;\r\n\r\n\t#include <logdepthbuf_fragment>\r\n\t#include <map_fragment>\r\n\t#include <color_fragment>\r\n\t#include <alphamap_fragment>\r\n\t#include <alphatest_fragment>\r\n\t#include <roughnessmap_fragment>\r\n\t#include <metalnessmap_fragment>\r\n\t#include <normal_fragment>\r\n\t#include <emissivemap_fragment>\r\n\r\n\t// accumulation\r\n\t#include <lights_physical_fragment>\r\n\t#include <lights_template>\r\n\r\n\t// modulation\r\n\t#include <aomap_fragment>\r\n\r\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\r\n\r\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\r\n\r\n\t#include <tonemapping_fragment>\r\n\t#include <encodings_fragment>\r\n\t#include <fog_fragment>\r\n\t#include <premultiplied_alpha_fragment>\r\n\t#include <dithering_fragment>\r\n\r\n}\r\n";var _n="#define PHYSICAL\r\n\r\nvarying vec3 vViewPosition;\r\n\r\n#ifndef FLAT_SHADED\r\n\r\n\tvarying vec3 vNormal;\r\n\r\n#endif\r\n\r\n#include <common>\r\n#include <uv_pars_vertex>\r\n#include <uv2_pars_vertex>\r\n#include <displacementmap_pars_vertex>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <shadowmap_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <uv_vertex>\r\n\t#include <uv2_vertex>\r\n\t#include <color_vertex>\r\n\r\n\t#include <beginnormal_vertex>\r\n\t#include <morphnormal_vertex>\r\n\t#include <skinbase_vertex>\r\n\t#include <skinnormal_vertex>\r\n\t#include <defaultnormal_vertex>\r\n\r\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\r\n\r\n\tvNormal = normalize( transformedNormal );\r\n\r\n#endif\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <displacementmap_vertex>\r\n\t#include <project_vertex>\r\n\t#include <logdepthbuf_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\r\n\tvViewPosition = - mvPosition.xyz;\r\n\r\n\t#include <worldpos_vertex>\r\n\t#include <shadowmap_vertex>\r\n\t#include <fog_vertex>\r\n\r\n}\r\n";var On="#define NORMAL\r\n\r\nuniform float opacity;\r\n\r\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\n\tvarying vec3 vViewPosition;\r\n\r\n#endif\r\n\r\n#ifndef FLAT_SHADED\r\n\r\n\tvarying vec3 vNormal;\r\n\r\n#endif\r\n\r\n#include <packing>\r\n#include <uv_pars_fragment>\r\n#include <bumpmap_pars_fragment>\r\n#include <normalmap_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\t#include <logdepthbuf_fragment>\r\n\t#include <normal_fragment>\r\n\r\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\r\n\r\n}\r\n";var jn="#define NORMAL\r\n\r\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\n\tvarying vec3 vViewPosition;\r\n\r\n#endif\r\n\r\n#ifndef FLAT_SHADED\r\n\r\n\tvarying vec3 vNormal;\r\n\r\n#endif\r\n\r\n#include <uv_pars_vertex>\r\n#include <displacementmap_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <uv_vertex>\r\n\r\n\t#include <beginnormal_vertex>\r\n\t#include <morphnormal_vertex>\r\n\t#include <skinbase_vertex>\r\n\t#include <skinnormal_vertex>\r\n\t#include <defaultnormal_vertex>\r\n\r\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\r\n\r\n\tvNormal = normalize( transformedNormal );\r\n\r\n#endif\r\n\r\n\t#include <begin_vertex>\r\n\t#include <morphtarget_vertex>\r\n\t#include <skinning_vertex>\r\n\t#include <displacementmap_vertex>\r\n\t#include <project_vertex>\r\n\t#include <logdepthbuf_vertex>\r\n\r\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\n\tvViewPosition = - mvPosition.xyz;\r\n\r\n#endif\r\n\r\n}\r\n";var Rn="uniform vec3 diffuse;\r\nuniform float opacity;\r\n\r\n#include <common>\r\n#include <packing>\r\n#include <color_pars_fragment>\r\n#include <map_particle_pars_fragment>\r\n#include <fog_pars_fragment>\r\n#include <shadowmap_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\t#include <clipping_planes_fragment>\r\n\r\n\tvec3 outgoingLight = vec3( 0.0 );\r\n\tvec4 diffuseColor = vec4( diffuse, opacity );\r\n\r\n\t#include <logdepthbuf_fragment>\r\n\t#include <map_particle_fragment>\r\n\t#include <color_fragment>\r\n\t#include <alphatest_fragment>\r\n\r\n\toutgoingLight = diffuseColor.rgb;\r\n\r\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\r\n\r\n\t#include <premultiplied_alpha_fragment>\r\n\t#include <tonemapping_fragment>\r\n\t#include <encodings_fragment>\r\n\t#include <fog_fragment>\r\n\r\n}\r\n";var zn="uniform float size;\r\nuniform float scale;\r\n\r\n#include <common>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <shadowmap_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <color_vertex>\r\n\t#include <begin_vertex>\r\n\t#include <project_vertex>\r\n\r\n\t#ifdef USE_SIZEATTENUATION\r\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\r\n\t#else\r\n\t\tgl_PointSize = size;\r\n\t#endif\r\n\r\n\t#include <logdepthbuf_vertex>\r\n\t#include <clipping_planes_vertex>\r\n\t#include <worldpos_vertex>\r\n\t#include <shadowmap_vertex>\r\n\t#include <fog_vertex>\r\n\r\n}\r\n";var kn="uniform vec3 color;\r\nuniform float opacity;\r\n\r\n#include <common>\r\n#include <packing>\r\n#include <fog_pars_fragment>\r\n#include <bsdfs>\r\n#include <lights_pars>\r\n#include <shadowmap_pars_fragment>\r\n#include <shadowmask_pars_fragment>\r\n\r\nvoid main() {\r\n\r\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\r\n\r\n\t#include <fog_fragment>\r\n\r\n}\r\n";var Pn="#include <fog_pars_vertex>\r\n#include <shadowmap_pars_vertex>\r\n\r\nvoid main() {\r\n\r\n\t#include <begin_vertex>\r\n\t#include <project_vertex>\r\n\t#include <worldpos_vertex>\r\n\t#include <shadowmap_vertex>\r\n\t#include <fog_vertex>\r\n\r\n}\r\n";var Un={alphamap_fragment:kr,alphamap_pars_fragment:Pr,alphatest_fragment:Ur,aomap_fragment:Br,aomap_pars_fragment:Fr,begin_vertex:Gr,beginnormal_vertex:Hr,bsdfs:Vr,bumpmap_pars_fragment:Qr,clipping_planes_fragment:Yr,clipping_planes_pars_fragment:Wr,clipping_planes_pars_vertex:Xr,clipping_planes_vertex:qr,color_fragment:Zr,color_pars_fragment:Jr,color_pars_vertex:Kr,color_vertex:$r,common:ei,cube_uv_reflection_fragment:ti,defaultnormal_vertex:ri,displacementmap_pars_vertex:ii,displacementmap_vertex:ni,emissivemap_fragment:ai,emissivemap_pars_fragment:oi,encodings_fragment:si,encodings_pars_fragment:ui,envmap_fragment:ci,envmap_pars_fragment:li,envmap_pars_vertex:hi,envmap_vertex:di,fog_vertex:pi,fog_pars_vertex:fi,fog_fragment:vi,fog_pars_fragment:mi,gradientmap_pars_fragment:gi,lightmap_fragment:yi,lightmap_pars_fragment:Ai,lights_lambert_vertex:Mi,lights_pars:wi,lights_phong_fragment:Ei,lights_phong_pars_fragment:xi,lights_physical_fragment:bi,lights_physical_pars_fragment:Ti,lights_template:Li,logdepthbuf_fragment:Ni,logdepthbuf_pars_fragment:Di,logdepthbuf_pars_vertex:Ci,logdepthbuf_vertex:Si,map_fragment:Ii,map_pars_fragment:_i,map_particle_fragment:Oi,map_particle_pars_fragment:ji,metalnessmap_fragment:Ri,metalnessmap_pars_fragment:zi,morphnormal_vertex:ki,morphtarget_pars_vertex:Pi,morphtarget_vertex:Ui,normal_fragment:Bi,normalmap_pars_fragment:Fi,packing:Gi,premultiplied_alpha_fragment:Hi,project_vertex:Vi,dithering_fragment:Qi,dithering_pars_fragment:Yi,roughnessmap_fragment:Wi,roughnessmap_pars_fragment:Xi,shadowmap_pars_fragment:qi,shadowmap_pars_vertex:Zi,shadowmap_vertex:Ji,shadowmask_pars_fragment:Ki,skinbase_vertex:$i,skinning_pars_vertex:en,skinning_vertex:tn,skinnormal_vertex:rn,specularmap_fragment:nn,specularmap_pars_fragment:an,tonemapping_fragment:on,tonemapping_pars_fragment:sn,uv_pars_fragment:un,uv_pars_vertex:cn,uv_vertex:ln,uv2_pars_fragment:hn,uv2_pars_vertex:dn,uv2_vertex:pn,worldpos_vertex:fn,cube_frag:vn,cube_vert:mn,depth_frag:gn,depth_vert:yn,distanceRGBA_frag:An,distanceRGBA_vert:Mn,equirect_frag:wn,equirect_vert:En,linedashed_frag:xn,linedashed_vert:bn,meshbasic_frag:Tn,meshbasic_vert:Ln,meshlambert_frag:Nn,meshlambert_vert:Dn,meshphong_frag:Cn,meshphong_vert:Sn,meshphysical_frag:In,meshphysical_vert:_n,normal_frag:On,normal_vert:jn,points_frag:Rn,points_vert:zn,shadow_frag:kn,shadow_vert:Pn};var Bn={basic:{uniforms:zr.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.fog]),vertexShader:Un.meshbasic_vert,fragmentShader:Un.meshbasic_frag},lambert:{uniforms:zr.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.fog,Rr.lights,{emissive:{value:new jr(0)}}]),vertexShader:Un.meshlambert_vert,fragmentShader:Un.meshlambert_frag},phong:{uniforms:zr.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,Rr.gradientmap,Rr.fog,Rr.lights,{emissive:{value:new jr(0)},specular:{value:new jr(1118481)},shininess:{value:30}}]),vertexShader:Un.meshphong_vert,fragmentShader:Un.meshphong_frag},standard:{uniforms:zr.merge([Rr.common,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,Rr.roughnessmap,Rr.metalnessmap,Rr.fog,Rr.lights,{emissive:{value:new jr(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Un.meshphysical_vert,fragmentShader:Un.meshphysical_frag},points:{uniforms:zr.merge([Rr.points,Rr.fog]),vertexShader:Un.points_vert,fragmentShader:Un.points_frag},dashed:{uniforms:zr.merge([Rr.common,Rr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Un.linedashed_vert,fragmentShader:Un.linedashed_frag},depth:{uniforms:zr.merge([Rr.common,Rr.displacementmap]),vertexShader:Un.depth_vert,fragmentShader:Un.depth_frag},normal:{uniforms:zr.merge([Rr.common,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,{opacity:{value:1}}]),vertexShader:Un.normal_vert,fragmentShader:Un.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Un.cube_vert,fragmentShader:Un.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Un.equirect_vert,fragmentShader:Un.equirect_frag},distanceRGBA:{uniforms:zr.merge([Rr.common,Rr.displacementmap,{referencePosition:{value:new kt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Un.distanceRGBA_vert,fragmentShader:Un.distanceRGBA_frag},shadow:{uniforms:zr.merge([Rr.lights,Rr.fog,{color:{value:new jr(0)},opacity:{value:1}}]),vertexShader:Un.shadow_vert,fragmentShader:Un.shadow_frag}};Bn.physical={uniforms:zr.merge([Bn.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Un.meshphysical_vert,fragmentShader:Un.meshphysical_frag};function Fn(e,t,r,i,n,a,o,s,u){Bt.call(this,e,t,r,i,n,a,o,s,u);this.needsUpdate=true}Fn.prototype=Object.create(Bt.prototype);Fn.prototype.constructor=Fn;function Gn(e,t,r,i,n){var a,o;var s,u,c;var l;var h=new kt;var d=new zt;var p=new kt;function f(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]);var r=new Uint16Array([0,1,2,0,2,3]);a=t.createBuffer();o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a);t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o);t.bufferData(t.ELEMENT_ARRAY_BUFFER,r,t.STATIC_DRAW);s=v();u={position:t.getAttribLocation(s,"position"),uv:t.getAttribLocation(s,"uv")};c={uvOffset:t.getUniformLocation(s,"uvOffset"),uvScale:t.getUniformLocation(s,"uvScale"),rotation:t.getUniformLocation(s,"rotation"),center:t.getUniformLocation(s,"center"),scale:t.getUniformLocation(s,"scale"),color:t.getUniformLocation(s,"color"),map:t.getUniformLocation(s,"map"),opacity:t.getUniformLocation(s,"opacity"),modelViewMatrix:t.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:t.getUniformLocation(s,"projectionMatrix"),fogType:t.getUniformLocation(s,"fogType"),fogDensity:t.getUniformLocation(s,"fogDensity"),fogNear:t.getUniformLocation(s,"fogNear"),fogFar:t.getUniformLocation(s,"fogFar"),fogColor:t.getUniformLocation(s,"fogColor"),fogDepth:t.getUniformLocation(s,"fogDepth"),alphaTest:t.getUniformLocation(s,"alphaTest")};var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=8;i.height=8;var n=i.getContext("2d");n.fillStyle="white";n.fillRect(0,0,8,8);l=new Fn(i)}this.render=function(n,v,g){if(0===n.length)return;void 0===s&&f();r.useProgram(s);r.initAttributes();r.enableAttribute(u.position);r.enableAttribute(u.uv);r.disableUnusedAttributes();r.disable(t.CULL_FACE);r.enable(t.BLEND);t.bindBuffer(t.ARRAY_BUFFER,a);t.vertexAttribPointer(u.position,2,t.FLOAT,false,16,0);t.vertexAttribPointer(u.uv,2,t.FLOAT,false,16,8);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o);t.uniformMatrix4fv(c.projectionMatrix,false,g.projectionMatrix.elements);r.activeTexture(t.TEXTURE0);t.uniform1i(c.map,0);var y=0;var A=0;var M=v.fog;if(M){t.uniform3f(c.fogColor,M.color.r,M.color.g,M.color.b);if(M.isFog){t.uniform1f(c.fogNear,M.near);t.uniform1f(c.fogFar,M.far);t.uniform1i(c.fogType,1);y=1;A=1}else if(M.isFogExp2){t.uniform1f(c.fogDensity,M.density);t.uniform1i(c.fogType,2);y=2;A=2}}else{t.uniform1i(c.fogType,0);y=0;A=0}for(var w=0,E=n.length;w<E;w++){var x=n[w];x.modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,x.matrixWorld);x.z=-x.modelViewMatrix.elements[14]}n.sort(m);var b=[];var T=[];for(var w=0,E=n.length;w<E;w++){var x=n[w];var L=x.material;if(false===L.visible)continue;x.onBeforeRender(e,v,g,void 0,L,void 0);t.uniform1f(c.alphaTest,L.alphaTest);t.uniformMatrix4fv(c.modelViewMatrix,false,x.modelViewMatrix.elements);x.matrixWorld.decompose(h,d,p);b[0]=p.x;b[1]=p.y;T[0]=x.center.x-.5;T[1]=x.center.y-.5;var N=0;v.fog&&L.fog&&(N=A);if(y!==N){t.uniform1i(c.fogType,N);y=N}if(null!==L.map){t.uniform2f(c.uvOffset,L.map.offset.x,L.map.offset.y);t.uniform2f(c.uvScale,L.map.repeat.x,L.map.repeat.y)}else{t.uniform2f(c.uvOffset,0,0);t.uniform2f(c.uvScale,1,1)}t.uniform1f(c.opacity,L.opacity);t.uniform3f(c.color,L.color.r,L.color.g,L.color.b);t.uniform1f(c.rotation,L.rotation);t.uniform2fv(c.center,T);t.uniform2fv(c.scale,b);r.setBlending(L.blending,L.blendEquation,L.blendSrc,L.blendDst,L.blendEquationAlpha,L.blendSrcAlpha,L.blendDstAlpha,L.premultipliedAlpha);r.buffers.depth.setTest(L.depthTest);r.buffers.depth.setMask(L.depthWrite);r.buffers.color.setMask(L.colorWrite);i.setTexture2D(L.map||l,0);t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0);x.onAfterRender(e,v,g,void 0,L,void 0)}r.enable(t.CULL_FACE);r.reset()};function v(){var e=t.createProgram();var r=t.createShader(t.VERTEX_SHADER);var i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,["precision "+n.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n"));t.shaderSource(i,["precision "+n.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n"));t.compileShader(r);t.compileShader(i);t.attachShader(e,r);t.attachShader(e,i);t.linkProgram(e);return e}function m(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}}var Hn=0;function Vn(){Object.defineProperty(this,"id",{value:Hn++});this.uuid=Ot.generateUUID();this.name="";this.type="Material";this.fog=true;this.lights=true;this.blending=E;this.side=p;this.flatShading=false;this.vertexColors=y;this.opacity=1;this.transparent=false;this.blendSrc=z;this.blendDst=k;this.blendEquation=N;this.blendSrcAlpha=null;this.blendDstAlpha=null;this.blendEquationAlpha=null;this.depthFunc=Y;this.depthTest=true;this.depthWrite=true;this.clippingPlanes=null;this.clipIntersection=false;this.clipShadows=false;this.shadowSide=null;this.colorWrite=true;this.precision=null;this.polygonOffset=false;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.dithering=false;this.alphaTest=0;this.premultipliedAlpha=false;this.overdraw=0;this.visible=true;this.userData={};this.needsUpdate=true}Vn.prototype=Object.assign(Object.create(t.prototype),{constructor:Vn,isMaterial:true,onBeforeCompile:function(){},setValues:function(e){if(void 0===e)return;for(var t in e){var r=e[t];if(void 0===r){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=r===m;continue}var i=this[t];if(void 0===i){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]="overdraw"===t?Number(r):r}},toJSON:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid;r.type=this.type;""!==this.name&&(r.name=this.name);this.color&&this.color.isColor&&(r.color=this.color.getHex());void 0!==this.roughness&&(r.roughness=this.roughness);void 0!==this.metalness&&(r.metalness=this.metalness);this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex());1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex());void 0!==this.shininess&&(r.shininess=this.shininess);void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat);void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness);this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid);this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid);this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid);if(this.bumpMap&&this.bumpMap.isTexture){r.bumpMap=this.bumpMap.toJSON(e).uuid;r.bumpScale=this.bumpScale}if(this.normalMap&&this.normalMap.isTexture){r.normalMap=this.normalMap.toJSON(e).uuid;r.normalScale=this.normalScale.toArray()}if(this.displacementMap&&this.displacementMap.isTexture){r.displacementMap=this.displacementMap.toJSON(e).uuid;r.displacementScale=this.displacementScale;r.displacementBias=this.displacementBias}this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid);this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid);this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid);if(this.envMap&&this.envMap.isTexture){r.envMap=this.envMap.toJSON(e).uuid;r.reflectivity=this.reflectivity}this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid);void 0!==this.size&&(r.size=this.size);void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation);this.blending!==E&&(r.blending=this.blending);true===this.flatShading&&(r.flatShading=this.flatShading);this.side!==p&&(r.side=this.side);this.vertexColors!==y&&(r.vertexColors=this.vertexColors);this.opacity<1&&(r.opacity=this.opacity);true===this.transparent&&(r.transparent=this.transparent);r.depthFunc=this.depthFunc;r.depthTest=this.depthTest;r.depthWrite=this.depthWrite;0!==this.rotation&&(r.rotation=this.rotation);1!==this.linewidth&&(r.linewidth=this.linewidth);void 0!==this.dashSize&&(r.dashSize=this.dashSize);void 0!==this.gapSize&&(r.gapSize=this.gapSize);void 0!==this.scale&&(r.scale=this.scale);true===this.dithering&&(r.dithering=true);this.alphaTest>0&&(r.alphaTest=this.alphaTest);true===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha);true===this.wireframe&&(r.wireframe=this.wireframe);this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth);"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin);true===this.morphTargets&&(r.morphTargets=true);true===this.skinning&&(r.skinning=true);false===this.visible&&(r.visible=false);"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData);function i(e){var t=[];for(var r in e){var i=e[r];delete i.metadata;t.push(i)}return t}if(t){var n=i(e.textures);var a=i(e.images);n.length>0&&(r.textures=n);a.length>0&&(r.images=a)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name;this.fog=e.fog;this.lights=e.lights;this.blending=e.blending;this.side=e.side;this.flatShading=e.flatShading;this.vertexColors=e.vertexColors;this.opacity=e.opacity;this.transparent=e.transparent;this.blendSrc=e.blendSrc;this.blendDst=e.blendDst;this.blendEquation=e.blendEquation;this.blendSrcAlpha=e.blendSrcAlpha;this.blendDstAlpha=e.blendDstAlpha;this.blendEquationAlpha=e.blendEquationAlpha;this.depthFunc=e.depthFunc;this.depthTest=e.depthTest;this.depthWrite=e.depthWrite;this.colorWrite=e.colorWrite;this.precision=e.precision;this.polygonOffset=e.polygonOffset;this.polygonOffsetFactor=e.polygonOffsetFactor;this.polygonOffsetUnits=e.polygonOffsetUnits;this.dithering=e.dithering;this.alphaTest=e.alphaTest;this.premultipliedAlpha=e.premultipliedAlpha;this.overdraw=e.overdraw;this.visible=e.visible;this.userData=JSON.parse(JSON.stringify(e.userData));this.clipShadows=e.clipShadows;this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,r=null;if(null!==t){var i=t.length;r=new Array(i);for(var n=0;n!==i;++n)r[n]=t[n].clone()}this.clippingPlanes=r;this.shadowSide=e.shadowSide;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Qn(e){Vn.call(this);this.type="MeshDepthMaterial";this.depthPacking=It;this.skinning=false;this.morphTargets=false;this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.setValues(e)}Qn.prototype=Object.create(Vn.prototype);Qn.prototype.constructor=Qn;Qn.prototype.isMeshDepthMaterial=true;Qn.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.depthPacking=e.depthPacking;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.map=e.map;this.alphaMap=e.alphaMap;this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;return this};function Yn(e){Vn.call(this);this.type="MeshDistanceMaterial";this.referencePosition=new kt;this.nearDistance=1;this.farDistance=1e3;this.skinning=false;this.morphTargets=false;this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.fog=false;this.lights=false;this.setValues(e)}Yn.prototype=Object.create(Vn.prototype);Yn.prototype.constructor=Yn;Yn.prototype.isMeshDistanceMaterial=true;Yn.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.referencePosition.copy(e.referencePosition);this.nearDistance=e.nearDistance;this.farDistance=e.farDistance;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.map=e.map;this.alphaMap=e.alphaMap;this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;return this};function Wn(e,t){this.min=void 0!==e?e:new kt(Infinity,Infinity,Infinity);this.max=void 0!==t?t:new kt(-Infinity,-Infinity,-Infinity)}Object.assign(Wn.prototype,{isBox3:true,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromArray:function(e){var t=Infinity;var r=Infinity;var i=Infinity;var n=-Infinity;var a=-Infinity;var o=-Infinity;for(var s=0,u=e.length;s<u;s+=3){var c=e[s];var l=e[s+1];var h=e[s+2];c<t&&(t=c);l<r&&(r=l);h<i&&(i=h);c>n&&(n=c);l>a&&(a=l);h>o&&(o=h)}this.min.set(t,r,i);this.max.set(n,a,o);return this},setFromBufferAttribute:function(e){var t=Infinity;var r=Infinity;var i=Infinity;var n=-Infinity;var a=-Infinity;var o=-Infinity;for(var s=0,u=e.count;s<u;s++){var c=e.getX(s);var l=e.getY(s);var h=e.getZ(s);c<t&&(t=c);l<r&&(r=l);h<i&&(i=h);c>n&&(n=c);l>a&&(a=l);h>o&&(o=h)}this.min.set(t,r,i);this.max.set(n,a,o);return this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new kt;return function t(r,i){var n=e.copy(i).multiplyScalar(.5);this.min.copy(r).sub(n);this.max.copy(r).add(n);return this}}(),setFromObject:function(e){this.makeEmpty();return this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){var t=e||new kt;return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new kt;return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},expandByObject:function(){var e,t,r;var i=new kt;function n(n){var a=n.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(t=0,r=o.length;t<r;t++){i.copy(o[t]);i.applyMatrix4(n.matrixWorld);e.expandByPoint(i)}}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(t=0,r=s.count;t<r;t++){i.fromBufferAttribute(s,t).applyMatrix4(n.matrixWorld);e.expandByPoint(i)}}}return function t(r){e=this;r.updateMatrixWorld(true);r.traverse(n);return this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){var r=t||new kt;return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new kt;return function t(r){this.clampPoint(r.center,e);return e.distanceToSquared(r.center)<=r.radius*r.radius}}(),intersectsPlane:function(e){var t,r;if(e.normal.x>0){t=e.normal.x*this.min.x;r=e.normal.x*this.max.x}else{t=e.normal.x*this.max.x;r=e.normal.x*this.min.x}if(e.normal.y>0){t+=e.normal.y*this.min.y;r+=e.normal.y*this.max.y}else{t+=e.normal.y*this.max.y;r+=e.normal.y*this.min.y}if(e.normal.z>0){t+=e.normal.z*this.min.z;r+=e.normal.z*this.max.z}else{t+=e.normal.z*this.max.z;r+=e.normal.z*this.min.z}return t<=e.constant&&r>=e.constant},intersectsTriangle:function(){var e=new kt;var t=new kt;var r=new kt;var i=new kt;var n=new kt;var a=new kt;var o=new kt;var s=new kt;var u=new kt;var c=new kt;function l(i){var n,a;for(n=0,a=i.length-3;n<=a;n+=3){o.fromArray(i,n);var s=u.x*Math.abs(o.x)+u.y*Math.abs(o.y)+u.z*Math.abs(o.z);var c=e.dot(o);var l=t.dot(o);var h=r.dot(o);if(Math.max(-Math.max(c,l,h),Math.min(c,l,h))>s)return false}return true}return function o(h){if(this.isEmpty())return false;this.getCenter(s);u.subVectors(this.max,s);e.subVectors(h.a,s);t.subVectors(h.b,s);r.subVectors(h.c,s);i.subVectors(t,e);n.subVectors(r,t);a.subVectors(e,r);var d=[0,-i.z,i.y,0,-n.z,n.y,0,-a.z,a.y,i.z,0,-i.x,n.z,0,-n.x,a.z,0,-a.x,-i.y,i.x,0,-n.y,n.x,0,-a.y,a.x,0];if(!l(d))return false;d=[1,0,0,0,1,0,0,0,1];if(!l(d))return false;c.crossVectors(i,n);d=[c.x,c.y,c.z];return l(d)}}(),clampPoint:function(e,t){var r=t||new kt;return r.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new kt;return function t(r){var i=e.copy(r).clamp(this.min,this.max);return i.sub(r).length()}}(),getBoundingSphere:function(){var e=new kt;return function t(r){var i=r||new Xn;this.getCenter(i.center);i.radius=.5*this.getSize(e).length();return i}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);this.isEmpty()&&this.makeEmpty();return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},applyMatrix4:function(){var e=[new kt,new kt,new kt,new kt,new kt,new kt,new kt,new kt];return function t(r){if(this.isEmpty())return this;e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r);e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r);e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r);e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r);e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r);e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r);e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r);e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r);this.setFromPoints(e);return this}}(),translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});function Xn(e,t){this.center=void 0!==e?e:new kt;this.radius=void 0!==t?t:0}Object.assign(Xn.prototype,{set:function(e,t){this.center.copy(e);this.radius=t;return this},setFromPoints:function(){var e=new Wn;return function t(r,i){var n=this.center;void 0!==i?n.copy(i):e.setFromPoints(r).getCenter(n);var a=0;for(var o=0,s=r.length;o<s;o++)a=Math.max(a,n.distanceToSquared(r[o]));this.radius=Math.sqrt(a);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.center.copy(e.center);this.radius=e.radius;return this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e);var i=t||new kt;i.copy(e);if(r>this.radius*this.radius){i.sub(this.center).normalize();i.multiplyScalar(this.radius).add(this.center)}return i},getBoundingBox:function(e){var t=e||new Wn;t.set(this.center,this.center);t.expandByScalar(this.radius);return t},applyMatrix4:function(e){this.center.applyMatrix4(e);this.radius=this.radius*e.getMaxScaleOnAxis();return this},translate:function(e){this.center.add(e);return this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});function qn(e,t){this.normal=void 0!==e?e:new kt(1,0,0);this.constant=void 0!==t?t:0}Object.assign(qn.prototype,{set:function(e,t){this.normal.copy(e);this.constant=t;return this},setComponents:function(e,t,r,i){this.normal.set(e,t,r);this.constant=i;return this},setFromNormalAndCoplanarPoint:function(e,t){this.normal.copy(e);this.constant=-t.dot(this.normal);return this},setFromCoplanarPoints:function(){var e=new kt;var t=new kt;return function r(i,n,a){var o=e.subVectors(a,n).cross(t.subVectors(i,n)).normalize();this.setFromNormalAndCoplanarPoint(o,i);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.normal.copy(e.normal);this.constant=e.constant;return this},normalize:function(){var e=1/this.normal.length();this.normal.multiplyScalar(e);this.constant*=e;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){var r=t||new kt;return r.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new kt;return function t(r,i){var n=i||new kt;var a=r.delta(e);var o=this.normal.dot(a);if(0===o){if(0===this.distanceToPoint(r.start))return n.copy(r.start);return}var s=-(r.start.dot(this.normal)+this.constant)/o;if(s<0||s>1)return;return n.copy(a).multiplyScalar(s).add(r.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start);var r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){var t=e||new kt;return t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new kt;var t=new Pt;return function r(i,n){var a=n||t.getNormalMatrix(i);var o=this.coplanarPoint(e).applyMatrix4(i);var s=this.normal.applyMatrix3(a).normalize();this.constant=-o.dot(s);return this}}(),translate:function(e){this.constant-=e.dot(this.normal);return this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});function Zn(e,t,r,i,n,a){this.planes=[void 0!==e?e:new qn,void 0!==t?t:new qn,void 0!==r?r:new qn,void 0!==i?i:new qn,void 0!==n?n:new qn,void 0!==a?a:new qn]}Object.assign(Zn.prototype,{set:function(e,t,r,i,n,a){var o=this.planes;o[0].copy(e);o[1].copy(t);o[2].copy(r);o[3].copy(i);o[4].copy(n);o[5].copy(a);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){var t=this.planes;for(var r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes;var r=e.elements;var i=r[0],n=r[1],a=r[2],o=r[3];var s=r[4],u=r[5],c=r[6],l=r[7];var h=r[8],d=r[9],p=r[10],f=r[11];var v=r[12],m=r[13],g=r[14],y=r[15];t[0].setComponents(o-i,l-s,f-h,y-v).normalize();t[1].setComponents(o+i,l+s,f+h,y+v).normalize();t[2].setComponents(o+n,l+u,f+d,y+m).normalize();t[3].setComponents(o-n,l-u,f-d,y-m).normalize();t[4].setComponents(o-a,l-c,f-p,y-g).normalize();t[5].setComponents(o+a,l+c,f+p,y+g).normalize();return this},intersectsObject:function(){var e=new Xn;return function t(r){var i=r.geometry;null===i.boundingSphere&&i.computeBoundingSphere();e.copy(i.boundingSphere).applyMatrix4(r.matrixWorld);return this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new Xn;return function t(r){e.center.set(0,0,0);e.radius=.7071067811865476;e.applyMatrix4(r.matrixWorld);return this.intersectsSphere(e)}}(),intersectsSphere:function(e){var t=this.planes;var r=e.center;var i=-e.radius;for(var n=0;n<6;n++){var a=t[n].distanceToPoint(r);if(a<i)return false}return true},intersectsBox:function(){var e=new kt,t=new kt;return function r(i){var n=this.planes;for(var a=0;a<6;a++){var o=n[a];e.x=o.normal.x>0?i.min.x:i.max.x;t.x=o.normal.x>0?i.max.x:i.min.x;e.y=o.normal.y>0?i.min.y:i.max.y;t.y=o.normal.y>0?i.max.y:i.min.y;e.z=o.normal.z>0?i.min.z:i.max.z;t.z=o.normal.z>0?i.max.z:i.min.z;var s=o.distanceToPoint(e);var u=o.distanceToPoint(t);if(s<0&&u<0)return false}return true}}(),containsPoint:function(e){var t=this.planes;for(var r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return false;return true}});function Jn(e,t,r){var i=new Zn,n=new Rt,a=new jt,o=new jt(r,r),s=new kt,u=new kt,c=1,l=2,d=1+(c|l),m=new Array(d),g=new Array(d),y={};var A={0:f,1:p,2:v};var M=[new kt(1,0,0),new kt(-1,0,0),new kt(0,0,1),new kt(0,0,-1),new kt(0,1,0),new kt(0,-1,0)];var w=[new kt(0,1,0),new kt(0,1,0),new kt(0,1,0),new kt(0,1,0),new kt(0,0,1),new kt(0,0,-1)];var E=[new Ft,new Ft,new Ft,new Ft,new Ft,new Ft];for(var x=0;x!==d;++x){var b=0!==(x&c);var T=0!==(x&l);var L=new Qn({depthPacking:_t,morphTargets:b,skinning:T});m[x]=L;var N=new Yn({morphTargets:b,skinning:T});g[x]=N}var D=this;this.enabled=false;this.autoUpdate=true;this.needsUpdate=false;this.type=h;this.render=function(t,r,c){if(false===D.enabled)return;if(false===D.autoUpdate&&false===D.needsUpdate)return;if(0===t.length)return;var l=e.context;var h=e.state;h.disable(l.BLEND);h.buffers.color.setClear(1,1,1,1);h.buffers.depth.setTest(true);h.setScissorTest(false);var d;for(var p=0,f=t.length;p<f;p++){var v=t[p];var m=v.shadow;var g=v&&v.isPointLight;if(void 0===m){console.warn("THREE.WebGLShadowMap:",v,"has no shadow.");continue}var y=m.camera;a.copy(m.mapSize);a.min(o);if(g){var A=a.x;var x=a.y;E[0].set(2*A,x,A,x);E[1].set(0,x,A,x);E[2].set(3*A,x,A,x);E[3].set(A,x,A,x);E[4].set(3*A,0,A,x);E[5].set(A,0,A,x);a.x*=4;a.y*=2}if(null===m.map){var b={minFilter:me,magFilter:me,format:ze};m.map=new Gt(a.x,a.y,b);m.map.texture.name=v.name+".shadowMap";y.updateProjectionMatrix()}m.isSpotLightShadow&&m.update(v);var T=m.map;var L=m.matrix;u.setFromMatrixPosition(v.matrixWorld);y.position.copy(u);if(g){d=6;L.makeTranslation(-u.x,-u.y,-u.z)}else{d=1;s.setFromMatrixPosition(v.target.matrixWorld);y.lookAt(s);y.updateMatrixWorld();L.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);L.multiply(y.projectionMatrix);L.multiply(y.matrixWorldInverse)}e.setRenderTarget(T);e.clear();for(var N=0;N<d;N++){if(g){s.copy(y.position);s.add(M[N]);y.up.copy(w[N]);y.lookAt(s);y.updateMatrixWorld();var C=E[N];h.viewport(C)}n.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse);i.setFromMatrix(n);S(r,c,y,g)}}D.needsUpdate=false};function C(t,r,i,n,a,o){var s=t.geometry;var u=null;var h=m;var d=t.customDepthMaterial;if(i){h=g;d=t.customDistanceMaterial}if(d)u=d;else{var p=false;r.morphTargets&&(s&&s.isBufferGeometry?p=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(p=s.morphTargets&&s.morphTargets.length>0));t.isSkinnedMesh&&false===r.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var f=t.isSkinnedMesh&&r.skinning;var v=0;p&&(v|=c);f&&(v|=l);u=h[v]}if(e.localClippingEnabled&&true===r.clipShadows&&0!==r.clippingPlanes.length){var M=u.uuid,w=r.uuid;var E=y[M];if(void 0===E){E={};y[M]=E}var x=E[w];if(void 0===x){x=u.clone();E[w]=x}u=x}u.visible=r.visible;u.wireframe=r.wireframe;u.side=null!=r.shadowSide?r.shadowSide:A[r.side];u.clipShadows=r.clipShadows;u.clippingPlanes=r.clippingPlanes;u.clipIntersection=r.clipIntersection;u.wireframeLinewidth=r.wireframeLinewidth;u.linewidth=r.linewidth;if(i&&u.isMeshDistanceMaterial){u.referencePosition.copy(n);u.nearDistance=a;u.farDistance=o}return u}function S(r,n,a,o){if(false===r.visible)return;var s=r.layers.test(n.layers);if(s&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||i.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,r.matrixWorld);var c=t.update(r);var l=r.material;if(Array.isArray(l)){var h=c.groups;for(var d=0,p=h.length;d<p;d++){var f=h[d];var v=l[f.materialIndex];if(v&&v.visible){var m=C(r,v,o,u,a.near,a.far);e.renderBufferDirect(a,null,c,m,r,f)}}}else if(l.visible){var m=C(r,l,o,u,a.near,a.far);e.renderBufferDirect(a,null,c,m,r,null)}}var g=r.children;for(var y=0,A=g.length;y<A;y++)S(g[y],n,a,o)}}function Kn(e){var t={};function r(t,r){var i=t.array;var n=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW;var a=e.createBuffer();e.bindBuffer(r,a);e.bufferData(r,i,n);t.onUploadCallback();var o=e.FLOAT;i instanceof Float32Array?o=e.FLOAT:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?o=e.UNSIGNED_SHORT:i instanceof Int16Array?o=e.SHORT:i instanceof Uint32Array?o=e.UNSIGNED_INT:i instanceof Int32Array?o=e.INT:i instanceof Int8Array?o=e.BYTE:i instanceof Uint8Array&&(o=e.UNSIGNED_BYTE);return{buffer:a,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}function i(t,r,i){var n=r.array;var a=r.updateRange;e.bindBuffer(i,t);if(false===r.dynamic)e.bufferData(i,n,e.STATIC_DRAW);else if(-1===a.count)e.bufferSubData(i,0,n);else if(0===a.count)console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.");else{e.bufferSubData(i,a.offset*n.BYTES_PER_ELEMENT,n.subarray(a.offset,a.offset+a.count));a.count=-1}}function n(e){e.isInterleavedBufferAttribute&&(e=e.data);return t[e.uuid]}function a(r){r.isInterleavedBufferAttribute&&(r=r.data);var i=t[r.uuid];if(i){e.deleteBuffer(i.buffer);delete t[r.uuid]}}function o(e,n){e.isInterleavedBufferAttribute&&(e=e.data);var a=t[e.uuid];if(void 0===a)t[e.uuid]=r(e,n);else if(a.version<e.version){i(a.buffer,e,n);a.version=e.version}}return{get:n,remove:a,update:o}}function $n(e,t,r,i){this._x=e||0;this._y=t||0;this._z=r||0;this._order=i||$n.DefaultOrder}$n.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];$n.DefaultOrder="XYZ";Object.defineProperties($n.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e;this.onChangeCallback()}}});Object.assign($n.prototype,{isEuler:true,set:function(e,t,r,i){this._x=e;this._y=t;this._z=r;this._order=i||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){this._x=e._x;this._y=e._y;this._z=e._z;this._order=e._order;this.onChangeCallback();return this},setFromRotationMatrix:function(e,t,r){var i=Ot.clamp;var n=e.elements;var a=n[0],o=n[4],s=n[8];var u=n[1],c=n[5],l=n[9];var h=n[2],d=n[6],p=n[10];t=t||this._order;if("XYZ"===t){this._y=Math.asin(i(s,-1,1));if(Math.abs(s)<.99999){this._x=Math.atan2(-l,p);this._z=Math.atan2(-o,a)}else{this._x=Math.atan2(d,c);this._z=0}}else if("YXZ"===t){this._x=Math.asin(-i(l,-1,1));if(Math.abs(l)<.99999){this._y=Math.atan2(s,p);this._z=Math.atan2(u,c)}else{this._y=Math.atan2(-h,a);this._z=0}}else if("ZXY"===t){this._x=Math.asin(i(d,-1,1));if(Math.abs(d)<.99999){this._y=Math.atan2(-h,p);this._z=Math.atan2(-o,c)}else{this._y=0;this._z=Math.atan2(u,a)}}else if("ZYX"===t){this._y=Math.asin(-i(h,-1,1));if(Math.abs(h)<.99999){this._x=Math.atan2(d,p);this._z=Math.atan2(u,a)}else{this._x=0;this._z=Math.atan2(-o,c)}}else if("YZX"===t){this._z=Math.asin(i(u,-1,1));if(Math.abs(u)<.99999){this._x=Math.atan2(-l,c);this._y=Math.atan2(-h,a)}else{this._x=0;this._y=Math.atan2(s,p)}}else if("XZY"===t){this._z=Math.asin(-i(o,-1,1));if(Math.abs(o)<.99999){this._x=Math.atan2(d,c);this._y=Math.atan2(s,a)}else{this._x=Math.atan2(-l,p);this._y=0}}else console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t);this._order=t;false!==r&&this.onChangeCallback();return this},setFromQuaternion:function(){var e=new Rt;return function t(r,i,n){e.makeRotationFromQuaternion(r);return this.setFromRotationMatrix(e,i,n)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new zt;return function t(r){e.setFromEuler(this);return this.setFromQuaternion(e,r)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){this._x=e[0];this._y=e[1];this._z=e[2];void 0!==e[3]&&(this._order=e[3]);this.onChangeCallback();return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._order;return e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new kt(this._x,this._y,this._z)},onChange:function(e){this.onChangeCallback=e;return this},onChangeCallback:function(){}});function ea(){this.mask=1}Object.assign(ea.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!==(this.mask&e.mask)}});var ta=0;function ra(){Object.defineProperty(this,"id",{value:ta++});this.uuid=Ot.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=ra.DefaultUp.clone();var e=new kt;var t=new $n;var r=new zt;var i=new kt(1,1,1);function n(){r.setFromEuler(t,false)}function a(){t.setFromQuaternion(r,void 0,false)}t.onChange(n);r.onChange(a);Object.defineProperties(this,{position:{enumerable:true,value:e},rotation:{enumerable:true,value:t},quaternion:{enumerable:true,value:r},scale:{enumerable:true,value:i},modelViewMatrix:{value:new Rt},normalMatrix:{value:new Pt}});this.matrix=new Rt;this.matrixWorld=new Rt;this.matrixAutoUpdate=ra.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=false;this.layers=new ea;this.visible=true;this.castShadow=false;this.receiveShadow=false;this.frustumCulled=true;this.renderOrder=0;this.userData={}}ra.DefaultUp=new kt(0,1,0);ra.DefaultMatrixAutoUpdate=true;ra.prototype=Object.assign(Object.create(t.prototype),{constructor:ra,isObject3D:true,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){this.quaternion.premultiply(e);return this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,true)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new zt;return function t(r,i){e.setFromAxisAngle(r,i);this.quaternion.multiply(e);return this}}(),rotateOnWorldAxis:function(){var e=new zt;return function t(r,i){e.setFromAxisAngle(r,i);this.quaternion.premultiply(e);return this}}(),rotateX:function(){var e=new kt(1,0,0);return function t(r){return this.rotateOnAxis(e,r)}}(),rotateY:function(){var e=new kt(0,1,0);return function t(r){return this.rotateOnAxis(e,r)}}(),rotateZ:function(){var e=new kt(0,0,1);return function t(r){return this.rotateOnAxis(e,r)}}(),translateOnAxis:function(){var e=new kt;return function t(r,i){e.copy(r).applyQuaternion(this.quaternion);this.position.add(e.multiplyScalar(i));return this}}(),translateX:function(){var e=new kt(1,0,0);return function t(r){return this.translateOnAxis(e,r)}}(),translateY:function(){var e=new kt(0,1,0);return function t(r){return this.translateOnAxis(e,r)}}(),translateZ:function(){var e=new kt(0,0,1);return function t(r){return this.translateOnAxis(e,r)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new Rt;return function t(r){return r.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new Rt;var t=new kt;return function r(i,n,a){i.isVector3?t.copy(i):t.set(i,n,a);this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up);this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}if(e===this){console.error("THREE.Object3D.add: object can't be added as a child of itself.",e);return this}if(e&&e.isObject3D){null!==e.parent&&e.parent.remove(e);e.parent=this;e.dispatchEvent({type:"added"});this.children.push(e)}else console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e);return this},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var r=this.children.indexOf(e);if(-1!==r){e.parent=null;e.dispatchEvent({type:"removed"});this.children.splice(r,1)}return this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,i=this.children.length;r<i;r++){var n=this.children[r];var a=n.getObjectByProperty(e,t);if(void 0!==a)return a}return},getWorldPosition:function(e){var t=e||new kt;this.updateMatrixWorld(true);return t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new kt;var t=new kt;return function r(i){var n=i||new zt;this.updateMatrixWorld(true);this.matrixWorld.decompose(e,n,t);return n}}(),getWorldRotation:function(){var e=new zt;return function t(r){var i=r||new $n;this.getWorldQuaternion(e);return i.setFromQuaternion(e,this.rotation.order,false)}}(),getWorldScale:function(){var e=new kt;var t=new zt;return function r(i){var n=i||new kt;this.updateMatrixWorld(true);this.matrixWorld.decompose(e,t,n);return n}}(),getWorldDirection:function(){var e=new zt;return function t(r){var i=r||new kt;this.getWorldQuaternion(e);return i.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);var t=this.children;for(var r=0,i=t.length;r<i;r++)t[r].traverse(e)},traverseVisible:function(e){if(false===this.visible)return;e(this);var t=this.children;for(var r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)},traverseAncestors:function(e){var t=this.parent;if(null!==t){e(t);t.traverseAncestors(e)}},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e){null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);this.matrixWorldNeedsUpdate=false;e=true}var t=this.children;for(var r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)},toJSON:function(e){var t=void 0===e||"string"===typeof e;var r={};if(t){e={geometries:{},materials:{},textures:{},images:{},shapes:{}};r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"}}var i={};i.uuid=this.uuid;i.type=this.type;""!==this.name&&(i.name=this.name);true===this.castShadow&&(i.castShadow=true);true===this.receiveShadow&&(i.receiveShadow=true);false===this.visible&&(i.visible=false);"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData);i.matrix=this.matrix.toArray();function n(t,r){void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e));return r.uuid}if(void 0!==this.geometry){i.geometry=n(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var c=o[s];n(e.shapes,c)}else n(e.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(var s=0,u=this.material.length;s<u;s++)l.push(n(e.materials,this.material[s]));i.material=l}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(var s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(e).object)}if(t){var h=v(e.geometries);var d=v(e.materials);var p=v(e.textures);var f=v(e.images);var o=v(e.shapes);h.length>0&&(r.geometries=h);d.length>0&&(r.materials=d);p.length>0&&(r.textures=p);f.length>0&&(r.images=f);o.length>0&&(r.shapes=o)}r.object=i;return r;function v(e){var t=[];for(var r in e){var i=e[r];delete i.metadata;t.push(i)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){void 0===t&&(t=true);this.name=e.name;this.up.copy(e.up);this.position.copy(e.position);this.quaternion.copy(e.quaternion);this.scale.copy(e.scale);this.matrix.copy(e.matrix);this.matrixWorld.copy(e.matrixWorld);this.matrixAutoUpdate=e.matrixAutoUpdate;this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate;this.layers.mask=e.layers.mask;this.visible=e.visible;this.castShadow=e.castShadow;this.receiveShadow=e.receiveShadow;this.frustumCulled=e.frustumCulled;this.renderOrder=e.renderOrder;this.userData=JSON.parse(JSON.stringify(e.userData));if(true===t)for(var r=0;r<e.children.length;r++){var i=e.children[r];this.add(i.clone())}return this}});function ia(){ra.call(this);this.type="Camera";this.matrixWorldInverse=new Rt;this.projectionMatrix=new Rt}ia.prototype=Object.assign(Object.create(ra.prototype),{constructor:ia,isCamera:true,copy:function(e,t){ra.prototype.copy.call(this,e,t);this.matrixWorldInverse.copy(e.matrixWorldInverse);this.projectionMatrix.copy(e.projectionMatrix);return this},getWorldDirection:function(){var e=new zt;return function t(r){var i=r||new kt;this.getWorldQuaternion(e);return i.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){ra.prototype.updateMatrixWorld.call(this,e);this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}});function na(e,t,r,i,n,a){ia.call(this);this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=e;this.right=t;this.top=r;this.bottom=i;this.near=void 0!==n?n:.1;this.far=void 0!==a?a:2e3;this.updateProjectionMatrix()}na.prototype=Object.assign(Object.create(ia.prototype),{constructor:na,isOrthographicCamera:true,copy:function(e,t){ia.prototype.copy.call(this,e,t);this.left=e.left;this.right=e.right;this.top=e.top;this.bottom=e.bottom;this.near=e.near;this.far=e.far;this.zoom=e.zoom;this.view=null===e.view?null:Object.assign({},e.view);return this},setViewOffset:function(e,t,r,i,n,a){null===this.view&&(this.view={enabled:true,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=true;this.view.fullWidth=e;this.view.fullHeight=t;this.view.offsetX=r;this.view.offsetY=i;this.view.width=n;this.view.height=a;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=false);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom);var t=(this.top-this.bottom)/(2*this.zoom);var r=(this.right+this.left)/2;var i=(this.top+this.bottom)/2;var n=r-e;var a=r+e;var o=i+t;var s=i-t;if(null!==this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth);var c=this.zoom/(this.view.height/this.view.fullHeight);var l=(this.right-this.left)/this.view.width;var h=(this.top-this.bottom)/this.view.height;n+=l*(this.view.offsetX/u);a=n+l*(this.view.width/u);o-=h*(this.view.offsetY/c);s=o-h*(this.view.height/c)}this.projectionMatrix.makeOrthographic(n,a,o,s,this.near,this.far)},toJSON:function(e){var t=ra.prototype.toJSON.call(this,e);t.object.zoom=this.zoom;t.object.left=this.left;t.object.right=this.right;t.object.top=this.top;t.object.bottom=this.bottom;t.object.near=this.near;t.object.far=this.far;null!==this.view&&(t.object.view=Object.assign({},this.view));return t}});function aa(e,t,r,i,n,a){this.a=e;this.b=t;this.c=r;this.normal=i&&i.isVector3?i:new kt;this.vertexNormals=Array.isArray(i)?i:[];this.color=n&&n.isColor?n:new jr;this.vertexColors=Array.isArray(n)?n:[];this.materialIndex=void 0!==a?a:0}Object.assign(aa.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a;this.b=e.b;this.c=e.c;this.normal.copy(e.normal);this.color.copy(e.color);this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var oa=0;function sa(){Object.defineProperty(this,"id",{value:oa+=2});this.uuid=Ot.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.elementsNeedUpdate=false;this.verticesNeedUpdate=false;this.uvsNeedUpdate=false;this.normalsNeedUpdate=false;this.colorsNeedUpdate=false;this.lineDistancesNeedUpdate=false;this.groupsNeedUpdate=false}sa.prototype=Object.assign(Object.create(t.prototype),{constructor:sa,isGeometry:true,applyMatrix:function(e){var t=(new Pt).getNormalMatrix(e);for(var r=0,i=this.vertices.length;r<i;r++){var n=this.vertices[r];n.applyMatrix4(e)}for(var r=0,i=this.faces.length;r<i;r++){var a=this.faces[r];a.normal.applyMatrix3(t).normalize();for(var o=0,s=a.vertexNormals.length;o<s;o++)a.vertexNormals[o].applyMatrix3(t).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.verticesNeedUpdate=true;this.normalsNeedUpdate=true;return this},rotateX:function(){var e=new Rt;return function t(r){e.makeRotationX(r);this.applyMatrix(e);return this}}(),rotateY:function(){var e=new Rt;return function t(r){e.makeRotationY(r);this.applyMatrix(e);return this}}(),rotateZ:function(){var e=new Rt;return function t(r){e.makeRotationZ(r);this.applyMatrix(e);return this}}(),translate:function(){var e=new Rt;return function t(r,i,n){e.makeTranslation(r,i,n);this.applyMatrix(e);return this}}(),scale:function(){var e=new Rt;return function t(r,i,n){e.makeScale(r,i,n);this.applyMatrix(e);return this}}(),lookAt:function(){var e=new ra;return function t(r){e.lookAt(r);e.updateMatrix();this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this;var r=null!==e.index?e.index.array:void 0;var i=e.attributes;var n=i.position.array;var a=void 0!==i.normal?i.normal.array:void 0;var o=void 0!==i.color?i.color.array:void 0;var s=void 0!==i.uv?i.uv.array:void 0;var u=void 0!==i.uv2?i.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);var c=[];var l=[];var h=[];for(var d=0,p=0;d<n.length;d+=3,p+=2){t.vertices.push(new kt(n[d],n[d+1],n[d+2]));void 0!==a&&c.push(new kt(a[d],a[d+1],a[d+2]));void 0!==o&&t.colors.push(new jr(o[d],o[d+1],o[d+2]));void 0!==s&&l.push(new jt(s[p],s[p+1]));void 0!==u&&h.push(new jt(u[p],u[p+1]))}function f(e,r,i,n){var d=void 0!==a?[c[e].clone(),c[r].clone(),c[i].clone()]:[];var p=void 0!==o?[t.colors[e].clone(),t.colors[r].clone(),t.colors[i].clone()]:[];var f=new aa(e,r,i,d,p,n);t.faces.push(f);void 0!==s&&t.faceVertexUvs[0].push([l[e].clone(),l[r].clone(),l[i].clone()]);void 0!==u&&t.faceVertexUvs[1].push([h[e].clone(),h[r].clone(),h[i].clone()])}var v=e.groups;if(v.length>0)for(var d=0;d<v.length;d++){var m=v[d];var g=m.start;var y=m.count;for(var p=g,A=g+y;p<A;p+=3)void 0!==r?f(r[p],r[p+1],r[p+2],m.materialIndex):f(p,p+1,p+2,m.materialIndex)}else if(void 0!==r)for(var d=0;d<r.length;d+=3)f(r[d],r[d+1],r[d+2]);else for(var d=0;d<n.length/3;d+=3)f(d,d+1,d+2);this.computeFaceNormals();null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone());null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();this.translate(e.x,e.y,e.z);return e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center;var t=this.boundingSphere.radius;var r=0===t?1:1/t;var i=new Rt;i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1);this.applyMatrix(i);return this},computeFaceNormals:function(){var e=new kt,t=new kt;for(var r=0,i=this.faces.length;r<i;r++){var n=this.faces[r];var a=this.vertices[n.a];var o=this.vertices[n.b];var s=this.vertices[n.c];e.subVectors(s,o);t.subVectors(a,o);e.cross(t);e.normalize();n.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=true);var t,r,i,n,a,o;o=new Array(this.vertices.length);for(t=0,r=this.vertices.length;t<r;t++)o[t]=new kt;if(e){var s,u,c;var l=new kt,h=new kt;for(i=0,n=this.faces.length;i<n;i++){a=this.faces[i];s=this.vertices[a.a];u=this.vertices[a.b];c=this.vertices[a.c];l.subVectors(c,u);h.subVectors(s,u);l.cross(h);o[a.a].add(l);o[a.b].add(l);o[a.c].add(l)}}else{this.computeFaceNormals();for(i=0,n=this.faces.length;i<n;i++){a=this.faces[i];o[a.a].add(a.normal);o[a.b].add(a.normal);o[a.c].add(a.normal)}}for(t=0,r=this.vertices.length;t<r;t++)o[t].normalize();for(i=0,n=this.faces.length;i<n;i++){a=this.faces[i];var d=a.vertexNormals;if(3===d.length){d[0].copy(o[a.a]);d[1].copy(o[a.b]);d[2].copy(o[a.c])}else{d[0]=o[a.a].clone();d[1]=o[a.b].clone();d[2]=o[a.c].clone()}}this.faces.length>0&&(this.normalsNeedUpdate=true)},computeFlatVertexNormals:function(){var e,t,r;this.computeFaceNormals();for(e=0,t=this.faces.length;e<t;e++){r=this.faces[e];var i=r.vertexNormals;if(3===i.length){i[0].copy(r.normal);i[1].copy(r.normal);i[2].copy(r.normal)}else{i[0]=r.normal.clone();i[1]=r.normal.clone();i[2]=r.normal.clone()}}this.faces.length>0&&(this.normalsNeedUpdate=true)},computeMorphNormals:function(){var e,t,r,i,n;for(r=0,i=this.faces.length;r<i;r++){n=this.faces[r];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone();n.__originalVertexNormals||(n.__originalVertexNormals=[]);for(e=0,t=n.vertexNormals.length;e<t;e++)n.__originalVertexNormals[e]?n.__originalVertexNormals[e].copy(n.vertexNormals[e]):n.__originalVertexNormals[e]=n.vertexNormals[e].clone()}var a=new sa;a.faces=this.faces;for(e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals;var s=this.morphNormals[e].vertexNormals;var u,c;for(r=0,i=this.faces.length;r<i;r++){u=new kt;c={a:new kt,b:new kt,c:new kt};o.push(u);s.push(c)}}var l=this.morphNormals[e];a.vertices=this.morphTargets[e].vertices;a.computeFaceNormals();a.computeVertexNormals();var u,c;for(r=0,i=this.faces.length;r<i;r++){n=this.faces[r];u=l.faceNormals[r];c=l.vertexNormals[r];u.copy(n.normal);c.a.copy(n.vertexNormals[0]);c.b.copy(n.vertexNormals[1]);c.c.copy(n.vertexNormals[2])}}for(r=0,i=this.faces.length;r<i;r++){n=this.faces[r];n.normal=n.__originalFaceNormal;n.vertexNormals=n.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Wn);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Xn);this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var i,n=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,u=e.faces,c=this.faceVertexUvs[0],l=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===r&&(r=0);void 0!==t&&(i=(new Pt).getNormalMatrix(t));for(var p=0,f=o.length;p<f;p++){var v=o[p];var m=v.clone();void 0!==t&&m.applyMatrix4(t);a.push(m)}for(var p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=u.length;p<f;p++){var g=u[p],y,A,M,w=g.vertexNormals,E=g.vertexColors;y=new aa(g.a+n,g.b+n,g.c+n);y.normal.copy(g.normal);void 0!==i&&y.normal.applyMatrix3(i).normalize();for(var x=0,b=w.length;x<b;x++){A=w[x].clone();void 0!==i&&A.applyMatrix3(i).normalize();y.vertexNormals.push(A)}y.color.copy(g.color);for(var x=0,b=E.length;x<b;x++){M=E[x];y.vertexColors.push(M.clone())}y.materialIndex=g.materialIndex+r;s.push(y)}for(p=0,f=l.length;p<f;p++){var T=l[p],L=[];if(void 0===T)continue;for(var x=0,b=T.length;x<b;x++)L.push(T[x].clone());c.push(L)}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix();this.merge(e.geometry,e.matrix)},mergeVertices:function(){var e={};var t=[],r=[];var i,n;var a=4;var o=Math.pow(10,a);var s,u,c;var l,h,d;for(s=0,u=this.vertices.length;s<u;s++){i=this.vertices[s];n=Math.round(i.x*o)+"_"+Math.round(i.y*o)+"_"+Math.round(i.z*o);if(void 0===e[n]){e[n]=s;t.push(this.vertices[s]);r[s]=t.length-1}else r[s]=r[e[n]]}var p=[];for(s=0,u=this.faces.length;s<u;s++){c=this.faces[s];c.a=r[c.a];c.b=r[c.b];c.c=r[c.c];l=[c.a,c.b,c.c];for(var f=0;f<3;f++)if(l[f]===l[(f+1)%3]){p.push(s);break}}for(s=p.length-1;s>=0;s--){var v=p[s];this.faces.splice(v,1);for(h=0,d=this.faceVertexUvs.length;h<d;h++)this.faceVertexUvs[h].splice(v,1)}var m=this.vertices.length-t.length;this.vertices=t;return m},setFromPoints:function(e){this.vertices=[];for(var t=0,r=e.length;t<r;t++){var i=e[t];this.vertices.push(new kt(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){var e=this.faces;var t=e.length;for(var r=0;r<t;r++)e[r]._id=r;function i(e,t){return e.materialIndex-t.materialIndex}e.sort(i);var n=this.faceVertexUvs[0];var a=this.faceVertexUvs[1];var o,s;n&&n.length===t&&(o=[]);a&&a.length===t&&(s=[]);for(var r=0;r<t;r++){var u=e[r]._id;o&&o.push(n[u]);s&&s.push(a[u])}o&&(this.faceVertexUvs[0]=o);s&&(this.faceVertexUvs[1]=s)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}var i=[];for(var n=0;n<this.vertices.length;n++){var a=this.vertices[n];i.push(a.x,a.y,a.z)}var o=[];var s=[];var u={};var c=[];var l={};var h=[];var d={};for(var n=0;n<this.faces.length;n++){var p=this.faces[n];var f=true;var v=false;var m=void 0!==this.faceVertexUvs[0][n];var g=p.normal.length()>0;var y=p.vertexNormals.length>0;var A=1!==p.color.r||1!==p.color.g||1!==p.color.b;var M=p.vertexColors.length>0;var w=0;w=T(w,0,0);w=T(w,1,f);w=T(w,2,v);w=T(w,3,m);w=T(w,4,g);w=T(w,5,y);w=T(w,6,A);w=T(w,7,M);o.push(w);o.push(p.a,p.b,p.c);o.push(p.materialIndex);if(m){var E=this.faceVertexUvs[0][n];o.push(D(E[0]),D(E[1]),D(E[2]))}g&&o.push(L(p.normal));if(y){var x=p.vertexNormals;o.push(L(x[0]),L(x[1]),L(x[2]))}A&&o.push(N(p.color));if(M){var b=p.vertexColors;o.push(N(b[0]),N(b[1]),N(b[2]))}}function T(e,t,r){return r?e|1<<t:e&~(1<<t)}function L(e){var t=e.x.toString()+e.y.toString()+e.z.toString();if(void 0!==u[t])return u[t];u[t]=s.length/3;s.push(e.x,e.y,e.z);return u[t]}function N(e){var t=e.r.toString()+e.g.toString()+e.b.toString();if(void 0!==l[t])return l[t];l[t]=c.length;c.push(e.getHex());return l[t]}function D(e){var t=e.x.toString()+e.y.toString();if(void 0!==d[t])return d[t];d[t]=h.length/2;h.push(e.x,e.y);return d[t]}e.data={};e.data.vertices=i;e.data.normals=s;c.length>0&&(e.data.colors=c);h.length>0&&(e.data.uvs=[h]);e.data.faces=o;return e},clone:function(){return(new sa).copy(this)},copy:function(e){var t,r,i,n,a,o;this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.name=e.name;var s=e.vertices;for(t=0,r=s.length;t<r;t++)this.vertices.push(s[t].clone());var u=e.colors;for(t=0,r=u.length;t<r;t++)this.colors.push(u[t].clone());var c=e.faces;for(t=0,r=c.length;t<r;t++)this.faces.push(c[t].clone());for(t=0,r=e.faceVertexUvs.length;t<r;t++){var l=e.faceVertexUvs[t];void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]);for(i=0,n=l.length;i<n;i++){var h=l[i],d=[];for(a=0,o=h.length;a<o;a++){var p=h[a];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var f=e.morphTargets;for(t=0,r=f.length;t<r;t++){var v={};v.name=f[t].name;if(void 0!==f[t].vertices){v.vertices=[];for(i=0,n=f[t].vertices.length;i<n;i++)v.vertices.push(f[t].vertices[i].clone())}if(void 0!==f[t].normals){v.normals=[];for(i=0,n=f[t].normals.length;i<n;i++)v.normals.push(f[t].normals[i].clone())}this.morphTargets.push(v)}var m=e.morphNormals;for(t=0,r=m.length;t<r;t++){var g={};if(void 0!==m[t].vertexNormals){g.vertexNormals=[];for(i=0,n=m[t].vertexNormals.length;i<n;i++){var y=m[t].vertexNormals[i];var A={};A.a=y.a.clone();A.b=y.b.clone();A.c=y.c.clone();g.vertexNormals.push(A)}}if(void 0!==m[t].faceNormals){g.faceNormals=[];for(i=0,n=m[t].faceNormals.length;i<n;i++)g.faceNormals.push(m[t].faceNormals[i].clone())}this.morphNormals.push(g)}var M=e.skinWeights;for(t=0,r=M.length;t<r;t++)this.skinWeights.push(M[t].clone());var w=e.skinIndices;for(t=0,r=w.length;t<r;t++)this.skinIndices.push(w[t].clone());var E=e.lineDistances;for(t=0,r=E.length;t<r;t++)this.lineDistances.push(E[t]);var x=e.boundingBox;null!==x&&(this.boundingBox=x.clone());var b=e.boundingSphere;null!==b&&(this.boundingSphere=b.clone());this.elementsNeedUpdate=e.elementsNeedUpdate;this.verticesNeedUpdate=e.verticesNeedUpdate;this.uvsNeedUpdate=e.uvsNeedUpdate;this.normalsNeedUpdate=e.normalsNeedUpdate;this.colorsNeedUpdate=e.colorsNeedUpdate;this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate;this.groupsNeedUpdate=e.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function ua(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Ot.generateUUID();this.name="";this.array=e;this.itemSize=t;this.count=void 0!==e?e.length/t:0;this.normalized=true===r;this.dynamic=false;this.updateRange={offset:0,count:-1};this.onUploadCallback=function(){};this.version=0}Object.defineProperty(ua.prototype,"needsUpdate",{set:function(e){true===e&&this.version++}});Object.assign(ua.prototype,{isBufferAttribute:true,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0;this.array=e},setDynamic:function(e){this.dynamic=e;return this},copy:function(e){this.array=new e.array.constructor(e.array);this.itemSize=e.itemSize;this.count=e.count;this.normalized=e.normalized;this.dynamic=e.dynamic;return this},copyAt:function(e,t,r){e*=this.itemSize;r*=t.itemSize;for(var i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this},copyArray:function(e){this.array.set(e);return this},copyColorsArray:function(e){var t=this.array,r=0;for(var i=0,n=e.length;i<n;i++){var a=e[i];if(void 0===a){console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i);a=new jr}t[r++]=a.r;t[r++]=a.g;t[r++]=a.b}return this},copyIndicesArray:function(e){var t=this.array,r=0;for(var i=0,n=e.length;i<n;i++){var a=e[i];t[r++]=a.a;t[r++]=a.b;t[r++]=a.c}return this},copyVector2sArray:function(e){var t=this.array,r=0;for(var i=0,n=e.length;i<n;i++){var a=e[i];if(void 0===a){console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i);a=new jt}t[r++]=a.x;t[r++]=a.y}return this},copyVector3sArray:function(e){var t=this.array,r=0;for(var i=0,n=e.length;i<n;i++){var a=e[i];if(void 0===a){console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i);a=new kt}t[r++]=a.x;t[r++]=a.y;t[r++]=a.z}return this},copyVector4sArray:function(e){var t=this.array,r=0;for(var i=0,n=e.length;i<n;i++){var a=e[i];if(void 0===a){console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i);a=new Ft}t[r++]=a.x;t[r++]=a.y;t[r++]=a.z;t[r++]=a.w}return this},set:function(e,t){void 0===t&&(t=0);this.array.set(e,t);return this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){this.array[e*this.itemSize]=t;return this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){this.array[e*this.itemSize+1]=t;return this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){this.array[e*this.itemSize+2]=t;return this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){this.array[e*this.itemSize+3]=t;return this},setXY:function(e,t,r){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;return this},setXYZ:function(e,t,r,i){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;this.array[e+2]=i;return this},setXYZW:function(e,t,r,i,n){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;this.array[e+2]=i;this.array[e+3]=n;return this},onUpload:function(e){this.onUploadCallback=e;return this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}});function ca(e,t,r){ua.call(this,new Int8Array(e),t,r)}ca.prototype=Object.create(ua.prototype);ca.prototype.constructor=ca;function la(e,t,r){ua.call(this,new Uint8Array(e),t,r)}la.prototype=Object.create(ua.prototype);la.prototype.constructor=la;function ha(e,t,r){ua.call(this,new Uint8ClampedArray(e),t,r)}ha.prototype=Object.create(ua.prototype);ha.prototype.constructor=ha;function da(e,t,r){ua.call(this,new Int16Array(e),t,r)}da.prototype=Object.create(ua.prototype);da.prototype.constructor=da;function pa(e,t,r){ua.call(this,new Uint16Array(e),t,r)}pa.prototype=Object.create(ua.prototype);pa.prototype.constructor=pa;function fa(e,t,r){ua.call(this,new Int32Array(e),t,r)}fa.prototype=Object.create(ua.prototype);fa.prototype.constructor=fa;function va(e,t,r){ua.call(this,new Uint32Array(e),t,r)}va.prototype=Object.create(ua.prototype);va.prototype.constructor=va;function ma(e,t,r){ua.call(this,new Float32Array(e),t,r)}ma.prototype=Object.create(ua.prototype);ma.prototype.constructor=ma;function ga(e,t,r){ua.call(this,new Float64Array(e),t,r)}ga.prototype=Object.create(ua.prototype);ga.prototype.constructor=ga;function ya(){this.indices=[];this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingBox=null;this.boundingSphere=null;this.verticesNeedUpdate=false;this.normalsNeedUpdate=false;this.colorsNeedUpdate=false;this.uvsNeedUpdate=false;this.groupsNeedUpdate=false}Object.assign(ya.prototype,{computeGroups:function(e){var t;var r=[];var i=void 0;var n=e.faces;for(var a=0;a<n.length;a++){var o=n[a];if(o.materialIndex!==i){i=o.materialIndex;if(void 0!==t){t.count=3*a-t.start;r.push(t)}t={start:3*a,materialIndex:i}}}if(void 0!==t){t.count=3*a-t.start;r.push(t)}this.groups=r},fromGeometry:function(e){var t=e.faces;var r=e.vertices;var i=e.faceVertexUvs;var n=i[0]&&i[0].length>0;var a=i[1]&&i[1].length>0;var o=e.morphTargets;var s=o.length;var u;if(s>0){u=[];for(var c=0;c<s;c++)u[c]=[];this.morphTargets.position=u}var l=e.morphNormals;var h=l.length;var d;if(h>0){d=[];for(var c=0;c<h;c++)d[c]=[];this.morphTargets.normal=d}var p=e.skinIndices;var f=e.skinWeights;var v=p.length===r.length;var m=f.length===r.length;for(var c=0;c<t.length;c++){var g=t[c];this.vertices.push(r[g.a],r[g.b],r[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var A=g.normal;this.normals.push(A,A,A)}var M=g.vertexColors;if(3===M.length)this.colors.push(M[0],M[1],M[2]);else{var w=g.color;this.colors.push(w,w,w)}if(true===n){var E=i[0][c];if(void 0!==E)this.uvs.push(E[0],E[1],E[2]);else{console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c);this.uvs.push(new jt,new jt,new jt)}}if(true===a){var E=i[1][c];if(void 0!==E)this.uvs2.push(E[0],E[1],E[2]);else{console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c);this.uvs2.push(new jt,new jt,new jt)}}for(var x=0;x<s;x++){var b=o[x].vertices;u[x].push(b[g.a],b[g.b],b[g.c])}for(var x=0;x<h;x++){var T=l[x].vertexNormals[c];d[x].push(T.a,T.b,T.c)}v&&this.skinIndices.push(p[g.a],p[g.b],p[g.c]);m&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}this.computeGroups(e);this.verticesNeedUpdate=e.verticesNeedUpdate;this.normalsNeedUpdate=e.normalsNeedUpdate;this.colorsNeedUpdate=e.colorsNeedUpdate;this.uvsNeedUpdate=e.uvsNeedUpdate;this.groupsNeedUpdate=e.groupsNeedUpdate;return this}});function Aa(e){if(0===e.length)return-Infinity;var t=e[0];for(var r=1,i=e.length;r<i;++r)e[r]>t&&(t=e[r]);return t}var Ma=1;function wa(){Object.defineProperty(this,"id",{value:Ma+=2});this.uuid=Ot.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingBox=null;this.boundingSphere=null;this.drawRange={start:0,count:Infinity}}wa.prototype=Object.assign(Object.create(t.prototype),{constructor:wa,isBufferGeometry:true,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Aa(e)>65535?va:pa)(e,1):this.index=e},addAttribute:function(e,t){if(!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)){console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).");this.addAttribute(e,new ua(arguments[1],arguments[2]));return}if("index"===e){console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.");this.setIndex(t);return}this.attributes[e]=t;return this},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){delete this.attributes[e];return this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e;this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;if(void 0!==t){e.applyToBufferAttribute(t);t.needsUpdate=true}var r=this.attributes.normal;if(void 0!==r){var i=(new Pt).getNormalMatrix(e);i.applyToBufferAttribute(r);r.needsUpdate=true}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(){var e=new Rt;return function t(r){e.makeRotationX(r);this.applyMatrix(e);return this}}(),rotateY:function(){var e=new Rt;return function t(r){e.makeRotationY(r);this.applyMatrix(e);return this}}(),rotateZ:function(){var e=new Rt;return function t(r){e.makeRotationZ(r);this.applyMatrix(e);return this}}(),translate:function(){var e=new Rt;return function t(r,i,n){e.makeTranslation(r,i,n);this.applyMatrix(e);return this}}(),scale:function(){var e=new Rt;return function t(r,i,n){e.makeScale(r,i,n);this.applyMatrix(e);return this}}(),lookAt:function(){var e=new ra;return function t(r){e.lookAt(r);e.updateMatrix();this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();this.translate(e.x,e.y,e.z);return e},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var r=new ma(3*t.vertices.length,3);var i=new ma(3*t.colors.length,3);this.addAttribute("position",r.copyVector3sArray(t.vertices));this.addAttribute("color",i.copyColorsArray(t.colors));if(t.lineDistances&&t.lineDistances.length===t.vertices.length){var n=new ma(t.lineDistances.length,1);this.addAttribute("lineDistance",n.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone());null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){var t=[];for(var r=0,i=e.length;r<i;r++){var n=e[r];t.push(n.x,n.y,n.z||0)}this.addAttribute("position",new ma(t,3));return this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var r=t.__directGeometry;if(true===t.elementsNeedUpdate){r=void 0;t.elementsNeedUpdate=false}if(void 0===r)return this.fromGeometry(t);r.verticesNeedUpdate=t.verticesNeedUpdate;r.normalsNeedUpdate=t.normalsNeedUpdate;r.colorsNeedUpdate=t.colorsNeedUpdate;r.uvsNeedUpdate=t.uvsNeedUpdate;r.groupsNeedUpdate=t.groupsNeedUpdate;t.verticesNeedUpdate=false;t.normalsNeedUpdate=false;t.colorsNeedUpdate=false;t.uvsNeedUpdate=false;t.groupsNeedUpdate=false;t=r}var i;if(true===t.verticesNeedUpdate){i=this.attributes.position;if(void 0!==i){i.copyVector3sArray(t.vertices);i.needsUpdate=true}t.verticesNeedUpdate=false}if(true===t.normalsNeedUpdate){i=this.attributes.normal;if(void 0!==i){i.copyVector3sArray(t.normals);i.needsUpdate=true}t.normalsNeedUpdate=false}if(true===t.colorsNeedUpdate){i=this.attributes.color;if(void 0!==i){i.copyColorsArray(t.colors);i.needsUpdate=true}t.colorsNeedUpdate=false}if(t.uvsNeedUpdate){i=this.attributes.uv;if(void 0!==i){i.copyVector2sArray(t.uvs);i.needsUpdate=true}t.uvsNeedUpdate=false}if(t.lineDistancesNeedUpdate){i=this.attributes.lineDistance;if(void 0!==i){i.copyArray(t.lineDistances);i.needsUpdate=true}t.lineDistancesNeedUpdate=false}if(t.groupsNeedUpdate){t.computeGroups(e.geometry);this.groups=t.groups;t.groupsNeedUpdate=false}return this},fromGeometry:function(e){e.__directGeometry=(new ya).fromGeometry(e);return this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);this.addAttribute("position",new ua(t,3).copyVector3sArray(e.vertices));if(e.normals.length>0){var r=new Float32Array(3*e.normals.length);this.addAttribute("normal",new ua(r,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var i=new Float32Array(3*e.colors.length);this.addAttribute("color",new ua(i,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var n=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new ua(n,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new ua(a,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var o=Aa(e.indices)>65535?Uint32Array:Uint16Array;var s=new o(3*e.indices.length);this.setIndex(new ua(s,1).copyIndicesArray(e.indices))}this.groups=e.groups;for(var u in e.morphTargets){var c=[];var l=e.morphTargets[u];for(var h=0,d=l.length;h<d;h++){var p=l[h];var f=new ma(3*p.length,3);c.push(f.copyVector3sArray(p))}this.morphAttributes[u]=c}if(e.skinIndices.length>0){var v=new ma(4*e.skinIndices.length,4);this.addAttribute("skinIndex",v.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var m=new ma(4*e.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(e.skinWeights))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone());null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone());return this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Wn);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new Wn;var t=new kt;return function r(){null===this.boundingSphere&&(this.boundingSphere=new Xn);var i=this.attributes.position;if(i){var n=this.boundingSphere.center;e.setFromBufferAttribute(i);e.getCenter(n);var a=0;for(var o=0,s=i.count;o<s;o++){t.x=i.getX(o);t.y=i.getY(o);t.z=i.getZ(o);a=Math.max(a,n.distanceToSquared(t))}this.boundingSphere.radius=Math.sqrt(a);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index;var t=this.attributes;var r=this.groups;if(t.position){var i=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new ua(new Float32Array(i.length),3));else{var n=t.normal.array;for(var a=0,o=n.length;a<o;a++)n[a]=0}var s=t.normal.array;var u,c,l;var h=new kt,d=new kt,p=new kt;var f=new kt,v=new kt;if(e){var m=e.array;0===r.length&&this.addGroup(0,m.length);for(var g=0,y=r.length;g<y;++g){var A=r[g];var M=A.start;var w=A.count;for(var a=M,o=M+w;a<o;a+=3){u=3*m[a+0];c=3*m[a+1];l=3*m[a+2];h.fromArray(i,u);d.fromArray(i,c);p.fromArray(i,l);f.subVectors(p,d);v.subVectors(h,d);f.cross(v);s[u]+=f.x;s[u+1]+=f.y;s[u+2]+=f.z;s[c]+=f.x;s[c+1]+=f.y;s[c+2]+=f.z;s[l]+=f.x;s[l+1]+=f.y;s[l+2]+=f.z}}}else for(var a=0,o=i.length;a<o;a+=9){h.fromArray(i,a);d.fromArray(i,a+3);p.fromArray(i,a+6);f.subVectors(p,d);v.subVectors(h,d);f.cross(v);s[a]=f.x;s[a+1]=f.y;s[a+2]=f.z;s[a+3]=f.x;s[a+4]=f.y;s[a+5]=f.z;s[a+6]=f.x;s[a+7]=f.y;s[a+8]=f.z}this.normalizeNormals();t.normal.needsUpdate=true}},merge:function(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}void 0===t&&(t=0);var r=this.attributes;for(var i in r){if(void 0===e.attributes[i])continue;var n=r[i];var a=n.array;var o=e.attributes[i];var s=o.array;var u=o.itemSize;for(var c=0,l=u*t;c<s.length;c++,l++)a[l]=s[c]}return this},normalizeNormals:function(){var e=new kt;return function t(){var r=this.attributes.normal;for(var i=0,n=r.count;i<n;i++){e.x=r.getX(i);e.y=r.getY(i);e.z=r.getZ(i);e.normalize();r.setXYZ(i,e.x,e.y,e.z)}}}(),toNonIndexed:function(){if(null===this.index){console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.");return this}var e=new wa;var t=this.index.array;var r=this.attributes;for(var i in r){var n=r[i];var a=n.array;var o=n.itemSize;var s=new a.constructor(t.length*o);var u=0,c=0;for(var l=0,h=t.length;l<h;l++){u=t[l]*o;for(var d=0;d<o;d++)s[c++]=a[u++]}e.addAttribute(i,new ua(s,o))}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};var i=this.index;if(null!==i){var n=Array.prototype.slice.call(i.array);e.data.index={type:i.array.constructor.name,array:n}}var a=this.attributes;for(var r in a){var o=a[r];var n=Array.prototype.slice.call(o.array);e.data.attributes[r]={itemSize:o.itemSize,type:o.array.constructor.name,array:n,normalized:o.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var u=this.boundingSphere;null!==u&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius});return e},clone:function(){return(new wa).copy(this)},copy:function(e){var t,r,i;this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingBox=null;this.boundingSphere=null;this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone());var a=e.attributes;for(t in a){var o=a[t];this.addAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var u=[];var c=s[t];for(r=0,i=c.length;r<i;r++)u.push(c[r].clone());this.morphAttributes[t]=u}var l=e.groups;for(r=0,i=l.length;r<i;r++){var h=l[r];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;null!==p&&(this.boundingSphere=p.clone());this.drawRange.start=e.drawRange.start;this.drawRange.count=e.drawRange.count;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Ea(e,t,r,i,n,a){sa.call(this);this.type="BoxGeometry";this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:a};this.fromBufferGeometry(new xa(e,t,r,i,n,a));this.mergeVertices()}Ea.prototype=Object.create(sa.prototype);Ea.prototype.constructor=Ea;function xa(e,t,r,i,n,a){wa.call(this);this.type="BoxBufferGeometry";this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:a};var o=this;e=e||1;t=t||1;r=r||1;i=Math.floor(i)||1;n=Math.floor(n)||1;a=Math.floor(a)||1;var s=[];var u=[];var c=[];var l=[];var h=0;var d=0;p("z","y","x",-1,-1,r,t,e,a,n,0);p("z","y","x",1,-1,r,t,-e,a,n,1);p("x","z","y",1,1,e,r,t,i,a,2);p("x","z","y",1,-1,e,r,-t,i,a,3);p("x","y","z",1,-1,e,t,r,i,n,4);p("x","y","z",-1,-1,e,t,-r,i,n,5);this.setIndex(s);this.addAttribute("position",new ma(u,3));this.addAttribute("normal",new ma(c,3));this.addAttribute("uv",new ma(l,2));function p(e,t,r,i,n,a,p,f,v,m,g){var y=a/v;var A=p/m;var M=a/2;var w=p/2;var E=f/2;var x=v+1;var b=m+1;var T=0;var L=0;var N,D;var C=new kt;for(D=0;D<b;D++){var S=D*A-w;for(N=0;N<x;N++){var I=N*y-M;C[e]=I*i;C[t]=S*n;C[r]=E;u.push(C.x,C.y,C.z);C[e]=0;C[t]=0;C[r]=f>0?1:-1;c.push(C.x,C.y,C.z);l.push(N/v);l.push(1-D/m);T+=1}}for(D=0;D<m;D++)for(N=0;N<v;N++){var _=h+N+x*D;var O=h+N+x*(D+1);var j=h+(N+1)+x*(D+1);var R=h+(N+1)+x*D;s.push(_,O,R);s.push(O,j,R);L+=6}o.addGroup(d,L,g);d+=L;h+=T}}xa.prototype=Object.create(wa.prototype);xa.prototype.constructor=xa;function ba(e,t,r,i){sa.call(this);this.type="PlaneGeometry";this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};this.fromBufferGeometry(new Ta(e,t,r,i));this.mergeVertices()}ba.prototype=Object.create(sa.prototype);ba.prototype.constructor=ba;function Ta(e,t,r,i){wa.call(this);this.type="PlaneBufferGeometry";this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};e=e||1;t=t||1;var n=e/2;var a=t/2;var o=Math.floor(r)||1;var s=Math.floor(i)||1;var u=o+1;var c=s+1;var l=e/o;var h=t/s;var d,p;var f=[];var v=[];var m=[];var g=[];for(p=0;p<c;p++){var y=p*h-a;for(d=0;d<u;d++){var A=d*l-n;v.push(A,-y,0);m.push(0,0,1);g.push(d/o);g.push(1-p/s)}}for(p=0;p<s;p++)for(d=0;d<o;d++){var M=d+u*p;var w=d+u*(p+1);var E=d+1+u*(p+1);var x=d+1+u*p;f.push(M,w,x);f.push(w,E,x)}this.setIndex(f);this.addAttribute("position",new ma(v,3));this.addAttribute("normal",new ma(m,3));this.addAttribute("uv",new ma(g,2))}Ta.prototype=Object.create(wa.prototype);Ta.prototype.constructor=Ta;function La(e){Vn.call(this);this.type="MeshBasicMaterial";this.color=new jr(16777215);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=J;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.lights=false;this.setValues(e)}La.prototype=Object.create(Vn.prototype);La.prototype.constructor=La;La.prototype.isMeshBasicMaterial=true;La.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.skinning=e.skinning;this.morphTargets=e.morphTargets;return this};function Na(e){Vn.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.clipping=false;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.extensions={derivatives:false,fragDepth:false,drawBuffers:false,shaderTextureLOD:false};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=false;if(void 0!==e){void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.");this.setValues(e)}}Na.prototype=Object.create(Vn.prototype);Na.prototype.constructor=Na;Na.prototype.isShaderMaterial=true;Na.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.fragmentShader=e.fragmentShader;this.vertexShader=e.vertexShader;this.uniforms=zr.clone(e.uniforms);this.defines=e.defines;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.lights=e.lights;this.clipping=e.clipping;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;this.extensions=e.extensions;return this};Na.prototype.toJSON=function(e){var t=Vn.prototype.toJSON.call(this,e);t.uniforms=this.uniforms;t.vertexShader=this.vertexShader;t.fragmentShader=this.fragmentShader;return t};function Da(e,t){this.origin=void 0!==e?e:new kt;this.direction=void 0!==t?t:new kt}Object.assign(Da.prototype,{set:function(e,t){this.origin.copy(e);this.direction.copy(t);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.origin.copy(e.origin);this.direction.copy(e.direction);return this},at:function(e,t){var r=t||new kt;return r.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){this.direction.copy(e).sub(this.origin).normalize();return this},recast:function(){var e=new kt;return function t(r){this.origin.copy(this.at(r,e));return this}}(),closestPointToPoint:function(e,t){var r=t||new kt;r.subVectors(e,this.origin);var i=r.dot(this.direction);if(i<0)return r.copy(this.origin);return r.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new kt;return function t(r){var i=e.subVectors(r,this.origin).dot(this.direction);if(i<0)return this.origin.distanceToSquared(r);e.copy(this.direction).multiplyScalar(i).add(this.origin);return e.distanceToSquared(r)}}(),distanceSqToSegment:function(){var e=new kt;var t=new kt;var r=new kt;return function i(n,a,o,s){e.copy(n).add(a).multiplyScalar(.5);t.copy(a).sub(n).normalize();r.copy(this.origin).sub(e);var u=.5*n.distanceTo(a);var c=-this.direction.dot(t);var l=r.dot(this.direction);var h=-r.dot(t);var d=r.lengthSq();var p=Math.abs(1-c*c);var f,v,m,g;if(p>0){f=c*h-l;v=c*l-h;g=u*p;if(f>=0)if(v>=-g)if(v<=g){var y=1/p;f*=y;v*=y;m=f*(f+c*v+2*l)+v*(c*f+v+2*h)+d}else{v=u;f=Math.max(0,-(c*v+l));m=-f*f+v*(v+2*h)+d}else{v=-u;f=Math.max(0,-(c*v+l));m=-f*f+v*(v+2*h)+d}else if(v<=-g){f=Math.max(0,-(-c*u+l));v=f>0?-u:Math.min(Math.max(-u,-h),u);m=-f*f+v*(v+2*h)+d}else if(v<=g){f=0;v=Math.min(Math.max(-u,-h),u);m=v*(v+2*h)+d}else{f=Math.max(0,-(c*u+l));v=f>0?u:Math.min(Math.max(-u,-h),u);m=-f*f+v*(v+2*h)+d}}else{v=c>0?-u:u;f=Math.max(0,-(c*v+l));m=-f*f+v*(v+2*h)+d}o&&o.copy(this.direction).multiplyScalar(f).add(this.origin);s&&s.copy(t).multiplyScalar(v).add(e);return m}}(),intersectSphere:function(){var e=new kt;return function t(r,i){e.subVectors(r.center,this.origin);var n=e.dot(this.direction);var a=e.dot(e)-n*n;var o=r.radius*r.radius;if(a>o)return null;var s=Math.sqrt(o-a);var u=n-s;var c=n+s;if(u<0&&c<0)return null;if(u<0)return this.at(c,i);return this.at(u,i)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t){if(0===e.distanceToPoint(this.origin))return 0;return null}var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);if(null===r)return null;return this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);if(0===t)return true;var r=e.normal.dot(this.direction);if(r*t<0)return true;return false},intersectBox:function(e,t){var r,i,n,a,o,s;var u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z;var h=this.origin;if(u>=0){r=(e.min.x-h.x)*u;i=(e.max.x-h.x)*u}else{r=(e.max.x-h.x)*u;i=(e.min.x-h.x)*u}if(c>=0){n=(e.min.y-h.y)*c;a=(e.max.y-h.y)*c}else{n=(e.max.y-h.y)*c;a=(e.min.y-h.y)*c}if(r>a||n>i)return null;(n>r||r!==r)&&(r=n);(a<i||i!==i)&&(i=a);if(l>=0){o=(e.min.z-h.z)*l;s=(e.max.z-h.z)*l}else{o=(e.max.z-h.z)*l;s=(e.min.z-h.z)*l}if(r>s||o>i)return null;(o>r||r!==r)&&(r=o);(s<i||i!==i)&&(i=s);if(i<0)return null;return this.at(r>=0?r:i,t)},intersectsBox:function(){var e=new kt;return function t(r){return null!==this.intersectBox(r,e)}}(),intersectTriangle:function(){var e=new kt;var t=new kt;var r=new kt;var i=new kt;return function n(a,o,s,u,c){t.subVectors(o,a);r.subVectors(s,a);i.crossVectors(t,r);var l=this.direction.dot(i);var h;if(l>0){if(u)return null;h=1}else{if(!(l<0))return null;h=-1;l=-l}e.subVectors(this.origin,a);var d=h*this.direction.dot(r.crossVectors(e,r));if(d<0)return null;var p=h*this.direction.dot(t.cross(e));if(p<0)return null;if(d+p>l)return null;var f=-h*e.dot(i);if(f<0)return null;return this.at(f/l,c)}}(),applyMatrix4:function(e){this.origin.applyMatrix4(e);this.direction.transformDirection(e);return this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});function Ca(e,t){this.start=void 0!==e?e:new kt;this.end=void 0!==t?t:new kt}Object.assign(Ca.prototype,{set:function(e,t){this.start.copy(e);this.end.copy(t);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.start.copy(e.start);this.end.copy(e.end);return this},getCenter:function(e){var t=e||new kt;return t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){var t=e||new kt;return t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var r=t||new kt;return this.delta(r).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new kt;var t=new kt;return function r(i,n){e.subVectors(i,this.start);t.subVectors(this.end,this.start);var a=t.dot(t);var o=t.dot(e);var s=o/a;n&&(s=Ot.clamp(s,0,1));return s}}(),closestPointToPoint:function(e,t,r){var i=this.closestPointToPointParameter(e,t);var n=r||new kt;return this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){this.start.applyMatrix4(e);this.end.applyMatrix4(e);return this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}});function Sa(e,t,r){this.a=void 0!==e?e:new kt;this.b=void 0!==t?t:new kt;this.c=void 0!==r?r:new kt}Object.assign(Sa,{normal:function(){var e=new kt;return function t(r,i,n,a){var o=a||new kt;o.subVectors(n,i);e.subVectors(r,i);o.cross(e);var s=o.lengthSq();if(s>0)return o.multiplyScalar(1/Math.sqrt(s));return o.set(0,0,0)}}(),barycoordFromPoint:function(){var e=new kt;var t=new kt;var r=new kt;return function i(n,a,o,s,u){e.subVectors(s,a);t.subVectors(o,a);r.subVectors(n,a);var c=e.dot(e);var l=e.dot(t);var h=e.dot(r);var d=t.dot(t);var p=t.dot(r);var f=c*d-l*l;var v=u||new kt;if(0===f)return v.set(-2,-1,-1);var m=1/f;var g=(d*h-l*p)*m;var y=(c*p-l*h)*m;return v.set(1-g-y,y,g)}}(),containsPoint:function(){var e=new kt;return function t(r,i,n,a){var o=Sa.barycoordFromPoint(r,i,n,a,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}()});Object.assign(Sa.prototype,{set:function(e,t,r){this.a.copy(e);this.b.copy(t);this.c.copy(r);return this},setFromPointsAndIndices:function(e,t,r,i){this.a.copy(e[t]);this.b.copy(e[r]);this.c.copy(e[i]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a.copy(e.a);this.b.copy(e.b);this.c.copy(e.c);return this},area:function(){var e=new kt;var t=new kt;return function r(){e.subVectors(this.c,this.b);t.subVectors(this.a,this.b);return.5*e.cross(t).length()}}(),midpoint:function(e){var t=e||new kt;return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return Sa.normal(this.a,this.b,this.c,e)},plane:function(e){var t=e||new qn;return t.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return Sa.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Sa.containsPoint(e,this.a,this.b,this.c)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var e=new qn;var t=[new Ca,new Ca,new Ca];var r=new kt;var i=new kt;return function n(a,o){var s=o||new kt;var u=Infinity;e.setFromCoplanarPoints(this.a,this.b,this.c);e.projectPoint(a,r);if(true===this.containsPoint(r))s.copy(r);else{t[0].set(this.a,this.b);t[1].set(this.b,this.c);t[2].set(this.c,this.a);for(var c=0;c<t.length;c++){t[c].closestPointToPoint(r,true,i);var l=r.distanceToSquared(i);if(l<u){u=l;s.copy(i)}}}return s}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});function Ia(e,t){ra.call(this);this.type="Mesh";this.geometry=void 0!==e?e:new wa;this.material=void 0!==t?t:new La({color:16777215*Math.random()});this.drawMode=Mt;this.updateMorphTargets()}Ia.prototype=Object.assign(Object.create(ra.prototype),{constructor:Ia,isMesh:true,setDrawMode:function(e){this.drawMode=e},copy:function(e){ra.prototype.copy.call(this,e);this.drawMode=e.drawMode;void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice());void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary));return this},updateMorphTargets:function(){var e=this.geometry;var t,r,i;if(e.isBufferGeometry){var n=e.morphAttributes;var a=Object.keys(n);if(a.length>0){var o=n[a[0]];if(void 0!==o){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(t=0,r=o.length;t<r;t++){i=o[t].name||String(t);this.morphTargetInfluences.push(0);this.morphTargetDictionary[i]=t}}}}else{var s=e.morphTargets;if(void 0!==s&&s.length>0){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(t=0,r=s.length;t<r;t++){i=s[t].name||String(t);this.morphTargetInfluences.push(0);this.morphTargetDictionary[i]=t}}}},raycast:function(){var e=new Rt;var t=new Da;var r=new Xn;var i=new kt;var n=new kt;var a=new kt;var o=new kt;var s=new kt;var u=new kt;var c=new jt;var l=new jt;var h=new jt;var d=new kt;var p=new kt;var m=new kt;function g(e,t,r,i,n,a,o){Sa.barycoordFromPoint(e,t,r,i,d);n.multiplyScalar(d.x);a.multiplyScalar(d.y);o.multiplyScalar(d.z);n.add(a).add(o);return n.clone()}function y(e,t,r,i,n,a,o,s){var u;u=t.side===f?i.intersectTriangle(o,a,n,true,s):i.intersectTriangle(n,a,o,t.side!==v,s);if(null===u)return null;m.copy(s);m.applyMatrix4(e.matrixWorld);var c=r.ray.origin.distanceTo(m);if(c<r.near||c>r.far)return null;return{distance:c,point:m.clone(),object:e}}function A(e,t,r,o,s,u,d,f){i.fromBufferAttribute(o,u);n.fromBufferAttribute(o,d);a.fromBufferAttribute(o,f);var v=y(e,e.material,t,r,i,n,a,p);if(v){if(s){c.fromBufferAttribute(s,u);l.fromBufferAttribute(s,d);h.fromBufferAttribute(s,f);v.uv=g(p,i,n,a,c,l,h)}v.face=new aa(u,d,f,Sa.normal(i,n,a));v.faceIndex=u}return v}return function d(f,v){var m=this.geometry;var M=this.material;var w=this.matrixWorld;if(void 0===M)return;null===m.boundingSphere&&m.computeBoundingSphere();r.copy(m.boundingSphere);r.applyMatrix4(w);if(false===f.ray.intersectsSphere(r))return;e.getInverse(w);t.copy(f.ray).applyMatrix4(e);if(null!==m.boundingBox&&false===t.intersectsBox(m.boundingBox))return;var E;if(m.isBufferGeometry){var x,b,T;var L=m.index;var N=m.attributes.position;var D=m.attributes.uv;var C,S;if(null!==L)for(C=0,S=L.count;C<S;C+=3){x=L.getX(C);b=L.getX(C+1);T=L.getX(C+2);E=A(this,f,t,N,D,x,b,T);if(E){E.faceIndex=Math.floor(C/3);v.push(E)}}else if(void 0!==N)for(C=0,S=N.count;C<S;C+=3){x=C;b=C+1;T=C+2;E=A(this,f,t,N,D,x,b,T);if(E){E.index=x;v.push(E)}}}else if(m.isGeometry){var I,_,O;var j=Array.isArray(M);var R=m.vertices;var z=m.faces;var k;var P=m.faceVertexUvs[0];P.length>0&&(k=P);for(var U=0,B=z.length;U<B;U++){var F=z[U];var G=j?M[F.materialIndex]:M;if(void 0===G)continue;I=R[F.a];_=R[F.b];O=R[F.c];if(true===G.morphTargets){var H=m.morphTargets;var V=this.morphTargetInfluences;i.set(0,0,0);n.set(0,0,0);a.set(0,0,0);for(var Q=0,Y=H.length;Q<Y;Q++){var W=V[Q];if(0===W)continue;var X=H[Q].vertices;i.addScaledVector(o.subVectors(X[F.a],I),W);n.addScaledVector(s.subVectors(X[F.b],_),W);a.addScaledVector(u.subVectors(X[F.c],O),W)}i.add(I);n.add(_);a.add(O);I=i;_=n;O=a}E=y(this,G,f,t,I,_,O,p);if(E){if(k&&k[U]){var q=k[U];c.copy(q[0]);l.copy(q[1]);h.copy(q[2]);E.uv=g(p,I,_,O,c,l,h)}E.face=F;E.faceIndex=U;v.push(E)}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function _a(e,t,r,i){var n=new jr(0);var a=0;var o,s;var u;function c(t,i,c,h){var d=i.background;if(null===d)l(n,a);else if(d&&d.isColor){l(d,1);h=true}(e.autoClear||h)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil);if(d&&d.isCubeTexture){if(void 0===u){u=new Ia(new xa(1,1,1),new Na({uniforms:Bn.cube.uniforms,vertexShader:Bn.cube.vertexShader,fragmentShader:Bn.cube.fragmentShader,side:f,depthTest:true,depthWrite:false,fog:false}));u.geometry.removeAttribute("normal");u.geometry.removeAttribute("uv");u.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)};r.update(u.geometry)}u.material.uniforms.tCube.value=d;t.push(u,u.geometry,u.material,0,null)}else if(d&&d.isTexture){if(void 0===o){o=new na(-1,1,1,-1,0,1);s=new Ia(new Ta(2,2),new La({depthTest:false,depthWrite:false,fog:false}));r.update(s.geometry)}s.material.map=d;e.renderBufferDirect(o,null,s.geometry,s.material,s,null)}}function l(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,i)}return{getClearColor:function(){return n},setClearColor:function(e,t){n.set(e);a=void 0!==t?t:1;l(n,a)},getClearAlpha:function(){return a},setClearAlpha:function(e){a=e;l(n,a)},render:c}}function Oa(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ja(e,t){if(e.renderOrder!==t.renderOrder)return e.renderOrder-t.renderOrder;return e.z!==t.z?t.z-e.z:e.id-t.id}function Ra(){var e=[];var t=0;var r=[];var i=[];function n(){t=0;r.length=0;i.length=0}function a(n,a,o,s,u){var c=e[t];if(void 0===c){c={id:n.id,object:n,geometry:a,material:o,program:o.program,renderOrder:n.renderOrder,z:s,group:u};e[t]=c}else{c.id=n.id;c.object=n;c.geometry=a;c.material=o;c.program=o.program;c.renderOrder=n.renderOrder;c.z=s;c.group=u}(true===o.transparent?i:r).push(c);t++}function o(){r.length>1&&r.sort(Oa);i.length>1&&i.sort(ja)}return{opaque:r,transparent:i,init:n,push:a,sort:o}}function za(){var e={};function t(t,r){var i=t.id+","+r.id;var n=e[i];if(void 0===n){n=new Ra;e[i]=n}return n}function r(){e={}}return{get:t,dispose:r}}function ka(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Pa(e){var t={};var r=new Float32Array(8);function i(i,n,a,o){var s=i.morphTargetInfluences;var u=s.length;var c=t[n.id];if(void 0===c){c=[];for(var l=0;l<u;l++)c[l]=[l,0];t[n.id]=c}var h=a.morphTargets&&n.morphAttributes.position;var d=a.morphNormals&&n.morphAttributes.normal;for(var l=0;l<u;l++){var p=c[l];if(0!==p[1]){h&&n.removeAttribute("morphTarget"+l);d&&n.removeAttribute("morphNormal"+l)}}for(var l=0;l<u;l++){var p=c[l];p[0]=l;p[1]=s[l]}c.sort(ka);for(var l=0;l<8;l++){var p=c[l];if(p){var f=p[0];var v=p[1];if(v){h&&n.addAttribute("morphTarget"+l,h[f]);d&&n.addAttribute("morphNormal"+l,d[f]);r[l]=v;continue}}r[l]=0}o.getUniforms().setValue(e,"morphTargetInfluences",r)}return{update:i}}function Ua(e,t,r){var i;function n(e){i=e}var a,o;function s(e){a=e.type;o=e.bytesPerElement}function u(t,n){e.drawElements(i,n,a,t*o);r.calls++;r.vertices+=n;i===e.TRIANGLES?r.faces+=n/3:i===e.POINTS&&(r.points+=n)}function c(n,s,u){var c=t.get("ANGLE_instanced_arrays");if(null===c){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}c.drawElementsInstancedANGLE(i,u,a,s*o,n.maxInstancedCount);r.calls++;r.vertices+=u*n.maxInstancedCount;i===e.TRIANGLES?r.faces+=n.maxInstancedCount*u/3:i===e.POINTS&&(r.points+=n.maxInstancedCount*u)}this.setMode=n;this.setIndex=s;this.render=u;this.renderInstances=c}function Ba(e,t,r){var i;function n(e){i=e}function a(t,n){e.drawArrays(i,t,n);r.calls++;r.vertices+=n;i===e.TRIANGLES?r.faces+=n/3:i===e.POINTS&&(r.points+=n)}function o(n,a,o){var s=t.get("ANGLE_instanced_arrays");if(null===s){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}var u=n.attributes.position;if(u.isInterleavedBufferAttribute){o=u.data.count;s.drawArraysInstancedANGLE(i,0,o,n.maxInstancedCount)}else s.drawArraysInstancedANGLE(i,a,o,n.maxInstancedCount);r.calls++;r.vertices+=o*n.maxInstancedCount;i===e.TRIANGLES?r.faces+=n.maxInstancedCount*o/3:i===e.POINTS&&(r.points+=n.maxInstancedCount*o)}this.setMode=n;this.render=a;this.renderInstances=o}function Fa(e,t,r){var i={};var n={};function a(e){var o=e.target;var s=i[o.id];null!==s.index&&t.remove(s.index);for(var u in s.attributes)t.remove(s.attributes[u]);o.removeEventListener("dispose",a);delete i[o.id];var c=n[o.id];if(c){t.remove(c);delete n[o.id]}c=n[s.id];if(c){t.remove(c);delete n[s.id]}r.geometries--}function o(e,t){var n=i[t.id];if(n)return n;t.addEventListener("dispose",a);if(t.isBufferGeometry)n=t;else if(t.isGeometry){void 0===t._bufferGeometry&&(t._bufferGeometry=(new wa).setFromObject(e));n=t._bufferGeometry}i[t.id]=n;r.geometries++;return n}function s(r){var i=r.index;var n=r.attributes;null!==i&&t.update(i,e.ELEMENT_ARRAY_BUFFER);for(var a in n)t.update(n[a],e.ARRAY_BUFFER);var o=r.morphAttributes;for(var a in o){var s=o[a];for(var u=0,c=s.length;u<c;u++)t.update(s[u],e.ARRAY_BUFFER)}}function u(r){var i=n[r.id];if(i)return i;var a=[];var o=r.index;var s=r.attributes;if(null!==o){var u=o.array;for(var c=0,l=u.length;c<l;c+=3){var h=u[c+0];var d=u[c+1];var p=u[c+2];a.push(h,d,d,p,p,h)}}else{var u=s.position.array;for(var c=0,l=u.length/3-1;c<l;c+=3){var h=c+0;var d=c+1;var p=c+2;a.push(h,d,d,p,p,h)}}i=new(Aa(a)>65535?va:pa)(a,1);t.update(i,e.ELEMENT_ARRAY_BUFFER);n[r.id]=i;return i}return{get:o,update:s,getWireframeAttribute:u}}function Ga(e,t){var r={};function i(i){var n=t.frame;var a=i.geometry;var o=e.get(i,a);if(r[o.id]!==n){a.isGeometry&&o.updateFromObject(i);e.update(o);r[o.id]=n}return o}function n(){r={}}return{update:i,dispose:n}}function Ha(e){var t=e.split("\n");for(var r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}function Va(e,t,r){var i=e.createShader(t);e.shaderSource(i,r);e.compileShader(i);false===e.getShaderParameter(i,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");""!==e.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(i),Ha(r));return i}var Qa=0;function Ya(e){switch(e){case xt:return["Linear","( value )"];case bt:return["sRGB","( value )"];case Lt:return["RGBE","( value )"];case Dt:return["RGBM","( value, 7.0 )"];case Ct:return["RGBM","( value, 16.0 )"];case St:return["RGBD","( value, 256.0 )"];case Tt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Wa(e,t){var r=Ya(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function Xa(e,t){var r=Ya(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function qa(e,t){var r;switch(t){case te:r="Linear";break;case re:r="Reinhard";break;case ie:r="Uncharted2";break;case ne:r="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Za(e,t,r){e=e||{};var i=[e.derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return i.filter($a).join("\n")}function Ja(e){var t=[];for(var r in e){var i=e[r];if(false===i)continue;t.push("#define "+r+" "+i)}return t.join("\n")}function Ka(e,t){var r={};var i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(var n=0;n<i;n++){var a=e.getActiveAttrib(t,n);var o=a.name;r[o]=e.getAttribLocation(t,o)}return r}function $a(e){return""!==e}function eo(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function to(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function ro(e){var t=/^[ \t]*#include +<([\w\d.]+)>/gm;function r(e,t){var r=Un[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return ro(r)}return e.replace(t,r)}function io(e){var t=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function r(e,t,r,i){var n="";for(var a=parseInt(t);a<parseInt(r);a++)n+=i.replace(/\[ i \]/g,"[ "+a+" ]");return n}return e.replace(t,r)}function no(e,t,r,i,n,a){var o=e.context;var s=i.defines;var u=n.vertexShader;var c=n.fragmentShader;var l="SHADOWMAP_TYPE_BASIC";a.shadowMapType===h?l="SHADOWMAP_TYPE_PCF":a.shadowMapType===d&&(l="SHADOWMAP_TYPE_PCF_SOFT");var p="ENVMAP_TYPE_CUBE";var f="ENVMAP_MODE_REFLECTION";var v="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(i.envMap.mapping){case oe:case se:p="ENVMAP_TYPE_CUBE";break;case he:case de:p="ENVMAP_TYPE_CUBE_UV";break;case ue:case ce:p="ENVMAP_TYPE_EQUIREC";break;case le:p="ENVMAP_TYPE_SPHERE";break}switch(i.envMap.mapping){case se:case ce:f="ENVMAP_MODE_REFRACTION";break}switch(i.combine){case J:v="ENVMAP_BLENDING_MULTIPLY";break;case K:v="ENVMAP_BLENDING_MIX";break;case $:v="ENVMAP_BLENDING_ADD";break}}var m=e.gammaFactor>0?e.gammaFactor:1;var g=Za(i.extensions,a,t);var y=Ja(s);var A=o.createProgram();var M,w;if(i.isRawShaderMaterial){M=[y].filter($a).join("\n");M.length>0&&(M+="\n");w=[g,y].filter($a).join("\n");w.length>0&&(w+="\n")}else{M=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+n.name,y,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+f:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&false===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+l:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter($a).join("\n");w=[g,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+n.name,y,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"","#define GAMMA_FACTOR "+m,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+p:"",a.envMap?"#define "+f:"",a.envMap?"#define "+v:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+l:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==ee?"#define TONE_MAPPING":"",a.toneMapping!==ee?Un["tonemapping_pars_fragment"]:"",a.toneMapping!==ee?qa("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.envMapEncoding||a.emissiveMapEncoding?Un["encodings_pars_fragment"]:"",a.mapEncoding?Wa("mapTexelToLinear",a.mapEncoding):"",a.envMapEncoding?Wa("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?Wa("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?Xa("linearToOutputTexel",a.outputEncoding):"",a.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter($a).join("\n")}u=ro(u);u=eo(u,a);u=to(u,a);c=ro(c);c=eo(c,a);c=to(c,a);u=io(u);c=io(c);var E=M+u;var x=w+c;var b=Va(o,o.VERTEX_SHADER,E);var T=Va(o,o.FRAGMENT_SHADER,x);o.attachShader(A,b);o.attachShader(A,T);void 0!==i.index0AttributeName?o.bindAttribLocation(A,0,i.index0AttributeName):true===a.morphTargets&&o.bindAttribLocation(A,0,"position");o.linkProgram(A);var L=o.getProgramInfoLog(A).trim();var N=o.getShaderInfoLog(b).trim();var D=o.getShaderInfoLog(T).trim();var C=true;var S=true;if(false===o.getProgramParameter(A,o.LINK_STATUS)){C=false;console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(A,o.VALIDATE_STATUS),"gl.getProgramInfoLog",L,N,D)}else""!==L?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",L):""!==N&&""!==D||(S=false);S&&(this.diagnostics={runnable:C,material:i,programLog:L,vertexShader:{log:N,prefix:M},fragmentShader:{log:D,prefix:w}});o.deleteShader(b);o.deleteShader(T);var I;this.getUniforms=function(){void 0===I&&(I=new _r(o,A,e));return I};var _;this.getAttributes=function(){void 0===_&&(_=Ka(o,A));return _};this.destroy=function(){o.deleteProgram(A);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.id=Qa++;this.code=r;this.usedTimes=1;this.program=A;this.vertexShader=b;this.fragmentShader=T;return this}function ao(e,t,r){var i=[];var n={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"};var a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function o(e){var t=e.skeleton;var i=t.bones;if(r.floatVertexTextures)return 1024;var n=r.maxVertexUniforms;var a=Math.floor((n-20)/4);var o=Math.min(a,i.length);if(o<i.length){console.warn("THREE.WebGLRenderer: Skeleton has "+i.length+" bones. This GPU supports "+o+".");return 0}return o}function s(e,t){var r;if(e){if(e.isTexture)r=e.encoding;else if(e.isWebGLRenderTarget){console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.");r=e.texture.encoding}}else r=xt;r===xt&&t&&(r=Tt);return r}this.getParameters=function(t,i,a,u,c,l,h){var d=n[t.type];var p=h.isSkinnedMesh?o(h):0;var m=r.precision;if(null!==t.precision){m=r.getMaxPrecision(t.precision);m!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",m,"instead.")}var g=e.getRenderTarget();var y={shaderID:d,precision:m,supportsVertexTextures:r.vertexTextures,outputEncoding:s(g?g.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:s(t.map,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:s(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===he||t.envMap.mapping===de),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:s(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!u,useFog:t.fog,fogExp:u&&u.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:t.skinning&&p>0,maxBones:p,useVertexTexture:r.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numClippingPlanes:c,numClipIntersection:l,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&h.receiveShadow&&a.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===v,flipSided:t.side===f,depthPacking:void 0!==t.depthPacking&&t.depthPacking};return y};this.getProgramCode=function(t,r){var i=[];if(r.shaderID)i.push(r.shaderID);else{i.push(t.fragmentShader);i.push(t.vertexShader)}if(void 0!==t.defines)for(var n in t.defines){i.push(n);i.push(t.defines[n])}for(var o=0;o<a.length;o++)i.push(r[a[o]]);i.push(t.onBeforeCompile.toString());i.push(e.gammaOutput);return i.join()};this.acquireProgram=function(r,n,a,o){var s;for(var u=0,c=i.length;u<c;u++){var l=i[u];if(l.code===o){s=l;++s.usedTimes;break}}if(void 0===s){s=new no(e,t,o,r,n,a);i.push(s)}return s};this.releaseProgram=function(e){if(0===--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1];i.pop();e.destroy()}};this.programs=i}function oo(e,t,r,i,n,a,o,s){var u="undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;var c={};var l;function h(e,t){if(e.width>t||e.height>t){var r=t/Math.max(e.width,e.height);var i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");i.width=Math.floor(e.width*r);i.height=Math.floor(e.height*r);var n=i.getContext("2d");n.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height);console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+i.width+"x"+i.height,e);return i}return e}function d(e){return Ot.isPowerOfTwo(e.width)&&Ot.isPowerOfTwo(e.height)}function p(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap){void 0===l&&(l=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"));l.width=Ot.floorPowerOfTwo(e.width);l.height=Ot.floorPowerOfTwo(e.height);var t=l.getContext("2d");t.drawImage(e,0,0,l.width,l.height);console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+l.width+"x"+l.height,e);return l}return e}function f(e){return e.wrapS!==fe||e.wrapT!==fe||e.minFilter!==me&&e.minFilter!==Ae}function v(e,t){return e.generateMipmaps&&t&&e.minFilter!==me&&e.minFilter!==Ae}function m(t){if(t===me||t===ge||t===ye)return e.NEAREST;return e.LINEAR}function g(e){var t=e.target;t.removeEventListener("dispose",g);A(t);t.isVideoTexture&&delete c[t.id];o.textures--}function y(e){var t=e.target;t.removeEventListener("dispose",y);M(t);o.textures--}function A(t){var r=i.get(t);if(t.image&&r.__image__webglTextureCube)e.deleteTexture(r.__image__webglTextureCube);else{if(void 0===r.__webglInit)return;e.deleteTexture(r.__webglTexture)}i.remove(t)}function M(t){var r=i.get(t);var n=i.get(t.texture);if(!t)return;void 0!==n.__webglTexture&&e.deleteTexture(n.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var a=0;a<6;a++){e.deleteFramebuffer(r.__webglFramebuffer[a]);r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[a])}else{e.deleteFramebuffer(r.__webglFramebuffer);r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer)}i.remove(t.texture);i.remove(t)}function w(t,n){var a=i.get(t);t.isVideoTexture&&_(t);if(t.version>0&&a.__version!==t.version){var o=t.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(false!==o.complete){T(a,t,n);return}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}}r.activeTexture(e.TEXTURE0+n);r.bindTexture(e.TEXTURE_2D,a.__webglTexture)}function E(t,s){var u=i.get(t);if(6===t.image.length)if(t.version>0&&u.__version!==t.version){if(!u.__image__webglTextureCube){t.addEventListener("dispose",g);u.__image__webglTextureCube=e.createTexture();o.textures++}r.activeTexture(e.TEXTURE0+s);r.bindTexture(e.TEXTURE_CUBE_MAP,u.__image__webglTextureCube);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);var c=t&&t.isCompressedTexture;var l=t.image[0]&&t.image[0].isDataTexture;var p=[];for(var f=0;f<6;f++)p[f]=c||l?l?t.image[f].image:t.image[f]:h(t.image[f],n.maxCubemapSize);var m=p[0],y=d(m),A=a.convert(t.format),M=a.convert(t.type);b(e.TEXTURE_CUBE_MAP,t,y);for(var f=0;f<6;f++)if(c){var w,E=p[f].mipmaps;for(var x=0,T=E.length;x<T;x++){w=E[x];t.format!==ze&&t.format!==Re?r.getCompressedTextureFormats().indexOf(A)>-1?r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,x,A,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,x,A,w.width,w.height,0,A,M,w.data)}}else l?r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,A,p[f].width,p[f].height,0,A,M,p[f].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,A,A,M,p[f]);v(t,y)&&e.generateMipmap(e.TEXTURE_CUBE_MAP);u.__version=t.version;t.onUpdate&&t.onUpdate(t)}else{r.activeTexture(e.TEXTURE0+s);r.bindTexture(e.TEXTURE_CUBE_MAP,u.__image__webglTextureCube)}}function x(t,n){r.activeTexture(e.TEXTURE0+n);r.bindTexture(e.TEXTURE_CUBE_MAP,i.get(t).__webglTexture)}function b(r,o,s){var u;if(s){e.texParameteri(r,e.TEXTURE_WRAP_S,a.convert(o.wrapS));e.texParameteri(r,e.TEXTURE_WRAP_T,a.convert(o.wrapT));e.texParameteri(r,e.TEXTURE_MAG_FILTER,a.convert(o.magFilter));e.texParameteri(r,e.TEXTURE_MIN_FILTER,a.convert(o.minFilter))}else{e.texParameteri(r,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(r,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);o.wrapS===fe&&o.wrapT===fe||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",o);e.texParameteri(r,e.TEXTURE_MAG_FILTER,m(o.magFilter));e.texParameteri(r,e.TEXTURE_MIN_FILTER,m(o.minFilter));o.minFilter!==me&&o.minFilter!==Ae&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",o)}u=t.get("EXT_texture_filter_anisotropic");if(u){if(o.type===De&&null===t.get("OES_texture_float_linear"))return;if(o.type===Ce&&null===t.get("OES_texture_half_float_linear"))return;if(o.anisotropy>1||i.get(o).__currentAnisotropy){e.texParameterf(r,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,n.getMaxAnisotropy()));i.get(o).__currentAnisotropy=o.anisotropy}}}function T(t,i,s){if(void 0===t.__webglInit){t.__webglInit=true;i.addEventListener("dispose",g);t.__webglTexture=e.createTexture();o.textures++}r.activeTexture(e.TEXTURE0+s);r.bindTexture(e.TEXTURE_2D,t.__webglTexture);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha);e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment);var c=h(i.image,n.maxTextureSize);f(i)&&false===d(c)&&(c=p(c));var l=d(c),m=a.convert(i.format),y=a.convert(i.type);b(e.TEXTURE_2D,i,l);var A,M=i.mipmaps;if(i.isDepthTexture){var w=e.DEPTH_COMPONENT;if(i.type===De){if(!u)throw new Error("Float Depth Texture only supported in WebGL2.0");w=e.DEPTH_COMPONENT32F}else u&&(w=e.DEPTH_COMPONENT16);if(i.format===Be&&w===e.DEPTH_COMPONENT&&i.type!==Te&&i.type!==Ne){console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.");i.type=Te;y=a.convert(i.type)}if(i.format===Fe){w=e.DEPTH_STENCIL;if(i.type!==Oe){console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.");i.type=Oe;y=a.convert(i.type)}}r.texImage2D(e.TEXTURE_2D,0,w,c.width,c.height,0,m,y,null)}else if(i.isDataTexture)if(M.length>0&&l){for(var E=0,x=M.length;E<x;E++){A=M[E];r.texImage2D(e.TEXTURE_2D,E,m,A.width,A.height,0,m,y,A.data)}i.generateMipmaps=false}else r.texImage2D(e.TEXTURE_2D,0,m,c.width,c.height,0,m,y,c.data);else if(i.isCompressedTexture)for(var E=0,x=M.length;E<x;E++){A=M[E];i.format!==ze&&i.format!==Re?r.getCompressedTextureFormats().indexOf(m)>-1?r.compressedTexImage2D(e.TEXTURE_2D,E,m,A.width,A.height,0,A.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(e.TEXTURE_2D,E,m,A.width,A.height,0,m,y,A.data)}else if(M.length>0&&l){for(var E=0,x=M.length;E<x;E++){A=M[E];r.texImage2D(e.TEXTURE_2D,E,m,m,y,A)}i.generateMipmaps=false}else r.texImage2D(e.TEXTURE_2D,0,m,m,y,c);v(i,l)&&e.generateMipmap(e.TEXTURE_2D);t.__version=i.version;i.onUpdate&&i.onUpdate(i)}function L(t,n,o,s){var u=a.convert(n.texture.format);var c=a.convert(n.texture.type);r.texImage2D(s,0,u,n.width,n.height,0,u,c,null);e.bindFramebuffer(e.FRAMEBUFFER,t);e.framebufferTexture2D(e.FRAMEBUFFER,o,s,i.get(n.texture).__webglTexture,0);e.bindFramebuffer(e.FRAMEBUFFER,null)}function N(t,r){e.bindRenderbuffer(e.RENDERBUFFER,t);if(r.depthBuffer&&!r.stencilBuffer){e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r.width,r.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(r.depthBuffer&&r.stencilBuffer){e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,r.width,r.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,r.width,r.height);e.bindRenderbuffer(e.RENDERBUFFER,null)}function D(t,r){var n=r&&r.isWebGLRenderTargetCube;if(n)throw new Error("Depth Texture with cube render targets is not supported");e.bindFramebuffer(e.FRAMEBUFFER,t);if(!(r.depthTexture&&r.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(!i.get(r.depthTexture).__webglTexture||r.depthTexture.image.width!==r.width||r.depthTexture.image.height!==r.height){r.depthTexture.image.width=r.width;r.depthTexture.image.height=r.height;r.depthTexture.needsUpdate=true}w(r.depthTexture,0);var a=i.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===Be)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else{if(r.depthTexture.format!==Fe)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0)}}function C(t){var r=i.get(t);var n=true===t.isWebGLRenderTargetCube;if(t.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");D(r.__webglFramebuffer,t)}else if(n){r.__webglDepthbuffer=[];for(var a=0;a<6;a++){e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[a]);r.__webglDepthbuffer[a]=e.createRenderbuffer();N(r.__webglDepthbuffer[a],t)}}else{e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer);r.__webglDepthbuffer=e.createRenderbuffer();N(r.__webglDepthbuffer,t)}e.bindFramebuffer(e.FRAMEBUFFER,null)}function S(t){var n=i.get(t);var a=i.get(t.texture);t.addEventListener("dispose",y);a.__webglTexture=e.createTexture();o.textures++;var s=true===t.isWebGLRenderTargetCube;var u=d(t);if(s){n.__webglFramebuffer=[];for(var c=0;c<6;c++)n.__webglFramebuffer[c]=e.createFramebuffer()}else n.__webglFramebuffer=e.createFramebuffer();if(s){r.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture);b(e.TEXTURE_CUBE_MAP,t.texture,u);for(var c=0;c<6;c++)L(n.__webglFramebuffer[c],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+c);v(t.texture,u)&&e.generateMipmap(e.TEXTURE_CUBE_MAP);r.bindTexture(e.TEXTURE_CUBE_MAP,null)}else{r.bindTexture(e.TEXTURE_2D,a.__webglTexture);b(e.TEXTURE_2D,t.texture,u);L(n.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D);v(t.texture,u)&&e.generateMipmap(e.TEXTURE_2D);r.bindTexture(e.TEXTURE_2D,null)}t.depthBuffer&&C(t)}function I(t){var n=t.texture;var a=d(t);if(v(n,a)){var o=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D;var s=i.get(n).__webglTexture;r.bindTexture(o,s);e.generateMipmap(o);r.bindTexture(o,null)}}function _(e){var t=e.id;var r=s.frame;if(c[t]!==r){c[t]=r;e.update()}}this.setTexture2D=w;this.setTextureCube=E;this.setTextureCubeDynamic=x;this.setupRenderTarget=S;this.updateRenderTargetMipmap=I}function so(){var e={};function t(t){var r=t.uuid;var i=e[r];if(void 0===i){i={};e[r]=i}return i}function r(t){delete e[t.uuid]}function i(t,r,i){var n=t.uuid;var a=e[n];a[r]=i}function n(){e={}}return{get:t,remove:r,update:i,dispose:n}}function uo(e,t,r){function i(){var t=false;var r=new Ft;var i=null;var n=new Ft(0,0,0,0);return{setMask:function(r){if(i!==r&&!t){e.colorMask(r,r,r,r);i=r}},setLocked:function(e){t=e},setClear:function(t,i,a,o,s){if(true===s){t*=o;i*=o;a*=o}r.set(t,i,a,o);if(false===n.equals(r)){e.clearColor(t,i,a,o);n.copy(r)}},reset:function(){t=false;i=null;n.set(-1,0,0,0)}}}function s(){var t=false;var r=null;var i=null;var n=null;return{setTest:function(t){t?ue(e.DEPTH_TEST):ce(e.DEPTH_TEST)},setMask:function(i){if(r!==i&&!t){e.depthMask(i);r=i}},setFunc:function(t){if(i!==t){if(t)switch(t){case H:e.depthFunc(e.NEVER);break;case V:e.depthFunc(e.ALWAYS);break;case Q:e.depthFunc(e.LESS);break;case Y:e.depthFunc(e.LEQUAL);break;case W:e.depthFunc(e.EQUAL);break;case X:e.depthFunc(e.GEQUAL);break;case q:e.depthFunc(e.GREATER);break;case Z:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);i=t}},setLocked:function(e){t=e},setClear:function(t){if(n!==t){e.clearDepth(t);n=t}},reset:function(){t=false;r=null;i=null;n=null}}}function u(){var t=false;var r=null;var i=null;var n=null;var a=null;var o=null;var s=null;var u=null;var c=null;return{setTest:function(t){t?ue(e.STENCIL_TEST):ce(e.STENCIL_TEST)},setMask:function(i){if(r!==i&&!t){e.stencilMask(i);r=i}},setFunc:function(t,r,o){if(i!==t||n!==r||a!==o){e.stencilFunc(t,r,o);i=t;n=r;a=o}},setOp:function(t,r,i){if(o!==t||s!==r||u!==i){e.stencilOp(t,r,i);o=t;s=r;u=i}},setLocked:function(e){t=e},setClear:function(t){if(c!==t){e.clearStencil(t);c=t}},reset:function(){t=false;r=null;i=null;n=null;a=null;o=null;s=null;u=null;c=null}}}var c=new i;var l=new s;var h=new u;var d=e.getParameter(e.MAX_VERTEX_ATTRIBS);var p=new Uint8Array(d);var m=new Uint8Array(d);var g=new Uint8Array(d);var y={};var A=null;var M=null;var N=null;var D=null;var C=null;var S=null;var I=null;var _=null;var O=null;var j=false;var R=null;var z=null;var k=null;var P=null;var U=null;var B=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);var F=false;var G=0;var J=e.getParameter(e.VERSION);if(-1!==J.indexOf("WebGL")){G=parseFloat(/^WebGL\ ([0-9])/.exec(J)[1]);F=G>=1}else if(-1!==J.indexOf("OpenGL ES")){G=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(J)[1]);F=G>=2}var K=null;var $={};var ee=new Ft;var te=new Ft;function re(t,r,i){var n=new Uint8Array(4);var a=e.createTexture();e.bindTexture(t,a);e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var o=0;o<i;o++)e.texImage2D(r+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,n);return a}var ie={};ie[e.TEXTURE_2D]=re(e.TEXTURE_2D,e.TEXTURE_2D,1);ie[e.TEXTURE_CUBE_MAP]=re(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6);c.setClear(0,0,0,1);l.setClear(1);h.setClear(0);ue(e.DEPTH_TEST);l.setFunc(Y);fe(false);ve(a);ue(e.CULL_FACE);ue(e.BLEND);de(E);function ne(){for(var e=0,t=p.length;e<t;e++)p[e]=0}function ae(r){p[r]=1;if(0===m[r]){e.enableVertexAttribArray(r);m[r]=1}if(0!==g[r]){var i=t.get("ANGLE_instanced_arrays");i.vertexAttribDivisorANGLE(r,0);g[r]=0}}function oe(r,i){p[r]=1;if(0===m[r]){e.enableVertexAttribArray(r);m[r]=1}if(g[r]!==i){var n=t.get("ANGLE_instanced_arrays");n.vertexAttribDivisorANGLE(r,i);g[r]=i}}function se(){for(var t=0,r=m.length;t!==r;++t)if(m[t]!==p[t]){e.disableVertexAttribArray(t);m[t]=0}}function ue(t){if(true!==y[t]){e.enable(t);y[t]=true}}function ce(t){if(false!==y[t]){e.disable(t);y[t]=false}}function le(){if(null===A){A=[];if(t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")){var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS);for(var i=0;i<r.length;i++)A.push(r[i])}}return A}function he(t){if(M!==t){e.useProgram(t);M=t;return true}return false}function de(t,i,n,a,o,s,u,c){t!==w?ue(e.BLEND):ce(e.BLEND);if(t!==L){if(t!==N||c!==j)switch(t){case x:if(c){e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD);e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)}else{e.blendEquation(e.FUNC_ADD);e.blendFunc(e.SRC_ALPHA,e.ONE)}break;case b:if(c){e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD);e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)}else{e.blendEquation(e.FUNC_ADD);e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)}break;case T:if(c){e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD);e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)}else{e.blendEquation(e.FUNC_ADD);e.blendFunc(e.ZERO,e.SRC_COLOR)}break;default:if(c){e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD);e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)}else{e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD);e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)}}D=null;C=null;S=null;I=null;_=null;O=null}else{o=o||i;s=s||n;u=u||a;if(i!==D||o!==I){e.blendEquationSeparate(r.convert(i),r.convert(o));D=i;I=o}if(n!==C||a!==S||s!==_||u!==O){e.blendFuncSeparate(r.convert(n),r.convert(a),r.convert(s),r.convert(u));C=n;S=a;_=s;O=u}}N=t;j=c}function pe(t,r){t.side===v?ce(e.CULL_FACE):ue(e.CULL_FACE);var i=t.side===f;r&&(i=!i);fe(i);true===t.transparent?de(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):de(w);l.setFunc(t.depthFunc);l.setTest(t.depthTest);l.setMask(t.depthWrite);c.setMask(t.colorWrite);ge(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function fe(t){if(R!==t){t?e.frontFace(e.CW):e.frontFace(e.CCW);R=t}}function ve(t){if(t!==n){ue(e.CULL_FACE);t!==z&&(t===a?e.cullFace(e.BACK):t===o?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))}else ce(e.CULL_FACE);z=t}function me(t){if(t!==k){F&&e.lineWidth(t);k=t}}function ge(t,r,i){if(t){ue(e.POLYGON_OFFSET_FILL);if(P!==r||U!==i){e.polygonOffset(r,i);P=r;U=i}}else ce(e.POLYGON_OFFSET_FILL)}function ye(t){t?ue(e.SCISSOR_TEST):ce(e.SCISSOR_TEST)}function Ae(t){void 0===t&&(t=e.TEXTURE0+B-1);if(K!==t){e.activeTexture(t);K=t}}function Me(t,r){null===K&&Ae();var i=$[K];if(void 0===i){i={type:void 0,texture:void 0};$[K]=i}if(i.type!==t||i.texture!==r){e.bindTexture(t,r||ie[t]);i.type=t;i.texture=r}}function we(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Ee(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function xe(t){if(false===ee.equals(t)){e.scissor(t.x,t.y,t.z,t.w);ee.copy(t)}}function be(t){if(false===te.equals(t)){e.viewport(t.x,t.y,t.z,t.w);te.copy(t)}}function Te(){for(var t=0;t<m.length;t++)if(1===m[t]){e.disableVertexAttribArray(t);m[t]=0}y={};A=null;K=null;$={};M=null;N=null;R=null;z=null;c.reset();l.reset();h.reset()}return{buffers:{color:c,depth:l,stencil:h},initAttributes:ne,enableAttribute:ae,enableAttributeAndDivisor:oe,disableUnusedAttributes:se,enable:ue,disable:ce,getCompressedTextureFormats:le,useProgram:he,setBlending:de,setMaterial:pe,setFlipSided:fe,setCullFace:ve,setLineWidth:me,setPolygonOffset:ge,setScissorTest:ye,activeTexture:Ae,bindTexture:Me,compressedTexImage2D:we,texImage2D:Ee,scissor:xe,viewport:be,reset:Te}}function co(e,t,r){var i;function n(){if(void 0!==i)return i;var r=t.get("EXT_texture_filter_anisotropic");i=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0;return i}function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}if("mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0)return"mediump";return"lowp"}var o=void 0!==r.precision?r.precision:"highp";var s=a(o);if(s!==o){console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead.");o=s}var u=true===r.logarithmicDepthBuffer;var c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);var l=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);var h=e.getParameter(e.MAX_TEXTURE_SIZE);var d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE);var p=e.getParameter(e.MAX_VERTEX_ATTRIBS);var f=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS);var v=e.getParameter(e.MAX_VARYING_VECTORS);var m=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);var g=l>0;var y=!!t.get("OES_texture_float");var A=g&&y;return{getMaxAnisotropy:n,getMaxPrecision:a,precision:o,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:v,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:A}}function lo(e,t,r,i){ia.call(this);this.type="PerspectiveCamera";this.fov=void 0!==e?e:50;this.zoom=1;this.near=void 0!==r?r:.1;this.far=void 0!==i?i:2e3;this.focus=10;this.aspect=void 0!==t?t:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}lo.prototype=Object.assign(Object.create(ia.prototype),{constructor:lo,isPerspectiveCamera:true,copy:function(e,t){ia.prototype.copy.call(this,e,t);this.fov=e.fov;this.zoom=e.zoom;this.near=e.near;this.far=e.far;this.focus=e.focus;this.aspect=e.aspect;this.view=null===e.view?null:Object.assign({},e.view);this.filmGauge=e.filmGauge;this.filmOffset=e.filmOffset;return this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Ot.RAD2DEG*Math.atan(t);this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Ot.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Ot.RAD2DEG*Math.atan(Math.tan(.5*Ot.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,i,n,a){this.aspect=e/t;null===this.view&&(this.view={enabled:true,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=true;this.view.fullWidth=e;this.view.fullHeight=t;this.view.offsetX=r;this.view.offsetY=i;this.view.width=n;this.view.height=a;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=false);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Ot.DEG2RAD*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;n+=a.offsetX*i/o;t-=a.offsetY*r/s;i*=a.width/o;r*=a.height/s}var u=this.filmOffset;0!==u&&(n+=e*u/this.getFilmWidth());this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far)},toJSON:function(e){var t=ra.prototype.toJSON.call(this,e);t.object.fov=this.fov;t.object.zoom=this.zoom;t.object.near=this.near;t.object.far=this.far;t.object.focus=this.focus;t.object.aspect=this.aspect;null!==this.view&&(t.object.view=Object.assign({},this.view));t.object.filmGauge=this.filmGauge;t.object.filmOffset=this.filmOffset;return t}});function ho(e){lo.call(this);this.cameras=e||[]}ho.prototype=Object.assign(Object.create(lo.prototype),{constructor:ho,isArrayCamera:true});function po(e){var t=this;var r=null;var i=null;var n=null;var a=new Rt;var o=new Rt;"undefined"!==typeof window&&"VRFrameData"in window&&(i=new window.VRFrameData);var s=new Rt;var u=new zt;var c=new kt;var l=new lo;l.bounds=new Ft(0,0,.5,1);l.layers.enable(1);var h=new lo;h.bounds=new Ft(.5,0,.5,1);h.layers.enable(2);var d=new ho([l,h]);d.layers.enable(1);d.layers.enable(2);var p,f;function v(){if(null!==r&&r.isPresenting){var i=r.getEyeParameters("left");var n=i.renderWidth;var a=i.renderHeight;f=e.getPixelRatio();p=e.getSize();e.setDrawingBufferSize(2*n,a,1)}else t.enabled&&e.setDrawingBufferSize(p.width,p.height,f)}"undefined"!==typeof window&&window.addEventListener("vrdisplaypresentchange",v,false);this.enabled=false;this.userHeight=1.6;this.getDevice=function(){return r};this.setDevice=function(e){void 0!==e&&(r=e)};this.setPoseTarget=function(e){void 0!==e&&(n=e)};this.getCamera=function(e){if(null===r)return e;r.depthNear=e.near;r.depthFar=e.far;r.getFrameData(i);var p=r.stageParameters;p?a.fromArray(p.sittingToStandingTransform):a.makeTranslation(0,t.userHeight,0);var f=i.pose;var v=null!==n?n:e;v.matrix.copy(a);v.matrix.decompose(v.position,v.quaternion,v.scale);if(null!==f.orientation){u.fromArray(f.orientation);v.quaternion.multiply(u)}if(null!==f.position){u.setFromRotationMatrix(a);c.fromArray(f.position);c.applyQuaternion(u);v.position.add(c)}v.updateMatrixWorld();if(false===r.isPresenting)return e;l.near=e.near;h.near=e.near;l.far=e.far;h.far=e.far;d.matrixWorld.copy(e.matrixWorld);d.matrixWorldInverse.copy(e.matrixWorldInverse);l.matrixWorldInverse.fromArray(i.leftViewMatrix);h.matrixWorldInverse.fromArray(i.rightViewMatrix);o.getInverse(a);l.matrixWorldInverse.multiply(o);h.matrixWorldInverse.multiply(o);var m=v.parent;if(null!==m){s.getInverse(m.matrixWorld);l.matrixWorldInverse.multiply(s);h.matrixWorldInverse.multiply(s)}l.matrixWorld.getInverse(l.matrixWorldInverse);h.matrixWorld.getInverse(h.matrixWorldInverse);l.projectionMatrix.fromArray(i.leftProjectionMatrix);h.projectionMatrix.fromArray(i.rightProjectionMatrix);d.projectionMatrix.copy(l.projectionMatrix);var g=r.getLayers();if(g.length){var y=g[0];null!==y.leftBounds&&4===y.leftBounds.length&&l.bounds.fromArray(y.leftBounds);null!==y.rightBounds&&4===y.rightBounds.length&&h.bounds.fromArray(y.rightBounds)}return d};this.getStandingMatrix=function(){return a};this.submitFrame=function(){r&&r.isPresenting&&r.submitFrame()};this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",v)}}function fo(e){var t={};return{get:function(r){if(void 0!==t[r])return t[r];var i;switch(r){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=e.getExtension("WEBGL_compressed_texture_etc1");break;default:i=e.getExtension(r)}null===i&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported.");t[r]=i;return i}}}function vo(){var e=this,t=null,r=0,i=false,n=false,a=new qn,o=new Pt,s={value:null,needsUpdate:false};this.uniform=s;this.numPlanes=0;this.numIntersection=0;this.init=function(e,n,a){var o=0!==e.length||n||0!==r||i;i=n;t=c(e,a,0);r=e.length;return o};this.beginShadows=function(){n=true;c(null)};this.endShadows=function(){n=false;u()};this.setState=function(e,a,o,l,h,d){if(!i||null===e||0===e.length||n&&!o)n?c(null):u();else{var p=n?0:r,f=4*p,v=h.clippingState||null;s.value=v;v=c(e,l,f,d);for(var m=0;m!==f;++m)v[m]=t[m];h.clippingState=v;this.numIntersection=a?this.numPlanes:0;this.numPlanes+=p}};function u(){if(s.value!==t){s.value=t;s.needsUpdate=r>0}e.numPlanes=r;e.numIntersection=0}function c(t,r,i,n){var u=null!==t?t.length:0,c=null;if(0!==u){c=s.value;if(true!==n||null===c){var l=i+4*u,h=r.matrixWorldInverse;o.getNormalMatrix(h);(null===c||c.length<l)&&(c=new Float32Array(l));for(var d=0,p=i;d!==u;++d,p+=4){a.copy(t[d]).applyMatrix4(h,o);a.normal.toArray(c,p);c[p+3]=a.constant}}s.value=c;s.needsUpdate=true}e.numPlanes=u;return c}}function mo(e,t){function r(r){var i;if(r===pe)return e.REPEAT;if(r===fe)return e.CLAMP_TO_EDGE;if(r===ve)return e.MIRRORED_REPEAT;if(r===me)return e.NEAREST;if(r===ge)return e.NEAREST_MIPMAP_NEAREST;if(r===ye)return e.NEAREST_MIPMAP_LINEAR;if(r===Ae)return e.LINEAR;if(r===Me)return e.LINEAR_MIPMAP_NEAREST;if(r===we)return e.LINEAR_MIPMAP_LINEAR;if(r===Ee)return e.UNSIGNED_BYTE;if(r===Se)return e.UNSIGNED_SHORT_4_4_4_4;if(r===Ie)return e.UNSIGNED_SHORT_5_5_5_1;if(r===_e)return e.UNSIGNED_SHORT_5_6_5;if(r===xe)return e.BYTE;if(r===be)return e.SHORT;if(r===Te)return e.UNSIGNED_SHORT;if(r===Le)return e.INT;if(r===Ne)return e.UNSIGNED_INT;if(r===De)return e.FLOAT;if(r===Ce){i=t.get("OES_texture_half_float");if(null!==i)return i.HALF_FLOAT_OES}if(r===je)return e.ALPHA;if(r===Re)return e.RGB;if(r===ze)return e.RGBA;if(r===ke)return e.LUMINANCE;if(r===Pe)return e.LUMINANCE_ALPHA;if(r===Be)return e.DEPTH_COMPONENT;if(r===Fe)return e.DEPTH_STENCIL;if(r===N)return e.FUNC_ADD;if(r===D)return e.FUNC_SUBTRACT;if(r===C)return e.FUNC_REVERSE_SUBTRACT;if(r===_)return e.ZERO;if(r===O)return e.ONE;if(r===j)return e.SRC_COLOR;if(r===R)return e.ONE_MINUS_SRC_COLOR;if(r===z)return e.SRC_ALPHA;if(r===k)return e.ONE_MINUS_SRC_ALPHA;if(r===P)return e.DST_ALPHA;if(r===U)return e.ONE_MINUS_DST_ALPHA;if(r===B)return e.DST_COLOR;if(r===F)return e.ONE_MINUS_DST_COLOR;if(r===G)return e.SRC_ALPHA_SATURATE;if(r===Ge||r===He||r===Ve||r===Qe){i=t.get("WEBGL_compressed_texture_s3tc");if(null!==i){if(r===Ge)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===He)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===Ve)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Qe)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}}if(r===Ye||r===We||r===Xe||r===qe){i=t.get("WEBGL_compressed_texture_pvrtc");if(null!==i){if(r===Ye)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===We)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Xe)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===qe)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}}if(r===Ze){i=t.get("WEBGL_compressed_texture_etc1");if(null!==i)return i.COMPRESSED_RGB_ETC1_WEBGL}if(r===Je||r===Ke||r===$e||r===et||r===tt||r===rt||r===it||r===nt||r===at||r===ot||r===st||r===ut||r===ct||r===lt){i=t.get("WEBGL_compressed_texture_astc");if(null!==i)return r}if(r===S||r===I){i=t.get("EXT_blend_minmax");if(null!==i){if(r===S)return i.MIN_EXT;if(r===I)return i.MAX_EXT}}if(r===Oe){i=t.get("WEBGL_depth_texture");if(null!==i)return i.UNSIGNED_INT_24_8_WEBGL}return 0}return{convert:r}}function go(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new kt,color:new jr,shadow:false,shadowBias:0,shadowRadius:1,shadowMapSize:new jt};break;case"SpotLight":r={position:new kt,direction:new kt,color:new jr,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:false,shadowBias:0,shadowRadius:1,shadowMapSize:new jt};break;case"PointLight":r={position:new kt,color:new jr,distance:0,decay:0,shadow:false,shadowBias:0,shadowRadius:1,shadowMapSize:new jt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new kt,skyColor:new jr,groundColor:new jr};break;case"RectAreaLight":r={color:new jr,position:new kt,halfWidth:new kt,halfHeight:new kt};break}e[t.id]=r;return r}}}var yo=0;function Ao(){var e=new go;var t={id:yo++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};var r=new kt;var i=new Rt;var n=new Rt;function a(a,o,s){var u=0,c=0,l=0;var h=0;var d=0;var p=0;var f=0;var v=0;var m=s.matrixWorldInverse;for(var g=0,y=a.length;g<y;g++){var A=a[g];var M=A.color;var w=A.intensity;var E=A.distance;var x=A.shadow&&A.shadow.map?A.shadow.map.texture:null;if(A.isAmbientLight){u+=M.r*w;c+=M.g*w;l+=M.b*w}else if(A.isDirectionalLight){var b=e.get(A);b.color.copy(A.color).multiplyScalar(A.intensity);b.direction.setFromMatrixPosition(A.matrixWorld);r.setFromMatrixPosition(A.target.matrixWorld);b.direction.sub(r);b.direction.transformDirection(m);b.shadow=A.castShadow;if(A.castShadow){var T=A.shadow;b.shadowBias=T.bias;b.shadowRadius=T.radius;b.shadowMapSize=T.mapSize}t.directionalShadowMap[h]=x;t.directionalShadowMatrix[h]=A.shadow.matrix;t.directional[h]=b;h++}else if(A.isSpotLight){var b=e.get(A);b.position.setFromMatrixPosition(A.matrixWorld);b.position.applyMatrix4(m);b.color.copy(M).multiplyScalar(w);b.distance=E;b.direction.setFromMatrixPosition(A.matrixWorld);r.setFromMatrixPosition(A.target.matrixWorld);b.direction.sub(r);b.direction.transformDirection(m);b.coneCos=Math.cos(A.angle);b.penumbraCos=Math.cos(A.angle*(1-A.penumbra));b.decay=0===A.distance?0:A.decay;b.shadow=A.castShadow;if(A.castShadow){var T=A.shadow;b.shadowBias=T.bias;b.shadowRadius=T.radius;b.shadowMapSize=T.mapSize}t.spotShadowMap[p]=x;t.spotShadowMatrix[p]=A.shadow.matrix;t.spot[p]=b;p++}else if(A.isRectAreaLight){var b=e.get(A);b.color.copy(M).multiplyScalar(w);b.position.setFromMatrixPosition(A.matrixWorld);b.position.applyMatrix4(m);n.identity();i.copy(A.matrixWorld);i.premultiply(m);n.extractRotation(i);b.halfWidth.set(.5*A.width,0,0);b.halfHeight.set(0,.5*A.height,0);b.halfWidth.applyMatrix4(n);b.halfHeight.applyMatrix4(n);t.rectArea[f]=b;f++}else if(A.isPointLight){var b=e.get(A);b.position.setFromMatrixPosition(A.matrixWorld);b.position.applyMatrix4(m);b.color.copy(A.color).multiplyScalar(A.intensity);b.distance=A.distance;b.decay=0===A.distance?0:A.decay;b.shadow=A.castShadow;if(A.castShadow){var T=A.shadow;b.shadowBias=T.bias;b.shadowRadius=T.radius;b.shadowMapSize=T.mapSize;b.shadowCameraNear=T.camera.near;b.shadowCameraFar=T.camera.far}t.pointShadowMap[d]=x;t.pointShadowMatrix[d]=A.shadow.matrix;t.point[d]=b;d++}else if(A.isHemisphereLight){var b=e.get(A);b.direction.setFromMatrixPosition(A.matrixWorld);b.direction.transformDirection(m);b.direction.normalize();b.skyColor.copy(A.color).multiplyScalar(w);b.groundColor.copy(A.groundColor).multiplyScalar(w);t.hemi[v]=b;v++}}t.ambient[0]=u;t.ambient[1]=c;t.ambient[2]=l;t.directional.length=h;t.spot.length=p;t.rectArea.length=f;t.point.length=d;t.hemi.length=v;t.hash=t.id+","+h+","+d+","+p+","+f+","+v+","+o.length}return{setup:a,state:t}}function Mo(){var e=new Ao;var t=[];var r=[];var i=[];function n(){t.length=0;r.length=0;i.length=0}function a(e){t.push(e)}function o(e){r.push(e)}function s(e){i.push(e)}function u(i){e.setup(t,r,i)}var c={lightsArray:t,shadowsArray:r,spritesArray:i,lights:e};return{init:n,state:c,setupLights:u,pushLight:a,pushShadow:o,pushSprite:s}}function wo(){var e={};function t(t,r){var i=t.id+","+r.id;var n=e[i];if(void 0===n){n=new Mo;e[i]=n}return n}function r(){e={}}return{get:t,dispose:r}}function Eo(e){console.log("THREE.WebGLRenderer",r);e=e||{};var t=void 0!==e.canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,a=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,u=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default";var h=null;var d=null;this.domElement=t;this.context=null;this.autoClear=true;this.autoClearColor=true;this.autoClearDepth=true;this.autoClearStencil=true;this.sortObjects=true;this.clippingPlanes=[];this.localClippingEnabled=false;this.gammaFactor=2;this.gammaInput=false;this.gammaOutput=false;this.physicallyCorrectLights=false;this.toneMapping=te;this.toneMappingExposure=1;this.toneMappingWhitePoint=1;this.maxMorphTargets=8;this.maxMorphNormals=4;var p=this,f=false,v=null,m=null,g=-1,A="",M=null,w=null,E=new Ft,x=new Ft,b=null,T=0,L=t.width,N=t.height,D=1,C=new Ft(0,0,L,N),S=new Ft(0,0,L,N),I=false,_=new Zn,O=new vo,j=false,R=false,z=new Rt,k=new kt,P={geometries:0,textures:0},U={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:U,memory:P,programs:null,autoReset:true,reset:B};function B(){U.frame++;U.calls=0;U.vertices=0;U.faces=0;U.points=0}function F(){return null===v?D:1}var G;try{var H={alpha:n,depth:a,stencil:o,antialias:s,premultipliedAlpha:u,preserveDrawingBuffer:c,powerPreference:l};t.addEventListener("webglcontextlost",he,false);t.addEventListener("webglcontextrestored",de,false);G=i||t.getContext("webgl",H)||t.getContext("experimental-webgl",H);if(null===G)throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===G.getShaderPrecisionFormat&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("THREE.WebGLRenderer: "+e.message)}var V,Q,Y;var W,X,q,Z,J;var K,$,ee;var re,ie,ne,ae;var oe;var se;function ue(){V=new fo(G);V.get("WEBGL_depth_texture");V.get("OES_texture_float");V.get("OES_texture_float_linear");V.get("OES_texture_half_float");V.get("OES_texture_half_float_linear");V.get("OES_standard_derivatives");V.get("OES_element_index_uint");V.get("ANGLE_instanced_arrays");se=new mo(G,V);Q=new co(G,V,e);Y=new uo(G,V,se);Y.scissor(x.copy(S).multiplyScalar(D));Y.viewport(E.copy(C).multiplyScalar(D));W=new so;X=new oo(G,V,Y,W,Q,se,P,U);q=new Kn(G);Z=new Fa(G,q,P);J=new Ga(Z,U);ie=new Pa(G);K=new ao(p,V,Q);$=new za;ee=new wo;re=new _a(p,Y,Z,u);ne=new Ba(G,V,U);ae=new Ua(G,V,U);oe=new Gn(p,G,Y,X,Q);p.info.programs=K.programs;p.context=G;p.capabilities=Q;p.extensions=V;p.properties=W;p.renderLists=$;p.state=Y}ue();var ce=new po(p);this.vr=ce;var le=new Jn(p,J,Q.maxTextureSize);this.shadowMap=le;this.getContext=function(){return G};this.getContextAttributes=function(){return G.getContextAttributes()};this.forceContextLoss=function(){var e=V.get("WEBGL_lose_context");e&&e.loseContext()};this.forceContextRestore=function(){var e=V.get("WEBGL_lose_context");e&&e.restoreContext()};this.getPixelRatio=function(){return D};this.setPixelRatio=function(e){if(void 0===e)return;D=e;this.setSize(L,N,false)};this.getSize=function(){return{width:L,height:N}};this.setSize=function(e,r,i){var n=ce.getDevice();if(n&&n.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}L=e;N=r;t.width=e*D;t.height=r*D;if(false!==i){t.style.width=e+"px";t.style.height=r+"px"}this.setViewport(0,0,e,r)};this.getDrawingBufferSize=function(){return{width:L*D,height:N*D}};this.setDrawingBufferSize=function(e,r,i){L=e;N=r;D=i;t.width=e*i;t.height=r*i;this.setViewport(0,0,e,r)};this.getCurrentViewport=function(){return E};this.setViewport=function(e,t,r,i){C.set(e,N-t-i,r,i);Y.viewport(E.copy(C).multiplyScalar(D))};this.setScissor=function(e,t,r,i){S.set(e,N-t-i,r,i);Y.scissor(x.copy(S).multiplyScalar(D))};this.setScissorTest=function(e){Y.setScissorTest(I=e)};this.getClearColor=function(){return re.getClearColor()};this.setClearColor=function(){re.setClearColor.apply(re,arguments)};this.getClearAlpha=function(){return re.getClearAlpha()};this.setClearAlpha=function(){re.setClearAlpha.apply(re,arguments)};this.clear=function(e,t,r){var i=0;(void 0===e||e)&&(i|=G.COLOR_BUFFER_BIT);(void 0===t||t)&&(i|=G.DEPTH_BUFFER_BIT);(void 0===r||r)&&(i|=G.STENCIL_BUFFER_BIT);G.clear(i)};this.clearColor=function(){this.clear(true,false,false)};this.clearDepth=function(){this.clear(false,true,false)};this.clearStencil=function(){this.clear(false,false,true)};this.clearTarget=function(e,t,r,i){this.setRenderTarget(e);this.clear(t,r,i)};this.dispose=function(){t.removeEventListener("webglcontextlost",he,false);t.removeEventListener("webglcontextrestored",de,false);$.dispose();ee.dispose();W.dispose();J.dispose();ce.dispose();we()};function he(e){e.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");f=true}function de(){console.log("THREE.WebGLRenderer: Context Restored.");f=false;ue()}function pe(e){var t=e.target;t.removeEventListener("dispose",pe);fe(t)}function fe(e){ve(e);W.remove(e)}function ve(e){var t=W.get(e).program;e.program=void 0;void 0!==t&&K.releaseProgram(t)}function me(e,t,r){e.render(function(e){p.renderBufferImmediate(e,t,r)})}this.renderBufferImmediate=function(e,t,r){Y.initAttributes();var i=W.get(e);e.hasPositions&&!i.position&&(i.position=G.createBuffer());e.hasNormals&&!i.normal&&(i.normal=G.createBuffer());e.hasUvs&&!i.uv&&(i.uv=G.createBuffer());e.hasColors&&!i.color&&(i.color=G.createBuffer());var n=t.getAttributes();if(e.hasPositions){G.bindBuffer(G.ARRAY_BUFFER,i.position);G.bufferData(G.ARRAY_BUFFER,e.positionArray,G.DYNAMIC_DRAW);Y.enableAttribute(n.position);G.vertexAttribPointer(n.position,3,G.FLOAT,false,0,0)}if(e.hasNormals){G.bindBuffer(G.ARRAY_BUFFER,i.normal);if(!r.isMeshPhongMaterial&&!r.isMeshStandardMaterial&&!r.isMeshNormalMaterial&&true===r.flatShading)for(var a=0,o=3*e.count;a<o;a+=9){var s=e.normalArray;var u=(s[a+0]+s[a+3]+s[a+6])/3;var c=(s[a+1]+s[a+4]+s[a+7])/3;var l=(s[a+2]+s[a+5]+s[a+8])/3;s[a+0]=u;s[a+1]=c;s[a+2]=l;s[a+3]=u;s[a+4]=c;s[a+5]=l;s[a+6]=u;s[a+7]=c;s[a+8]=l}G.bufferData(G.ARRAY_BUFFER,e.normalArray,G.DYNAMIC_DRAW);Y.enableAttribute(n.normal);G.vertexAttribPointer(n.normal,3,G.FLOAT,false,0,0)}if(e.hasUvs&&r.map){G.bindBuffer(G.ARRAY_BUFFER,i.uv);G.bufferData(G.ARRAY_BUFFER,e.uvArray,G.DYNAMIC_DRAW);Y.enableAttribute(n.uv);G.vertexAttribPointer(n.uv,2,G.FLOAT,false,0,0)}if(e.hasColors&&r.vertexColors!==y){G.bindBuffer(G.ARRAY_BUFFER,i.color);G.bufferData(G.ARRAY_BUFFER,e.colorArray,G.DYNAMIC_DRAW);Y.enableAttribute(n.color);G.vertexAttribPointer(n.color,3,G.FLOAT,false,0,0)}Y.disableUnusedAttributes();G.drawArrays(G.TRIANGLES,0,e.count);e.count=0};this.renderBufferDirect=function(e,t,r,i,n,a){var o=n.isMesh&&n.matrixWorld.determinant()<0;Y.setMaterial(i,o);var s=Ie(e,t,i,n);var u=r.id+"_"+s.id+"_"+(true===i.wireframe);var c=false;if(u!==A){A=u;c=true}if(n.morphTargetInfluences){ie.update(n,r,i,s);c=true}var l=r.index;var h=r.attributes.position;var d=1;if(true===i.wireframe){l=Z.getWireframeAttribute(r);d=2}var p;var f=ne;if(null!==l){p=q.get(l);f=ae;f.setIndex(p)}if(c){ge(i,s,r);null!==l&&G.bindBuffer(G.ELEMENT_ARRAY_BUFFER,p.buffer)}var v=Infinity;null!==l?v=l.count:void 0!==h&&(v=h.count);var m=r.drawRange.start*d;var g=r.drawRange.count*d;var y=null!==a?a.start*d:0;var M=null!==a?a.count*d:Infinity;var w=Math.max(m,y);var E=Math.min(v,m+g,y+M)-1;var x=Math.max(0,E-w+1);if(0===x)return;if(n.isMesh)if(true===i.wireframe){Y.setLineWidth(i.wireframeLinewidth*F());f.setMode(G.LINES)}else switch(n.drawMode){case Mt:f.setMode(G.TRIANGLES);break;case wt:f.setMode(G.TRIANGLE_STRIP);break;case Et:f.setMode(G.TRIANGLE_FAN);break}else if(n.isLine){var b=i.linewidth;void 0===b&&(b=1);Y.setLineWidth(b*F());n.isLineSegments?f.setMode(G.LINES):n.isLineLoop?f.setMode(G.LINE_LOOP):f.setMode(G.LINE_STRIP)}else n.isPoints&&f.setMode(G.POINTS);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&f.renderInstances(r,w,x):f.render(w,x)};function ge(e,t,r,i){if(r&&r.isInstancedBufferGeometry&&null===V.get("ANGLE_instanced_arrays")){console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}void 0===i&&(i=0);Y.initAttributes();var n=r.attributes;var a=t.getAttributes();var o=e.defaultAttributeValues;for(var s in a){var u=a[s];if(u>=0){var c=n[s];if(void 0!==c){var l=c.normalized;var h=c.itemSize;var d=q.get(c);if(void 0===d)continue;var p=d.buffer;var f=d.type;var v=d.bytesPerElement;if(c.isInterleavedBufferAttribute){var m=c.data;var g=m.stride;var y=c.offset;if(m&&m.isInstancedInterleavedBuffer){Y.enableAttributeAndDivisor(u,m.meshPerAttribute);void 0===r.maxInstancedCount&&(r.maxInstancedCount=m.meshPerAttribute*m.count)}else Y.enableAttribute(u);G.bindBuffer(G.ARRAY_BUFFER,p);G.vertexAttribPointer(u,h,f,l,g*v,(i*g+y)*v)}else{if(c.isInstancedBufferAttribute){Y.enableAttributeAndDivisor(u,c.meshPerAttribute);void 0===r.maxInstancedCount&&(r.maxInstancedCount=c.meshPerAttribute*c.count)}else Y.enableAttribute(u);G.bindBuffer(G.ARRAY_BUFFER,p);G.vertexAttribPointer(u,h,f,l,0,i*h*v)}}else if(void 0!==o){var A=o[s];if(void 0!==A)switch(A.length){case 2:G.vertexAttrib2fv(u,A);break;case 3:G.vertexAttrib3fv(u,A);break;case 4:G.vertexAttrib4fv(u,A);break;default:G.vertexAttrib1fv(u,A)}}}}Y.disableUnusedAttributes()}this.compile=function(e,t){d=ee.get(e,t);d.init();e.traverse(function(e){if(e.isLight){d.pushLight(e);e.castShadow&&d.pushShadow(e)}});d.setupLights(t);e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)Se(t.material[r],e.fog,t);else Se(t.material,e.fog,t)})};var ye=false;var Ae=null;function Me(){if(ye)return;xe();ye=true}function we(){ye=false}function xe(){var e=ce.getDevice();e&&e.isPresenting?e.requestAnimationFrame(be):window.requestAnimationFrame(be)}function be(e){if(false===ye)return;Ae(e);xe()}this.animate=function(e){Ae=e;null!==Ae?Me():we()};this.render=function(e,t,r,i){if(!(t&&t.isCamera)){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(f)return;A="";g=-1;M=null;true===e.autoUpdate&&e.updateMatrixWorld();null===t.parent&&t.updateMatrixWorld();ce.enabled&&(t=ce.getCamera(t));d=ee.get(e,t);d.init();e.onBeforeRender(p,e,t,r);z.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);_.setFromMatrix(z);R=this.localClippingEnabled;j=O.init(this.clippingPlanes,R,t);h=$.get(e,t);h.init();Te(e,t,p.sortObjects);true===p.sortObjects&&h.sort();j&&O.beginShadows();var n=d.state.shadowsArray;le.render(n,e,t);d.setupLights(t);j&&O.endShadows();this.info.autoReset&&this.info.reset();void 0===r&&(r=null);this.setRenderTarget(r);re.render(h,e,t,i);var a=h.opaque;var o=h.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;a.length&&Le(a,e,t,s);o.length&&Le(o,e,t,s)}else{a.length&&Le(a,e,t);o.length&&Le(o,e,t)}var u=d.state.spritesArray;oe.render(u,e,t);r&&X.updateRenderTargetMipmap(r);Y.buffers.depth.setTest(true);Y.buffers.depth.setMask(true);Y.buffers.color.setMask(true);Y.setPolygonOffset(false);e.onAfterRender(p,e,t);ce.enabled&&ce.submitFrame();h=null;d=null};function Te(e,t,r){if(false===e.visible)return;var i=e.layers.test(t.layers);if(i)if(e.isLight){d.pushLight(e);e.castShadow&&d.pushShadow(e)}else if(e.isSprite)e.frustumCulled&&!_.intersectsSprite(e)||d.pushSprite(e);else if(e.isImmediateRenderObject){r&&k.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);h.push(e,null,e.material,k.z,null)}else if(e.isMesh||e.isLine||e.isPoints){e.isSkinnedMesh&&e.skeleton.update();if(!e.frustumCulled||_.intersectsObject(e)){r&&k.setFromMatrixPosition(e.matrixWorld).applyMatrix4(z);var n=J.update(e);var a=e.material;if(Array.isArray(a)){var o=n.groups;for(var s=0,u=o.length;s<u;s++){var c=o[s];var l=a[c.materialIndex];l&&l.visible&&h.push(e,n,l,k.z,c)}}else a.visible&&h.push(e,n,a,k.z,null)}}var p=e.children;for(var s=0,u=p.length;s<u;s++)Te(p[s],t,r)}function Le(e,t,r,i){for(var n=0,a=e.length;n<a;n++){var o=e[n];var s=o.object;var u=o.geometry;var c=void 0===i?o.material:i;var l=o.group;if(r.isArrayCamera){w=r;var h=r.cameras;for(var d=0,p=h.length;d<p;d++){var f=h[d];if(s.layers.test(f.layers)){var v=f.bounds;var m=v.x*L;var g=v.y*N;var y=v.z*L;var A=v.w*N;Y.viewport(E.set(m,g,y,A).multiplyScalar(D));Ne(s,t,f,u,c,l)}}}else{w=null;Ne(s,t,r,u,c,l)}}}function Ne(e,t,r,i,n,a){e.onBeforeRender(p,t,r,i,n,a);d=ee.get(t,w||r);e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld);e.normalMatrix.getNormalMatrix(e.modelViewMatrix);if(e.isImmediateRenderObject){var o=e.isMesh&&e.matrixWorld.determinant()<0;Y.setMaterial(n,o);var s=Ie(r,t.fog,n,e);A="";me(e,s,n)}else p.renderBufferDirect(r,t.fog,i,n,e,a);e.onAfterRender(p,t,r,i,n,a);d=ee.get(t,w||r)}function Se(e,t,r){var i=W.get(e);var n=d.state.lights;var a=d.state.shadowsArray;var o=K.getParameters(e,n.state,a,t,O.numPlanes,O.numIntersection,r);var s=K.getProgramCode(e,o);var u=i.program;var c=true;if(void 0===u)e.addEventListener("dispose",pe);else if(u.code!==s)ve(e);else if(i.lightsHash!==n.state.hash){W.update(e,"lightsHash",n.state.hash);c=false}else{if(void 0!==o.shaderID)return;c=false}if(c){if(o.shaderID){var l=Bn[o.shaderID];i.shader={name:e.type,uniforms:zr.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else i.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(i.shader);u=K.acquireProgram(e,i.shader,o,s);i.program=u;e.program=u}var h=u.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var f=0;f<p.maxMorphTargets;f++)h["morphTarget"+f]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(var f=0;f<p.maxMorphNormals;f++)h["morphNormal"+f]>=0&&e.numSupportedMorphNormals++}var v=i.shader.uniforms;if(!e.isShaderMaterial&&!e.isRawShaderMaterial||true===e.clipping){i.numClippingPlanes=O.numPlanes;i.numIntersection=O.numIntersection;v.clippingPlanes=O.uniform}i.fog=t;i.lightsHash=n.state.hash;if(e.lights){v.ambientLightColor.value=n.state.ambient;v.directionalLights.value=n.state.directional;v.spotLights.value=n.state.spot;v.rectAreaLights.value=n.state.rectArea;v.pointLights.value=n.state.point;v.hemisphereLights.value=n.state.hemi;v.directionalShadowMap.value=n.state.directionalShadowMap;v.directionalShadowMatrix.value=n.state.directionalShadowMatrix;v.spotShadowMap.value=n.state.spotShadowMap;v.spotShadowMatrix.value=n.state.spotShadowMatrix;v.pointShadowMap.value=n.state.pointShadowMap;v.pointShadowMatrix.value=n.state.pointShadowMatrix}var m=i.program.getUniforms(),g=_r.seqWithValue(m.seq,v);i.uniformsList=g}function Ie(e,t,r,i){T=0;var n=W.get(r);var a=d.state.lights;if(j&&(R||e!==M)){var o=e===M&&r.id===g;O.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,n,o)}false===r.needsUpdate&&(void 0===n.program?r.needsUpdate=true:r.fog&&n.fog!==t?r.needsUpdate=true:r.lights&&n.lightsHash!==a.state.hash?r.needsUpdate=true:void 0===n.numClippingPlanes||n.numClippingPlanes===O.numPlanes&&n.numIntersection===O.numIntersection||(r.needsUpdate=true));if(r.needsUpdate){Se(r,t,i);r.needsUpdate=false}var s=false;var u=false;var c=false;var l=n.program,h=l.getUniforms(),f=n.shader.uniforms;if(Y.useProgram(l.program)){s=true;u=true;c=true}if(r.id!==g){g=r.id;u=true}if(s||e!==M){h.setValue(G,"projectionMatrix",e.projectionMatrix);Q.logarithmicDepthBuffer&&h.setValue(G,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2));if(M!==(w||e)){M=w||e;u=true;c=true}if(r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var v=h.map.cameraPosition;void 0!==v&&v.setValue(G,k.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&h.setValue(G,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){h.setOptional(G,i,"bindMatrix");h.setOptional(G,i,"bindMatrixInverse");var m=i.skeleton;if(m){var y=m.bones;if(Q.floatVertexTextures){if(void 0===m.boneTexture){var A=Math.sqrt(4*y.length);A=Ot.ceilPowerOfTwo(A);A=Math.max(A,4);var E=new Float32Array(A*A*4);E.set(m.boneMatrices);var x=new Vt(E,A,A,ze,De);x.needsUpdate=true;m.boneMatrices=E;m.boneTexture=x;m.boneTextureSize=A}h.setValue(G,"boneTexture",m.boneTexture);h.setValue(G,"boneTextureSize",m.boneTextureSize)}else h.setOptional(G,m,"boneMatrices")}}if(u){h.setValue(G,"toneMappingExposure",p.toneMappingExposure);h.setValue(G,"toneMappingWhitePoint",p.toneMappingWhitePoint);r.lights&&Ye(f,c);t&&r.fog&&ke(f,t);if(r.isMeshBasicMaterial)_e(f,r);else if(r.isMeshLambertMaterial){_e(f,r);Pe(f,r)}else if(r.isMeshPhongMaterial){_e(f,r);r.isMeshToonMaterial?Be(f,r):Ue(f,r)}else if(r.isMeshStandardMaterial){_e(f,r);r.isMeshPhysicalMaterial?Ge(f,r):Fe(f,r)}else if(r.isMeshDepthMaterial){_e(f,r);He(f,r)}else if(r.isMeshDistanceMaterial){_e(f,r);Ve(f,r)}else if(r.isMeshNormalMaterial){_e(f,r);Qe(f,r)}else if(r.isLineBasicMaterial){Oe(f,r);r.isLineDashedMaterial&&je(f,r)}else if(r.isPointsMaterial)Re(f,r);else if(r.isShadowMaterial){f.color.value=r.color;f.opacity.value=r.opacity}void 0!==f.ltc_1&&(f.ltc_1.value=Rr.LTC_1);void 0!==f.ltc_2&&(f.ltc_2.value=Rr.LTC_2);_r.upload(G,n.uniformsList,f,p)}if(r.isShaderMaterial&&true===r.uniformsNeedUpdate){_r.upload(G,n.uniformsList,f,p);r.uniformsNeedUpdate=false}h.setValue(G,"modelViewMatrix",i.modelViewMatrix);h.setValue(G,"normalMatrix",i.normalMatrix);h.setValue(G,"modelMatrix",i.matrixWorld);return l}function _e(e,t){e.opacity.value=t.opacity;t.color&&(e.diffuse.value=t.color);t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity);t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.specularMap&&(e.specularMap.value=t.specularMap);if(t.envMap){e.envMap.value=t.envMap;e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1;e.reflectivity.value=t.reflectivity;e.refractionRatio.value=t.refractionRatio}if(t.lightMap){e.lightMap.value=t.lightMap;e.lightMapIntensity.value=t.lightMapIntensity}if(t.aoMap){e.aoMap.value=t.aoMap;e.aoMapIntensity.value=t.aoMapIntensity}var r;t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap);if(void 0!==r){r.isWebGLRenderTarget&&(r=r.texture);if(true===r.matrixAutoUpdate){var i=r.offset;var n=r.repeat;var a=r.rotation;var o=r.center;r.matrix.setUvTransform(i.x,i.y,n.x,n.y,a,o.x,o.y)}e.uvTransform.value.copy(r.matrix)}}function Oe(e,t){e.diffuse.value=t.color;e.opacity.value=t.opacity}function je(e,t){e.dashSize.value=t.dashSize;e.totalSize.value=t.dashSize+t.gapSize;e.scale.value=t.scale}function Re(e,t){e.diffuse.value=t.color;e.opacity.value=t.opacity;e.size.value=t.size*D;e.scale.value=.5*N;e.map.value=t.map;if(null!==t.map){if(true===t.map.matrixAutoUpdate){var r=t.map.offset;var i=t.map.repeat;var n=t.map.rotation;var a=t.map.center;t.map.matrix.setUvTransform(r.x,r.y,i.x,i.y,n,a.x,a.y)}e.uvTransform.value.copy(t.map.matrix)}}function ke(e,t){e.fogColor.value=t.color;if(t.isFog){e.fogNear.value=t.near;e.fogFar.value=t.far}else t.isFogExp2&&(e.fogDensity.value=t.density)}function Pe(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}function Ue(e,t){e.specular.value=t.specular;e.shininess.value=Math.max(t.shininess,1e-4);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale)}if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}}function Be(e,t){Ue(e,t);t.gradientMap&&(e.gradientMap.value=t.gradientMap)}function Fe(e,t){e.roughness.value=t.roughness;e.metalness.value=t.metalness;t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap);t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale)}if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function Ge(e,t){e.clearCoat.value=t.clearCoat;e.clearCoatRoughness.value=t.clearCoatRoughness;Fe(e,t)}function He(e,t){if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}}function Ve(e,t){if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}e.referencePosition.value.copy(t.referencePosition);e.nearDistance.value=t.nearDistance;e.farDistance.value=t.farDistance}function Qe(e,t){if(t.bumpMap){e.bumpMap.value=t.bumpMap;e.bumpScale.value=t.bumpScale}if(t.normalMap){e.normalMap.value=t.normalMap;e.normalScale.value.copy(t.normalScale)}if(t.displacementMap){e.displacementMap.value=t.displacementMap;e.displacementScale.value=t.displacementScale;e.displacementBias.value=t.displacementBias}}function Ye(e,t){e.ambientLightColor.needsUpdate=t;e.directionalLights.needsUpdate=t;e.pointLights.needsUpdate=t;e.spotLights.needsUpdate=t;e.rectAreaLights.needsUpdate=t;e.hemisphereLights.needsUpdate=t}function We(){var e=T;e>=Q.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+Q.maxTextures);T+=1;return e}this.allocTextureUnit=We;this.setTexture2D=function(){var e=false;return function t(r,i){if(r&&r.isWebGLRenderTarget){if(!e){console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead.");e=true}r=r.texture}X.setTexture2D(r,i)}}();this.setTexture=function(){var e=false;return function t(r,i){if(!e){console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.");e=true}X.setTexture2D(r,i)}}();this.setTextureCube=function(){var e=false;return function t(r,i){if(r&&r.isWebGLRenderTargetCube){if(!e){console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead.");e=true}r=r.texture}r&&r.isCubeTexture||Array.isArray(r.image)&&6===r.image.length?X.setTextureCube(r,i):X.setTextureCubeDynamic(r,i)}}();this.getRenderTarget=function(){return v};this.setRenderTarget=function(e){v=e;e&&void 0===W.get(e).__webglFramebuffer&&X.setupRenderTarget(e);var t=null;var r=false;if(e){var i=W.get(e).__webglFramebuffer;if(e.isWebGLRenderTargetCube){t=i[e.activeCubeFace];r=true}else t=i;E.copy(e.viewport);x.copy(e.scissor);b=e.scissorTest}else{E.copy(C).multiplyScalar(D);x.copy(S).multiplyScalar(D);b=I}if(m!==t){G.bindFramebuffer(G.FRAMEBUFFER,t);m=t}Y.viewport(E);Y.scissor(x);Y.setScissorTest(b);if(r){var n=W.get(e.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,n.__webglTexture,e.activeMipMapLevel)}};this.readRenderTargetPixels=function(e,t,r,i,n,a){if(!(e&&e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var o=W.get(e).__webglFramebuffer;if(o){var s=false;if(o!==m){G.bindFramebuffer(G.FRAMEBUFFER,o);s=true}try{var u=e.texture;var c=u.format;var l=u.type;if(c!==ze&&se.convert(c)!==G.getParameter(G.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(l!==Ee&&se.convert(l)!==G.getParameter(G.IMPLEMENTATION_COLOR_READ_TYPE)&&!(l===De&&(V.get("OES_texture_float")||V.get("WEBGL_color_buffer_float")))&&!(l===Ce&&V.get("EXT_color_buffer_half_float"))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}G.checkFramebufferStatus(G.FRAMEBUFFER)===G.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-i&&r>=0&&r<=e.height-n&&G.readPixels(t,r,i,n,se.convert(c),se.convert(l),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&G.bindFramebuffer(G.FRAMEBUFFER,m)}}};this.copyFramebufferToTexture=function(e,t,r){var i=t.image.width;var n=t.image.height;var a=se.convert(t.format);this.setTexture2D(t,0);G.copyTexImage2D(G.TEXTURE_2D,r||0,a,e.x,e.y,i,n,0)}}function xo(e,t){this.name="";this.color=new jr(e);this.density=void 0!==t?t:25e-5}xo.prototype.isFogExp2=true;xo.prototype.clone=function(){return new xo(this.color.getHex(),this.density)};xo.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};function bo(e,t,r){this.name="";this.color=new jr(e);this.near=void 0!==t?t:1;this.far=void 0!==r?r:1e3}bo.prototype.isFog=true;bo.prototype.clone=function(){return new bo(this.color.getHex(),this.near,this.far)};bo.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};function To(){ra.call(this);this.type="Scene";this.background=null;this.fog=null;this.overrideMaterial=null;this.autoUpdate=true}To.prototype=Object.assign(Object.create(ra.prototype),{constructor:To,copy:function(e,t){ra.prototype.copy.call(this,e,t);null!==e.background&&(this.background=e.background.clone());null!==e.fog&&(this.fog=e.fog.clone());null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone());this.autoUpdate=e.autoUpdate;this.matrixAutoUpdate=e.matrixAutoUpdate;return this},toJSON:function(e){var t=ra.prototype.toJSON.call(this,e);null!==this.background&&(t.object.background=this.background.toJSON(e));null!==this.fog&&(t.object.fog=this.fog.toJSON());return t}});function Lo(e){Vn.call(this);this.type="SpriteMaterial";this.color=new jr(16777215);this.map=null;this.rotation=0;this.fog=false;this.lights=false;this.setValues(e)}Lo.prototype=Object.create(Vn.prototype);Lo.prototype.constructor=Lo;Lo.prototype.isSpriteMaterial=true;Lo.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.rotation=e.rotation;return this};function No(e){ra.call(this);this.type="Sprite";this.material=void 0!==e?e:new Lo;this.center=new jt(.5,.5)}No.prototype=Object.assign(Object.create(ra.prototype),{constructor:No,isSprite:true,raycast:function(){var e=new kt;var t=new kt;var r=new kt;return function i(n,a){t.setFromMatrixPosition(this.matrixWorld);n.ray.closestPointToPoint(t,e);r.setFromMatrixScale(this.matrixWorld);var o=r.x*r.y/4;if(t.distanceToSquared(e)>o)return;var s=n.ray.origin.distanceTo(e);if(s<n.near||s>n.far)return;a.push({distance:s,point:e.clone(),face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){ra.prototype.copy.call(this,e);void 0!==e.center&&this.center.copy(e.center);return this}});function Do(){ra.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:true,value:[]}})}Do.prototype=Object.assign(Object.create(ra.prototype),{constructor:Do,copy:function(e){ra.prototype.copy.call(this,e,false);var t=e.levels;for(var r=0,i=t.length;r<i;r++){var n=t[r];this.addLevel(n.object.clone(),n.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0);t=Math.abs(t);var r=this.levels;for(var i=0;i<r.length;i++)if(t<r[i].distance)break;r.splice(i,0,{distance:t,object:e});this.add(e)},getObjectForDistance:function(e){var t=this.levels;for(var r=1,i=t.length;r<i;r++)if(e<t[r].distance)break;return t[r-1].object},raycast:function(){var e=new kt;return function t(r,i){e.setFromMatrixPosition(this.matrixWorld);var n=r.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(r,i)}}(),update:function(){var e=new kt;var t=new kt;return function r(i){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(i.matrixWorld);t.setFromMatrixPosition(this.matrixWorld);var a=e.distanceTo(t);n[0].object.visible=true;for(var o=1,s=n.length;o<s;o++){if(!(a>=n[o].distance))break;n[o-1].object.visible=false;n[o].object.visible=true}for(;o<s;o++)n[o].object.visible=false}}}(),toJSON:function(e){var t=ra.prototype.toJSON.call(this,e);t.object.levels=[];var r=this.levels;for(var i=0,n=r.length;i<n;i++){var a=r[i];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}});function Co(e,t){e=e||[];this.bones=e.slice(0);this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length.");this.boneInverses=[];for(var r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Rt)}}Object.assign(Co.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new Rt;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld);this.boneInverses.push(r)}},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++){e=this.bones[t];e&&e.matrixWorld.getInverse(this.boneInverses[t])}for(t=0,r=this.bones.length;t<r;t++){e=this.bones[t];if(e){if(e.parent&&e.parent.isBone){e.matrix.getInverse(e.parent.matrixWorld);e.matrix.multiply(e.matrixWorld)}else e.matrix.copy(e.matrixWorld);e.matrix.decompose(e.position,e.quaternion,e.scale)}}},update:function(){var e=new Rt;var t=new Rt;return function r(){var i=this.bones;var n=this.boneInverses;var a=this.boneMatrices;var o=this.boneTexture;for(var s=0,u=i.length;s<u;s++){var c=i[s]?i[s].matrixWorld:t;e.multiplyMatrices(c,n[s]);e.toArray(a,16*s)}void 0!==o&&(o.needsUpdate=true)}}(),clone:function(){return new Co(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,r=this.bones.length;t<r;t++){var i=this.bones[t];if(i.name===e)return i}return}});function So(){ra.call(this);this.type="Bone"}So.prototype=Object.assign(Object.create(ra.prototype),{constructor:So,isBone:true});function Io(e,t){Ia.call(this,e,t);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new Rt;this.bindMatrixInverse=new Rt;var r=this.initBones();var i=new Co(r);this.bind(i,this.matrixWorld);this.normalizeSkinWeights()}Io.prototype=Object.assign(Object.create(Ia.prototype),{constructor:Io,isSkinnedMesh:true,initBones:function(){var e=[],t,r;var i,n;if(this.geometry&&void 0!==this.geometry.bones){for(i=0,n=this.geometry.bones.length;i<n;i++){r=this.geometry.bones[i];t=new So;e.push(t);t.name=r.name;t.position.fromArray(r.pos);t.quaternion.fromArray(r.rotq);void 0!==r.scl&&t.scale.fromArray(r.scl)}for(i=0,n=this.geometry.bones.length;i<n;i++){r=this.geometry.bones[i];-1!==r.parent&&null!==r.parent&&void 0!==e[r.parent]?e[r.parent].add(e[i]):this.add(e[i])}}this.updateMatrixWorld(true);return e},bind:function(e,t){this.skeleton=e;if(void 0===t){this.updateMatrixWorld(true);this.skeleton.calculateInverses();t=this.matrixWorld}this.bindMatrix.copy(t);this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var r=this.geometry.skinWeights[t];e=1/r.manhattanLength();Infinity!==e?r.multiplyScalar(e):r.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var i=new Ft;var n=this.geometry.attributes.skinWeight;for(t=0;t<n.count;t++){i.x=n.getX(t);i.y=n.getY(t);i.z=n.getZ(t);i.w=n.getW(t);e=1/i.manhattanLength();Infinity!==e?i.multiplyScalar(e):i.set(1,0,0,0);n.setXYZW(t,i.x,i.y,i.z,i.w)}}},updateMatrixWorld:function(e){Ia.prototype.updateMatrixWorld.call(this,e);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function _o(e){Vn.call(this);this.type="LineBasicMaterial";this.color=new jr(16777215);this.linewidth=1;this.linecap="round";this.linejoin="round";this.lights=false;this.setValues(e)}_o.prototype=Object.create(Vn.prototype);_o.prototype.constructor=_o;_o.prototype.isLineBasicMaterial=true;_o.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.color.copy(e.color);this.linewidth=e.linewidth;this.linecap=e.linecap;this.linejoin=e.linejoin;return this};function Oo(e,t,r){if(1===r){console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.");return new jo(e,t)}ra.call(this);this.type="Line";this.geometry=void 0!==e?e:new wa;this.material=void 0!==t?t:new _o({color:16777215*Math.random()})}Oo.prototype=Object.assign(Object.create(ra.prototype),{constructor:Oo,isLine:true,computeLineDistances:function(){var e=new kt;var t=new kt;return function r(){var i=this.geometry;if(i.isBufferGeometry)if(null===i.index){var n=i.attributes.position;var a=[0];for(var o=1,s=n.count;o<s;o++){e.fromBufferAttribute(n,o-1);t.fromBufferAttribute(n,o);a[o]=a[o-1];a[o]+=e.distanceTo(t)}i.addAttribute("lineDistance",new THREE.Float32BufferAttribute(a,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(i.isGeometry){var u=i.vertices;var a=i.lineDistances;a[0]=0;for(var o=1,s=u.length;o<s;o++){a[o]=a[o-1];a[o]+=u[o-1].distanceTo(u[o])}}return this}}(),raycast:function(){var e=new Rt;var t=new Da;var r=new Xn;return function i(n,a){var o=n.linePrecision;var s=o*o;var u=this.geometry;var c=this.matrixWorld;null===u.boundingSphere&&u.computeBoundingSphere();r.copy(u.boundingSphere);r.applyMatrix4(c);if(false===n.ray.intersectsSphere(r))return;e.getInverse(c);t.copy(n.ray).applyMatrix4(e);var l=new kt;var h=new kt;var d=new kt;var p=new kt;var f=this&&this.isLineSegments?2:1;if(u.isBufferGeometry){var v=u.index;var m=u.attributes;var g=m.position.array;if(null!==v){var y=v.array;for(var A=0,M=y.length-1;A<M;A+=f){var w=y[A];var E=y[A+1];l.fromArray(g,3*w);h.fromArray(g,3*E);var x=t.distanceSqToSegment(l,h,p,d);if(x>s)continue;p.applyMatrix4(this.matrixWorld);var b=n.ray.origin.distanceTo(p);if(b<n.near||b>n.far)continue;a.push({distance:b,point:d.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}else for(var A=0,M=g.length/3-1;A<M;A+=f){l.fromArray(g,3*A);h.fromArray(g,3*A+3);var x=t.distanceSqToSegment(l,h,p,d);if(x>s)continue;p.applyMatrix4(this.matrixWorld);var b=n.ray.origin.distanceTo(p);if(b<n.near||b>n.far)continue;a.push({distance:b,point:d.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}else if(u.isGeometry){var T=u.vertices;var L=T.length;for(var A=0;A<L-1;A+=f){var x=t.distanceSqToSegment(T[A],T[A+1],p,d);if(x>s)continue;p.applyMatrix4(this.matrixWorld);var b=n.ray.origin.distanceTo(p);if(b<n.near||b>n.far)continue;a.push({distance:b,point:d.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function jo(e,t){Oo.call(this,e,t);this.type="LineSegments"}jo.prototype=Object.assign(Object.create(Oo.prototype),{constructor:jo,isLineSegments:true,computeLineDistances:function(){var e=new kt;var t=new kt;return function r(){var i=this.geometry;if(i.isBufferGeometry)if(null===i.index){var n=i.attributes.position;var a=[];for(var o=0,s=n.count;o<s;o+=2){e.fromBufferAttribute(n,o);t.fromBufferAttribute(n,o+1);a[o]=0===o?0:a[o-1];a[o+1]=a[o]+e.distanceTo(t)}i.addAttribute("lineDistance",new THREE.Float32BufferAttribute(a,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(i.isGeometry){var u=i.vertices;var a=i.lineDistances;for(var o=0,s=u.length;o<s;o+=2){e.copy(u[o]);t.copy(u[o+1]);a[o]=0===o?0:a[o-1];a[o+1]=a[o]+e.distanceTo(t)}}return this}}()});function Ro(e,t){Oo.call(this,e,t);this.type="LineLoop"}Ro.prototype=Object.assign(Object.create(Oo.prototype),{constructor:Ro,isLineLoop:true});function zo(e){Vn.call(this);this.type="PointsMaterial";this.color=new jr(16777215);this.map=null;this.size=1;this.sizeAttenuation=true;this.lights=false;this.setValues(e)}zo.prototype=Object.create(Vn.prototype);zo.prototype.constructor=zo;zo.prototype.isPointsMaterial=true;zo.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.size=e.size;this.sizeAttenuation=e.sizeAttenuation;return this};function ko(e,t){ra.call(this);this.type="Points";this.geometry=void 0!==e?e:new wa;this.material=void 0!==t?t:new zo({color:16777215*Math.random()})}ko.prototype=Object.assign(Object.create(ra.prototype),{constructor:ko,isPoints:true,raycast:function(){var e=new Rt;var t=new Da;var r=new Xn;return function i(n,a){var o=this;var s=this.geometry;var u=this.matrixWorld;var c=n.params.Points.threshold;null===s.boundingSphere&&s.computeBoundingSphere();r.copy(s.boundingSphere);r.applyMatrix4(u);r.radius+=c;if(false===n.ray.intersectsSphere(r))return;e.getInverse(u);t.copy(n.ray).applyMatrix4(e);var l=c/((this.scale.x+this.scale.y+this.scale.z)/3);var h=l*l;var d=new kt;function p(e,r){var i=t.distanceSqToPoint(e);if(i<h){var s=t.closestPointToPoint(e);s.applyMatrix4(u);var c=n.ray.origin.distanceTo(s);if(c<n.near||c>n.far)return;a.push({distance:c,distanceToRay:Math.sqrt(i),point:s.clone(),index:r,face:null,object:o})}}if(s.isBufferGeometry){var f=s.index;var v=s.attributes;var m=v.position.array;if(null!==f){var g=f.array;for(var y=0,A=g.length;y<A;y++){var M=g[y];d.fromArray(m,3*M);p(d,M)}}else for(var y=0,w=m.length/3;y<w;y++){d.fromArray(m,3*y);p(d,y)}}else{var E=s.vertices;for(var y=0,w=E.length;y<w;y++)p(E[y],y)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function Po(){ra.call(this);this.type="Group"}Po.prototype=Object.assign(Object.create(ra.prototype),{constructor:Po,isGroup:true});function Uo(e,t,r,i,n,a,o,s,u){Bt.call(this,e,t,r,i,n,a,o,s,u);this.generateMipmaps=false}Uo.prototype=Object.assign(Object.create(Bt.prototype),{constructor:Uo,isVideoTexture:true,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=true)}});function Bo(e,t,r,i,n,a,o,s,u,c,l,h){Bt.call(this,null,a,o,s,u,c,i,n,l,h);this.image={width:t,height:r};this.mipmaps=e;this.flipY=false;this.generateMipmaps=false}Bo.prototype=Object.create(Bt.prototype);Bo.prototype.constructor=Bo;Bo.prototype.isCompressedTexture=true;function Fo(e,t,r,i,n,a,o,s,u,c){c=void 0!==c?c:Be;if(c!==Be&&c!==Fe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===Be&&(r=Te);void 0===r&&c===Fe&&(r=Oe);Bt.call(this,null,i,n,a,o,s,c,r,u);this.image={width:e,height:t};this.magFilter=void 0!==o?o:me;this.minFilter=void 0!==s?s:me;this.flipY=false;this.generateMipmaps=false}Fo.prototype=Object.create(Bt.prototype);Fo.prototype.constructor=Fo;Fo.prototype.isDepthTexture=true;function Go(e){wa.call(this);this.type="WireframeGeometry";var t=[];var r,i,n,a,o;var s=[0,0],u={},c,l,h;var d,p=["a","b","c"];var f;if(e&&e.isGeometry){var v=e.faces;for(r=0,n=v.length;r<n;r++){var m=v[r];for(i=0;i<3;i++){l=m[p[i]];h=m[p[(i+1)%3]];s[0]=Math.min(l,h);s[1]=Math.max(l,h);d=s[0]+","+s[1];void 0===u[d]&&(u[d]={index1:s[0],index2:s[1]})}}for(d in u){c=u[d];f=e.vertices[c.index1];t.push(f.x,f.y,f.z);f=e.vertices[c.index2];t.push(f.x,f.y,f.z)}}else if(e&&e.isBufferGeometry){var g,y,A;var M,w,E;var x,b;f=new kt;if(null!==e.index){g=e.attributes.position;y=e.index;A=e.groups;0===A.length&&(A=[{start:0,count:y.count,materialIndex:0}]);for(a=0,o=A.length;a<o;++a){M=A[a];w=M.start;E=M.count;for(r=w,n=w+E;r<n;r+=3)for(i=0;i<3;i++){l=y.getX(r+i);h=y.getX(r+(i+1)%3);s[0]=Math.min(l,h);s[1]=Math.max(l,h);d=s[0]+","+s[1];void 0===u[d]&&(u[d]={index1:s[0],index2:s[1]})}}for(d in u){c=u[d];f.fromBufferAttribute(g,c.index1);t.push(f.x,f.y,f.z);f.fromBufferAttribute(g,c.index2);t.push(f.x,f.y,f.z)}}else{g=e.attributes.position;for(r=0,n=g.count/3;r<n;r++)for(i=0;i<3;i++){x=3*r+i;f.fromBufferAttribute(g,x);t.push(f.x,f.y,f.z);b=3*r+(i+1)%3;f.fromBufferAttribute(g,b);t.push(f.x,f.y,f.z)}}}this.addAttribute("position",new ma(t,3))}Go.prototype=Object.create(wa.prototype);Go.prototype.constructor=Go;function Ho(e,t,r){sa.call(this);this.type="ParametricGeometry";this.parameters={func:e,slices:t,stacks:r};this.fromBufferGeometry(new Vo(e,t,r));this.mergeVertices()}Ho.prototype=Object.create(sa.prototype);Ho.prototype.constructor=Ho;function Vo(e,t,r){wa.call(this);this.type="ParametricBufferGeometry";this.parameters={func:e,slices:t,stacks:r};var i=[];var n=[];var a=[];var o=[];var s=1e-5;var u=new kt;var c=new kt,l=new kt;var h=new kt,d=new kt;var p,f;var v=t+1;for(p=0;p<=r;p++){var m=p/r;for(f=0;f<=t;f++){var g=f/t;c=e(g,m,c);n.push(c.x,c.y,c.z);if(g-s>=0){l=e(g-s,m,l);h.subVectors(c,l)}else{l=e(g+s,m,l);h.subVectors(l,c)}if(m-s>=0){l=e(g,m-s,l);d.subVectors(c,l)}else{l=e(g,m+s,l);d.subVectors(l,c)}u.crossVectors(h,d).normalize();a.push(u.x,u.y,u.z);o.push(g,m)}}for(p=0;p<r;p++)for(f=0;f<t;f++){var y=p*v+f;var A=p*v+f+1;var M=(p+1)*v+f+1;var w=(p+1)*v+f;i.push(y,A,w);i.push(A,M,w)}this.setIndex(i);this.addAttribute("position",new ma(n,3));this.addAttribute("normal",new ma(a,3));this.addAttribute("uv",new ma(o,2))}Vo.prototype=Object.create(wa.prototype);Vo.prototype.constructor=Vo;function Qo(e,t,r,i){sa.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:e,indices:t,radius:r,detail:i};this.fromBufferGeometry(new Yo(e,t,r,i));this.mergeVertices()}Qo.prototype=Object.create(sa.prototype);Qo.prototype.constructor=Qo;function Yo(e,t,r,i){wa.call(this);this.type="PolyhedronBufferGeometry";this.parameters={vertices:e,indices:t,radius:r,detail:i};r=r||1;i=i||0;var n=[];var a=[];o(i);u(r);c();this.addAttribute("position",new ma(n,3));this.addAttribute("normal",new ma(n.slice(),3));this.addAttribute("uv",new ma(a,2));0===i?this.computeVertexNormals():this.normalizeNormals();function o(e){var r=new kt;var i=new kt;var n=new kt;for(var a=0;a<t.length;a+=3){d(t[a+0],r);d(t[a+1],i);d(t[a+2],n);s(r,i,n,e)}}function s(e,t,r,i){var n=Math.pow(2,i);var a=[];var o,s;for(o=0;o<=n;o++){a[o]=[];var u=e.clone().lerp(r,o/n);var c=t.clone().lerp(r,o/n);var l=n-o;for(s=0;s<=l;s++)a[o][s]=0===s&&o===n?u:u.clone().lerp(c,s/l)}for(o=0;o<n;o++)for(s=0;s<2*(n-o)-1;s++){var d=Math.floor(s/2);if(s%2===0){h(a[o][d+1]);h(a[o+1][d]);h(a[o][d])}else{h(a[o][d+1]);h(a[o+1][d+1]);h(a[o+1][d])}}}function u(e){var t=new kt;for(var r=0;r<n.length;r+=3){t.x=n[r+0];t.y=n[r+1];t.z=n[r+2];t.normalize().multiplyScalar(e);n[r+0]=t.x;n[r+1]=t.y;n[r+2]=t.z}}function c(){var e=new kt;for(var t=0;t<n.length;t+=3){e.x=n[t+0];e.y=n[t+1];e.z=n[t+2];var r=v(e)/2/Math.PI+.5;var i=m(e)/Math.PI+.5;a.push(r,1-i)}p();l()}function l(){for(var e=0;e<a.length;e+=6){var t=a[e+0];var r=a[e+2];var i=a[e+4];var n=Math.max(t,r,i);var o=Math.min(t,r,i);if(n>.9&&o<.1){t<.2&&(a[e+0]+=1);r<.2&&(a[e+2]+=1);i<.2&&(a[e+4]+=1)}}}function h(e){n.push(e.x,e.y,e.z)}function d(t,r){var i=3*t;r.x=e[i+0];r.y=e[i+1];r.z=e[i+2]}function p(){var e=new kt;var t=new kt;var r=new kt;var i=new kt;var o=new jt;var s=new jt;var u=new jt;for(var c=0,l=0;c<n.length;c+=9,l+=6){e.set(n[c+0],n[c+1],n[c+2]);t.set(n[c+3],n[c+4],n[c+5]);r.set(n[c+6],n[c+7],n[c+8]);o.set(a[l+0],a[l+1]);s.set(a[l+2],a[l+3]);u.set(a[l+4],a[l+5]);i.copy(e).add(t).add(r).divideScalar(3);var h=v(i);f(o,l+0,e,h);f(s,l+2,t,h);f(u,l+4,r,h)}}function f(e,t,r,i){i<0&&1===e.x&&(a[t]=e.x-1);0===r.x&&0===r.z&&(a[t]=i/2/Math.PI+.5)}function v(e){return Math.atan2(e.z,-e.x)}function m(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}}Yo.prototype=Object.create(wa.prototype);Yo.prototype.constructor=Yo;function Wo(e,t){sa.call(this);this.type="TetrahedronGeometry";this.parameters={radius:e,detail:t};this.fromBufferGeometry(new Xo(e,t));this.mergeVertices()}Wo.prototype=Object.create(sa.prototype);Wo.prototype.constructor=Wo;function Xo(e,t){var r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1];var i=[2,1,0,0,3,2,1,3,0,2,3,1];Yo.call(this,r,i,e,t);this.type="TetrahedronBufferGeometry";this.parameters={radius:e,detail:t}}Xo.prototype=Object.create(Yo.prototype);Xo.prototype.constructor=Xo;function qo(e,t){sa.call(this);this.type="OctahedronGeometry";this.parameters={radius:e,detail:t};this.fromBufferGeometry(new Zo(e,t));this.mergeVertices()}qo.prototype=Object.create(sa.prototype);qo.prototype.constructor=qo;function Zo(e,t){var r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1];var i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Yo.call(this,r,i,e,t);this.type="OctahedronBufferGeometry";this.parameters={radius:e,detail:t}}Zo.prototype=Object.create(Yo.prototype);Zo.prototype.constructor=Zo;function Jo(e,t){sa.call(this);this.type="IcosahedronGeometry";this.parameters={radius:e,detail:t};this.fromBufferGeometry(new Ko(e,t));this.mergeVertices()}Jo.prototype=Object.create(sa.prototype);Jo.prototype.constructor=Jo;function Ko(e,t){var r=(1+Math.sqrt(5))/2;var i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];var n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Yo.call(this,i,n,e,t);this.type="IcosahedronBufferGeometry";this.parameters={radius:e,detail:t}}Ko.prototype=Object.create(Yo.prototype);Ko.prototype.constructor=Ko;function $o(e,t){sa.call(this);this.type="DodecahedronGeometry";this.parameters={radius:e,detail:t};this.fromBufferGeometry(new es(e,t));this.mergeVertices()}$o.prototype=Object.create(sa.prototype);$o.prototype.constructor=$o;function es(e,t){var r=(1+Math.sqrt(5))/2;var i=1/r;var n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i];var a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Yo.call(this,n,a,e,t);this.type="DodecahedronBufferGeometry";this.parameters={radius:e,detail:t}}es.prototype=Object.create(Yo.prototype);es.prototype.constructor=es;function ts(e,t,r,i,n,a){sa.call(this);this.type="TubeGeometry";this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:n};void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new rs(e,t,r,i,n);this.tangents=o.tangents;this.normals=o.normals;this.binormals=o.binormals;this.fromBufferGeometry(o);this.mergeVertices()}ts.prototype=Object.create(sa.prototype);ts.prototype.constructor=ts;function rs(e,t,r,i,n){wa.call(this);this.type="TubeBufferGeometry";this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:n};t=t||64;r=r||1;i=i||8;n=n||false;var a=e.computeFrenetFrames(t,n);this.tangents=a.tangents;this.normals=a.normals;this.binormals=a.binormals;var o=new kt;var s=new kt;var u=new jt;var c=new kt;var l,h;var d=[];var p=[];var f=[];var v=[];m();this.setIndex(v);this.addAttribute("position",new ma(d,3));this.addAttribute("normal",new ma(p,3));this.addAttribute("uv",new ma(f,2));function m(){for(l=0;l<t;l++)g(l);g(false===n?t:0);A();y()}function g(n){c=e.getPointAt(n/t,c);var u=a.normals[n];var l=a.binormals[n];for(h=0;h<=i;h++){var f=h/i*Math.PI*2;var v=Math.sin(f);var m=-Math.cos(f);s.x=m*u.x+v*l.x;s.y=m*u.y+v*l.y;s.z=m*u.z+v*l.z;s.normalize();p.push(s.x,s.y,s.z);o.x=c.x+r*s.x;o.y=c.y+r*s.y;o.z=c.z+r*s.z;d.push(o.x,o.y,o.z)}}function y(){for(h=1;h<=t;h++)for(l=1;l<=i;l++){var e=(i+1)*(h-1)+(l-1);var r=(i+1)*h+(l-1);var n=(i+1)*h+l;var a=(i+1)*(h-1)+l;v.push(e,r,a);v.push(r,n,a)}}function A(){for(l=0;l<=t;l++)for(h=0;h<=i;h++){u.x=l/t;u.y=h/i;f.push(u.x,u.y)}}}rs.prototype=Object.create(wa.prototype);rs.prototype.constructor=rs;function is(e,t,r,i,n,a,o){sa.call(this);this.type="TorusKnotGeometry";this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:a};void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");this.fromBufferGeometry(new ns(e,t,r,i,n,a));this.mergeVertices()}is.prototype=Object.create(sa.prototype);is.prototype.constructor=is;function ns(e,t,r,i,n,a){wa.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:a};e=e||1;t=t||.4;r=Math.floor(r)||64;i=Math.floor(i)||8;n=n||2;a=a||3;var o=[];var s=[];var u=[];var c=[];var l,h;var d=new kt;var p=new kt;var f=new kt;var v=new kt;var m=new kt;var g=new kt;var y=new kt;for(l=0;l<=r;++l){var A=l/r*n*Math.PI*2;N(A,n,a,e,f);N(A+.01,n,a,e,v);g.subVectors(v,f);y.addVectors(v,f);m.crossVectors(g,y);y.crossVectors(m,g);m.normalize();y.normalize();for(h=0;h<=i;++h){var M=h/i*Math.PI*2;var w=-t*Math.cos(M);var E=t*Math.sin(M);d.x=f.x+(w*y.x+E*m.x);d.y=f.y+(w*y.y+E*m.y);d.z=f.z+(w*y.z+E*m.z);s.push(d.x,d.y,d.z);p.subVectors(d,f).normalize();u.push(p.x,p.y,p.z);c.push(l/r);c.push(h/i)}}for(h=1;h<=r;h++)for(l=1;l<=i;l++){var x=(i+1)*(h-1)+(l-1);var b=(i+1)*h+(l-1);var T=(i+1)*h+l;var L=(i+1)*(h-1)+l;o.push(x,b,L);o.push(b,T,L)}this.setIndex(o);this.addAttribute("position",new ma(s,3));this.addAttribute("normal",new ma(u,3));this.addAttribute("uv",new ma(c,2));function N(e,t,r,i,n){var a=Math.cos(e);var o=Math.sin(e);var s=r/t*e;var u=Math.cos(s);n.x=i*(2+u)*.5*a;n.y=i*(2+u)*o*.5;n.z=i*Math.sin(s)*.5}}ns.prototype=Object.create(wa.prototype);ns.prototype.constructor=ns;function as(e,t,r,i,n){sa.call(this);this.type="TorusGeometry";this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n};this.fromBufferGeometry(new os(e,t,r,i,n));this.mergeVertices()}as.prototype=Object.create(sa.prototype);as.prototype.constructor=as;function os(e,t,r,i,n){wa.call(this);this.type="TorusBufferGeometry";this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n};e=e||1;t=t||.4;r=Math.floor(r)||8;i=Math.floor(i)||6;n=n||2*Math.PI;var a=[];var o=[];var s=[];var u=[];var c=new kt;var l=new kt;var h=new kt;var d,p;for(d=0;d<=r;d++)for(p=0;p<=i;p++){var f=p/i*n;var v=d/r*Math.PI*2;l.x=(e+t*Math.cos(v))*Math.cos(f);l.y=(e+t*Math.cos(v))*Math.sin(f);l.z=t*Math.sin(v);o.push(l.x,l.y,l.z);c.x=e*Math.cos(f);c.y=e*Math.sin(f);h.subVectors(l,c).normalize();s.push(h.x,h.y,h.z);u.push(p/i);u.push(d/r)}for(d=1;d<=r;d++)for(p=1;p<=i;p++){var m=(i+1)*d+p-1;var g=(i+1)*(d-1)+p-1;var y=(i+1)*(d-1)+p;var A=(i+1)*d+p;a.push(m,g,A);a.push(g,y,A)}this.setIndex(a);this.addAttribute("position",new ma(o,3));this.addAttribute("normal",new ma(s,3));this.addAttribute("uv",new ma(u,2))}os.prototype=Object.create(wa.prototype);os.prototype.constructor=os;var ss={triangulate:function(e,t,r){r=r||2;var i=t&&t.length,n=i?t[0]*r:e.length,a=us(e,0,n,r,true),o=[];if(!a)return o;var s,u,c,l,h,d,p;i&&(a=vs(e,t,a,r));if(e.length>80*r){s=c=e[0];u=l=e[1];for(var f=r;f<n;f+=r){h=e[f];d=e[f+1];h<s&&(s=h);d<u&&(u=d);h>c&&(c=h);d>l&&(l=d)}p=Math.max(c-s,l-u);p=0!==p?1/p:0}ls(a,o,r,s,u,p);return o}};function us(e,t,r,i,n){var a,o;if(n===Rs(e,t,r,i)>0)for(a=t;a<r;a+=i)o=_s(a,e[a],e[a+1],o);else for(a=r-i;a>=t;a-=i)o=_s(a,e[a],e[a+1],o);if(o&&Ls(o,o.next)){Os(o);o=o.next}return o}function cs(e,t){if(!e)return e;t||(t=e);var r=e,i;do{i=false;if(r.steiner||!Ls(r,r.next)&&0!==Ts(r.prev,r,r.next))r=r.next;else{Os(r);r=t=r.prev;if(r===r.next)break;i=true}}while(i||r!==t);return t}function ls(e,t,r,i,n,a,o){if(!e)return;!o&&a&&As(e,i,n,a);var s=e,u,c;while(e.prev!==e.next){u=e.prev;c=e.next;if(a?ds(e,i,n,a):hs(e)){t.push(u.i/r);t.push(e.i/r);t.push(c.i/r);Os(e);e=c.next;s=c.next;continue}e=c;if(e===s){if(o)if(1===o){e=ps(e,t,r);ls(e,t,r,i,n,a,2)}else 2===o&&fs(e,t,r,i,n,a);else ls(cs(e),t,r,i,n,a,1);break}}}function hs(e){var t=e.prev,r=e,i=e.next;if(Ts(t,r,i)>=0)return false;var n=e.next.next;while(n!==e.prev){if(xs(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&Ts(n.prev,n,n.next)>=0)return false;n=n.next}return true}function ds(e,t,r,i){var n=e.prev,a=e,o=e.next;if(Ts(n,a,o)>=0)return false;var s=n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,u=n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,c=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,l=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y;var h=ws(s,u,t,r,i),d=ws(c,l,t,r,i);var p=e.nextZ;while(p&&p.z<=d){if(p!==e.prev&&p!==e.next&&xs(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Ts(p.prev,p,p.next)>=0)return false;p=p.nextZ}p=e.prevZ;while(p&&p.z>=h){if(p!==e.prev&&p!==e.next&&xs(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Ts(p.prev,p,p.next)>=0)return false;p=p.prevZ}return true}function ps(e,t,r){var i=e;do{var n=i.prev,a=i.next.next;if(!Ls(n,a)&&Ns(n,i,i.next,a)&&Cs(n,a)&&Cs(a,n)){t.push(n.i/r);t.push(i.i/r);t.push(a.i/r);Os(i);Os(i.next);i=e=a}i=i.next}while(i!==e);return i}function fs(e,t,r,i,n,a){var o=e;do{var s=o.next.next;while(s!==o.prev){if(o.i!==s.i&&bs(o,s)){var u=Is(o,s);o=cs(o,o.next);u=cs(u,u.next);ls(o,t,r,i,n,a);ls(u,t,r,i,n,a);return}s=s.next}o=o.next}while(o!==e)}function vs(e,t,r,i){var n=[],a,o,s,u,c;for(a=0,o=t.length;a<o;a++){s=t[a]*i;u=a<o-1?t[a+1]*i:e.length;c=us(e,s,u,i,false);c===c.next&&(c.steiner=true);n.push(Es(c))}n.sort(ms);for(a=0;a<n.length;a++){gs(n[a],r);r=cs(r,r.next)}return r}function ms(e,t){return e.x-t.x}function gs(e,t){t=ys(e,t);if(t){var r=Is(t,e);cs(r,r.next)}}function ys(e,t){var r=t,i=e.x,n=e.y,a=-Infinity,o;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var s=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){a=s;if(s===i){if(n===r.y)return r;if(n===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(i===a)return o.prev;var u=o,c=o.x,l=o.y,h=Infinity,d;r=o.next;while(r!==u){if(i>=r.x&&r.x>=c&&i!==r.x&&xs(n<l?i:a,n,c,l,n<l?a:i,n,r.x,r.y)){d=Math.abs(n-r.y)/(i-r.x);if((d<h||d===h&&r.x>o.x)&&Cs(r,e)){o=r;h=d}}r=r.next}return o}function As(e,t,r,i){var n=e;do{null===n.z&&(n.z=ws(n.x,n.y,t,r,i));n.prevZ=n.prev;n.nextZ=n.next;n=n.next}while(n!==e);n.prevZ.nextZ=null;n.prevZ=null;Ms(n)}function Ms(e){var t,r,i,n,a,o,s,u,c=1;do{r=e;e=null;a=null;o=0;while(r){o++;i=r;s=0;for(t=0;t<c;t++){s++;i=i.nextZ;if(!i)break}u=c;while(s>0||u>0&&i){if(0!==s&&(0===u||!i||r.z<=i.z)){n=r;r=r.nextZ;s--}else{n=i;i=i.nextZ;u--}a?a.nextZ=n:e=n;n.prevZ=a;a=n}r=i}a.nextZ=null;c*=2}while(o>1);return e}function ws(e,t,r,i,n){e=32767*(e-r)*n;t=32767*(t-i)*n;e=16711935&(e|e<<8);e=252645135&(e|e<<4);e=858993459&(e|e<<2);e=1431655765&(e|e<<1);t=16711935&(t|t<<8);t=252645135&(t|t<<4);t=858993459&(t|t<<2);t=1431655765&(t|t<<1);return e|t<<1}function Es(e){var t=e,r=e;do{t.x<r.x&&(r=t);t=t.next}while(t!==e);return r}function xs(e,t,r,i,n,a,o,s){return(n-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(n-o)*(i-s)>=0}function bs(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Ds(e,t)&&Cs(e,t)&&Cs(t,e)&&Ss(e,t)}function Ts(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ls(e,t){return e.x===t.x&&e.y===t.y}function Ns(e,t,r,i){if(Ls(e,t)&&Ls(r,i)||Ls(e,i)&&Ls(r,t))return true;return Ts(e,t,r)>0!==Ts(e,t,i)>0&&Ts(r,i,e)>0!==Ts(r,i,t)>0}function Ds(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Ns(r,r.next,e,t))return true;r=r.next}while(r!==e);return false}function Cs(e,t){return Ts(e.prev,e,e.next)<0?Ts(e,t,e.next)>=0&&Ts(e,e.prev,t)>=0:Ts(e,t,e.prev)<0||Ts(e,e.next,t)<0}function Ss(e,t){var r=e,i=false,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!==r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i);r=r.next}while(r!==e);return i}function Is(e,t){var r=new js(e.i,e.x,e.y),i=new js(t.i,t.x,t.y),n=e.next,a=t.prev;e.next=t;t.prev=e;r.next=n;n.prev=r;i.next=r;r.prev=i;a.next=i;i.prev=a;return i}function _s(e,t,r,i){var n=new js(e,t,r);if(i){n.next=i.next;n.prev=i;i.next.prev=n;i.next=n}else{n.prev=n;n.next=n}return n}function Os(e){e.next.prev=e.prev;e.prev.next=e.next;e.prevZ&&(e.prevZ.nextZ=e.nextZ);e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function js(e,t,r){this.i=e;this.x=t;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}function Rs(e,t,r,i){var n=0;for(var a=t,o=r-i;a<r;a+=i){n+=(e[o]-e[a])*(e[a+1]+e[o+1]);o=a}return n}var zs={area:function(e){var t=e.length;var r=0;for(var i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return.5*r},isClockWise:function(e){return zs.area(e)<0},triangulateShape:function(e,t){var r=[];var i=[];var n=[];ks(e);Ps(r,e);var a=e.length;t.forEach(ks);for(var o=0;o<t.length;o++){i.push(a);a+=t[o].length;Ps(r,t[o])}var s=ss.triangulate(r,i);for(var o=0;o<s.length;o+=3)n.push(s.slice(o,o+3));return n}};function ks(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Ps(e,t){for(var r=0;r<t.length;r++){e.push(t[r].x);e.push(t[r].y)}}function Us(e,t){sa.call(this);this.type="ExtrudeGeometry";this.parameters={shapes:e,options:t};this.fromBufferGeometry(new Bs(e,t));this.mergeVertices()}Us.prototype=Object.create(sa.prototype);Us.prototype.constructor=Us;function Bs(e,t){if("undefined"===typeof e)return;wa.call(this);this.type="ExtrudeBufferGeometry";e=Array.isArray(e)?e:[e];this.addShapeList(e,t);this.computeVertexNormals()}Bs.prototype=Object.create(wa.prototype);Bs.prototype.constructor=Bs;Bs.prototype.getArrays=function(){var e=this.getAttribute("position");var t=e?Array.prototype.slice.call(e.array):[];var r=this.getAttribute("uv");var i=r?Array.prototype.slice.call(r.array):[];var n=this.index;var a=n?Array.prototype.slice.call(n.array):[];return{position:t,uv:i,index:a}};Bs.prototype.addShapeList=function(e,t){var r=e.length;t.arrays=this.getArrays();for(var i=0;i<r;i++){var n=e[i];this.addShape(n,t)}this.setIndex(t.arrays.index);this.addAttribute("position",new ma(t.arrays.position,3));this.addAttribute("uv",new ma(t.arrays.uv,2))};Bs.prototype.addShape=function(e,t){var r=t.arrays?t.arrays:this.getArrays();var i=r.position;var n=r.index;var a=r.uv;var o=[];var s=void 0!==t.amount?t.amount:100;var u=void 0!==t.bevelThickness?t.bevelThickness:6;var c=void 0!==t.bevelSize?t.bevelSize:u-2;var l=void 0!==t.bevelSegments?t.bevelSegments:3;var h=void 0===t.bevelEnabled||t.bevelEnabled;var d=void 0!==t.curveSegments?t.curveSegments:12;var p=void 0!==t.steps?t.steps:1;var f=t.extrudePath;var v,m=false;var g=void 0!==t.UVGenerator?t.UVGenerator:Us.WorldUVGenerator;var y,A,M,w;if(f){v=f.getSpacedPoints(p);m=true;h=false;y=void 0!==t.frames?t.frames:f.computeFrenetFrames(p,false);A=new kt;M=new kt;w=new kt}if(!h){l=0;u=0;c=0}var E,x,b;var T=this;var L=e.extractPoints(d);var N=L.shape;var D=L.holes;var C=!zs.isClockWise(N);if(C){N=N.reverse();for(x=0,b=D.length;x<b;x++){E=D[x];zs.isClockWise(E)&&(D[x]=E.reverse())}}var S=zs.triangulateShape(N,D);var I=N;for(x=0,b=D.length;x<b;x++){E=D[x];N=N.concat(E)}function _(e,t,r){t||console.error("THREE.ExtrudeGeometry: vec does not exist");return t.clone().multiplyScalar(r).add(e)}var O,j,R,z,k,P=N.length,U,B=S.length;function F(e,t,r){var i,n,a;var o=e.x-t.x,s=e.y-t.y;var u=r.x-e.x,c=r.y-e.y;var l=o*o+s*s;var h=o*c-s*u;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(l);var p=Math.sqrt(u*u+c*c);var f=t.x-s/d;var v=t.y+o/d;var m=r.x-c/p;var g=r.y+u/p;var y=((m-f)*c-(g-v)*u)/(o*c-s*u);i=f+o*y-e.x;n=v+s*y-e.y;var A=i*i+n*n;if(A<=2)return new jt(i,n);a=Math.sqrt(A/2)}else{var M=false;o>Number.EPSILON?u>Number.EPSILON&&(M=true):o<-Number.EPSILON?u<-Number.EPSILON&&(M=true):Math.sign(s)===Math.sign(c)&&(M=true);if(M){i=-s;n=o;a=Math.sqrt(l)}else{i=o;n=s;a=Math.sqrt(l/2)}}return new jt(i/a,n/a)}var G=[];for(var H=0,V=I.length,Q=V-1,Y=H+1;H<V;H++,Q++,Y++){Q===V&&(Q=0);Y===V&&(Y=0);G[H]=F(I[H],I[Q],I[Y])}var W=[],X,q=G.concat();for(x=0,b=D.length;x<b;x++){E=D[x];X=[];for(H=0,V=E.length,Q=V-1,Y=H+1;H<V;H++,Q++,Y++){Q===V&&(Q=0);Y===V&&(Y=0);X[H]=F(E[H],E[Q],E[Y])}W.push(X);q=q.concat(X)}for(O=0;O<l;O++){R=O/l;z=u*Math.cos(R*Math.PI/2);j=c*Math.sin(R*Math.PI/2);for(H=0,V=I.length;H<V;H++){k=_(I[H],G[H],j);ee(k.x,k.y,-z)}for(x=0,b=D.length;x<b;x++){E=D[x];X=W[x];for(H=0,V=E.length;H<V;H++){k=_(E[H],X[H],j);ee(k.x,k.y,-z)}}}j=c;for(H=0;H<P;H++){k=h?_(N[H],q[H],j):N[H];if(m){M.copy(y.normals[0]).multiplyScalar(k.x);A.copy(y.binormals[0]).multiplyScalar(k.y);w.copy(v[0]).add(M).add(A);ee(w.x,w.y,w.z)}else ee(k.x,k.y,0)}var Z;for(Z=1;Z<=p;Z++)for(H=0;H<P;H++){k=h?_(N[H],q[H],j):N[H];if(m){M.copy(y.normals[Z]).multiplyScalar(k.x);A.copy(y.binormals[Z]).multiplyScalar(k.y);w.copy(v[Z]).add(M).add(A);ee(w.x,w.y,w.z)}else ee(k.x,k.y,s/p*Z)}for(O=l-1;O>=0;O--){R=O/l;z=u*Math.cos(R*Math.PI/2);j=c*Math.sin(R*Math.PI/2);for(H=0,V=I.length;H<V;H++){k=_(I[H],G[H],j);ee(k.x,k.y,s+z)}for(x=0,b=D.length;x<b;x++){E=D[x];X=W[x];for(H=0,V=E.length;H<V;H++){k=_(E[H],X[H],j);m?ee(k.x,k.y+v[p-1].y,v[p-1].x+z):ee(k.x,k.y,s+z)}}}J();K();function J(){var e=i.length/3;if(h){var r=0;var n=P*r;for(H=0;H<B;H++){U=S[H];te(U[2]+n,U[1]+n,U[0]+n)}r=p+2*l;n=P*r;for(H=0;H<B;H++){U=S[H];te(U[0]+n,U[1]+n,U[2]+n)}}else{for(H=0;H<B;H++){U=S[H];te(U[2],U[1],U[0])}for(H=0;H<B;H++){U=S[H];te(U[0]+P*p,U[1]+P*p,U[2]+P*p)}}T.addGroup(e,i.length/3-e,void 0!==t.material?t.material:0)}function K(){var e=i.length/3;var r=0;$(I,r);r+=I.length;for(x=0,b=D.length;x<b;x++){E=D[x];$(E,r);r+=E.length}T.addGroup(e,i.length/3-e,void 0!==t.extrudeMaterial?t.extrudeMaterial:1)}function $(e,t){var r,i;H=e.length;while(--H>=0){r=H;i=H-1;i<0&&(i=e.length-1);var n=0,a=p+2*l;for(n=0;n<a;n++){var o=P*n;var s=P*(n+1);var u=t+r+o,c=t+i+o,h=t+i+s,d=t+r+s;re(u,c,h,d)}}}function ee(e,t,r){o.push(e);o.push(t);o.push(r)}function te(e,t,r){ie(e);ie(t);ie(r);var n=i.length/3;var a=g.generateTopUV(T,i,n-3,n-2,n-1);ne(a[0]);ne(a[1]);ne(a[2])}function re(e,t,r,n){ie(e);ie(t);ie(n);ie(t);ie(r);ie(n);var a=i.length/3;var o=g.generateSideWallUV(T,i,a-6,a-3,a-2,a-1);ne(o[0]);ne(o[1]);ne(o[3]);ne(o[1]);ne(o[2]);ne(o[3])}function ie(e){n.push(i.length/3);i.push(o[3*e+0]);i.push(o[3*e+1]);i.push(o[3*e+2])}function ne(e){a.push(e.x);a.push(e.y)}if(!t.arrays){this.setIndex(n);this.addAttribute("position",new ma(i,3));this.addAttribute("uv",new ma(a,2))}};Us.WorldUVGenerator={generateTopUV:function(e,t,r,i,n){var a=t[3*r];var o=t[3*r+1];var s=t[3*i];var u=t[3*i+1];var c=t[3*n];var l=t[3*n+1];return[new jt(a,o),new jt(s,u),new jt(c,l)]},generateSideWallUV:function(e,t,r,i,n,a){var o=t[3*r];var s=t[3*r+1];var u=t[3*r+2];var c=t[3*i];var l=t[3*i+1];var h=t[3*i+2];var d=t[3*n];var p=t[3*n+1];var f=t[3*n+2];var v=t[3*a];var m=t[3*a+1];var g=t[3*a+2];return Math.abs(s-l)<.01?[new jt(o,1-u),new jt(c,1-h),new jt(d,1-f),new jt(v,1-g)]:[new jt(s,1-u),new jt(l,1-h),new jt(p,1-f),new jt(m,1-g)]}};function Fs(e,t){sa.call(this);this.type="TextGeometry";this.parameters={text:e,parameters:t};this.fromBufferGeometry(new Gs(e,t));this.mergeVertices()}Fs.prototype=Object.create(sa.prototype);Fs.prototype.constructor=Fs;function Gs(e,t){t=t||{};var r=t.font;if(!(r&&r.isFont)){console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font.");return new sa}var i=r.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50;void 0===t.bevelThickness&&(t.bevelThickness=10);void 0===t.bevelSize&&(t.bevelSize=8);void 0===t.bevelEnabled&&(t.bevelEnabled=false);Bs.call(this,i,t);this.type="TextBufferGeometry"}Gs.prototype=Object.create(Bs.prototype);Gs.prototype.constructor=Gs;function Hs(e,t,r,i,n,a,o){sa.call(this);this.type="SphereGeometry";this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:a,thetaLength:o};this.fromBufferGeometry(new Vs(e,t,r,i,n,a,o));this.mergeVertices()}Hs.prototype=Object.create(sa.prototype);Hs.prototype.constructor=Hs;function Vs(e,t,r,i,n,a,o){wa.call(this);this.type="SphereBufferGeometry";this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:a,thetaLength:o};e=e||1;t=Math.max(3,Math.floor(t)||8);r=Math.max(2,Math.floor(r)||6);i=void 0!==i?i:0;n=void 0!==n?n:2*Math.PI;a=void 0!==a?a:0;o=void 0!==o?o:Math.PI;var s=a+o;var u,c;var l=0;var h=[];var d=new kt;var p=new kt;var f=[];var v=[];var m=[];var g=[];for(c=0;c<=r;c++){var y=[];var A=c/r;for(u=0;u<=t;u++){var M=u/t;d.x=-e*Math.cos(i+M*n)*Math.sin(a+A*o);d.y=e*Math.cos(a+A*o);d.z=e*Math.sin(i+M*n)*Math.sin(a+A*o);v.push(d.x,d.y,d.z);p.set(d.x,d.y,d.z).normalize();m.push(p.x,p.y,p.z);g.push(M,1-A);y.push(l++)}h.push(y)}for(c=0;c<r;c++)for(u=0;u<t;u++){var w=h[c][u+1];var E=h[c][u];var x=h[c+1][u];var b=h[c+1][u+1];(0!==c||a>0)&&f.push(w,E,b);(c!==r-1||s<Math.PI)&&f.push(E,x,b)}this.setIndex(f);this.addAttribute("position",new ma(v,3));this.addAttribute("normal",new ma(m,3));this.addAttribute("uv",new ma(g,2))}Vs.prototype=Object.create(wa.prototype);Vs.prototype.constructor=Vs;function Qs(e,t,r,i,n,a){sa.call(this);this.type="RingGeometry";this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:n,thetaLength:a};this.fromBufferGeometry(new Ys(e,t,r,i,n,a));this.mergeVertices()}Qs.prototype=Object.create(sa.prototype);Qs.prototype.constructor=Qs;function Ys(e,t,r,i,n,a){wa.call(this);this.type="RingBufferGeometry";this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:n,thetaLength:a};e=e||.5;t=t||1;n=void 0!==n?n:0;a=void 0!==a?a:2*Math.PI;r=void 0!==r?Math.max(3,r):8;i=void 0!==i?Math.max(1,i):1;var o=[];var s=[];var u=[];var c=[];var l;var h=e;var d=(t-e)/i;var p=new kt;var f=new jt;var v,m;for(v=0;v<=i;v++){for(m=0;m<=r;m++){l=n+m/r*a;p.x=h*Math.cos(l);p.y=h*Math.sin(l);s.push(p.x,p.y,p.z);u.push(0,0,1);f.x=(p.x/t+1)/2;f.y=(p.y/t+1)/2;c.push(f.x,f.y)}h+=d}for(v=0;v<i;v++){var g=v*(r+1);for(m=0;m<r;m++){l=m+g;var y=l;var A=l+r+1;var M=l+r+2;var w=l+1;o.push(y,A,w);o.push(A,M,w)}}this.setIndex(o);this.addAttribute("position",new ma(s,3));this.addAttribute("normal",new ma(u,3));this.addAttribute("uv",new ma(c,2))}Ys.prototype=Object.create(wa.prototype);Ys.prototype.constructor=Ys;function Ws(e,t,r,i){sa.call(this);this.type="LatheGeometry";this.parameters={points:e,segments:t,phiStart:r,phiLength:i};this.fromBufferGeometry(new Xs(e,t,r,i));this.mergeVertices()}Ws.prototype=Object.create(sa.prototype);Ws.prototype.constructor=Ws;function Xs(e,t,r,i){wa.call(this);this.type="LatheBufferGeometry";this.parameters={points:e,segments:t,phiStart:r,phiLength:i};t=Math.floor(t)||12;r=r||0;i=i||2*Math.PI;i=Ot.clamp(i,0,2*Math.PI);var n=[];var a=[];var o=[];var s;var u=1/t;var c=new kt;var l=new jt;var h,d;for(h=0;h<=t;h++){var p=r+h*u*i;var f=Math.sin(p);var v=Math.cos(p);for(d=0;d<=e.length-1;d++){c.x=e[d].x*f;c.y=e[d].y;c.z=e[d].x*v;a.push(c.x,c.y,c.z);l.x=h/t;l.y=d/(e.length-1);o.push(l.x,l.y)}}for(h=0;h<t;h++)for(d=0;d<e.length-1;d++){s=d+h*e.length;var m=s;var g=s+e.length;var y=s+e.length+1;var A=s+1;n.push(m,g,A);n.push(g,y,A)}this.setIndex(n);this.addAttribute("position",new ma(a,3));this.addAttribute("uv",new ma(o,2));this.computeVertexNormals();if(i===2*Math.PI){var M=this.attributes.normal.array;var w=new kt;var E=new kt;var x=new kt;s=t*e.length*3;for(h=0,d=0;h<e.length;h++,d+=3){w.x=M[d+0];w.y=M[d+1];w.z=M[d+2];E.x=M[s+d+0];E.y=M[s+d+1];E.z=M[s+d+2];x.addVectors(w,E).normalize();M[d+0]=M[s+d+0]=x.x;M[d+1]=M[s+d+1]=x.y;M[d+2]=M[s+d+2]=x.z}}}Xs.prototype=Object.create(wa.prototype);Xs.prototype.constructor=Xs;function qs(e,t){sa.call(this);this.type="ShapeGeometry";if("object"===typeof t){console.warn("THREE.ShapeGeometry: Options parameter has been removed.");t=t.curveSegments}this.parameters={shapes:e,curveSegments:t};this.fromBufferGeometry(new Zs(e,t));this.mergeVertices()}qs.prototype=Object.create(sa.prototype);qs.prototype.constructor=qs;qs.prototype.toJSON=function(){var e=sa.prototype.toJSON.call(this);var t=this.parameters.shapes;return Js(t,e)};function Zs(e,t){wa.call(this);this.type="ShapeBufferGeometry";this.parameters={shapes:e,curveSegments:t};t=t||12;var r=[];var i=[];var n=[];var a=[];var o=0;var s=0;if(false===Array.isArray(e))c(e);else for(var u=0;u<e.length;u++){c(e[u]);this.addGroup(o,s,u);o+=s;s=0}this.setIndex(r);this.addAttribute("position",new ma(i,3));this.addAttribute("normal",new ma(n,3));this.addAttribute("uv",new ma(a,2));function c(e){var o,u,c;var l=i.length/3;var h=e.extractPoints(t);var d=h.shape;var p=h.holes;if(false===zs.isClockWise(d)){d=d.reverse();for(o=0,u=p.length;o<u;o++){c=p[o];true===zs.isClockWise(c)&&(p[o]=c.reverse())}}var f=zs.triangulateShape(d,p);for(o=0,u=p.length;o<u;o++){c=p[o];d=d.concat(c)}for(o=0,u=d.length;o<u;o++){var v=d[o];i.push(v.x,v.y,0);n.push(0,0,1);a.push(v.x,v.y)}for(o=0,u=f.length;o<u;o++){var m=f[o];var g=m[0]+l;var y=m[1]+l;var A=m[2]+l;r.push(g,y,A);s+=3}}}Zs.prototype=Object.create(wa.prototype);Zs.prototype.constructor=Zs;Zs.prototype.toJSON=function(){var e=wa.prototype.toJSON.call(this);var t=this.parameters.shapes;return Js(t,e)};function Js(e,t){t.shapes=[];if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var n=e[r];t.shapes.push(n.uuid)}else t.shapes.push(e.uuid);return t}function Ks(e,t){wa.call(this);this.type="EdgesGeometry";this.parameters={thresholdAngle:t};t=void 0!==t?t:1;var r=[];var i=Math.cos(Ot.DEG2RAD*t);var n=[0,0],a={},o,s;var u,c=["a","b","c"];var l;if(e.isBufferGeometry){l=new sa;l.fromBufferGeometry(e)}else l=e.clone();l.mergeVertices();l.computeFaceNormals();var h=l.vertices;var d=l.faces;for(var p=0,f=d.length;p<f;p++){var v=d[p];for(var m=0;m<3;m++){o=v[c[m]];s=v[c[(m+1)%3]];n[0]=Math.min(o,s);n[1]=Math.max(o,s);u=n[0]+","+n[1];void 0===a[u]?a[u]={index1:n[0],index2:n[1],face1:p,face2:void 0}:a[u].face2=p}}for(u in a){var g=a[u];if(void 0===g.face2||d[g.face1].normal.dot(d[g.face2].normal)<=i){var y=h[g.index1];r.push(y.x,y.y,y.z);y=h[g.index2];r.push(y.x,y.y,y.z)}}this.addAttribute("position",new ma(r,3))}Ks.prototype=Object.create(wa.prototype);Ks.prototype.constructor=Ks;function $s(e,t,r,i,n,a,o,s){sa.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:a,thetaStart:o,thetaLength:s};this.fromBufferGeometry(new eu(e,t,r,i,n,a,o,s));this.mergeVertices()}$s.prototype=Object.create(sa.prototype);$s.prototype.constructor=$s;function eu(e,t,r,i,n,a,o,s){wa.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:a,thetaStart:o,thetaLength:s};var u=this;e=void 0!==e?e:1;t=void 0!==t?t:1;r=r||1;i=Math.floor(i)||8;n=Math.floor(n)||1;a=void 0!==a&&a;o=void 0!==o?o:0;s=void 0!==s?s:2*Math.PI;var c=[];var l=[];var h=[];var d=[];var p=0;var f=[];var v=r/2;var m=0;g();if(false===a){e>0&&y(true);t>0&&y(false)}this.setIndex(c);this.addAttribute("position",new ma(l,3));this.addAttribute("normal",new ma(h,3));this.addAttribute("uv",new ma(d,2));function g(){var a,g;var y=new kt;var A=new kt;var M=0;var w=(t-e)/r;for(g=0;g<=n;g++){var E=[];var x=g/n;var b=x*(t-e)+e;for(a=0;a<=i;a++){var T=a/i;var L=T*s+o;var N=Math.sin(L);var D=Math.cos(L);A.x=b*N;A.y=-x*r+v;A.z=b*D;l.push(A.x,A.y,A.z);y.set(N,w,D).normalize();h.push(y.x,y.y,y.z);d.push(T,1-x);E.push(p++)}f.push(E)}for(a=0;a<i;a++)for(g=0;g<n;g++){var C=f[g][a];var S=f[g+1][a];var I=f[g+1][a+1];var _=f[g][a+1];c.push(C,S,_);c.push(S,I,_);M+=6}u.addGroup(m,M,0);m+=M}function y(r){var n,a,f;var g=new jt;var y=new kt;var A=0;var M=true===r?e:t;var w=true===r?1:-1;a=p;for(n=1;n<=i;n++){l.push(0,v*w,0);h.push(0,w,0);d.push(.5,.5);p++}f=p;for(n=0;n<=i;n++){var E=n/i;var x=E*s+o;var b=Math.cos(x);var T=Math.sin(x);y.x=M*T;y.y=v*w;y.z=M*b;l.push(y.x,y.y,y.z);h.push(0,w,0);g.x=.5*b+.5;g.y=.5*T*w+.5;d.push(g.x,g.y);p++}for(n=0;n<i;n++){var L=a+n;var N=f+n;true===r?c.push(N,N+1,L):c.push(N+1,N,L);A+=3}u.addGroup(m,A,true===r?1:2);m+=A}}eu.prototype=Object.create(wa.prototype);eu.prototype.constructor=eu;function tu(e,t,r,i,n,a,o){$s.call(this,0,e,t,r,i,n,a,o);this.type="ConeGeometry";this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:a,thetaLength:o}}tu.prototype=Object.create($s.prototype);tu.prototype.constructor=tu;function ru(e,t,r,i,n,a,o){eu.call(this,0,e,t,r,i,n,a,o);this.type="ConeBufferGeometry";this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:a,thetaLength:o}}ru.prototype=Object.create(eu.prototype);ru.prototype.constructor=ru;function iu(e,t,r,i){sa.call(this);this.type="CircleGeometry";this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i};this.fromBufferGeometry(new nu(e,t,r,i));this.mergeVertices()}iu.prototype=Object.create(sa.prototype);iu.prototype.constructor=iu;function nu(e,t,r,i){wa.call(this);this.type="CircleBufferGeometry";this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i};e=e||1;t=void 0!==t?Math.max(3,t):8;r=void 0!==r?r:0;i=void 0!==i?i:2*Math.PI;var n=[];var a=[];var o=[];var s=[];var u,c;var l=new kt;var h=new jt;a.push(0,0,0);o.push(0,0,1);s.push(.5,.5);for(c=0,u=3;c<=t;c++,u+=3){var d=r+c/t*i;l.x=e*Math.cos(d);l.y=e*Math.sin(d);a.push(l.x,l.y,l.z);o.push(0,0,1);h.x=(a[u]/e+1)/2;h.y=(a[u+1]/e+1)/2;s.push(h.x,h.y)}for(u=1;u<=t;u++)n.push(u,u+1,0);this.setIndex(n);this.addAttribute("position",new ma(a,3));this.addAttribute("normal",new ma(o,3));this.addAttribute("uv",new ma(s,2))}nu.prototype=Object.create(wa.prototype);nu.prototype.constructor=nu;var au=Object.freeze({WireframeGeometry:Go,ParametricGeometry:Ho,ParametricBufferGeometry:Vo,TetrahedronGeometry:Wo,TetrahedronBufferGeometry:Xo,OctahedronGeometry:qo,OctahedronBufferGeometry:Zo,IcosahedronGeometry:Jo,IcosahedronBufferGeometry:Ko,DodecahedronGeometry:$o,DodecahedronBufferGeometry:es,PolyhedronGeometry:Qo,PolyhedronBufferGeometry:Yo,TubeGeometry:ts,TubeBufferGeometry:rs,TorusKnotGeometry:is,TorusKnotBufferGeometry:ns,TorusGeometry:as,TorusBufferGeometry:os,TextGeometry:Fs,TextBufferGeometry:Gs,SphereGeometry:Hs,SphereBufferGeometry:Vs,RingGeometry:Qs,RingBufferGeometry:Ys,PlaneGeometry:ba,PlaneBufferGeometry:Ta,LatheGeometry:Ws,LatheBufferGeometry:Xs,ShapeGeometry:qs,ShapeBufferGeometry:Zs,ExtrudeGeometry:Us,ExtrudeBufferGeometry:Bs,EdgesGeometry:Ks,ConeGeometry:tu,ConeBufferGeometry:ru,CylinderGeometry:$s,CylinderBufferGeometry:eu,CircleGeometry:iu,CircleBufferGeometry:nu,BoxGeometry:Ea,BoxBufferGeometry:xa});function ou(e){Vn.call(this);this.type="ShadowMaterial";this.color=new jr(0);this.opacity=1;this.lights=true;this.transparent=true;this.setValues(e)}ou.prototype=Object.create(Vn.prototype);ou.prototype.constructor=ou;ou.prototype.isShadowMaterial=true;function su(e){Na.call(this,e);this.type="RawShaderMaterial"}su.prototype=Object.create(Na.prototype);su.prototype.constructor=su;su.prototype.isRawShaderMaterial=true;function uu(e){Vn.call(this);this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new jr(16777215);this.roughness=.5;this.metalness=.5;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new jr(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new jt(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.roughnessMap=null;this.metalnessMap=null;this.alphaMap=null;this.envMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}uu.prototype=Object.create(Vn.prototype);uu.prototype.constructor=uu;uu.prototype.isMeshStandardMaterial=true;uu.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.defines={STANDARD:""};this.color.copy(e.color);this.roughness=e.roughness;this.metalness=e.metalness;this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.roughnessMap=e.roughnessMap;this.metalnessMap=e.metalnessMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.envMapIntensity=e.envMapIntensity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function cu(e){uu.call(this);this.defines={PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.clearCoat=0;this.clearCoatRoughness=0;this.setValues(e)}cu.prototype=Object.create(uu.prototype);cu.prototype.constructor=cu;cu.prototype.isMeshPhysicalMaterial=true;cu.prototype.copy=function(e){uu.prototype.copy.call(this,e);this.defines={PHYSICAL:""};this.reflectivity=e.reflectivity;this.clearCoat=e.clearCoat;this.clearCoatRoughness=e.clearCoatRoughness;return this};function lu(e){Vn.call(this);this.type="MeshPhongMaterial";this.color=new jr(16777215);this.specular=new jr(1118481);this.shininess=30;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new jr(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new jt(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=J;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}lu.prototype=Object.create(Vn.prototype);lu.prototype.constructor=lu;lu.prototype.isMeshPhongMaterial=true;lu.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.color.copy(e.color);this.specular.copy(e.specular);this.shininess=e.shininess;this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function hu(e){lu.call(this);this.defines={TOON:""};this.type="MeshToonMaterial";this.gradientMap=null;this.setValues(e)}hu.prototype=Object.create(lu.prototype);hu.prototype.constructor=hu;hu.prototype.isMeshToonMaterial=true;hu.prototype.copy=function(e){lu.prototype.copy.call(this,e);this.gradientMap=e.gradientMap;return this};function du(e){Vn.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new jt(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}du.prototype=Object.create(Vn.prototype);du.prototype.constructor=du;du.prototype.isMeshNormalMaterial=true;du.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function pu(e){Vn.call(this);this.type="MeshLambertMaterial";this.color=new jr(16777215);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new jr(0);this.emissiveIntensity=1;this.emissiveMap=null;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=J;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(e)}pu.prototype=Object.create(Vn.prototype);pu.prototype.constructor=pu;pu.prototype.isMeshLambertMaterial=true;pu.prototype.copy=function(e){Vn.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};function fu(e){_o.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(e)}fu.prototype=Object.create(_o.prototype);fu.prototype.constructor=fu;fu.prototype.isLineDashedMaterial=true;fu.prototype.copy=function(e){_o.prototype.copy.call(this,e);this.scale=e.scale;this.dashSize=e.dashSize;this.gapSize=e.gapSize;return this};var vu=Object.freeze({ShadowMaterial:ou,SpriteMaterial:Lo,RawShaderMaterial:su,ShaderMaterial:Na,PointsMaterial:zo,MeshPhysicalMaterial:cu,MeshStandardMaterial:uu,MeshPhongMaterial:lu,MeshToonMaterial:hu,MeshNormalMaterial:du,MeshLambertMaterial:pu,MeshDepthMaterial:Qn,MeshDistanceMaterial:Yn,MeshBasicMaterial:La,LineDashedMaterial:fu,LineBasicMaterial:_o,Material:Vn});var mu={enabled:false,files:{},add:function(e,t){if(false===this.enabled)return;this.files[e]=t},get:function(e){if(false===this.enabled)return;return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function gu(e,t,r){var i=this;var n=false;var a=0;var o=0;var s=void 0;this.onStart=void 0;this.onLoad=e;this.onProgress=t;this.onError=r;this.itemStart=function(e){o++;false===n&&void 0!==i.onStart&&i.onStart(e,a,o);n=true};this.itemEnd=function(e){a++;void 0!==i.onProgress&&i.onProgress(e,a,o);if(a===o){n=false;void 0!==i.onLoad&&i.onLoad()}};this.itemError=function(e){void 0!==i.onError&&i.onError(e)};this.resolveURL=function(e){if(s)return s(e);return e};this.setURLModifier=function(e){s=e;return this}}var yu=new gu;var Au={};function Mu(e){this.manager=void 0!==e?e:yu}Object.assign(Mu.prototype,{load:function(e,t,r,i){void 0===e&&(e="");void 0!==this.path&&(e=this.path+e);e=this.manager.resolveURL(e);var n=this;var a=mu.get(e);if(void 0!==a){n.manager.itemStart(e);setTimeout(function(){t&&t(a);n.manager.itemEnd(e)},0);return a}if(void 0!==Au[e]){Au[e].push({onLoad:t,onProgress:r,onError:i});return}var o=/^data:(.*?)(;base64)?,(.*)$/;var s=e.match(o);if(s){var u=s[1];var c=!!s[2];var l=s[3];l=window.decodeURIComponent(l);c&&(l=window.atob(l));try{var h;var d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":var p=new Uint8Array(l.length);for(var f=0;f<l.length;f++)p[f]=l.charCodeAt(f);h="blob"===d?new Blob([p.buffer],{type:u}):p.buffer;break;case"document":var v=new DOMParser;h=v.parseFromString(l,u);break;case"json":h=JSON.parse(l);break;default:h=l;break}window.setTimeout(function(){t&&t(h);n.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){i&&i(t);n.manager.itemEnd(e);n.manager.itemError(e)},0)}}else{Au[e]=[];Au[e].push({onLoad:t,onProgress:r,onError:i});var m=new XMLHttpRequest;m.open("GET",e,true);m.addEventListener("load",function(t){var r=this.response;mu.add(e,r);var i=Au[e];delete Au[e];if(200===this.status){for(var a=0,o=i.length;a<o;a++){var s=i[a];s.onLoad&&s.onLoad(r)}n.manager.itemEnd(e)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var a=0,o=i.length;a<o;a++){var s=i[a];s.onLoad&&s.onLoad(r)}n.manager.itemEnd(e)}else{for(var a=0,o=i.length;a<o;a++){var s=i[a];s.onError&&s.onError(t)}n.manager.itemEnd(e);n.manager.itemError(e)}},false);m.addEventListener("progress",function(t){var r=Au[e];for(var i=0,n=r.length;i<n;i++){var a=r[i];a.onProgress&&a.onProgress(t)}},false);m.addEventListener("error",function(t){var r=Au[e];delete Au[e];for(var i=0,a=r.length;i<a;i++){var o=r[i];o.onError&&o.onError(t)}n.manager.itemEnd(e);n.manager.itemError(e)},false);void 0!==this.responseType&&(m.responseType=this.responseType);void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials);m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(var g in this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}n.manager.itemStart(e);return m},setPath:function(e){this.path=e;return this},setResponseType:function(e){this.responseType=e;return this},setWithCredentials:function(e){this.withCredentials=e;return this},setMimeType:function(e){this.mimeType=e;return this},setRequestHeader:function(e){this.requestHeader=e;return this}});function wu(e){this.manager=void 0!==e?e:yu;this._parser=null}Object.assign(wu.prototype,{load:function(e,t,r,i){var n=this;var a=[];var o=new Bo;o.image=a;var s=new Mu(this.manager);s.setPath(this.path);s.setResponseType("arraybuffer");function u(u){s.load(e[u],function(e){var r=n._parser(e,true);a[u]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps};c+=1;if(6===c){1===r.mipmapCount&&(o.minFilter=Ae);o.format=r.format;o.needsUpdate=true;t&&t(o)}},r,i)}if(Array.isArray(e)){var c=0;for(var l=0,h=e.length;l<h;++l)u(l)}else s.load(e,function(e){var r=n._parser(e,true);if(r.isCubemap){var i=r.mipmaps.length/r.mipmapCount;for(var s=0;s<i;s++){a[s]={mipmaps:[]};for(var u=0;u<r.mipmapCount;u++){a[s].mipmaps.push(r.mipmaps[s*r.mipmapCount+u]);a[s].format=r.format;a[s].width=r.width;a[s].height=r.height}}}else{o.image.width=r.width;o.image.height=r.height;o.mipmaps=r.mipmaps}1===r.mipmapCount&&(o.minFilter=Ae);o.format=r.format;o.needsUpdate=true;t&&t(o)},r,i);return o},setPath:function(e){this.path=e;return this}});function Eu(e){this.manager=void 0!==e?e:yu;this._parser=null}Object.assign(Eu.prototype,{load:function(e,t,r,i){var n=this;var a=new Vt;var o=new Mu(this.manager);o.setResponseType("arraybuffer");o.load(e,function(e){var r=n._parser(e);if(!r)return;if(void 0!==r.image)a.image=r.image;else if(void 0!==r.data){a.image.width=r.width;a.image.height=r.height;a.image.data=r.data}a.wrapS=void 0!==r.wrapS?r.wrapS:fe;a.wrapT=void 0!==r.wrapT?r.wrapT:fe;a.magFilter=void 0!==r.magFilter?r.magFilter:Ae;a.minFilter=void 0!==r.minFilter?r.minFilter:we;a.anisotropy=void 0!==r.anisotropy?r.anisotropy:1;void 0!==r.format&&(a.format=r.format);void 0!==r.type&&(a.type=r.type);void 0!==r.mipmaps&&(a.mipmaps=r.mipmaps);1===r.mipmapCount&&(a.minFilter=Ae);a.needsUpdate=true;t&&t(a,r)},r,i);return a}});function xu(e){this.manager=void 0!==e?e:yu}Object.assign(xu.prototype,{crossOrigin:"Anonymous",load:function(e,t,r,i){void 0===e&&(e="");void 0!==this.path&&(e=this.path+e);e=this.manager.resolveURL(e);var n=this;var a=mu.get(e);if(void 0!==a){n.manager.itemStart(e);setTimeout(function(){t&&t(a);n.manager.itemEnd(e)},0);return a}var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");o.addEventListener("load",function(){mu.add(e,this);t&&t(this);n.manager.itemEnd(e)},false);o.addEventListener("error",function(t){i&&i(t);n.manager.itemEnd(e);n.manager.itemError(e)},false);"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin);n.manager.itemStart(e);o.src=e;return o},setCrossOrigin:function(e){this.crossOrigin=e;return this},setPath:function(e){this.path=e;return this}});function bu(e){this.manager=void 0!==e?e:yu}Object.assign(bu.prototype,{crossOrigin:"Anonymous",load:function(e,t,r,i){var n=new Qt;var a=new xu(this.manager);a.setCrossOrigin(this.crossOrigin);a.setPath(this.path);var o=0;function s(r){a.load(e[r],function(e){n.images[r]=e;o++;if(6===o){n.needsUpdate=true;t&&t(n)}},void 0,i)}for(var u=0;u<e.length;++u)s(u);return n},setCrossOrigin:function(e){this.crossOrigin=e;return this},setPath:function(e){this.path=e;return this}});function Tu(e){this.manager=void 0!==e?e:yu}Object.assign(Tu.prototype,{crossOrigin:"Anonymous",load:function(e,t,r,i){var n=new Bt;var a=new xu(this.manager);a.setCrossOrigin(this.crossOrigin);a.setPath(this.path);a.load(e,function(r){n.image=r;var i=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);n.format=i?Re:ze;n.needsUpdate=true;void 0!==t&&t(n)},r,i);return n},setCrossOrigin:function(e){this.crossOrigin=e;return this},setPath:function(e){this.path=e;return this}});function Lu(){this.type="Curve";this.arcLengthDivisions=200}Object.assign(Lu.prototype,{getPoint:function(){console.warn("THREE.Curve: .getPoint() not implemented.");return null},getPointAt:function(e,t){var r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){void 0===e&&(e=5);var t=[];for(var r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);var t=[];for(var r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){void 0===e&&(e=this.arcLengthDivisions);if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=false;var t=[];var r,i=this.getPoint(0);var n,a=0;t.push(0);for(n=1;n<=e;n++){r=this.getPoint(n/e);a+=r.distanceTo(i);t.push(a);i=r}this.cacheArcLengths=t;return t},updateArcLengths:function(){this.needsUpdate=true;this.getLengths()},getUtoTmapping:function(e,t){var r=this.getLengths();var i=0,n=r.length;var a;a=t||e*r[n-1];var o=0,s=n-1,u;while(o<=s){i=Math.floor(o+(s-o)/2);u=r[i]-a;if(u<0)o=i+1;else{if(!(u>0)){s=i;break}s=i-1}}i=s;if(r[i]===a)return i/(n-1);var c=r[i];var l=r[i+1];var h=l-c;var d=(a-c)/h;var p=(i+d)/(n-1);return p},getTangent:function(e){var t=1e-4;var r=e-t;var i=e+t;r<0&&(r=0);i>1&&(i=1);var n=this.getPoint(r);var a=this.getPoint(i);var o=a.clone().sub(n);return o.normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var r=new kt;var i=[];var n=[];var a=[];var o=new kt;var s=new Rt;var u,c,l;for(u=0;u<=e;u++){c=u/e;i[u]=this.getTangentAt(c);i[u].normalize()}n[0]=new kt;a[0]=new kt;var h=Number.MAX_VALUE;var d=Math.abs(i[0].x);var p=Math.abs(i[0].y);var f=Math.abs(i[0].z);if(d<=h){h=d;r.set(1,0,0)}if(p<=h){h=p;r.set(0,1,0)}f<=h&&r.set(0,0,1);o.crossVectors(i[0],r).normalize();n[0].crossVectors(i[0],o);a[0].crossVectors(i[0],n[0]);for(u=1;u<=e;u++){n[u]=n[u-1].clone();a[u]=a[u-1].clone();o.crossVectors(i[u-1],i[u]);if(o.length()>Number.EPSILON){o.normalize();l=Math.acos(Ot.clamp(i[u-1].dot(i[u]),-1,1));n[u].applyMatrix4(s.makeRotationAxis(o,l))}a[u].crossVectors(i[u],n[u])}if(true===t){l=Math.acos(Ot.clamp(n[0].dot(n[e]),-1,1));l/=e;i[0].dot(o.crossVectors(n[0],n[e]))>0&&(l=-l);for(u=1;u<=e;u++){n[u].applyMatrix4(s.makeRotationAxis(i[u],l*u));a[u].crossVectors(i[u],n[u])}}return{tangents:i,normals:n,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.arcLengthDivisions=e.arcLengthDivisions;return this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};e.arcLengthDivisions=this.arcLengthDivisions;e.type=this.type;return e},fromJSON:function(e){this.arcLengthDivisions=e.arcLengthDivisions;return this}});function Nu(e,t,r,i,n,a,o,s){Lu.call(this);this.type="EllipseCurve";this.aX=e||0;this.aY=t||0;this.xRadius=r||1;this.yRadius=i||1;this.aStartAngle=n||0;this.aEndAngle=a||2*Math.PI;this.aClockwise=o||false;this.aRotation=s||0}Nu.prototype=Object.create(Lu.prototype);Nu.prototype.constructor=Nu;Nu.prototype.isEllipseCurve=true;Nu.prototype.getPoint=function(e,t){var r=t||new jt;var i=2*Math.PI;var n=this.aEndAngle-this.aStartAngle;var a=Math.abs(n)<Number.EPSILON;while(n<0)n+=i;while(n>i)n-=i;n<Number.EPSILON&&(n=a?0:i);true!==this.aClockwise||a||(n===i?n=-i:n-=i);var o=this.aStartAngle+e*n;var s=this.aX+this.xRadius*Math.cos(o);var u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var c=Math.cos(this.aRotation);var l=Math.sin(this.aRotation);var h=s-this.aX;var d=u-this.aY;s=h*c-d*l+this.aX;u=h*l+d*c+this.aY}return r.set(s,u)};Nu.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.aX=e.aX;this.aY=e.aY;this.xRadius=e.xRadius;this.yRadius=e.yRadius;this.aStartAngle=e.aStartAngle;this.aEndAngle=e.aEndAngle;this.aClockwise=e.aClockwise;this.aRotation=e.aRotation;return this};Nu.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.aX=this.aX;e.aY=this.aY;e.xRadius=this.xRadius;e.yRadius=this.yRadius;e.aStartAngle=this.aStartAngle;e.aEndAngle=this.aEndAngle;e.aClockwise=this.aClockwise;e.aRotation=this.aRotation;return e};Nu.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.aX=e.aX;this.aY=e.aY;this.xRadius=e.xRadius;this.yRadius=e.yRadius;this.aStartAngle=e.aStartAngle;this.aEndAngle=e.aEndAngle;this.aClockwise=e.aClockwise;this.aRotation=e.aRotation;return this};function Du(e,t,r,i,n,a){Nu.call(this,e,t,r,r,i,n,a);this.type="ArcCurve"}Du.prototype=Object.create(Nu.prototype);Du.prototype.constructor=Du;Du.prototype.isArcCurve=true;function Cu(){var e=0,t=0,r=0,i=0;function n(n,a,o,s){e=n;t=o;r=-3*n+3*a-2*o-s;i=2*n-2*a+o+s}return{initCatmullRom:function(e,t,r,i,a){n(t,r,a*(r-e),a*(i-t))},initNonuniformCatmullRom:function(e,t,r,i,a,o,s){var u=(t-e)/a-(r-e)/(a+o)+(r-t)/o;var c=(r-t)/o-(i-t)/(o+s)+(i-r)/s;u*=o;c*=o;n(t,r,u,c)},calc:function(n){var a=n*n;var o=a*n;return e+t*n+r*a+i*o}}}var Su=new kt;var Iu=new Cu;var _u=new Cu;var Ou=new Cu;function ju(e,t,r,i){Lu.call(this);this.type="CatmullRomCurve3";this.points=e||[];this.closed=t||false;this.curveType=r||"centripetal";this.tension=i||.5}ju.prototype=Object.create(Lu.prototype);ju.prototype.constructor=ju;ju.prototype.isCatmullRomCurve3=true;ju.prototype.getPoint=function(e,t){var r=t||new kt;var i=this.points;var n=i.length;var a=(n-(this.closed?0:1))*e;var o=Math.floor(a);var s=a-o;if(this.closed)o+=o>0?0:(Math.floor(Math.abs(o)/i.length)+1)*i.length;else if(0===s&&o===n-1){o=n-2;s=1}var u,c,l,h;if(this.closed||o>0)u=i[(o-1)%n];else{Su.subVectors(i[0],i[1]).add(i[0]);u=Su}c=i[o%n];l=i[(o+1)%n];if(this.closed||o+2<n)h=i[(o+2)%n];else{Su.subVectors(i[n-1],i[n-2]).add(i[n-1]);h=Su}if("centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25;var p=Math.pow(u.distanceToSquared(c),d);var f=Math.pow(c.distanceToSquared(l),d);var v=Math.pow(l.distanceToSquared(h),d);f<1e-4&&(f=1);p<1e-4&&(p=f);v<1e-4&&(v=f);Iu.initNonuniformCatmullRom(u.x,c.x,l.x,h.x,p,f,v);_u.initNonuniformCatmullRom(u.y,c.y,l.y,h.y,p,f,v);Ou.initNonuniformCatmullRom(u.z,c.z,l.z,h.z,p,f,v)}else if("catmullrom"===this.curveType){Iu.initCatmullRom(u.x,c.x,l.x,h.x,this.tension);_u.initCatmullRom(u.y,c.y,l.y,h.y,this.tension);Ou.initCatmullRom(u.z,c.z,l.z,h.z,this.tension)}r.set(Iu.calc(s),_u.calc(s),Ou.calc(s));return r};ju.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}this.closed=e.closed;this.curveType=e.curveType;this.tension=e.tension;return this};ju.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}e.closed=this.closed;e.curveType=this.curveType;e.tension=this.tension;return e};ju.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new kt).fromArray(i))}this.closed=e.closed;this.curveType=e.curveType;this.tension=e.tension;return this};function Ru(e,t,r,i,n){var a=.5*(i-t);var o=.5*(n-r);var s=e*e;var u=e*s;return(2*r-2*i+a+o)*u+(-3*r+3*i-2*a-o)*s+a*e+r}function zu(e,t){var r=1-e;return r*r*t}function ku(e,t){return 2*(1-e)*e*t}function Pu(e,t){return e*e*t}function Uu(e,t,r,i){return zu(e,t)+ku(e,r)+Pu(e,i)}function Bu(e,t){var r=1-e;return r*r*r*t}function Fu(e,t){var r=1-e;return 3*r*r*e*t}function Gu(e,t){return 3*(1-e)*e*e*t}function Hu(e,t){return e*e*e*t}function Vu(e,t,r,i,n){return Bu(e,t)+Fu(e,r)+Gu(e,i)+Hu(e,n)}function Qu(e,t,r,i){Lu.call(this);this.type="CubicBezierCurve";this.v0=e||new jt;this.v1=t||new jt;this.v2=r||new jt;this.v3=i||new jt}Qu.prototype=Object.create(Lu.prototype);Qu.prototype.constructor=Qu;Qu.prototype.isCubicBezierCurve=true;Qu.prototype.getPoint=function(e,t){var r=t||new jt;var i=this.v0,n=this.v1,a=this.v2,o=this.v3;r.set(Vu(e,i.x,n.x,a.x,o.x),Vu(e,i.y,n.y,a.y,o.y));return r};Qu.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);this.v3.copy(e.v3);return this};Qu.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();e.v3=this.v3.toArray();return e};Qu.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);this.v3.fromArray(e.v3);return this};function Yu(e,t,r,i){Lu.call(this);this.type="CubicBezierCurve3";this.v0=e||new kt;this.v1=t||new kt;this.v2=r||new kt;this.v3=i||new kt}Yu.prototype=Object.create(Lu.prototype);Yu.prototype.constructor=Yu;Yu.prototype.isCubicBezierCurve3=true;Yu.prototype.getPoint=function(e,t){var r=t||new kt;var i=this.v0,n=this.v1,a=this.v2,o=this.v3;r.set(Vu(e,i.x,n.x,a.x,o.x),Vu(e,i.y,n.y,a.y,o.y),Vu(e,i.z,n.z,a.z,o.z));return r};Yu.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);this.v3.copy(e.v3);return this};Yu.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();e.v3=this.v3.toArray();return e};Yu.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);this.v3.fromArray(e.v3);return this};function Wu(e,t){Lu.call(this);this.type="LineCurve";this.v1=e||new jt;this.v2=t||new jt}Wu.prototype=Object.create(Lu.prototype);Wu.prototype.constructor=Wu;Wu.prototype.isLineCurve=true;Wu.prototype.getPoint=function(e,t){var r=t||new jt;if(1===e)r.copy(this.v2);else{r.copy(this.v2).sub(this.v1);r.multiplyScalar(e).add(this.v1)}return r};Wu.prototype.getPointAt=function(e,t){return this.getPoint(e,t)};Wu.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()};Wu.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.v1.copy(e.v1);this.v2.copy(e.v2);return this};Wu.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e};Wu.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this};function Xu(e,t){Lu.call(this);this.type="LineCurve3";this.v1=e||new kt;this.v2=t||new kt}Xu.prototype=Object.create(Lu.prototype);Xu.prototype.constructor=Xu;Xu.prototype.isLineCurve3=true;Xu.prototype.getPoint=function(e,t){var r=t||new kt;if(1===e)r.copy(this.v2);else{r.copy(this.v2).sub(this.v1);r.multiplyScalar(e).add(this.v1)}return r};Xu.prototype.getPointAt=function(e,t){return this.getPoint(e,t)};Xu.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.v1.copy(e.v1);this.v2.copy(e.v2);return this};Xu.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e};Xu.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this};function qu(e,t,r){Lu.call(this);this.type="QuadraticBezierCurve";this.v0=e||new jt;this.v1=t||new jt;this.v2=r||new jt}qu.prototype=Object.create(Lu.prototype);qu.prototype.constructor=qu;qu.prototype.isQuadraticBezierCurve=true;qu.prototype.getPoint=function(e,t){var r=t||new jt;var i=this.v0,n=this.v1,a=this.v2;r.set(Uu(e,i.x,n.x,a.x),Uu(e,i.y,n.y,a.y));return r};qu.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);return this};qu.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e};qu.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this};function Zu(e,t,r){Lu.call(this);this.type="QuadraticBezierCurve3";this.v0=e||new kt;this.v1=t||new kt;this.v2=r||new kt}Zu.prototype=Object.create(Lu.prototype);Zu.prototype.constructor=Zu;Zu.prototype.isQuadraticBezierCurve3=true;Zu.prototype.getPoint=function(e,t){var r=t||new kt;var i=this.v0,n=this.v1,a=this.v2;r.set(Uu(e,i.x,n.x,a.x),Uu(e,i.y,n.y,a.y),Uu(e,i.z,n.z,a.z));return r};Zu.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.v0.copy(e.v0);this.v1.copy(e.v1);this.v2.copy(e.v2);return this};Zu.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.v0=this.v0.toArray();e.v1=this.v1.toArray();e.v2=this.v2.toArray();return e};Zu.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.v0.fromArray(e.v0);this.v1.fromArray(e.v1);this.v2.fromArray(e.v2);return this};function Ju(e){Lu.call(this);this.type="SplineCurve";this.points=e||[]}Ju.prototype=Object.create(Lu.prototype);Ju.prototype.constructor=Ju;Ju.prototype.isSplineCurve=true;Ju.prototype.getPoint=function(e,t){var r=t||new jt;var i=this.points;var n=(i.length-1)*e;var a=Math.floor(n);var o=n-a;var s=i[0===a?a:a-1];var u=i[a];var c=i[a>i.length-2?i.length-1:a+1];var l=i[a>i.length-3?i.length-1:a+2];r.set(Ru(o,s.x,u.x,c.x,l.x),Ru(o,s.y,u.y,c.y,l.y));return r};Ju.prototype.copy=function(e){Lu.prototype.copy.call(this,e);this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this};Ju.prototype.toJSON=function(){var e=Lu.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e};Ju.prototype.fromJSON=function(e){Lu.prototype.fromJSON.call(this,e);this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new jt).fromArray(i))}return this};var Ku=Object.freeze({ArcCurve:Du,CatmullRomCurve3:ju,CubicBezierCurve:Qu,CubicBezierCurve3:Yu,EllipseCurve:Nu,LineCurve:Wu,LineCurve3:Xu,QuadraticBezierCurve:qu,QuadraticBezierCurve3:Zu,SplineCurve:Ju});function $u(){Lu.call(this);this.type="CurvePath";this.curves=[];this.autoClose=false}$u.prototype=Object.assign(Object.create(Lu.prototype),{constructor:$u,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0);var t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Wu(t,e))},getPoint:function(e){var t=e*this.getLength();var r=this.getCurveLengths();var i=0;while(i<r.length){if(r[i]>=t){var n=r[i]-t;var a=this.curves[i];var o=a.getLength();var s=0===o?0:1-n/o;return a.getPointAt(s)}i++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=true;this.cacheLengths=null;this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;var e=[],t=0;for(var r=0,i=this.curves.length;r<i;r++){t+=this.curves[r].getLength();e.push(t)}this.cacheLengths=e;return e},getSpacedPoints:function(e){void 0===e&&(e=40);var t=[];for(var r=0;r<=e;r++)t.push(this.getPoint(r/e));this.autoClose&&t.push(t[0]);return t},getPoints:function(e){e=e||12;var t=[],r;for(var i=0,n=this.curves;i<n.length;i++){var a=n[i];var o=a&&a.isEllipseCurve?2*e:a&&a.isLineCurve?1:a&&a.isSplineCurve?e*a.points.length:e;var s=a.getPoints(o);for(var u=0;u<s.length;u++){var c=s[u];if(r&&r.equals(c))continue;t.push(c);r=c}}this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]);return t},copy:function(e){Lu.prototype.copy.call(this,e);this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push(i.clone())}this.autoClose=e.autoClose;return this},toJSON:function(){var e=Lu.prototype.toJSON.call(this);e.autoClose=this.autoClose;e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e},fromJSON:function(e){Lu.prototype.fromJSON.call(this,e);this.autoClose=e.autoClose;this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push((new Ku[i.type]).fromJSON(i))}return this}});function ec(e){$u.call(this);this.type="Path";this.currentPoint=new jt;e&&this.setFromPoints(e)}ec.prototype=Object.assign(Object.create($u.prototype),{constructor:ec,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new Wu(this.currentPoint.clone(),new jt(e,t));this.curves.push(r);this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,i){var n=new qu(this.currentPoint.clone(),new jt(e,t),new jt(r,i));this.curves.push(n);this.currentPoint.set(r,i)},bezierCurveTo:function(e,t,r,i,n,a){var o=new Qu(this.currentPoint.clone(),new jt(e,t),new jt(r,i),new jt(n,a));this.curves.push(o);this.currentPoint.set(n,a)},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e);var r=new Ju(t);this.curves.push(r);this.currentPoint.copy(e[e.length-1])},arc:function(e,t,r,i,n,a){var o=this.currentPoint.x;var s=this.currentPoint.y;this.absarc(e+o,t+s,r,i,n,a)},absarc:function(e,t,r,i,n,a){this.absellipse(e,t,r,r,i,n,a)},ellipse:function(e,t,r,i,n,a,o,s){var u=this.currentPoint.x;var c=this.currentPoint.y;this.absellipse(e+u,t+c,r,i,n,a,o,s)},absellipse:function(e,t,r,i,n,a,o,s){var u=new Nu(e,t,r,i,n,a,o,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);this.currentPoint.copy(l)},copy:function(e){$u.prototype.copy.call(this,e);this.currentPoint.copy(e.currentPoint);return this},toJSON:function(){var e=$u.prototype.toJSON.call(this);e.currentPoint=this.currentPoint.toArray();return e},fromJSON:function(e){$u.prototype.fromJSON.call(this,e);this.currentPoint.fromArray(e.currentPoint);return this}});function tc(e){ec.call(this,e);this.uuid=Ot.generateUUID();this.type="Shape";this.holes=[]}tc.prototype=Object.assign(Object.create(ec.prototype),{constructor:tc,getPointsHoles:function(e){var t=[];for(var r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){ec.prototype.copy.call(this,e);this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push(i.clone())}return this},toJSON:function(){var e=ec.prototype.toJSON.call(this);e.uuid=this.uuid;e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e},fromJSON:function(e){ec.prototype.fromJSON.call(this,e);this.uuid=e.uuid;this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push((new ec).fromJSON(i))}return this}});function rc(e,t){ra.call(this);this.type="Light";this.color=new jr(e);this.intensity=void 0!==t?t:1;this.receiveShadow=void 0}rc.prototype=Object.assign(Object.create(ra.prototype),{constructor:rc,isLight:true,copy:function(e){ra.prototype.copy.call(this,e);this.color.copy(e.color);this.intensity=e.intensity;return this},toJSON:function(e){var t=ra.prototype.toJSON.call(this,e);t.object.color=this.color.getHex();t.object.intensity=this.intensity;void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(t.object.distance=this.distance);void 0!==this.angle&&(t.object.angle=this.angle);void 0!==this.decay&&(t.object.decay=this.decay);void 0!==this.penumbra&&(t.object.penumbra=this.penumbra);void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON());return t}});function ic(e,t,r){rc.call(this,e,r);this.type="HemisphereLight";this.castShadow=void 0;this.position.copy(ra.DefaultUp);this.updateMatrix();this.groundColor=new jr(t)}ic.prototype=Object.assign(Object.create(rc.prototype),{constructor:ic,isHemisphereLight:true,copy:function(e){rc.prototype.copy.call(this,e);this.groundColor.copy(e.groundColor);return this}});function nc(e){this.camera=e;this.bias=0;this.radius=1;this.mapSize=new jt(512,512);this.map=null;this.matrix=new Rt}Object.assign(nc.prototype,{copy:function(e){this.camera=e.camera.clone();this.bias=e.bias;this.radius=e.radius;this.mapSize.copy(e.mapSize);return this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};0!==this.bias&&(e.bias=this.bias);1!==this.radius&&(e.radius=this.radius);512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray());e.camera=this.camera.toJSON(false).object;delete e.camera.matrix;return e}});function ac(){nc.call(this,new lo(50,1,.5,500))}ac.prototype=Object.assign(Object.create(nc.prototype),{constructor:ac,isSpotLightShadow:true,update:function(e){var t=this.camera;var r=2*Ot.RAD2DEG*e.angle;var i=this.mapSize.width/this.mapSize.height;var n=e.distance||t.far;if(r!==t.fov||i!==t.aspect||n!==t.far){t.fov=r;t.aspect=i;t.far=n;t.updateProjectionMatrix()}}});function oc(e,t,r,i,n,a){rc.call(this,e,t);this.type="SpotLight";this.position.copy(ra.DefaultUp);this.updateMatrix();this.target=new ra;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}});this.distance=void 0!==r?r:0;this.angle=void 0!==i?i:Math.PI/3;this.penumbra=void 0!==n?n:0;this.decay=void 0!==a?a:1;this.shadow=new ac}oc.prototype=Object.assign(Object.create(rc.prototype),{constructor:oc,isSpotLight:true,copy:function(e){rc.prototype.copy.call(this,e);this.distance=e.distance;this.angle=e.angle;this.penumbra=e.penumbra;this.decay=e.decay;this.target=e.target.clone();this.shadow=e.shadow.clone();return this}});function sc(e,t,r,i){rc.call(this,e,t);this.type="PointLight";Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}});this.distance=void 0!==r?r:0;this.decay=void 0!==i?i:1;this.shadow=new nc(new lo(90,1,.5,500))}sc.prototype=Object.assign(Object.create(rc.prototype),{constructor:sc,isPointLight:true,copy:function(e){rc.prototype.copy.call(this,e);this.distance=e.distance;this.decay=e.decay;this.shadow=e.shadow.clone();return this}});function uc(){nc.call(this,new na(-5,5,5,-5,.5,500))}uc.prototype=Object.assign(Object.create(nc.prototype),{constructor:uc});function cc(e,t){rc.call(this,e,t);this.type="DirectionalLight";this.position.copy(ra.DefaultUp);this.updateMatrix();this.target=new ra;this.shadow=new uc}cc.prototype=Object.assign(Object.create(rc.prototype),{constructor:cc,isDirectionalLight:true,copy:function(e){rc.prototype.copy.call(this,e);this.target=e.target.clone();this.shadow=e.shadow.clone();return this}});function lc(e,t){rc.call(this,e,t);this.type="AmbientLight";this.castShadow=void 0}lc.prototype=Object.assign(Object.create(rc.prototype),{constructor:lc,isAmbientLight:true});function hc(e,t,r,i){rc.call(this,e,t);this.type="RectAreaLight";this.width=void 0!==r?r:10;this.height=void 0!==i?i:10}hc.prototype=Object.assign(Object.create(rc.prototype),{constructor:hc,isRectAreaLight:true,copy:function(e){rc.prototype.copy.call(this,e);this.width=e.width;this.height=e.height;return this},toJSON:function(e){var t=rc.prototype.toJSON.call(this,e);t.object.width=this.width;t.object.height=this.height;return t}});function dc(e,t,r,i){xc.call(this,e,t,r,i)}dc.prototype=Object.assign(Object.create(xc.prototype),{constructor:dc,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ft,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function pc(e,t,r){xc.call(this,e,t,r)}pc.prototype=Object.assign(Object.create(xc.prototype),{constructor:pc,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ft,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function fc(e,t,r,i){this.parameterPositions=e;this._cachedIndex=0;this.resultBuffer=void 0!==i?i:new t.constructor(r);this.sampleValues=t;this.valueSize=r}Object.assign(fc.prototype,{evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{var a;r:{i:if(!(e<i)){for(var o=r+2;;){if(void 0===i){if(e<n)break i;r=t.length;this._cachedIndex=r;return this.afterEnd_(r-1,e,n)}if(r===o)break;n=i;i=t[++r];if(e<i)break t}a=t.length;break r}if(!(e>=n)){var s=t[1];if(e<s){r=2;n=s}for(var o=r-2;;){if(void 0===n){this._cachedIndex=0;return this.beforeStart_(0,e,i)}if(r===o)break;i=n;n=t[--r-1];if(e>=n)break t}a=r;r=0;break r}break e}while(r<a){var u=r+a>>>1;e<t[u]?a=u:r=u+1}i=t[r];n=t[r-1];if(void 0===n){this._cachedIndex=0;return this.beforeStart_(0,e,i)}if(void 0===i){r=t.length;this._cachedIndex=r;return this.afterEnd_(r-1,n,e)}}this._cachedIndex=r;this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(var a=0;a!==i;++a)t[a]=r[n+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});Object.assign(fc.prototype,{beforeStart_:fc.prototype.copySampleValue_,afterEnd_:fc.prototype.copySampleValue_});function vc(e,t,r,i){fc.call(this,e,t,r,i)}vc.prototype=Object.assign(Object.create(fc.prototype),{constructor:vc,interpolate_:function(e,t,r,i){var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=(r-t)/(i-t);for(var c=s+o;s!==c;s+=4)zt.slerpFlat(n,0,a,s-o,a,s,u);return n}});function mc(e,t,r,i){xc.call(this,e,t,r,i)}mc.prototype=Object.assign(Object.create(xc.prototype),{constructor:mc,ValueTypeName:"quaternion",DefaultInterpolation:vt,InterpolantFactoryMethodLinear:function(e){return new vc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0});function gc(e,t,r,i){xc.call(this,e,t,r,i)}gc.prototype=Object.assign(Object.create(xc.prototype),{constructor:gc,ValueTypeName:"color"});function yc(e,t,r,i){xc.call(this,e,t,r,i)}yc.prototype=Object.assign(Object.create(xc.prototype),{constructor:yc,ValueTypeName:"number"});function Ac(e,t,r,i){fc.call(this,e,t,r,i);this._weightPrev=-0;this._offsetPrev=-0;this._weightNext=-0;this._offsetNext=-0}Ac.prototype=Object.assign(Object.create(fc.prototype),{constructor:Ac,DefaultSettings_:{endingStart:gt,endingEnd:gt},intervalChanged_:function(e,t,r){var i=this.parameterPositions,n=e-2,a=e+1,o=i[n],s=i[a];if(void 0===o)switch(this.getSettings_().endingStart){case yt:n=e;o=2*t-r;break;case At:n=i.length-2;o=t+i[n]-i[n+1];break;default:n=e;o=r}if(void 0===s)switch(this.getSettings_().endingEnd){case yt:a=e;s=2*r-t;break;case At:a=1;s=r+i[1]-i[0];break;default:a=e-1;s=t}var u=.5*(r-t),c=this.valueSize;this._weightPrev=u/(t-o);this._weightNext=u/(s-r);this._offsetPrev=n*c;this._offsetNext=a*c},interpolate_:function(e,t,r,i){var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-t)/(i-t),f=p*p,v=f*p;var m=-h*v+2*h*f-h*p;var g=(1+h)*v+(-1.5-2*h)*f+(-.5+h)*p+1;var y=(-1-d)*v+(1.5+d)*f+.5*p;var A=d*v-d*f;for(var M=0;M!==o;++M)n[M]=m*a[c+M]+g*a[u+M]+y*a[s+M]+A*a[l+M];return n}});function Mc(e,t,r,i){fc.call(this,e,t,r,i)}Mc.prototype=Object.assign(Object.create(fc.prototype),{constructor:Mc,interpolate_:function(e,t,r,i){var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,c=(r-t)/(i-t),l=1-c;for(var h=0;h!==o;++h)n[h]=a[u+h]*l+a[s+h]*c;return n}});function wc(e,t,r,i){fc.call(this,e,t,r,i)}wc.prototype=Object.assign(Object.create(fc.prototype),{constructor:wc,interpolate_:function(e){return this.copySampleValue_(e-1)}});var Ec={arraySlice:function(e,t,r){if(Ec.isTypedArray(e))return new e.constructor(e.subarray(t,void 0!==r?r:e.length));return e.slice(t,r)},convertArray:function(e,t,r){if(!e||!r&&e.constructor===t)return e;if("number"===typeof t.BYTES_PER_ELEMENT)return new t(e);return Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function t(t,r){return e[t]-e[r]}var r=e.length;var i=new Array(r);for(var n=0;n!==r;++n)i[n]=n;i.sort(t);return i},sortedArray:function(e,t,r){var i=e.length;var n=new e.constructor(i);for(var a=0,o=0;o!==i;++a){var s=r[a]*t;for(var u=0;u!==t;++u)n[o++]=e[s+u]}return n},flattenJSON:function(e,t,r,i){var n=1,a=e[0];while(void 0!==a&&void 0===a[i])a=e[n++];if(void 0===a)return;var o=a[i];if(void 0===o)return;if(Array.isArray(o))do{o=a[i];if(void 0!==o){t.push(a.time);r.push.apply(r,o)}a=e[n++]}while(void 0!==a);else if(void 0!==o.toArray)do{o=a[i];if(void 0!==o){t.push(a.time);o.toArray(r,r.length)}a=e[n++]}while(void 0!==a);else do{o=a[i];if(void 0!==o){t.push(a.time);r.push(o)}a=e[n++]}while(void 0!==a)}};function xc(e,t,r,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e;this.times=Ec.convertArray(t,this.TimeBufferType);this.values=Ec.convertArray(r,this.ValueBufferType);this.setInterpolation(i||this.DefaultInterpolation);this.validate();this.optimize()}Object.assign(xc,{parse:function(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=xc._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var r=[],i=[];Ec.flattenJSON(e.keys,r,i,"value");e.times=r;e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t=e.constructor;var r;if(void 0!==t.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Ec.convertArray(e.times,Array),values:Ec.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}r.type=e.ValueTypeName;return r},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return yc;case"vector":case"vector2":case"vector3":case"vector4":return bc;case"color":return gc;case"quaternion":return mc;case"bool":case"boolean":return pc;case"string":return dc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}});Object.assign(xc.prototype,{constructor:xc,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:vt,InterpolantFactoryMethodDiscrete:function(e){return new wc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Mc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ac(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case ft:t=this.InterpolantFactoryMethodDiscrete;break;case vt:t=this.InterpolantFactoryMethodLinear;break;case mt:t=this.InterpolantFactoryMethodSmooth;break}if(void 0===t){var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",r);return}this.createInterpolant=t},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ft;case this.InterpolantFactoryMethodLinear:return vt;case this.InterpolantFactoryMethodSmooth:return mt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e){var t=this.times;for(var r=0,i=t.length;r!==i;++r)t[r]+=e}return this},scale:function(e){if(1!==e){var t=this.times;for(var r=0,i=t.length;r!==i;++r)t[r]*=e}return this},trim:function(e,t){var r=this.times,i=r.length,n=0,a=i-1;while(n!==i&&r[n]<e)++n;while(-1!==a&&r[a]>t)--a;++a;if(0!==n||a!==i){n>=a&&(a=Math.max(a,1),n=a-1);var o=this.getValueSize();this.times=Ec.arraySlice(r,n,a);this.values=Ec.arraySlice(this.values,n*o,a*o)}return this},validate:function(){var e=true;var t=this.getValueSize();if(t-Math.floor(t)!==0){console.error("THREE.KeyframeTrack: Invalid value size in track.",this);e=false}var r=this.times,i=this.values,n=r.length;if(0===n){console.error("THREE.KeyframeTrack: Track is empty.",this);e=false}var a=null;for(var o=0;o!==n;o++){var s=r[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s);e=false;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a);e=false;break}a=s}if(void 0!==i&&Ec.isTypedArray(i))for(var o=0,u=i.length;o!==u;++o){var c=i[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c);e=false;break}}return e},optimize:function(){var e=this.times,t=this.values,r=this.getValueSize(),i=this.getInterpolation()===mt,n=1,a=e.length-1;for(var o=1;o<a;++o){var s=false;var u=e[o];var c=e[o+1];if(u!==c&&(1!==o||u!==u[0]))if(i)s=true;else{var l=o*r,h=l-r,d=l+r;for(var p=0;p!==r;++p){var f=t[l+p];if(f!==t[h+p]||f!==t[d+p]){s=true;break}}}if(s){if(o!==n){e[n]=e[o];var v=o*r,m=n*r;for(var p=0;p!==r;++p)t[m+p]=t[v+p]}++n}}if(a>0){e[n]=e[a];for(var v=a*r,m=n*r,p=0;p!==r;++p)t[m+p]=t[v+p];++n}if(n!==e.length){this.times=Ec.arraySlice(e,0,n);this.values=Ec.arraySlice(t,0,n*r)}return this}});function bc(e,t,r,i){xc.call(this,e,t,r,i)}bc.prototype=Object.assign(Object.create(xc.prototype),{constructor:bc,ValueTypeName:"vector"});function Tc(e,t,r){this.name=e;this.tracks=r;this.duration=void 0!==t?t:-1;this.uuid=Ot.generateUUID();this.duration<0&&this.resetDuration();this.optimize()}Object.assign(Tc,{parse:function(e){var t=[],r=e.tracks,i=1/(e.fps||1);for(var n=0,a=r.length;n!==a;++n)t.push(xc.parse(r[n]).scale(i));return new Tc(e.name,e.duration,t)},toJSON:function(e){var t=[],r=e.tracks;var i={name:e.name,duration:e.duration,tracks:t};for(var n=0,a=r.length;n!==a;++n)t.push(xc.toJSON(r[n]));return i},CreateFromMorphTargetSequence:function(e,t,r,i){var n=t.length;var a=[];for(var o=0;o<n;o++){var s=[];var u=[];s.push((o+n-1)%n,o,(o+1)%n);u.push(0,1,0);var c=Ec.getKeyframeOrder(s);s=Ec.sortedArray(s,1,c);u=Ec.sortedArray(u,1,c);if(!i&&0===s[0]){s.push(n);u.push(u[0])}a.push(new yc(".morphTargetInfluences["+t[o].name+"]",s,u).scale(1/r))}return new Tc(e,-1,a)},findByName:function(e,t){var r=e;if(!Array.isArray(e)){var i=e;r=i.geometry&&i.geometry.animations||i.animations}for(var n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){var i={};var n=/^([\w-]*?)([\d]+)$/;for(var a=0,o=e.length;a<o;a++){var s=e[a];var u=s.name.match(n);if(u&&u.length>1){var c=u[1];var l=i[c];l||(i[c]=l=[]);l.push(s)}}var h=[];for(var c in i)h.push(Tc.CreateFromMorphTargetSequence(c,i[c],t,r));return h},parseAnimation:function(e,t){if(!e){console.error("THREE.AnimationClip: No animation in JSONLoader data.");return null}var r=function(e,t,r,i,n){if(0!==r.length){var a=[];var o=[];Ec.flattenJSON(r,a,o,i);0!==a.length&&n.push(new e(t,a,o))}};var i=[];var n=e.name||"default";var a=e.length||-1;var o=e.fps||30;var s=e.hierarchy||[];for(var u=0;u<s.length;u++){var c=s[u].keys;if(!c||0===c.length)continue;if(c[0].morphTargets){var l={};for(var h=0;h<c.length;h++)if(c[h].morphTargets)for(var d=0;d<c[h].morphTargets.length;d++)l[c[h].morphTargets[d]]=-1;for(var p in l){var f=[];var v=[];for(var d=0;d!==c[h].morphTargets.length;++d){var m=c[h];f.push(m.time);v.push(m.morphTarget===p?1:0)}i.push(new yc(".morphTargetInfluence["+p+"]",f,v))}a=l.length*(o||1)}else{var g=".bones["+t[u].name+"]";r(bc,g+".position",c,"pos",i);r(mc,g+".quaternion",c,"rot",i);r(bc,g+".scale",c,"scl",i)}}if(0===i.length)return null;var y=new Tc(n,a,i);return y}});Object.assign(Tc.prototype,{resetDuration:function(){var e=this.tracks,t=0;for(var r=0,i=e.length;r!==i;++r){var n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}this.duration=t},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}});function Lc(e){this.manager=void 0!==e?e:yu;this.textures={}}Object.assign(Lc.prototype,{load:function(e,t,r,i){var n=this;var a=new Mu(n.manager);a.load(e,function(e){t(n.parse(JSON.parse(e)))},r,i)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function r(e){void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e);return t[e]}var i=new vu[e.type];void 0!==e.uuid&&(i.uuid=e.uuid);void 0!==e.name&&(i.name=e.name);void 0!==e.color&&i.color.setHex(e.color);void 0!==e.roughness&&(i.roughness=e.roughness);void 0!==e.metalness&&(i.metalness=e.metalness);void 0!==e.emissive&&i.emissive.setHex(e.emissive);void 0!==e.specular&&i.specular.setHex(e.specular);void 0!==e.shininess&&(i.shininess=e.shininess);void 0!==e.clearCoat&&(i.clearCoat=e.clearCoat);void 0!==e.clearCoatRoughness&&(i.clearCoatRoughness=e.clearCoatRoughness);void 0!==e.uniforms&&(i.uniforms=e.uniforms);void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader);void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader);void 0!==e.vertexColors&&(i.vertexColors=e.vertexColors);void 0!==e.fog&&(i.fog=e.fog);void 0!==e.flatShading&&(i.flatShading=e.flatShading);void 0!==e.blending&&(i.blending=e.blending);void 0!==e.side&&(i.side=e.side);void 0!==e.opacity&&(i.opacity=e.opacity);void 0!==e.transparent&&(i.transparent=e.transparent);void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest);void 0!==e.depthTest&&(i.depthTest=e.depthTest);void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite);void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite);void 0!==e.wireframe&&(i.wireframe=e.wireframe);void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth);void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap);void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin);void 0!==e.rotation&&(i.rotation=e.rotation);1!==e.linewidth&&(i.linewidth=e.linewidth);void 0!==e.dashSize&&(i.dashSize=e.dashSize);void 0!==e.gapSize&&(i.gapSize=e.gapSize);void 0!==e.scale&&(i.scale=e.scale);void 0!==e.skinning&&(i.skinning=e.skinning);void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets);void 0!==e.dithering&&(i.dithering=e.dithering);void 0!==e.visible&&(i.visible=e.visible);void 0!==e.userData&&(i.userData=e.userData);void 0!==e.shading&&(i.flatShading=1===e.shading);void 0!==e.size&&(i.size=e.size);void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation);void 0!==e.map&&(i.map=r(e.map));if(void 0!==e.alphaMap){i.alphaMap=r(e.alphaMap);i.transparent=true}void 0!==e.bumpMap&&(i.bumpMap=r(e.bumpMap));void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale);void 0!==e.normalMap&&(i.normalMap=r(e.normalMap));if(void 0!==e.normalScale){var n=e.normalScale;false===Array.isArray(n)&&(n=[n,n]);i.normalScale=(new jt).fromArray(n)}void 0!==e.displacementMap&&(i.displacementMap=r(e.displacementMap));void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale);void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias);void 0!==e.roughnessMap&&(i.roughnessMap=r(e.roughnessMap));void 0!==e.metalnessMap&&(i.metalnessMap=r(e.metalnessMap));void 0!==e.emissiveMap&&(i.emissiveMap=r(e.emissiveMap));void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity);void 0!==e.specularMap&&(i.specularMap=r(e.specularMap));void 0!==e.envMap&&(i.envMap=r(e.envMap));void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity);void 0!==e.lightMap&&(i.lightMap=r(e.lightMap));void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity);void 0!==e.aoMap&&(i.aoMap=r(e.aoMap));void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity);void 0!==e.gradientMap&&(i.gradientMap=r(e.gradientMap));return i}});function Nc(e){this.manager=void 0!==e?e:yu}Object.assign(Nc.prototype,{load:function(e,t,r,i){var n=this;var a=new Mu(n.manager);a.load(e,function(e){t(n.parse(JSON.parse(e)))},r,i)},parse:function(e){var t=new wa;var r=e.data.index;if(void 0!==r){var i=new Dc[r.type](r.array);t.setIndex(new ua(i,1))}var n=e.data.attributes;for(var a in n){var o=n[a];var i=new Dc[o.type](o.array);t.addAttribute(a,new ua(i,o.itemSize,o.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var u=0,c=s.length;u!==c;++u){var l=s[u];t.addGroup(l.start,l.count,l.materialIndex)}var h=e.data.boundingSphere;if(void 0!==h){var d=new kt;void 0!==h.center&&d.fromArray(h.center);t.boundingSphere=new Xn(d,h.radius)}return t}});var Dc={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Cc(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}}Cc.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){var t=this.handlers;for(var r=0,i=t.length;r<i;r+=2){var n=t[r];var a=t[r+1];if(n.test(e))return a}return null}};Object.assign(Cc.prototype,{crossOrigin:void 0,initMaterials:function(e,t,r){var i=[];for(var n=0;n<e.length;++n)i[n]=this.createMaterial(e[n],t,r);return i},createMaterial:function(){var e={NoBlending:w,NormalBlending:E,AdditiveBlending:x,SubtractiveBlending:b,MultiplyBlending:T,CustomBlending:L};var t=new jr;var r=new Tu;var i=new Lc;return function n(a,o,s){var u={};function c(e,t,i,n,a){var c=o+e;var l=Cc.Handlers.get(c);var h;if(null!==l)h=l.load(c);else{r.setCrossOrigin(s);h=r.load(c)}if(void 0!==t){h.repeat.fromArray(t);1!==t[0]&&(h.wrapS=pe);1!==t[1]&&(h.wrapT=pe)}void 0!==i&&h.offset.fromArray(i);if(void 0!==n){"repeat"===n[0]&&(h.wrapS=pe);"mirror"===n[0]&&(h.wrapS=ve);"repeat"===n[1]&&(h.wrapT=pe);"mirror"===n[1]&&(h.wrapT=ve)}void 0!==a&&(h.anisotropy=a);var d=Ot.generateUUID();u[d]=h;return d}var l={uuid:Ot.generateUUID(),type:"MeshLambertMaterial"};for(var h in a){var d=a[h];switch(h){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=d;break;case"blending":l.blending=e[d];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",h,"is no longer supported.");break;case"colorDiffuse":l.color=t.fromArray(d).getHex();break;case"colorSpecular":l.specular=t.fromArray(d).getHex();break;case"colorEmissive":l.emissive=t.fromArray(d).getHex();break;case"specularCoef":l.shininess=d;break;case"shading":"basic"===d.toLowerCase()&&(l.type="MeshBasicMaterial");"phong"===d.toLowerCase()&&(l.type="MeshPhongMaterial");"standard"===d.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=c(d,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=c(d,a.mapEmissiveRepeat,a.mapEmissiveOffset,a.mapEmissiveWrap,a.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=c(d,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=c(d,a.mapAORepeat,a.mapAOOffset,a.mapAOWrap,a.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=c(d,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=d;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=c(d,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=[d,d];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=c(d,a.mapSpecularRepeat,a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=c(d,a.mapMetalnessRepeat,a.mapMetalnessOffset,a.mapMetalnessWrap,a.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=c(d,a.mapRoughnessRepeat,a.mapRoughnessOffset,a.mapRoughnessWrap,a.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=c(d,a.mapAlphaRepeat,a.mapAlphaOffset,a.mapAlphaWrap,a.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=f;break;case"doubleSided":l.side=v;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity");l.opacity=d;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[h]=d;break;case"vertexColors":true===d&&(l.vertexColors=M);"face"===d&&(l.vertexColors=A);break;default:console.error("THREE.Loader.createMaterial: Unsupported",h,d);break}}"MeshBasicMaterial"===l.type&&delete l.emissive;"MeshPhongMaterial"!==l.type&&delete l.specular;l.opacity<1&&(l.transparent=true);i.setTextures(u);return i.parse(l)}}()});var Sc={decodeText:function(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);var t="";for(var r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.split("/");if(1===t.length)return"./";t.pop();return t.join("/")+"/"}};function Ic(e){if("boolean"===typeof e){console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor.");e=void 0}this.manager=void 0!==e?e:yu;this.withCredentials=false}Object.assign(Ic.prototype,{load:function(e,t,r,i){var n=this;var a=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:Sc.extractUrlBase(e);var o=new Mu(this.manager);o.setWithCredentials(this.withCredentials);o.load(e,function(r){var i=JSON.parse(r);var o=i.metadata;if(void 0!==o){var s=o.type;if(void 0!==s){if("object"===s.toLowerCase()){console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");return}if("scene"===s.toLowerCase()){console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.");return}}}var u=n.parse(i,a);t(u.geometry,u.materials)},r,i)},setTexturePath:function(e){this.texturePath=e},parse:function(){function e(e,t){function r(e,t){return e&1<<t}var i,n,a,o,s,u,c,l,h,d,p,f,v,m,g,y,A,M,w,E,x,b,T,L,N,D,C,S=e.faces,I=e.vertices,_=e.normals,O=e.colors,j=e.scale,R=0;if(void 0!==e.uvs){for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&R++;for(i=0;i<R;i++)t.faceVertexUvs[i]=[]}o=0;s=I.length;while(o<s){M=new kt;M.x=I[o++]*j;M.y=I[o++]*j;M.z=I[o++]*j;t.vertices.push(M)}o=0;s=S.length;while(o<s){d=S[o++];p=r(d,0);f=r(d,1);v=r(d,3);m=r(d,4);g=r(d,5);y=r(d,6);A=r(d,7);if(p){E=new aa;E.a=S[o];E.b=S[o+1];E.c=S[o+3];x=new aa;x.a=S[o+1];x.b=S[o+2];x.c=S[o+3];o+=4;if(f){h=S[o++];E.materialIndex=h;x.materialIndex=h}a=t.faces.length;if(v)for(i=0;i<R;i++){L=e.uvs[i];t.faceVertexUvs[i][a]=[];t.faceVertexUvs[i][a+1]=[];for(n=0;n<4;n++){l=S[o++];D=L[2*l];C=L[2*l+1];N=new jt(D,C);2!==n&&t.faceVertexUvs[i][a].push(N);0!==n&&t.faceVertexUvs[i][a+1].push(N)}}if(m){c=3*S[o++];E.normal.set(_[c++],_[c++],_[c]);x.normal.copy(E.normal)}if(g)for(i=0;i<4;i++){c=3*S[o++];T=new kt(_[c++],_[c++],_[c]);2!==i&&E.vertexNormals.push(T);0!==i&&x.vertexNormals.push(T)}if(y){u=S[o++];b=O[u];E.color.setHex(b);x.color.setHex(b)}if(A)for(i=0;i<4;i++){u=S[o++];b=O[u];2!==i&&E.vertexColors.push(new jr(b));0!==i&&x.vertexColors.push(new jr(b))}t.faces.push(E);t.faces.push(x)}else{w=new aa;w.a=S[o++];w.b=S[o++];w.c=S[o++];if(f){h=S[o++];w.materialIndex=h}a=t.faces.length;if(v)for(i=0;i<R;i++){L=e.uvs[i];t.faceVertexUvs[i][a]=[];for(n=0;n<3;n++){l=S[o++];D=L[2*l];C=L[2*l+1];N=new jt(D,C);t.faceVertexUvs[i][a].push(N)}}if(m){c=3*S[o++];w.normal.set(_[c++],_[c++],_[c])}if(g)for(i=0;i<3;i++){c=3*S[o++];T=new kt(_[c++],_[c++],_[c]);w.vertexNormals.push(T)}if(y){u=S[o++];w.color.setHex(O[u])}if(A)for(i=0;i<3;i++){u=S[o++];w.vertexColors.push(new jr(O[u]))}t.faces.push(w)}}}function t(e,t){var r=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var i=0,n=e.skinWeights.length;i<n;i+=r){var a=e.skinWeights[i];var o=r>1?e.skinWeights[i+1]:0;var s=r>2?e.skinWeights[i+2]:0;var u=r>3?e.skinWeights[i+3]:0;t.skinWeights.push(new Ft(a,o,s,u))}if(e.skinIndices)for(var i=0,n=e.skinIndices.length;i<n;i+=r){var c=e.skinIndices[i];var l=r>1?e.skinIndices[i+1]:0;var h=r>2?e.skinIndices[i+2]:0;var d=r>3?e.skinIndices[i+3]:0;t.skinIndices.push(new Ft(c,l,h,d))}t.bones=e.bones;t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}function r(e,t){var r=e.scale;if(void 0!==e.morphTargets)for(var i=0,n=e.morphTargets.length;i<n;i++){t.morphTargets[i]={};t.morphTargets[i].name=e.morphTargets[i].name;t.morphTargets[i].vertices=[];var a=t.morphTargets[i].vertices;var o=e.morphTargets[i].vertices;for(var s=0,u=o.length;s<u;s+=3){var c=new kt;c.x=o[s]*r;c.y=o[s+1]*r;c.z=o[s+2]*r;a.push(c)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var l=t.faces;var h=e.morphColors[0].colors;for(var i=0,n=l.length;i<n;i++)l[i].color.fromArray(h,3*i)}}function i(e,t){var r=[];var i=[];void 0!==e.animation&&i.push(e.animation);void 0!==e.animations&&(e.animations.length?i=i.concat(e.animations):i.push(e.animations));for(var n=0;n<i.length;n++){var a=Tc.parseAnimation(i[n],t.bones);a&&r.push(a)}if(t.morphTargets){var o=Tc.CreateClipsFromMorphTargetSequences(t.morphTargets,10);r=r.concat(o)}r.length>0&&(t.animations=r)}return function n(a,o){void 0!==a.data&&(a=a.data);void 0!==a.scale?a.scale=1/a.scale:a.scale=1;var s=new sa;e(a,s);t(a,s);r(a,s);i(a,s);s.computeFaceNormals();s.computeBoundingSphere();if(void 0===a.materials||0===a.materials.length)return{geometry:s};var u=Cc.prototype.initMaterials(a.materials,o,this.crossOrigin);return{geometry:s,materials:u}}}()});function _c(e){this.manager=void 0!==e?e:yu;this.texturePath=""}Object.assign(_c.prototype,{load:function(e,t,r,i){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var n=this;var a=new Mu(n.manager);a.load(e,function(r){var a=null;try{a=JSON.parse(r)}catch(t){void 0!==i&&i(t);console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message);return}var o=a.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase()){console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.");return}n.parse(a,t)},r,i)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var r=this.parseShape(e.shapes);var i=this.parseGeometries(e.geometries,r);var n=this.parseImages(e.images,function(){void 0!==t&&t(s)});var a=this.parseTextures(e.textures,n);var o=this.parseMaterials(e.materials,a);var s=this.parseObject(e.object,i,o);e.animations&&(s.animations=this.parseAnimations(e.animations));void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s);return s},parseShape:function(e){var t={};if(void 0!==e)for(var r=0,i=e.length;r<i;r++){var n=(new tc).fromJSON(e[r]);t[n.uuid]=n}return t},parseGeometries:function(e,t){var r={};if(void 0!==e){var i=new Ic;var n=new Nc;for(var a=0,o=e.length;a<o;a++){var s;var u=e[a];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new au[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new au[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new au[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new au[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new au[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new au[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new au[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new au[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new au[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new au[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new au[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new au[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var c=[];for(var a=0,o=u.shapes.length;a<o;a++){var l=t[u.shapes[a]];c.push(l)}s=new au[u.type](c,u.curveSegments);break;case"BufferGeometry":s=n.parse(u);break;case"Geometry":s=i.parse(u,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}s.uuid=u.uuid;void 0!==u.name&&(s.name=u.name);r[u.uuid]=s}}return r},parseMaterials:function(e,t){var r={};if(void 0!==e){var i=new Lc;i.setTextures(t);for(var n=0,a=e.length;n<a;n++){var o=e[n];if("MultiMaterial"===o.type){var s=[];for(var u=0;u<o.materials.length;u++)s.push(i.parse(o.materials[u]));r[o.uuid]=s}else r[o.uuid]=i.parse(o)}}return r},parseAnimations:function(e){var t=[];for(var r=0;r<e.length;r++){var i=Tc.parse(e[r]);t.push(i)}return t},parseImages:function(e,t){var r=this;var i={};function n(e){r.manager.itemStart(e);return o.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemEnd(e);r.manager.itemError(e)})}if(void 0!==e&&e.length>0){var a=new gu(t);var o=new xu(a);o.setCrossOrigin(this.crossOrigin);for(var s=0,u=e.length;s<u;s++){var c=e[s];var l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:r.texturePath+c.url;i[c.uuid]=n(l)}}return i},parseTextures:function(e,t){function r(e,t){if("number"===typeof e)return e;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e);return t[e]}var i={};if(void 0!==e)for(var n=0,a=e.length;n<a;n++){var o=e[n];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid);void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=new Bt(t[o.image]);s.needsUpdate=true;s.uuid=o.uuid;void 0!==o.name&&(s.name=o.name);void 0!==o.mapping&&(s.mapping=r(o.mapping,Oc));void 0!==o.offset&&s.offset.fromArray(o.offset);void 0!==o.repeat&&s.repeat.fromArray(o.repeat);void 0!==o.center&&s.center.fromArray(o.center);void 0!==o.rotation&&(s.rotation=o.rotation);if(void 0!==o.wrap){s.wrapS=r(o.wrap[0],jc);s.wrapT=r(o.wrap[1],jc)}void 0!==o.minFilter&&(s.minFilter=r(o.minFilter,Rc));void 0!==o.magFilter&&(s.magFilter=r(o.magFilter,Rc));void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy);void 0!==o.flipY&&(s.flipY=o.flipY);i[o.uuid]=s}return i},parseObject:function(e,t,r){var i;function n(e){void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e);return t[e]}function a(e){if(void 0===e)return;if(Array.isArray(e)){var t=[];for(var i=0,n=e.length;i<n;i++){var a=e[i];void 0===r[a]&&console.warn("THREE.ObjectLoader: Undefined material",a);t.push(r[a])}return t}void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined material",e);return r[e]}switch(e.type){case"Scene":i=new To;void 0!==e.background&&Number.isInteger(e.background)&&(i.background=new jr(e.background));void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new bo(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new xo(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new lo(e.fov,e.aspect,e.near,e.far);void 0!==e.focus&&(i.focus=e.focus);void 0!==e.zoom&&(i.zoom=e.zoom);void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge);void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset);void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new na(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":i=new lc(e.color,e.intensity);break;case"DirectionalLight":i=new cc(e.color,e.intensity);break;case"PointLight":i=new sc(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new hc(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new oc(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new ic(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=n(e.geometry);var s=a(e.material);i=o.bones&&o.bones.length>0?new Io(o,s):new Ia(o,s);break;case"LOD":i=new Do;break;case"Line":i=new Oo(n(e.geometry),a(e.material),e.mode);break;case"LineLoop":i=new Ro(n(e.geometry),a(e.material));break;case"LineSegments":i=new jo(n(e.geometry),a(e.material));break;case"PointCloud":case"Points":i=new ko(n(e.geometry),a(e.material));break;case"Sprite":i=new No(a(e.material));break;case"Group":i=new Po;break;default:i=new ra}i.uuid=e.uuid;void 0!==e.name&&(i.name=e.name);if(void 0!==e.matrix){i.matrix.fromArray(e.matrix);i.matrix.decompose(i.position,i.quaternion,i.scale)}else{void 0!==e.position&&i.position.fromArray(e.position);void 0!==e.rotation&&i.rotation.fromArray(e.rotation);void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion);void 0!==e.scale&&i.scale.fromArray(e.scale)}void 0!==e.castShadow&&(i.castShadow=e.castShadow);void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow);if(e.shadow){void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias);void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius);void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize);void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))}void 0!==e.visible&&(i.visible=e.visible);void 0!==e.userData&&(i.userData=e.userData);if(void 0!==e.children){var u=e.children;for(var c=0;c<u.length;c++)i.add(this.parseObject(u[c],t,r))}if("LOD"===e.type){var l=e.levels;for(var h=0;h<l.length;h++){var d=l[h];var p=i.getObjectByProperty("uuid",d.object);void 0!==p&&i.addLevel(p,d.distance)}}return i}});var Oc={UVMapping:ae,CubeReflectionMapping:oe,CubeRefractionMapping:se,EquirectangularReflectionMapping:ue,EquirectangularRefractionMapping:ce,SphericalReflectionMapping:le,CubeUVReflectionMapping:he,CubeUVRefractionMapping:de};var jc={RepeatWrapping:pe,ClampToEdgeWrapping:fe,MirroredRepeatWrapping:ve};var Rc={NearestFilter:me,NearestMipMapNearestFilter:ge,NearestMipMapLinearFilter:ye,LinearFilter:Ae,LinearMipMapNearestFilter:Me,LinearMipMapLinearFilter:we};function zc(e){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");this.manager=void 0!==e?e:yu;this.options=void 0}zc.prototype={constructor:zc,setOptions:function e(t){this.options=t;return this},load:function e(t,r,i,n){void 0===t&&(t="");void 0!==this.path&&(t=this.path+t);var a=this;var o=mu.get(t);if(void 0!==o){a.manager.itemStart(t);setTimeout(function(){r&&r(o);a.manager.itemEnd(t)},0);return o}fetch(t).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,a.options)}).then(function(e){mu.add(t,e);r&&r(e);a.manager.itemEnd(t)}).catch(function(e){n&&n(e);a.manager.itemEnd(t);a.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(e){this.path=e;return this}};function kc(){this.type="ShapePath";this.subPaths=[];this.currentPath=null}Object.assign(kc.prototype,{moveTo:function(e,t){this.currentPath=new ec;this.subPaths.push(this.currentPath);this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,i){this.currentPath.quadraticCurveTo(e,t,r,i)},bezierCurveTo:function(e,t,r,i,n,a){this.currentPath.bezierCurveTo(e,t,r,i,n,a)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function r(e){var t=[];for(var r=0,i=e.length;r<i;r++){var n=e[r];var a=new tc;a.curves=n.curves;t.push(a)}return t}function i(e,t){var r=t.length;var i=false;for(var n=r-1,a=0;a<r;n=a++){var o=t[n];var s=t[a];var u=s.x-o.x;var c=s.y-o.y;if(Math.abs(c)>Number.EPSILON){if(c<0){o=t[a];u=-u;s=t[n];c=-c}if(e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return true}else{var l=c*(e.x-o.x)-u*(e.y-o.y);if(0===l)return true;if(l<0)continue;i=!i}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return true}}return i}var n=zs.isClockWise;var a=this.subPaths;if(0===a.length)return[];if(true===t)return r(a);var o,s,u,c=[];if(1===a.length){s=a[0];u=new tc;u.curves=s.curves;c.push(u);return c}var l=!n(a[0].getPoints());l=e?!l:l;var h=[];var d=[];var p=[];var f=0;var v;d[f]=void 0;p[f]=[];for(var m=0,g=a.length;m<g;m++){s=a[m];v=s.getPoints();o=n(v);o=e?!o:o;if(o){!l&&d[f]&&f++;d[f]={s:new tc,p:v};d[f].s.curves=s.curves;l&&f++;p[f]=[]}else p[f].push({h:s,p:v[0]})}if(!d[0])return r(a);if(d.length>1){var y=false;var A=[];for(var M=0,w=d.length;M<w;M++)h[M]=[];for(var M=0,w=d.length;M<w;M++){var E=p[M];for(var x=0;x<E.length;x++){var b=E[x];var T=true;for(var L=0;L<d.length;L++)if(i(b.p,d[L].p)){M!==L&&A.push({froms:M,tos:L,hole:x});if(T){T=false;h[L].push(b)}else y=true}T&&h[M].push(b)}}A.length>0&&(y||(p=h))}var N;for(var m=0,D=d.length;m<D;m++){u=d[m].s;c.push(u);N=p[m];for(var C=0,S=N.length;C<S;C++)u.holes.push(N[C].h)}return c}});function Pc(e){this.type="Font";this.data=e}Object.assign(Pc.prototype,{isFont:true,generateShapes:function(e,t,r){void 0===t&&(t=100);void 0===r&&(r=4);var i=[];var n=Uc(e,t,r,this.data);for(var a=0,o=n.length;a<o;a++)Array.prototype.push.apply(i,n[a].toShapes());return i}});function Uc(e,t,r,i){var n=String(e).split("");var a=t/i.resolution;var o=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*a;var s=[];var u=0,c=0;for(var l=0;l<n.length;l++){var h=n[l];if("\n"===h){u=0;c-=o}else{var d=Bc(h,r,a,u,c,i);u+=d.offsetX;s.push(d.path)}}return s}function Bc(e,t,r,i,n,a){var o=a.glyphs[e]||a.glyphs["?"];if(!o)return;var s=new kc;var u,c,l,h,d,p,f,v;if(o.o){var m=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(var g=0,y=m.length;g<y;){var A=m[g++];switch(A){case"m":u=m[g++]*r+i;c=m[g++]*r+n;s.moveTo(u,c);break;case"l":u=m[g++]*r+i;c=m[g++]*r+n;s.lineTo(u,c);break;case"q":l=m[g++]*r+i;h=m[g++]*r+n;d=m[g++]*r+i;p=m[g++]*r+n;s.quadraticCurveTo(d,p,l,h);break;case"b":l=m[g++]*r+i;h=m[g++]*r+n;d=m[g++]*r+i;p=m[g++]*r+n;f=m[g++]*r+i;v=m[g++]*r+n;s.bezierCurveTo(d,p,f,v,l,h);break}}}return{offsetX:o.ha*r,path:s}}function Fc(e){this.manager=void 0!==e?e:yu}Object.assign(Fc.prototype,{load:function(e,t,r,i){var n=this;var a=new Mu(this.manager);a.setPath(this.path);a.load(e,function(e){var r;try{r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.");r=JSON.parse(e.substring(65,e.length-2))}var i=n.parse(r);t&&t(i)},r,i)},parse:function(e){return new Pc(e)},setPath:function(e){this.path=e;return this}});var Gc;var Hc={getContext:function(){void 0===Gc&&(Gc=new(window.AudioContext||window.webkitAudioContext));return Gc},setContext:function(e){Gc=e}};function Vc(e){this.manager=void 0!==e?e:yu}Object.assign(Vc.prototype,{load:function(e,t,r,i){var n=new Mu(this.manager);n.setResponseType("arraybuffer");n.load(e,function(e){var r=Hc.getContext();r.decodeAudioData(e,function(e){t(e)})},r,i)}});function Qc(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new lo;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=false;this.cameraR=new lo;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=false}Object.assign(Qc.prototype,{update:function(){var e,t,r,i,n,a,o,s;var u=new Rt;var c=new Rt;return function l(h){var d=e!==this||t!==h.focus||r!==h.fov||i!==h.aspect*this.aspect||n!==h.near||a!==h.far||o!==h.zoom||s!==this.eyeSep;if(d){e=this;t=h.focus;r=h.fov;i=h.aspect*this.aspect;n=h.near;a=h.far;o=h.zoom;var p=h.projectionMatrix.clone();s=this.eyeSep/2;var f=s*n/t;var v=n*Math.tan(Ot.DEG2RAD*r*.5)/o;var m,g;c.elements[12]=-s;u.elements[12]=s;m=-v*i+f;g=v*i+f;p.elements[0]=2*n/(g-m);p.elements[8]=(g+m)/(g-m);this.cameraL.projectionMatrix.copy(p);m=-v*i-f;g=v*i-f;p.elements[0]=2*n/(g-m);p.elements[8]=(g+m)/(g-m);this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(h.matrixWorld).multiply(c);this.cameraR.matrixWorld.copy(h.matrixWorld).multiply(u)}}()});function Yc(e,t,r){ra.call(this);this.type="CubeCamera";var i=90,n=1;var a=new lo(i,n,e,t);a.up.set(0,-1,0);a.lookAt(new kt(1,0,0));this.add(a);var o=new lo(i,n,e,t);o.up.set(0,-1,0);o.lookAt(new kt(-1,0,0));this.add(o);var s=new lo(i,n,e,t);s.up.set(0,0,1);s.lookAt(new kt(0,1,0));this.add(s);var u=new lo(i,n,e,t);u.up.set(0,0,-1);u.lookAt(new kt(0,-1,0));this.add(u);var c=new lo(i,n,e,t);c.up.set(0,-1,0);c.lookAt(new kt(0,0,1));this.add(c);var l=new lo(i,n,e,t);l.up.set(0,-1,0);l.lookAt(new kt(0,0,-1));this.add(l);var h={format:Re,magFilter:Ae,minFilter:Ae};this.renderTarget=new Ht(r,r,h);this.renderTarget.texture.name="CubeCamera";this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget;var i=r.texture.generateMipmaps;r.texture.generateMipmaps=false;r.activeCubeFace=0;e.render(t,a,r);r.activeCubeFace=1;e.render(t,o,r);r.activeCubeFace=2;e.render(t,s,r);r.activeCubeFace=3;e.render(t,u,r);r.activeCubeFace=4;e.render(t,c,r);r.texture.generateMipmaps=i;r.activeCubeFace=5;e.render(t,l,r);e.setRenderTarget(null)};this.clear=function(e,t,r,i){var n=this.renderTarget;for(var a=0;a<6;a++){n.activeCubeFace=a;e.setRenderTarget(n);e.clear(t,r,i)}e.setRenderTarget(null)}}Yc.prototype=Object.create(ra.prototype);Yc.prototype.constructor=Yc;function Wc(){ra.call(this);this.type="AudioListener";this.context=Hc.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null}Wc.prototype=Object.assign(Object.create(ra.prototype),{constructor:Wc,getInput:function(){return this.gain},removeFilter:function(){if(null!==this.filter){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination);this.gain.connect(this.context.destination);this.filter=null}},getFilter:function(){return this.filter},setFilter:function(e){if(null!==this.filter){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination)}else this.gain.disconnect(this.context.destination);this.filter=e;this.gain.connect(this.filter);this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var e=new kt;var t=new zt;var r=new kt;var i=new kt;return function n(a){ra.prototype.updateMatrixWorld.call(this,a);var o=this.context.listener;var s=this.up;this.matrixWorld.decompose(e,t,r);i.set(0,0,-1).applyQuaternion(t);if(o.positionX){o.positionX.setValueAtTime(e.x,this.context.currentTime);o.positionY.setValueAtTime(e.y,this.context.currentTime);o.positionZ.setValueAtTime(e.z,this.context.currentTime);o.forwardX.setValueAtTime(i.x,this.context.currentTime);o.forwardY.setValueAtTime(i.y,this.context.currentTime);o.forwardZ.setValueAtTime(i.z,this.context.currentTime);o.upX.setValueAtTime(s.x,this.context.currentTime);o.upY.setValueAtTime(s.y,this.context.currentTime);o.upZ.setValueAtTime(s.z,this.context.currentTime)}else{o.setPosition(e.x,e.y,e.z);o.setOrientation(i.x,i.y,i.z,s.x,s.y,s.z)}}}()});function Xc(e){ra.call(this);this.type="Audio";this.context=e.context;this.gain=this.context.createGain();this.gain.connect(e.getInput());this.autoplay=false;this.buffer=null;this.loop=false;this.startTime=0;this.offset=0;this.playbackRate=1;this.isPlaying=false;this.hasPlaybackControl=true;this.sourceType="empty";this.filters=[]}Xc.prototype=Object.assign(Object.create(ra.prototype),{constructor:Xc,getOutput:function(){return this.gain},setNodeSource:function(e){this.hasPlaybackControl=false;this.sourceType="audioNode";this.source=e;this.connect();return this},setBuffer:function(e){this.buffer=e;this.sourceType="buffer";this.autoplay&&this.play();return this},play:function(){if(true===this.isPlaying){console.warn("THREE.Audio: Audio is already playing.");return}if(false===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}var e=this.context.createBufferSource();e.buffer=this.buffer;e.loop=this.loop;e.onended=this.onEnded.bind(this);e.playbackRate.setValueAtTime(this.playbackRate,this.startTime);this.startTime=this.context.currentTime;e.start(this.startTime,this.offset);this.isPlaying=true;this.source=e;return this.connect()},pause:function(){if(false===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}if(true===this.isPlaying){this.source.stop();this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate;this.isPlaying=false}return this},stop:function(){if(false===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}this.source.stop();this.offset=0;this.isPlaying=false;return this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){e||(e=[]);if(true===this.isPlaying){this.disconnect();this.filters=e;this.connect()}else this.filters=e;return this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(false===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}this.playbackRate=e;true===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime);return this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=false},getLoop:function(){if(false===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return false}return this.loop},setLoop:function(e){if(false===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}this.loop=e;true===this.isPlaying&&(this.source.loop=this.loop);return this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){this.gain.gain.value=e;return this}});function qc(e){Xc.call(this,e);this.panner=this.context.createPanner();this.panner.connect(this.gain)}qc.prototype=Object.assign(Object.create(Xc.prototype),{constructor:qc,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new kt;return function t(r){ra.prototype.updateMatrixWorld.call(this,r);e.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(e.x,e.y,e.z)}}()});function Zc(e,t){this.analyser=e.context.createAnalyser();this.analyser.fftSize=void 0!==t?t:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);e.getOutput().connect(this.analyser)}Object.assign(Zc.prototype,{getFrequencyData:function(){this.analyser.getByteFrequencyData(this.data);return this.data},getAverageFrequency:function(){var e=0,t=this.getFrequencyData();for(var r=0;r<t.length;r++)e+=t[r];return e/t.length}});function Jc(e,t,r){this.binding=e;this.valueSize=r;var i=Float64Array,n;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":i=Array;n=this._select;break;default:n=this._lerp}this.buffer=new i(4*r);this._mixBufferRegion=n;this.cumulativeWeight=0;this.useCount=0;this.referenceCount=0}Object.assign(Jc.prototype,{accumulate:function(e,t){var r=this.buffer,i=this.valueSize,n=e*i+i,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==i;++o)r[n+o]=r[o];a=t}else{a+=t;var s=t/a;this._mixBufferRegion(r,n,0,s,i)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,a=this.binding;this.cumulativeWeight=0;if(n<1){var o=3*t;this._mixBufferRegion(r,i,o,1-n,t)}for(var s=t,u=t+t;s!==u;++s)if(r[s]!==r[s+t]){a.setValue(r,i);break}},saveOriginalState:function(){var e=this.binding;var t=this.buffer,r=this.valueSize,i=3*r;e.getValue(t,i);for(var n=r,a=i;n!==a;++n)t[n]=t[i+n%r];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,r,i,n){if(i>=.5)for(var a=0;a!==n;++a)e[t+a]=e[r+a]},_slerp:function(e,t,r,i){zt.slerpFlat(e,t,e,t,e,r,i)},_lerp:function(e,t,r,i,n){var a=1-i;for(var o=0;o!==n;++o){var s=t+o;e[s]=e[s]*a+e[r+o]*i}}});var Kc="\\[\\]\\.:\\/";function $c(e,t,r){var i=r||el.parseTrackName(t);this._targetGroup=e;this._bindings=e.subscribe_(t,i)}Object.assign($c.prototype,{getValue:function(e,t){this.bind();var r=this._targetGroup.nCachedObjects_,i=this._bindings[r];void 0!==i&&i.getValue(e,t)},setValue:function(e,t){var r=this._bindings;for(var i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)},bind:function(){var e=this._bindings;for(var t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){var e=this._bindings;for(var t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}});function el(e,t,r){this.path=t;this.parsedPath=r||el.parseTrackName(t);this.node=el.findNode(e,this.parsedPath.nodeName)||e;this.rootNode=e}Object.assign(el,{Composite:$c,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new el.Composite(e,t,r):new el(e,t,r)},sanitizeNodeName:function(){var e=new RegExp("["+Kc+"]","g");return function t(r){return r.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var e="[^"+Kc+"]";var t="[^"+Kc.replace("\\.","")+"]";var r=/((?:WC+[\/:])*)/.source.replace("WC",e);var i=/(WCOD+)?/.source.replace("WCOD",t);var n=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e);var a=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e);var o=new RegExp("^"+r+i+n+a+"$");var s=["material","materials","bones"];return function e(t){var r=o.exec(t);if(!r)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var i={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]};var n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var a=i.nodeName.substring(n+1);if(-1!==s.indexOf(a)){i.nodeName=i.nodeName.substring(0,n);i.objectName=a}}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){var i=function(e){for(var r=0;r<e.length;r++){var n=e[r];if(n.name===t||n.uuid===t)return n;var a=i(n.children);if(a)return a}return null};var n=i(e.children);if(n)return n}return null}});Object.assign(el.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function e(t,r){t[r]=this.node[this.propertyName]},function e(t,r){var i=this.resolvedProperty;for(var n=0,a=i.length;n!==a;++n)t[r++]=i[n]},function e(t,r){t[r]=this.resolvedProperty[this.propertyIndex]},function e(t,r){this.resolvedProperty.toArray(t,r)}],SetterByBindingTypeAndVersioning:[[function e(t,r){this.targetObject[this.propertyName]=t[r]},function e(t,r){this.targetObject[this.propertyName]=t[r];this.targetObject.needsUpdate=true},function e(t,r){this.targetObject[this.propertyName]=t[r];this.targetObject.matrixWorldNeedsUpdate=true}],[function e(t,r){var i=this.resolvedProperty;for(var n=0,a=i.length;n!==a;++n)i[n]=t[r++]},function e(t,r){var i=this.resolvedProperty;for(var n=0,a=i.length;n!==a;++n)i[n]=t[r++];this.targetObject.needsUpdate=true},function e(t,r){var i=this.resolvedProperty;for(var n=0,a=i.length;n!==a;++n)i[n]=t[r++];this.targetObject.matrixWorldNeedsUpdate=true}],[function e(t,r){this.resolvedProperty[this.propertyIndex]=t[r]},function e(t,r){this.resolvedProperty[this.propertyIndex]=t[r];this.targetObject.needsUpdate=true},function e(t,r){this.resolvedProperty[this.propertyIndex]=t[r];this.targetObject.matrixWorldNeedsUpdate=true}],[function e(t,r){this.resolvedProperty.fromArray(t,r)},function e(t,r){this.resolvedProperty.fromArray(t,r);this.targetObject.needsUpdate=true},function e(t,r){this.resolvedProperty.fromArray(t,r);this.targetObject.matrixWorldNeedsUpdate=true}]],getValue:function e(t,r){this.bind();this.getValue(t,r)},setValue:function e(t,r){this.bind();this.setValue(t,r)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(!e){e=el.findNode(this.rootNode,t.nodeName)||this.rootNode;this.node=e}this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){var a=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[r]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(void 0!==a){if(void 0===e[a]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[a]}}var s=e[i];if(void 0===s){var u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}var c=this.Versioning.None;if(void 0!==e.needsUpdate){c=this.Versioning.NeedsUpdate;this.targetObject=e}else if(void 0!==e.matrixWorldNeedsUpdate){c=this.Versioning.MatrixWorldNeedsUpdate;this.targetObject=e}var l=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===i){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(var o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===n){n=o;break}}else{if(!e.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(var o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===n){n=o;break}}}l=this.BindingType.ArrayElement;this.resolvedProperty=s;this.propertyIndex=n}else if(void 0!==s.fromArray&&void 0!==s.toArray){l=this.BindingType.HasFromToArray;this.resolvedProperty=s}else if(Array.isArray(s)){l=this.BindingType.EntireArray;this.resolvedProperty=s}else this.propertyName=i;this.getValue=this.GetterByBindingType[l];this.setValue=this.SetterByBindingTypeAndVersioning[l][c]},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});Object.assign(el.prototype,{_getValue_unbound:el.prototype.getValue,_setValue_unbound:el.prototype.setValue});function tl(){this.uuid=Ot.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}Object.assign(tl.prototype,{isAnimationObjectGroup:true,add:function(){var e=this._objects,t=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,n=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,u=void 0;for(var c=0,l=arguments.length;c!==l;++c){var h=arguments[c],d=h.uuid,p=i[d];if(void 0===p){p=t++;i[d]=p;e.push(h);for(var f=0,v=s;f!==v;++f)o[f].push(new el(h,n[f],a[f]))}else if(p<r){u=e[p];var m=--r,g=e[m];i[g.uuid]=p;e[p]=g;i[d]=m;e[m]=h;for(var f=0,v=s;f!==v;++f){var y=o[f],A=y[m],M=y[p];y[p]=A;void 0===M&&(M=new el(h,n[f],a[f]));y[m]=M}}else e[p]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){var e=this._objects,t=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,n=i.length;for(var a=0,o=arguments.length;a!==o;++a){var s=arguments[a],u=s.uuid,c=r[u];if(void 0!==c&&c>=t){var l=t++,h=e[l];r[h.uuid]=c;e[c]=h;r[u]=l;e[l]=s;for(var d=0,p=n;d!==p;++d){var f=i[d],v=f[l],m=f[c];f[c]=v;f[l]=m}}}this.nCachedObjects_=t},uncache:function(){var e=this._objects,t=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,a=n.length;for(var o=0,s=arguments.length;o!==s;++o){var u=arguments[o],c=u.uuid,l=i[c];if(void 0!==l){delete i[c];if(l<r){var h=--r,d=e[h],p=--t,f=e[p];i[d.uuid]=l;e[l]=d;i[f.uuid]=h;e[h]=f;e.pop();for(var v=0,m=a;v!==m;++v){var g=n[v],y=g[h],A=g[p];g[l]=y;g[h]=A;g.pop()}}else{var p=--t,f=e[p];i[f.uuid]=l;e[l]=f;e.pop();for(var v=0,m=a;v!==m;++v){var g=n[v];g[l]=g[p];g.pop()}}}}this.nCachedObjects_=r},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,i=r[e],n=this._bindings;if(void 0!==i)return n[i];var a=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);i=n.length;r[e]=i;a.push(e);o.push(t);n.push(l);for(var h=c,d=s.length;h!==d;++h){var p=s[h];l[h]=new el(p,e,t)}return l},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){var i=this._paths,n=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o],u=e[o];t[u]=r;a[r]=s;a.pop();n[r]=n[o];n.pop();i[r]=i[o];i.pop()}}});function rl(e,t,r){this._mixer=e;this._clip=t;this._localRoot=r||null;var i=t.tracks,n=i.length,a=new Array(n);var o={endingStart:gt,endingEnd:gt};for(var s=0;s!==n;++s){var u=i[s].createInterpolant(null);a[s]=u;u.settings=o}this._interpolantSettings=o;this._interpolants=a;this._propertyBindings=new Array(n);this._cacheIndex=null;this._byClipCacheIndex=null;this._timeScaleInterpolant=null;this._weightInterpolant=null;this.loop=dt;this._loopCount=-1;this._startTime=null;this.time=0;this.timeScale=1;this._effectiveTimeScale=1;this.weight=1;this._effectiveWeight=1;this.repetitions=Infinity;this.paused=false;this.enabled=true;this.clampWhenFinished=false;this.zeroSlopeAtStart=true;this.zeroSlopeAtEnd=true}Object.assign(rl.prototype,{play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},reset:function(){this.paused=false;this.enabled=true;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){this._startTime=e;return this},setLoop:function(e,t){this.loop=e;this.repetitions=t;return this},setEffectiveWeight:function(e){this.weight=e;this._effectiveWeight=this.enabled?e:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){e.fadeOut(t);this.fadeIn(t);if(r){var i=this._clip.duration,n=e._clip.duration,a=n/i,o=i/n;e.warp(1,a,t);this.warp(o,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;if(null!==e){this._weightInterpolant=null;this._mixer._takeBackControlInterpolant(e)}return this},setEffectiveTimeScale:function(e){this.timeScale=e;this._effectiveTimeScale=this.paused?0:e;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){this.timeScale=this._clip.duration/e;return this.stopWarping()},syncWith:function(e){this.time=e.time;this.timeScale=e.timeScale;return this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){var i=this._mixer,n=i.time,a=this._timeScaleInterpolant,o=this.timeScale;if(null===a){a=i._lendControlInterpolant();this._timeScaleInterpolant=a}var s=a.parameterPositions,u=a.sampleValues;s[0]=n;s[1]=n+r;u[0]=e/o;u[1]=t/o;return this},stopWarping:function(){var e=this._timeScaleInterpolant;if(null!==e){this._timeScaleInterpolant=null;this._mixer._takeBackControlInterpolant(e)}return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}var n=this._startTime;if(null!==n){var a=(e-n)*r;if(a<0||0===r)return;this._startTime=null;t=r*a}t*=this._updateTimeScale(e);var o=this._updateTime(t);var s=this._updateWeight(e);if(s>0){var u=this._interpolants;var c=this._propertyBindings;for(var l=0,h=u.length;l!==h;++l){u[l].evaluate(o);c[l].accumulate(i,s)}}},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var r=this._weightInterpolant;if(null!==r){var i=r.evaluate(e)[0];t*=i;if(e>r.parameterPositions[1]){this.stopFading();0===i&&(this.enabled=false)}}}this._effectiveWeight=t;return t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r){var i=r.evaluate(e)[0];t*=i;if(e>r.parameterPositions[1]){this.stopWarping();0===t?this.paused=true:this.timeScale=t}}}this._effectiveTimeScale=t;return t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var r=this._clip.duration,i=this.loop,n=this._loopCount;if(i===ht){if(-1===n){this._loopCount=0;this._setEndings(true,true,false)}e:{if(t>=r)t=r;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=true:this.enabled=false;this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var a=i===pt;if(-1===n)if(e>=0){n=0;this._setEndings(true,0===this.repetitions,a)}else this._setEndings(0===this.repetitions,true,a);if(t>=r||t<0){var o=Math.floor(t/r);t-=r*o;n+=Math.abs(o);var s=this.repetitions-n;if(s<0){this.clampWhenFinished?this.paused=true:this.enabled=false;t=e>0?r:0;this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1})}else{if(0===s){var u=e<0;this._setEndings(u,!u,a)}else this._setEndings(false,false,a);this._loopCount=n;this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1===(1&n)){this.time=t;return r-t}}this.time=t;return t},_setEndings:function(e,t,r){var i=this._interpolantSettings;if(r){i.endingStart=yt;i.endingEnd=yt}else{i.endingStart=e?this.zeroSlopeAtStart?yt:gt:At;i.endingEnd=t?this.zeroSlopeAtEnd?yt:gt:At}},_scheduleFading:function(e,t,r){var i=this._mixer,n=i.time,a=this._weightInterpolant;if(null===a){a=i._lendControlInterpolant();this._weightInterpolant=a}var o=a.parameterPositions,s=a.sampleValues;o[0]=n;s[0]=t;o[1]=n+e;s[1]=r;return this}});function il(e){this._root=e;this._initMemoryManager();this._accuIndex=0;this.time=0;this.timeScale=1}il.prototype=Object.assign(Object.create(t.prototype),{constructor:il,_bindAction:function(e,t){var r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,a=e._propertyBindings,o=e._interpolants,s=r.uuid,u=this._bindingsByRootAndName,c=u[s];if(void 0===c){c={};u[s]=c}for(var l=0;l!==n;++l){var h=i[l],d=h.name,p=c[d];if(void 0!==p)a[l]=p;else{p=a[l];if(void 0!==p){if(null===p._cacheIndex){++p.referenceCount;this._addInactiveBinding(p,s,d)}continue}var f=t&&t._propertyBindings[l].binding.parsedPath;p=new Jc(el.create(r,d,f),h.ValueTypeName,h.getValueSize());++p.referenceCount;this._addInactiveBinding(p,s,d);a[l]=p}o[l].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,r=e._clip.uuid,i=this._actionsByClip[r];this._bindAction(e,i&&i.knownActions[0]);this._addInactiveAction(e,r,t)}var n=e._propertyBindings;for(var a=0,o=n.length;a!==o;++a){var s=n[a];if(0===s.useCount++){this._lendBinding(s);s.saveOriginalState()}}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){var t=e._propertyBindings;for(var r=0,i=t.length;r!==i;++r){var n=t[r];if(0===--n.useCount){n.restoreOriginalState();this._takeBackBinding(n)}}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){var i=this._actions,n=this._actionsByClip,a=n[t];if(void 0===a){a={knownActions:[e],actionByRoot:{}};e._byClipCacheIndex=0;n[t]=a}else{var o=a.knownActions;e._byClipCacheIndex=o.length;o.push(e)}e._cacheIndex=i.length;i.push(e);a.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i;t[i]=r;t.pop();e._cacheIndex=null;var n=e._clip.uuid,a=this._actionsByClip,o=a[n],s=o.knownActions,u=s[s.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c;s[c]=u;s.pop();e._byClipCacheIndex=null;var l=o.actionByRoot,h=(e._localRoot||this._root).uuid;delete l[h];0===s.length&&delete a[n];this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){var t=e._propertyBindings;for(var r=0,i=t.length;r!==i;++r){var n=t[r];0===--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i;t[i]=e;n._cacheIndex=r;t[r]=n},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i;t[i]=e;n._cacheIndex=r;t[r]=n},_addInactiveBinding:function(e,t,r){var i=this._bindingsByRootAndName,n=i[t],a=this._bindings;if(void 0===n){n={};i[t]=n}n[r]=e;e._cacheIndex=a.length;a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,a=this._bindingsByRootAndName,o=a[i],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u;t[u]=s;t.pop();delete o[n];e:{for(var c in o)break e;delete a[i]}},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i;t[i]=e;n._cacheIndex=r;t[r]=n},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i;t[i]=e;n._cacheIndex=r;t[r]=n},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];if(void 0===r){r=new Mc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer);r.__cacheIndex=t;e[t]=r}return r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i;t[i]=e;n.__cacheIndex=r;t[r]=n},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var r=t||this._root,i=r.uuid,n="string"===typeof e?Tc.findByName(r,e):e,a=null!==n?n.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var u=o.actionByRoot[i];if(void 0!==u)return u;s=o.knownActions[0];null===n&&(n=s._clip)}if(null===n)return null;var c=new rl(this,n,t);this._bindAction(c,s);this._addInactiveAction(c,a,i);return c},existingAction:function(e,t){var r=t||this._root,i=r.uuid,n="string"===typeof e?Tc.findByName(r,e):e,a=n?n.uuid:e,o=this._actionsByClip[a];if(void 0!==o)return o.actionByRoot[i]||null;return null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,r=this._bindings,i=this._nActiveBindings;this._nActiveActions=0;this._nActiveBindings=0;for(var n=0;n!==t;++n)e[n].reset();for(var n=0;n!==i;++n)r[n].useCount=0;return this},update:function(e){e*=this.timeScale;var t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),a=this._accuIndex^=1;for(var o=0;o!==r;++o){var s=t[o];s._update(i,e,n,a)}var u=this._bindings,c=this._nActiveBindings;for(var o=0;o!==c;++o)u[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(void 0!==n){var a=n.knownActions;for(var o=0,s=a.length;o!==s;++o){var u=a[o];this._deactivateAction(u);var c=u._cacheIndex,l=t[t.length-1];u._cacheIndex=null;u._byClipCacheIndex=null;l._cacheIndex=c;t[c]=l;t.pop();this._removeInactiveBindingsForAction(u)}delete i[r]}},uncacheRoot:function(e){var t=e.uuid,r=this._actionsByClip;for(var i in r){var n=r[i].actionByRoot,a=n[t];if(void 0!==a){this._deactivateAction(a);this._removeInactiveAction(a)}}var o=this._bindingsByRootAndName,s=o[t];if(void 0!==s)for(var u in s){var c=s[u];c.restoreOriginalState();this._removeInactiveBinding(c)}},uncacheAction:function(e,t){var r=this.existingAction(e,t);if(null!==r){this._deactivateAction(r);this._removeInactiveAction(r)}}});function nl(e){if("string"===typeof e){console.warn("THREE.Uniform: Type parameter is no longer needed.");e=arguments[1]}this.value=e}nl.prototype.clone=function(){return new nl(void 0===this.value.clone?this.value:this.value.clone())};function al(){wa.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0}al.prototype=Object.assign(Object.create(wa.prototype),{constructor:al,isInstancedBufferGeometry:true,copy:function(e){wa.prototype.copy.call(this,e);this.maxInstancedCount=e.maxInstancedCount;return this},clone:function(){return(new this.constructor).copy(this)}});function ol(e,t,r,i){this.uuid=Ot.generateUUID();this.data=e;this.itemSize=t;this.offset=r;this.normalized=true===i}Object.defineProperties(ol.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(ol.prototype,{isInterleavedBufferAttribute:true,setX:function(e,t){this.data.array[e*this.data.stride+this.offset]=t;return this},setY:function(e,t){this.data.array[e*this.data.stride+this.offset+1]=t;return this},setZ:function(e,t){this.data.array[e*this.data.stride+this.offset+2]=t;return this},setW:function(e,t){this.data.array[e*this.data.stride+this.offset+3]=t;return this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;return this},setXYZ:function(e,t,r,i){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;this.data.array[e+2]=i;return this},setXYZW:function(e,t,r,i,n){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;this.data.array[e+2]=i;this.data.array[e+3]=n;return this}});function sl(e,t){this.uuid=Ot.generateUUID();this.array=e;this.stride=t;this.count=void 0!==e?e.length/t:0;this.dynamic=false;this.updateRange={offset:0,count:-1};this.onUploadCallback=function(){};this.version=0}Object.defineProperty(sl.prototype,"needsUpdate",{set:function(e){true===e&&this.version++}});Object.assign(sl.prototype,{isInterleavedBuffer:true,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0;this.array=e},setDynamic:function(e){this.dynamic=e;return this},copy:function(e){this.array=new e.array.constructor(e.array);this.count=e.count;this.stride=e.stride;this.dynamic=e.dynamic;return this},copyAt:function(e,t,r){e*=this.stride;r*=t.stride;for(var i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this},set:function(e,t){void 0===t&&(t=0);this.array.set(e,t);return this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){this.onUploadCallback=e;return this}});function ul(e,t,r){sl.call(this,e,t);this.meshPerAttribute=r||1}ul.prototype=Object.assign(Object.create(sl.prototype),{constructor:ul,isInstancedInterleavedBuffer:true,copy:function(e){sl.prototype.copy.call(this,e);this.meshPerAttribute=e.meshPerAttribute;return this}});function cl(e,t,r){ua.call(this,e,t);this.meshPerAttribute=r||1}cl.prototype=Object.assign(Object.create(ua.prototype),{constructor:cl,isInstancedBufferAttribute:true,copy:function(e){ua.prototype.copy.call(this,e);this.meshPerAttribute=e.meshPerAttribute;return this}});function ll(e,t,r,i){this.ray=new Da(e,t);this.near=r||0;this.far=i||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})}function hl(e,t){return e.distance-t.distance}function dl(e,t,r,i){if(false===e.visible)return;e.raycast(t,r);if(true===i){var n=e.children;for(var a=0,o=n.length;a<o;a++)dl(n[a],t,r,true)}}Object.assign(ll.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){if(t&&t.isPerspectiveCamera){this.ray.origin.setFromMatrixPosition(t.matrixWorld);this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()}else if(t&&t.isOrthographicCamera){this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t);this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)}else console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,r){var i=r||[];dl(e,this,i,t);i.sort(hl);return i},intersectObjects:function(e,t,r){var i=r||[];if(false===Array.isArray(e)){console.warn("THREE.Raycaster.intersectObjects: objects is not an Array.");return i}for(var n=0,a=e.length;n<a;n++)dl(e[n],this,i,t);i.sort(hl);return i}});function pl(e){this.autoStart=void 0===e||e;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=false}Object.assign(pl.prototype,{start:function(){this.startTime=("undefined"===typeof performance?Date:performance).now();this.oldTime=this.startTime;this.elapsedTime=0;this.running=true},stop:function(){this.getElapsedTime();this.running=false;this.autoStart=false},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running){this.start();return 0}if(this.running){var t=("undefined"===typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3;this.oldTime=t;this.elapsedTime+=e}return e}});function fl(e,t,r){this.radius=void 0!==e?e:1;this.phi=void 0!==t?t:0;this.theta=void 0!==r?r:0;return this}Object.assign(fl.prototype,{set:function(e,t,r){this.radius=e;this.phi=t;this.theta=r;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.radius=e.radius;this.phi=e.phi;this.theta=e.theta;return this},makeSafe:function(){var e=1e-6;this.phi=Math.max(e,Math.min(Math.PI-e,this.phi));return this},setFromVector3:function(e){this.radius=e.length();if(0===this.radius){this.theta=0;this.phi=0}else{this.theta=Math.atan2(e.x,e.z);this.phi=Math.acos(Ot.clamp(e.y/this.radius,-1,1))}return this}});function vl(e,t,r){this.radius=void 0!==e?e:1;this.theta=void 0!==t?t:0;this.y=void 0!==r?r:0;return this}Object.assign(vl.prototype,{set:function(e,t,r){this.radius=e;this.theta=t;this.y=r;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.radius=e.radius;this.theta=e.theta;this.y=e.y;return this},setFromVector3:function(e){this.radius=Math.sqrt(e.x*e.x+e.z*e.z);this.theta=Math.atan2(e.x,e.z);this.y=e.y;return this}});function ml(e,t){this.min=void 0!==e?e:new jt(Infinity,Infinity);this.max=void 0!==t?t:new jt(-Infinity,-Infinity)}Object.assign(ml.prototype,{set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new jt;return function t(r,i){var n=e.copy(i).multiplyScalar(.5);this.min.copy(r).sub(n);this.max.copy(r).add(n);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){var t=e||new jt;return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new jt;return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){var r=t||new jt;return r.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){var r=t||new jt;return r.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new jt;return function t(r){var i=e.copy(r).clamp(this.min,this.max);return i.sub(r).length()}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});function gl(e){ra.call(this);this.material=e;this.render=function(){}}gl.prototype=Object.create(ra.prototype);gl.prototype.constructor=gl;gl.prototype.isImmediateRenderObject=true;function yl(e,t,r,i){this.object=e;this.size=void 0!==t?t:1;var n=void 0!==r?r:16711680;var a=void 0!==i?i:1;var o=0;var s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var u=new wa;var c=new ma(2*o*3,3);u.addAttribute("position",c);jo.call(this,u,new _o({color:n,linewidth:a}));this.matrixAutoUpdate=false;this.update()}yl.prototype=Object.create(jo.prototype);yl.prototype.constructor=yl;yl.prototype.update=function(){var e=new kt;var t=new kt;var r=new Pt;return function i(){var n=["a","b","c"];this.object.updateMatrixWorld(true);r.getNormalMatrix(this.object.matrixWorld);var a=this.object.matrixWorld;var o=this.geometry.attributes.position;var s=this.object.geometry;if(s&&s.isGeometry){var u=s.vertices;var c=s.faces;var l=0;for(var h=0,d=c.length;h<d;h++){var p=c[h];for(var f=0,v=p.vertexNormals.length;f<v;f++){var m=u[p[n[f]]];var g=p.vertexNormals[f];e.copy(m).applyMatrix4(a);t.copy(g).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e);o.setXYZ(l,e.x,e.y,e.z);l+=1;o.setXYZ(l,t.x,t.y,t.z);l+=1}}}else if(s&&s.isBufferGeometry){var y=s.attributes.position;var A=s.attributes.normal;var l=0;for(var f=0,v=y.count;f<v;f++){e.set(y.getX(f),y.getY(f),y.getZ(f)).applyMatrix4(a);t.set(A.getX(f),A.getY(f),A.getZ(f));t.applyMatrix3(r).normalize().multiplyScalar(this.size).add(e);o.setXYZ(l,e.x,e.y,e.z);l+=1;o.setXYZ(l,t.x,t.y,t.z);l+=1}}o.needsUpdate=true}}();function Al(e,t){ra.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=t;var r=new wa;var i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var n=0,a=1,o=32;n<o;n++,a++){var s=n/o*Math.PI*2;var u=a/o*Math.PI*2;i.push(Math.cos(s),Math.sin(s),1,Math.cos(u),Math.sin(u),1)}r.addAttribute("position",new ma(i,3));var c=new _o({fog:false});this.cone=new jo(r,c);this.add(this.cone);this.update()}Al.prototype=Object.create(ra.prototype);Al.prototype.constructor=Al;Al.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};Al.prototype.update=function(){var e=new kt;var t=new kt;return function r(){this.light.updateMatrixWorld();var i=this.light.distance?this.light.distance:1e3;var n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i);e.setFromMatrixPosition(this.light.matrixWorld);t.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(t.sub(e));void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}();function Ml(e){var t=[];e&&e.isBone&&t.push(e);for(var r=0;r<e.children.length;r++)t.push.apply(t,Ml(e.children[r]));return t}function wl(e){var t=Ml(e);var r=new wa;var i=[];var n=[];var a=new jr(0,0,1);var o=new jr(0,1,0);for(var s=0;s<t.length;s++){var u=t[s];if(u.parent&&u.parent.isBone){i.push(0,0,0);i.push(0,0,0);n.push(a.r,a.g,a.b);n.push(o.r,o.g,o.b)}}r.addAttribute("position",new ma(i,3));r.addAttribute("color",new ma(n,3));var c=new _o({vertexColors:M,depthTest:false,depthWrite:false,transparent:true});jo.call(this,r,c);this.root=e;this.bones=t;this.matrix=e.matrixWorld;this.matrixAutoUpdate=false}wl.prototype=Object.create(jo.prototype);wl.prototype.constructor=wl;wl.prototype.updateMatrixWorld=function(){var e=new kt;var t=new Rt;var r=new Rt;return function i(n){var a=this.bones;var o=this.geometry;var s=o.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var u=0,c=0;u<a.length;u++){var l=a[u];if(l.parent&&l.parent.isBone){t.multiplyMatrices(r,l.matrixWorld);e.setFromMatrixPosition(t);s.setXYZ(c,e.x,e.y,e.z);t.multiplyMatrices(r,l.parent.matrixWorld);e.setFromMatrixPosition(t);s.setXYZ(c+1,e.x,e.y,e.z);c+=2}}o.getAttribute("position").needsUpdate=true;ra.prototype.updateMatrixWorld.call(this,n)}}();function El(e,t,r){this.light=e;this.light.updateMatrixWorld();this.color=r;var i=new Vs(t,4,2);var n=new La({wireframe:true,fog:false});Ia.call(this,i,n);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=false;this.update()}El.prototype=Object.create(Ia.prototype);El.prototype.constructor=El;El.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};El.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};function xl(e,t){ra.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=t;var r=new _o({fog:false});var i=new wa;i.addAttribute("position",new ua(new Float32Array(15),3));this.line=new Oo(i,r);this.add(this.line);this.update()}xl.prototype=Object.create(ra.prototype);xl.prototype.constructor=xl;xl.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};xl.prototype.update=function(){var e=.5*this.light.width;var t=.5*this.light.height;var r=this.line.geometry.attributes.position;var i=r.array;i[0]=e;i[1]=-t;i[2]=0;i[3]=e;i[4]=t;i[5]=0;i[6]=-e;i[7]=t;i[8]=0;i[9]=-e;i[10]=-t;i[11]=0;i[12]=e;i[13]=-t;i[14]=0;r.needsUpdate=true;void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)};function bl(e,t,r){ra.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=r;var i=new Zo(t);i.rotateY(.5*Math.PI);this.material=new La({wireframe:true,fog:false});void 0===this.color&&(this.material.vertexColors=M);var n=i.getAttribute("position");var a=new Float32Array(3*n.count);i.addAttribute("color",new ua(a,3));this.add(new Ia(i,this.material));this.update()}bl.prototype=Object.create(ra.prototype);bl.prototype.constructor=bl;bl.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};bl.prototype.update=function(){var e=new kt;var t=new jr;var r=new jr;return function i(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var a=n.geometry.getAttribute("color");t.copy(this.light.color);r.copy(this.light.groundColor);for(var o=0,s=a.count;o<s;o++){var u=o<s/2?t:r;a.setXYZ(o,u.r,u.g,u.b)}a.needsUpdate=true}n.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}();function Tl(e,t,r,i){e=e||10;t=t||10;r=new jr(void 0!==r?r:4473924);i=new jr(void 0!==i?i:8947848);var n=t/2;var a=e/t;var o=e/2;var s=[],u=[];for(var c=0,l=0,h=-o;c<=t;c++,h+=a){s.push(-o,0,h,o,0,h);s.push(h,0,-o,h,0,o);var d=c===n?r:i;d.toArray(u,l);l+=3;d.toArray(u,l);l+=3;d.toArray(u,l);l+=3;d.toArray(u,l);l+=3}var p=new wa;p.addAttribute("position",new ma(s,3));p.addAttribute("color",new ma(u,3));var f=new _o({vertexColors:M});jo.call(this,p,f)}Tl.prototype=Object.create(jo.prototype);Tl.prototype.constructor=Tl;function Ll(e,t,r,i,n,a){e=e||10;t=t||16;r=r||8;i=i||64;n=new jr(void 0!==n?n:4473924);a=new jr(void 0!==a?a:8947848);var o=[];var s=[];var u,c;var l,h,d,p,f;for(h=0;h<=t;h++){l=h/t*(2*Math.PI);u=Math.sin(l)*e;c=Math.cos(l)*e;o.push(0,0,0);o.push(u,0,c);f=1&h?n:a;s.push(f.r,f.g,f.b);s.push(f.r,f.g,f.b)}for(h=0;h<=r;h++){f=1&h?n:a;p=e-e/r*h;for(d=0;d<i;d++){l=d/i*(2*Math.PI);u=Math.sin(l)*p;c=Math.cos(l)*p;o.push(u,0,c);s.push(f.r,f.g,f.b);l=(d+1)/i*(2*Math.PI);u=Math.sin(l)*p;c=Math.cos(l)*p;o.push(u,0,c);s.push(f.r,f.g,f.b)}}var v=new wa;v.addAttribute("position",new ma(o,3));v.addAttribute("color",new ma(s,3));var m=new _o({vertexColors:M});jo.call(this,v,m)}Ll.prototype=Object.create(jo.prototype);Ll.prototype.constructor=Ll;function Nl(e,t,r,i){this.object=e;this.size=void 0!==t?t:1;var n=void 0!==r?r:16776960;var a=void 0!==i?i:1;var o=0;var s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var u=new wa;var c=new ma(2*o*3,3);u.addAttribute("position",c);jo.call(this,u,new _o({color:n,linewidth:a}));this.matrixAutoUpdate=false;this.update()}Nl.prototype=Object.create(jo.prototype);Nl.prototype.constructor=Nl;Nl.prototype.update=function(){var e=new kt;var t=new kt;var r=new Pt;return function i(){this.object.updateMatrixWorld(true);r.getNormalMatrix(this.object.matrixWorld);var n=this.object.matrixWorld;var a=this.geometry.attributes.position;var o=this.object.geometry;var s=o.vertices;var u=o.faces;var c=0;for(var l=0,h=u.length;l<h;l++){var d=u[l];var p=d.normal;e.copy(s[d.a]).add(s[d.b]).add(s[d.c]).divideScalar(3).applyMatrix4(n);t.copy(p).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e);a.setXYZ(c,e.x,e.y,e.z);c+=1;a.setXYZ(c,t.x,t.y,t.z);c+=1}a.needsUpdate=true}}();function Dl(e,t,r){ra.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.color=r;void 0===t&&(t=1);var i=new wa;i.addAttribute("position",new ma([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var n=new _o({fog:false});this.lightPlane=new Oo(i,n);this.add(this.lightPlane);i=new wa;i.addAttribute("position",new ma([0,0,0,0,0,1],3));this.targetLine=new Oo(i,n);this.add(this.targetLine);this.update()}Dl.prototype=Object.create(ra.prototype);Dl.prototype.constructor=Dl;Dl.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};Dl.prototype.update=function(){var e=new kt;var t=new kt;var r=new kt;return function i(){e.setFromMatrixPosition(this.light.matrixWorld);t.setFromMatrixPosition(this.light.target.matrixWorld);r.subVectors(t,e);this.lightPlane.lookAt(r);if(void 0!==this.color){this.lightPlane.material.color.set(this.color);this.targetLine.material.color.set(this.color)}else{this.lightPlane.material.color.copy(this.light.color);this.targetLine.material.color.copy(this.light.color)}this.targetLine.lookAt(r);this.targetLine.scale.z=r.length()}}();function Cl(e){var t=new wa;var r=new _o({color:16777215,vertexColors:A});var i=[];var n=[];var a={};var o=new jr(16755200);var s=new jr(16711680);var u=new jr(43775);var c=new jr(16777215);var l=new jr(3355443);h("n1","n2",o);h("n2","n4",o);h("n4","n3",o);h("n3","n1",o);h("f1","f2",o);h("f2","f4",o);h("f4","f3",o);h("f3","f1",o);h("n1","f1",o);h("n2","f2",o);h("n3","f3",o);h("n4","f4",o);h("p","n1",s);h("p","n2",s);h("p","n3",s);h("p","n4",s);h("u1","u2",u);h("u2","u3",u);h("u3","u1",u);h("c","t",c);h("p","c",l);h("cn1","cn2",l);h("cn3","cn4",l);h("cf1","cf2",l);h("cf3","cf4",l);function h(e,t,r){d(e,r);d(t,r)}function d(e,t){i.push(0,0,0);n.push(t.r,t.g,t.b);void 0===a[e]&&(a[e]=[]);a[e].push(i.length/3-1)}t.addAttribute("position",new ma(i,3));t.addAttribute("color",new ma(n,3));jo.call(this,t,r);this.camera=e;this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix();this.matrix=e.matrixWorld;this.matrixAutoUpdate=false;this.pointMap=a;this.update()}Cl.prototype=Object.create(jo.prototype);Cl.prototype.constructor=Cl;Cl.prototype.update=function(){var e,t;var r=new kt;var i=new ia;function n(n,a,o,s){r.set(a,o,s).unproject(i);var u=t[n];if(void 0!==u){var c=e.getAttribute("position");for(var l=0,h=u.length;l<h;l++)c.setXYZ(u[l],r.x,r.y,r.z)}}return function r(){e=this.geometry;t=this.pointMap;var a=1,o=1;i.projectionMatrix.copy(this.camera.projectionMatrix);n("c",0,0,-1);n("t",0,0,1);n("n1",-a,-o,-1);n("n2",a,-o,-1);n("n3",-a,o,-1);n("n4",a,o,-1);n("f1",-a,-o,1);n("f2",a,-o,1);n("f3",-a,o,1);n("f4",a,o,1);n("u1",.7*a,1.1*o,-1);n("u2",.7*-a,1.1*o,-1);n("u3",0,2*o,-1);n("cf1",-a,0,1);n("cf2",a,0,1);n("cf3",0,-o,1);n("cf4",0,o,1);n("cn1",-a,0,-1);n("cn2",a,0,-1);n("cn3",0,-o,-1);n("cn4",0,o,-1);e.getAttribute("position").needsUpdate=true}}();function Sl(e,t){this.object=e;void 0===t&&(t=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new Float32Array(24);var n=new wa;n.setIndex(new ua(r,1));n.addAttribute("position",new ua(i,3));jo.call(this,n,new _o({color:t}));this.matrixAutoUpdate=false;this.update()}Sl.prototype=Object.create(jo.prototype);Sl.prototype.constructor=Sl;Sl.prototype.update=function(){var e=new Wn;return function t(r){void 0!==r&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");void 0!==this.object&&e.setFromObject(this.object);if(e.isEmpty())return;var i=e.min;var n=e.max;var a=this.geometry.attributes.position;var o=a.array;o[0]=n.x;o[1]=n.y;o[2]=n.z;o[3]=i.x;o[4]=n.y;o[5]=n.z;o[6]=i.x;o[7]=i.y;o[8]=n.z;o[9]=n.x;o[10]=i.y;o[11]=n.z;o[12]=n.x;o[13]=n.y;o[14]=i.z;o[15]=i.x;o[16]=n.y;o[17]=i.z;o[18]=i.x;o[19]=i.y;o[20]=i.z;o[21]=n.x;o[22]=i.y;o[23]=i.z;a.needsUpdate=true;this.geometry.computeBoundingSphere()}}();Sl.prototype.setFromObject=function(e){this.object=e;this.update();return this};function Il(e,t){this.type="Box3Helper";this.box=e;var r=void 0!==t?t:16776960;var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1];var a=new wa;a.setIndex(new ua(i,1));a.addAttribute("position",new ma(n,3));jo.call(this,a,new _o({color:r}));this.geometry.computeBoundingSphere()}Il.prototype=Object.create(jo.prototype);Il.prototype.constructor=Il;Il.prototype.updateMatrixWorld=function(e){var t=this.box;if(t.isEmpty())return;t.getCenter(this.position);t.getSize(this.scale);this.scale.multiplyScalar(.5);ra.prototype.updateMatrixWorld.call(this,e)};function _l(e,t,r){this.type="PlaneHelper";this.plane=e;this.size=void 0===t?1:t;var i=void 0!==r?r:16776960;var n=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0];var a=new wa;a.addAttribute("position",new ma(n,3));a.computeBoundingSphere();Oo.call(this,a,new _o({color:i}));var o=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1];var s=new wa;s.addAttribute("position",new ma(o,3));s.computeBoundingSphere();this.add(new Ia(s,new La({color:i,opacity:.2,transparent:true,depthWrite:false})))}_l.prototype=Object.create(Oo.prototype);_l.prototype.constructor=_l;_l.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8);this.scale.set(.5*this.size,.5*this.size,t);this.lookAt(this.plane.normal);ra.prototype.updateMatrixWorld.call(this,e)};var Ol;var jl;function Rl(e,t,r,i,n,a){ra.call(this);void 0===i&&(i=16776960);void 0===r&&(r=1);void 0===n&&(n=.2*r);void 0===a&&(a=.2*n);if(void 0===Ol){Ol=new wa;Ol.addAttribute("position",new ma([0,0,0,0,1,0],3));jl=new eu(0,.5,1,5,1);jl.translate(0,-.5,0)}this.position.copy(t);this.line=new Oo(Ol,new _o({color:i}));this.line.matrixAutoUpdate=false;this.add(this.line);this.cone=new Ia(jl,new La({color:i}));this.cone.matrixAutoUpdate=false;this.add(this.cone);this.setDirection(e);this.setLength(r,n,a)}Rl.prototype=Object.create(ra.prototype);Rl.prototype.constructor=Rl;Rl.prototype.setDirection=function(){var e=new kt;var t;return function r(i){if(i.y>.99999)this.quaternion.set(0,0,0,1);else if(i.y<-.99999)this.quaternion.set(1,0,0,0);else{e.set(i.z,0,-i.x).normalize();t=Math.acos(i.y);this.quaternion.setFromAxisAngle(e,t)}}}();Rl.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e);void 0===r&&(r=.2*t);this.line.scale.set(1,Math.max(0,e-t),1);this.line.updateMatrix();this.cone.scale.set(r,t,r);this.cone.position.y=e;this.cone.updateMatrix()};Rl.prototype.setColor=function(e){this.line.material.color.copy(e);this.cone.material.color.copy(e)};function zl(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];var r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1];var i=new wa;i.addAttribute("position",new ma(t,3));i.addAttribute("color",new ma(r,3));var n=new _o({vertexColors:M});jo.call(this,i,n)}zl.prototype=Object.create(jo.prototype);zl.prototype.constructor=zl;function kl(e,t,r,i,n,a,o){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new aa(e,t,r,n,a,o)}var Pl=0;var Ul=1;function Bl(e){console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead.");return e}function Fl(e){void 0===e&&(e=[]);console.warn("THREE.MultiMaterial has been removed. Use an Array instead.");e.isMultiMaterial=true;e.materials=e;e.clone=function(){return e.slice()};return e}function Gl(e,t){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new ko(e,t)}function Hl(e){console.warn("THREE.Particle has been renamed to THREE.Sprite.");return new No(e)}function Vl(e,t){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new ko(e,t)}function Ql(e){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new zo(e)}function Yl(e){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");return new zo(e)}function Wl(e){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new zo(e)}function Xl(e,t,r){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");return new kt(e,t,r)}function ql(e,t){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return new ua(e,t).setDynamic(true)}function Zl(e,t){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.");return new ca(e,t)}function Jl(e,t){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.");return new la(e,t)}function Kl(e,t){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.");return new ha(e,t)}function $l(e,t){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.");return new da(e,t)}function eh(e,t){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.");return new pa(e,t)}function th(e,t){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.");return new fa(e,t)}function rh(e,t){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.");return new va(e,t)}function ih(e,t){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.");return new ma(e,t)}function nh(e,t){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.");return new ga(e,t)}Lu.create=function(e,t){console.log("THREE.Curve.create() has been deprecated");e.prototype=Object.create(Lu.prototype);e.prototype.constructor=e;e.prototype.getPoint=t;return e};Object.assign($u.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=new sa;for(var r=0,i=e.length;r<i;r++){var n=e[r];t.vertices.push(new kt(n.x,n.y,n.z||0))}return t}});Object.assign(ec.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints().");this.setFromPoints(e)}});function ah(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");ju.call(this,e);this.type="catmullrom";this.closed=true}ah.prototype=Object.create(ju.prototype);function oh(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");ju.call(this,e);this.type="catmullrom"}oh.prototype=Object.create(ju.prototype);function sh(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.");ju.call(this,e);this.type="catmullrom"}sh.prototype=Object.create(ju.prototype);Object.assign(sh.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});function uh(e){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper.");return new zl(e)}function ch(e,t){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.");return new Sl(e,t)}function lh(e,t){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.");return new jo(new Ks(e.geometry),new _o({color:void 0!==t?t:16777215}))}Tl.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};wl.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function hh(e,t){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.");return new jo(new Go(e.geometry),new _o({color:void 0!==t?t:16777215}))}Object.assign(Cc.prototype,{extractUrlBase:function(e){console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.");return Sc.extractUrlBase(e)}});function dh(e){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader.");return new Mu(e)}function ph(e){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.");return new Eu(e)}Object.assign(ml.prototype,{center:function(e){console.warn("THREE.Box2: .center() has been renamed to .getCenter().");return this.getCenter(e)},empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(e){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)},size:function(e){console.warn("THREE.Box2: .size() has been renamed to .getSize().");return this.getSize(e)}});Object.assign(Wn.prototype,{center:function(e){console.warn("THREE.Box3: .center() has been renamed to .getCenter().");return this.getCenter(e)},empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(e){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)},isIntersectionSphere:function(e){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(e)},size:function(e){console.warn("THREE.Box3: .size() has been renamed to .getSize().");return this.getSize(e)}});Ca.prototype.center=function(e){console.warn("THREE.Line3: .center() has been renamed to .getCenter().");return this.getCenter(e)};Object.assign(Ot,{random16:function(){console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead.");return Math.random()},nearestPowerOfTwo:function(e){console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().");return Ot.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().");return Ot.ceilPowerOfTwo(e)}});Object.assign(Pt.prototype,{flattenToArrayOffset:function(e,t){console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(e,t)},multiplyVector3:function(e){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(Rt.prototype,{extractPosition:function(e){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(e)},flattenToArrayOffset:function(e,t){console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(e,t)},getPosition:function(){var e;return function t(){void 0===e&&(e=new kt);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},multiplyVector4:function(e){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");e.transformDirection(this)},crossVector:function(e){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,r,i,n,a){console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.");return this.makePerspective(e,t,i,r,n,a)}});qn.prototype.isIntersectionLine=function(e){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(e)};zt.prototype.multiplyVector3=function(e){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return e.applyQuaternion(this)};Object.assign(Da.prototype,{isIntersectionBox:function(e){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)},isIntersectionPlane:function(e){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(e)},isIntersectionSphere:function(e){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(e)}});Object.assign(tc.prototype,{extractAllPoints:function(e){console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.");return this.extractPoints(e)},extrude:function(e){console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.");return new Us(this,e)},makeGeometry:function(e){console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.");return new qs(this,e)}});Object.assign(jt.prototype,{fromAttribute:function(e,t,r){console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(e)},lengthManhattan:function(){console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(kt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(t,e)},applyProjection:function(e){console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.");return this.applyMatrix4(e)},fromAttribute:function(e,t,r){console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(e)},lengthManhattan:function(){console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(Ft.prototype,{fromAttribute:function(e,t,r){console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(e,t,r)},lengthManhattan:function(){console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(sa.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}});Object.assign(ra.prototype,{getChildByName:function(e){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(t,e)}});Object.defineProperties(ra.prototype,{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Object.defineProperties(Do.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}});Object.defineProperty(Co.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});Object.defineProperty(Lu.prototype,"__arcLengthDivisions",{get:function(){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");return this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");this.arcLengthDivisions=e}});lo.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==t&&(this.filmGauge=t);this.setFocalLength(e)};Object.defineProperties(rc.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=e}}});Object.defineProperties(ua.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead.");return this.array.length}}});Object.assign(wa.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(e)},addDrawCall:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}});Object.defineProperties(wa.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups}}});Object.defineProperties(nl.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.");return this}}});Object.defineProperties(Vn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){console.warn("THREE.Material: .wrapRGB has been removed.");return new jr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=e===m}}});Object.defineProperties(lu.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");return false},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(Na.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=e}}});Object.assign(Eo.prototype,{getCurrentRenderTarget:function(){console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().");return this.getRenderTarget()},getMaxAnisotropy:function(){console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().");return this.capabilities.getMaxAnisotropy()},getPrecision:function(){console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.");return this.capabilities.precision},resetGLState:function(){console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset().");return this.state.reset()},supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.");return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}});Object.defineProperties(Eo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.");return},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Jn.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.");return},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.");return},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.");return},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Gt.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=e}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=e}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=e}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=e}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=e}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=e}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=e}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");return this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=e}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=e}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");return this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=e}}});Object.defineProperties(po.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}});Xc.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;var r=new Vc;r.load(e,function(e){t.setBuffer(e)});return this};Zc.prototype.getData=function(){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");return this.getFrequencyData()};Yc.prototype.updateCubeMap=function(e,t){console.warn("THREE.CubeCamera: .updateCubeMap() is now .update().");return this.update(e,t)};var fh={merge:function(e,t,r){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var i;if(t.isMesh){t.matrixAutoUpdate&&t.updateMatrix();i=t.matrix;t=t.geometry}e.merge(t,i,r)},center:function(e){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return e.center()}};var vh={crossOrigin:void 0,loadTexture:function(e,t,r,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new Tu;n.setCrossOrigin(this.crossOrigin);var a=n.load(e,r,void 0,i);t&&(a.mapping=t);return a},loadTextureCube:function(e,t,r,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new bu;n.setCrossOrigin(this.crossOrigin);var a=n.load(e,r,void 0,i);t&&(a.mapping=t);return a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};function mh(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project().");e.project(t)};this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");e.unproject(t)};this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function gh(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}}var yh={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function Ah(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}e.WebGLRenderTargetCube=Ht;e.WebGLRenderTarget=Gt;e.WebGLRenderer=Eo;e.ShaderLib=Bn;e.UniformsLib=Rr;e.UniformsUtils=zr;e.ShaderChunk=Un;e.FogExp2=xo;e.Fog=bo;e.Scene=To;e.Sprite=No;e.LOD=Do;e.SkinnedMesh=Io;e.Skeleton=Co;e.Bone=So;e.Mesh=Ia;e.LineSegments=jo;e.LineLoop=Ro;e.Line=Oo;e.Points=ko;e.Group=Po;e.VideoTexture=Uo;e.DataTexture=Vt;e.CompressedTexture=Bo;e.CubeTexture=Qt;e.CanvasTexture=Fn;e.DepthTexture=Fo;e.Texture=Bt;e.CompressedTextureLoader=wu;e.DataTextureLoader=Eu;e.CubeTextureLoader=bu;e.TextureLoader=Tu;e.ObjectLoader=_c;e.MaterialLoader=Lc;e.BufferGeometryLoader=Nc;e.DefaultLoadingManager=yu;e.LoadingManager=gu;e.JSONLoader=Ic;e.ImageLoader=xu;e.ImageBitmapLoader=zc;e.FontLoader=Fc;e.FileLoader=Mu;e.Loader=Cc;e.LoaderUtils=Sc;e.Cache=mu;e.AudioLoader=Vc;e.SpotLightShadow=ac;e.SpotLight=oc;e.PointLight=sc;e.RectAreaLight=hc;e.HemisphereLight=ic;e.DirectionalLightShadow=uc;e.DirectionalLight=cc;e.AmbientLight=lc;e.LightShadow=nc;e.Light=rc;e.StereoCamera=Qc;e.PerspectiveCamera=lo;e.OrthographicCamera=na;e.CubeCamera=Yc;e.ArrayCamera=ho;e.Camera=ia;e.AudioListener=Wc;e.PositionalAudio=qc;e.AudioContext=Hc;e.AudioAnalyser=Zc;e.Audio=Xc;e.VectorKeyframeTrack=bc;e.StringKeyframeTrack=dc;e.QuaternionKeyframeTrack=mc;e.NumberKeyframeTrack=yc;e.ColorKeyframeTrack=gc;e.BooleanKeyframeTrack=pc;e.PropertyMixer=Jc;e.PropertyBinding=el;e.KeyframeTrack=xc;e.AnimationUtils=Ec;e.AnimationObjectGroup=tl;e.AnimationMixer=il;e.AnimationClip=Tc;e.Uniform=nl;e.InstancedBufferGeometry=al;e.BufferGeometry=wa;e.Geometry=sa;e.InterleavedBufferAttribute=ol;e.InstancedInterleavedBuffer=ul;e.InterleavedBuffer=sl;e.InstancedBufferAttribute=cl;e.Face3=aa;e.Object3D=ra;e.Raycaster=ll;e.Layers=ea;e.EventDispatcher=t;e.Clock=pl;e.QuaternionLinearInterpolant=vc;e.LinearInterpolant=Mc;e.DiscreteInterpolant=wc;e.CubicInterpolant=Ac;e.Interpolant=fc;e.Triangle=Sa;e.Math=Ot;e.Spherical=fl;e.Cylindrical=vl;e.Plane=qn;e.Frustum=Zn;e.Sphere=Xn;e.Ray=Da;e.Matrix4=Rt;e.Matrix3=Pt;e.Box3=Wn;e.Box2=ml;e.Line3=Ca;e.Euler=$n;e.Vector4=Ft;e.Vector3=kt;e.Vector2=jt;e.Quaternion=zt;e.Color=jr;e.ImmediateRenderObject=gl;e.VertexNormalsHelper=yl;e.SpotLightHelper=Al;e.SkeletonHelper=wl;e.PointLightHelper=El;e.RectAreaLightHelper=xl;e.HemisphereLightHelper=bl;e.GridHelper=Tl;e.PolarGridHelper=Ll;e.FaceNormalsHelper=Nl;e.DirectionalLightHelper=Dl;e.CameraHelper=Cl;e.BoxHelper=Sl;e.Box3Helper=Il;e.PlaneHelper=_l;e.ArrowHelper=Rl;e.AxesHelper=zl;e.Shape=tc;e.Path=ec;e.ShapePath=kc;e.Font=Pc;e.CurvePath=$u;e.Curve=Lu;e.ShapeUtils=zs;e.WebGLUtils=mo;e.WireframeGeometry=Go;e.ParametricGeometry=Ho;e.ParametricBufferGeometry=Vo;e.TetrahedronGeometry=Wo;e.TetrahedronBufferGeometry=Xo;e.OctahedronGeometry=qo;e.OctahedronBufferGeometry=Zo;e.IcosahedronGeometry=Jo;e.IcosahedronBufferGeometry=Ko;e.DodecahedronGeometry=$o;e.DodecahedronBufferGeometry=es;e.PolyhedronGeometry=Qo;e.PolyhedronBufferGeometry=Yo;e.TubeGeometry=ts;e.TubeBufferGeometry=rs;e.TorusKnotGeometry=is;e.TorusKnotBufferGeometry=ns;e.TorusGeometry=as;e.TorusBufferGeometry=os;e.TextGeometry=Fs;e.TextBufferGeometry=Gs;e.SphereGeometry=Hs;e.SphereBufferGeometry=Vs;e.RingGeometry=Qs;e.RingBufferGeometry=Ys;e.PlaneGeometry=ba;e.PlaneBufferGeometry=Ta;e.LatheGeometry=Ws;e.LatheBufferGeometry=Xs;e.ShapeGeometry=qs;e.ShapeBufferGeometry=Zs;e.ExtrudeGeometry=Us;e.ExtrudeBufferGeometry=Bs;e.EdgesGeometry=Ks;e.ConeGeometry=tu;e.ConeBufferGeometry=ru;e.CylinderGeometry=$s;e.CylinderBufferGeometry=eu;e.CircleGeometry=iu;e.CircleBufferGeometry=nu;e.BoxGeometry=Ea;e.BoxBufferGeometry=xa;e.ShadowMaterial=ou;e.SpriteMaterial=Lo;e.RawShaderMaterial=su;e.ShaderMaterial=Na;e.PointsMaterial=zo;e.MeshPhysicalMaterial=cu;e.MeshStandardMaterial=uu;e.MeshPhongMaterial=lu;e.MeshToonMaterial=hu;e.MeshNormalMaterial=du;e.MeshLambertMaterial=pu;e.MeshDepthMaterial=Qn;e.MeshDistanceMaterial=Yn;e.MeshBasicMaterial=La;e.LineDashedMaterial=fu;e.LineBasicMaterial=_o;e.Material=Vn;e.Float64BufferAttribute=ga;e.Float32BufferAttribute=ma;e.Uint32BufferAttribute=va;e.Int32BufferAttribute=fa;e.Uint16BufferAttribute=pa;e.Int16BufferAttribute=da;e.Uint8ClampedBufferAttribute=ha;e.Uint8BufferAttribute=la;e.Int8BufferAttribute=ca;e.BufferAttribute=ua;e.ArcCurve=Du;e.CatmullRomCurve3=ju;e.CubicBezierCurve=Qu;e.CubicBezierCurve3=Yu;e.EllipseCurve=Nu;e.LineCurve=Wu;e.LineCurve3=Xu;e.QuadraticBezierCurve=qu;e.QuadraticBezierCurve3=Zu;e.SplineCurve=Ju;e.REVISION=r;e.MOUSE=i;e.CullFaceNone=n;e.CullFaceBack=a;e.CullFaceFront=o;e.CullFaceFrontBack=s;e.FrontFaceDirectionCW=u;e.FrontFaceDirectionCCW=c;e.BasicShadowMap=l;e.PCFShadowMap=h;e.PCFSoftShadowMap=d;e.FrontSide=p;e.BackSide=f;e.DoubleSide=v;e.FlatShading=m;e.SmoothShading=g;e.NoColors=y;e.FaceColors=A;e.VertexColors=M;e.NoBlending=w;e.NormalBlending=E;e.AdditiveBlending=x;e.SubtractiveBlending=b;e.MultiplyBlending=T;e.CustomBlending=L;e.AddEquation=N;e.SubtractEquation=D;e.ReverseSubtractEquation=C;e.MinEquation=S;e.MaxEquation=I;e.ZeroFactor=_;e.OneFactor=O;e.SrcColorFactor=j;e.OneMinusSrcColorFactor=R;e.SrcAlphaFactor=z;e.OneMinusSrcAlphaFactor=k;e.DstAlphaFactor=P;e.OneMinusDstAlphaFactor=U;e.DstColorFactor=B;e.OneMinusDstColorFactor=F;e.SrcAlphaSaturateFactor=G;e.NeverDepth=H;e.AlwaysDepth=V;e.LessDepth=Q;e.LessEqualDepth=Y;e.EqualDepth=W;e.GreaterEqualDepth=X;e.GreaterDepth=q;e.NotEqualDepth=Z;e.MultiplyOperation=J;e.MixOperation=K;e.AddOperation=$;e.NoToneMapping=ee;e.LinearToneMapping=te;e.ReinhardToneMapping=re;e.Uncharted2ToneMapping=ie;e.CineonToneMapping=ne;e.UVMapping=ae;e.CubeReflectionMapping=oe;e.CubeRefractionMapping=se;e.EquirectangularReflectionMapping=ue;e.EquirectangularRefractionMapping=ce;e.SphericalReflectionMapping=le;e.CubeUVReflectionMapping=he;e.CubeUVRefractionMapping=de;e.RepeatWrapping=pe;e.ClampToEdgeWrapping=fe;e.MirroredRepeatWrapping=ve;e.NearestFilter=me;e.NearestMipMapNearestFilter=ge;e.NearestMipMapLinearFilter=ye;e.LinearFilter=Ae;e.LinearMipMapNearestFilter=Me;e.LinearMipMapLinearFilter=we;e.UnsignedByteType=Ee;e.ByteType=xe;e.ShortType=be;e.UnsignedShortType=Te;e.IntType=Le;e.UnsignedIntType=Ne;e.FloatType=De;e.HalfFloatType=Ce;e.UnsignedShort4444Type=Se;e.UnsignedShort5551Type=Ie;e.UnsignedShort565Type=_e;e.UnsignedInt248Type=Oe;e.AlphaFormat=je;e.RGBFormat=Re;e.RGBAFormat=ze;e.LuminanceFormat=ke;e.LuminanceAlphaFormat=Pe;e.RGBEFormat=Ue;e.DepthFormat=Be;e.DepthStencilFormat=Fe;e.RGB_S3TC_DXT1_Format=Ge;e.RGBA_S3TC_DXT1_Format=He;e.RGBA_S3TC_DXT3_Format=Ve;e.RGBA_S3TC_DXT5_Format=Qe;e.RGB_PVRTC_4BPPV1_Format=Ye;e.RGB_PVRTC_2BPPV1_Format=We;e.RGBA_PVRTC_4BPPV1_Format=Xe;e.RGBA_PVRTC_2BPPV1_Format=qe;e.RGB_ETC1_Format=Ze;e.RGBA_ASTC_4x4_Format=Je;e.RGBA_ASTC_5x4_Format=Ke;e.RGBA_ASTC_5x5_Format=$e;e.RGBA_ASTC_6x5_Format=et;e.RGBA_ASTC_6x6_Format=tt;e.RGBA_ASTC_8x5_Format=rt;e.RGBA_ASTC_8x6_Format=it;e.RGBA_ASTC_8x8_Format=nt;e.RGBA_ASTC_10x5_Format=at;e.RGBA_ASTC_10x6_Format=ot;e.RGBA_ASTC_10x8_Format=st;e.RGBA_ASTC_10x10_Format=ut;e.RGBA_ASTC_12x10_Format=ct;e.RGBA_ASTC_12x12_Format=lt;e.LoopOnce=ht;e.LoopRepeat=dt;e.LoopPingPong=pt;e.InterpolateDiscrete=ft;e.InterpolateLinear=vt;e.InterpolateSmooth=mt;e.ZeroCurvatureEnding=gt;e.ZeroSlopeEnding=yt;e.WrapAroundEnding=At;e.TrianglesDrawMode=Mt;e.TriangleStripDrawMode=wt;e.TriangleFanDrawMode=Et;e.LinearEncoding=xt;e.sRGBEncoding=bt;e.GammaEncoding=Tt;e.RGBEEncoding=Lt;e.LogLuvEncoding=Nt;e.RGBM7Encoding=Dt;e.RGBM16Encoding=Ct;e.RGBDEncoding=St;e.BasicDepthPacking=It;e.RGBADepthPacking=_t;e.CubeGeometry=Ea;e.Face4=kl;e.LineStrip=Pl;e.LinePieces=Ul;e.MeshFaceMaterial=Bl;e.MultiMaterial=Fl;e.PointCloud=Gl;e.Particle=Hl;e.ParticleSystem=Vl;e.PointCloudMaterial=Ql;e.ParticleBasicMaterial=Yl;e.ParticleSystemMaterial=Wl;e.Vertex=Xl;e.DynamicBufferAttribute=ql;e.Int8Attribute=Zl;e.Uint8Attribute=Jl;e.Uint8ClampedAttribute=Kl;e.Int16Attribute=$l;e.Uint16Attribute=eh;e.Int32Attribute=th;e.Uint32Attribute=rh;e.Float32Attribute=ih;e.Float64Attribute=nh;e.ClosedSplineCurve3=ah;e.SplineCurve3=oh;e.Spline=sh;e.AxisHelper=uh;e.BoundingBoxHelper=ch;e.EdgesHelper=lh;e.WireframeHelper=hh;e.XHRLoader=dh;e.BinaryTextureLoader=ph;e.GeometryUtils=fh;e.ImageUtils=vh;e.Projector=mh;e.CanvasRenderer=gh;e.SceneUtils=yh;e.LensFlare=Ah;Object.defineProperty(e,"__esModule",{value:true})})},{}],41:[function(e,t,r){THREE.ColladaLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"Anonymous",load:function(e,t,r,i){var n=this;var a=void 0===n.path?THREE.LoaderUtils.extractUrlBase(e):n.path;var o=new THREE.FileLoader(n.manager);o.load(e,function(e){t(n.parse(e,a))},r,i)},setPath:function(e){this.path=e},options:{set convertUpAxis(e){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){function r(e,t){var r=[];var i=e.childNodes;for(var n=0,a=i.length;n<a;n++){var o=i[n];o.nodeName===t&&r.push(o)}return r}function i(e){if(0===e.length)return[];var t=e.trim().split(/\s+/);var r=new Array(t.length);for(var i=0,n=t.length;i<n;i++)r[i]=t[i];return r}function n(e){if(0===e.length)return[];var t=e.trim().split(/\s+/);var r=new Array(t.length);for(var i=0,n=t.length;i<n;i++)r[i]=parseFloat(t[i]);return r}function a(e){if(0===e.length)return[];var t=e.trim().split(/\s+/);var r=new Array(t.length);for(var i=0,n=t.length;i<n;i++)r[i]=parseInt(t[i]);return r}function o(e){return e.substring(1)}function s(){return"three_default_"+dt++}function u(e){return 0===Object.keys(e).length}function c(e){return{unit:l(r(e,"unit")[0]),upAxis:h(r(e,"up_axis")[0])}}function l(e){return void 0!==e?parseFloat(e.getAttribute("meter")):1}function h(e){return void 0!==e?e.textContent:"Y_UP"}function d(e,t,i,n){var a=r(e,t)[0];if(void 0!==a){var o=r(a,i);for(var s=0;s<o.length;s++)n(o[s])}}function p(e,t){for(var r in e){var i=e[r];i.build=t(e[r])}}function f(e,t){if(void 0!==e.build)return e.build;e.build=t(e);return e.build}function v(e){var t={sources:{},samplers:{},channels:{}};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;var a;switch(n.nodeName){case"source":a=n.getAttribute("id");t.sources[a]=Me(n);break;case"sampler":a=n.getAttribute("id");t.samplers[a]=m(n);break;case"channel":a=n.getAttribute("target");t.channels[a]=g(n);break;default:console.log(n)}}pt.animations[e.getAttribute("id")]=t}function m(e){var t={inputs:{}};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"input":var a=o(n.getAttribute("source"));var s=n.getAttribute("semantic");t.inputs[s]=a;break}}return t}function g(e){var t={};var r=e.getAttribute("target");var i=r.split("/");var n=i.shift();var a=i.shift();var s=-1!==a.indexOf("(");var u=-1!==a.indexOf(".");if(u){i=a.split(".");a=i.shift();t.member=i.shift()}else if(s){var c=a.split("(");a=c.shift();for(var l=0;l<c.length;l++)c[l]=parseInt(c[l].replace(/\)/,""));t.indices=c}t.id=n;t.sid=a;t.arraySyntax=s;t.memberSyntax=u;t.sampler=o(e.getAttribute("source"));return t}function y(e){var t=[];var r=e.channels;var i=e.samplers;var n=e.sources;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];var s=i[o.sampler];var u=s.inputs.INPUT;var c=s.inputs.OUTPUT;var l=n[u];var h=n[c];var d=M(o,l,h);T(d,t)}return t}function A(e){return f(pt.animations[e],y)}function M(e,t,r){var i=pt.nodes[e.id];var n=$e(i.id);var a=i.transforms[e.sid];var o=i.matrix.clone().transpose();var s,u;var c,l,h,d;var p={};switch(a){case"matrix":for(c=0,l=t.array.length;c<l;c++){s=t.array[c];u=c*r.stride;void 0===p[s]&&(p[s]={});if(true===e.arraySyntax){var f=r.array[u];var v=e.indices[0]+4*e.indices[1];p[s][v]=f}else for(h=0,d=r.stride;h<d;h++)p[s][h]=r.array[u+h]}break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',a);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',a);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',a);break}var m=w(p,o);var g={name:n.uuid,keyframes:m};return g}function w(e,t){var r=[];for(var i in e)r.push({time:parseFloat(i),value:e[i]});r.sort(a);for(var n=0;n<16;n++)L(r,n,t.elements[n]);return r;function a(e,t){return e.time-t.time}}var E=new THREE.Vector3;var x=new THREE.Vector3;var b=new THREE.Quaternion;function T(e,t){var r=e.keyframes;var i=e.name;var n=[];var a=[];var o=[];var s=[];for(var u=0,c=r.length;u<c;u++){var l=r[u];var h=l.time;var d=l.value;Ve.fromArray(d).transpose();Ve.decompose(E,b,x);n.push(h);a.push(E.x,E.y,E.z);o.push(b.x,b.y,b.z,b.w);s.push(x.x,x.y,x.z)}a.length>0&&t.push(new THREE.VectorKeyframeTrack(i+".position",n,a));o.length>0&&t.push(new THREE.QuaternionKeyframeTrack(i+".quaternion",n,o));s.length>0&&t.push(new THREE.VectorKeyframeTrack(i+".scale",n,s));return t}function L(e,t,r){var i;var n=true;var a,o;for(a=0,o=e.length;a<o;a++){i=e[a];void 0===i.value[t]?i.value[t]=null:n=false}if(true===n)for(a=0,o=e.length;a<o;a++){i=e[a];i.value[t]=r}else N(e,t)}function N(e,t){var r,i;for(var n=0,a=e.length;n<a;n++){var o=e[n];if(null===o.value[t]){r=D(e,n,t);i=C(e,n,t);if(null===r){o.value[t]=i.value[t];continue}if(null===i){o.value[t]=r.value[t];continue}S(o,r,i,t)}}}function D(e,t,r){while(t>=0){var i=e[t];if(null!==i.value[r])return i;t--}return null}function C(e,t,r){while(t<e.length){var i=e[t];if(null!==i.value[r])return i;t++}return null}function S(e,t,r,i){if(r.time-t.time===0){e.value[i]=t.value[i];return}e.value[i]=(e.time-t.time)*(r.value[i]-t.value[i])/(r.time-t.time)+t.value[i]}function I(e){var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"instance_animation":t.animations.push(o(n.getAttribute("url")));break}}pt.clips[e.getAttribute("id")]=t}function _(e){var t=[];var r=e.name;var i=e.end-e.start||-1;var n=e.animations;for(var a=0,o=n.length;a<o;a++){var s=A(n[a]);for(var u=0,c=s.length;u<c;u++)t.push(s[u])}return new THREE.AnimationClip(r,i,t)}function O(e){return f(pt.clips[e],_)}function j(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"skin":t.id=o(n.getAttribute("source"));t.skin=R(n);break;case"morph":t.id=o(n.getAttribute("source"));console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}pt.controllers[e.getAttribute("id")]=t}function R(e){var t={sources:{}};for(var r=0,i=e.childNodes.length;r<i;r++){var a=e.childNodes[r];if(1!==a.nodeType)continue;switch(a.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=n(a.textContent);break;case"source":var o=a.getAttribute("id");t.sources[o]=Me(a);break;case"joints":t.joints=z(a);break;case"vertex_weights":t.vertexWeights=k(a);break}}return t}function z(e){var t={inputs:{}};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"input":var a=n.getAttribute("semantic");var s=o(n.getAttribute("source"));t.inputs[a]=s;break}}return t}function k(e){var t={inputs:{}};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"input":var s=n.getAttribute("semantic");var u=o(n.getAttribute("source"));var c=parseInt(n.getAttribute("offset"));t.inputs[s]={id:u,offset:c};break;case"vcount":t.vcount=a(n.textContent);break;case"v":t.v=a(n.textContent);break}}return t}function P(e){var t={id:e.id};var r=pt.geometries[t.id];if(void 0!==e.skin){t.skin=U(e.skin);r.sources.skinIndices=t.skin.indices;r.sources.skinWeights=t.skin.weights}return t}function U(e){var t=4;var r={joints:[],indices:{array:[],stride:t},weights:{array:[],stride:t}};var i=e.sources;var n=e.vertexWeights;var a=n.vcount;var o=n.v;var s=n.inputs.JOINT.offset;var u=n.inputs.WEIGHT.offset;var c=e.sources[e.joints.inputs.JOINT];var l=e.sources[e.joints.inputs.INV_BIND_MATRIX];var h=i[n.inputs.WEIGHT.id].array;var d=0;var p,f,v;for(p=0,v=a.length;p<v;p++){var m=a[p];var g=[];for(f=0;f<m;f++){var y=o[d+s];var A=o[d+u];var M=h[A];g.push({index:y,weight:M});d+=2}g.sort(b);for(f=0;f<t;f++){var w=g[f];if(void 0!==w){r.indices.array.push(w.index);r.weights.array.push(w.weight)}else{r.indices.array.push(0);r.weights.array.push(0)}}}r.bindMatrix=(new THREE.Matrix4).fromArray(e.bindShapeMatrix).transpose();for(p=0,v=c.array.length;p<v;p++){var E=c.array[p];var x=(new THREE.Matrix4).fromArray(l.array,p*l.stride).transpose();r.joints.push({name:E,boneInverse:x})}return r;function b(e,t){return t.weight-e.weight}}function B(e){return f(pt.controllers[e],P)}function F(e){var t={init_from:r(e,"init_from")[0].textContent};pt.images[e.getAttribute("id")]=t}function G(e){if(void 0!==e.build)return e.build;return e.init_from}function H(e){return f(pt.images[e],G)}function V(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"profile_COMMON":t.profile=Q(n);break}}pt.effects[e.getAttribute("id")]=t}function Q(e){var t={surfaces:{},samplers:{}};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"newparam":Y(n,t);break;case"technique":t.technique=q(n);break;case"extra":t.extra=te(n);break}}return t}function Y(e,t){var r=e.getAttribute("sid");for(var i=0,n=e.childNodes.length;i<n;i++){var a=e.childNodes[i];if(1!==a.nodeType)continue;switch(a.nodeName){case"surface":t.surfaces[r]=W(a);break;case"sampler2D":t.samplers[r]=X(a);break}}}function W(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"init_from":t.init_from=n.textContent;break}}return t}function X(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"source":t.source=n.textContent;break}}return t}function q(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=n.nodeName;t.parameters=Z(n);break}}return t}function Z(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"emission":case"diffuse":case"specular":case"shininess":case"transparency":t[n.nodeName]=J(n);break;case"transparent":t[n.nodeName]={opaque:n.getAttribute("opaque"),data:J(n)};break}}return t}function J(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var a=e.childNodes[r];if(1!==a.nodeType)continue;switch(a.nodeName){case"color":t[a.nodeName]=n(a.textContent);break;case"float":t[a.nodeName]=parseFloat(a.textContent);break;case"texture":t[a.nodeName]={id:a.getAttribute("texture"),extra:K(a)};break}}return t}function K(e){var t={technique:{}};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"extra":$(n,t);break}}return t}function $(e,t){for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"technique":ee(n,t);break}}}function ee(e,t){for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[n.nodeName]=parseFloat(n.textContent);break;case"wrapU":case"wrapV":"TRUE"===n.textContent.toUpperCase()?t.technique[n.nodeName]=1:"FALSE"===n.textContent.toUpperCase()?t.technique[n.nodeName]=0:t.technique[n.nodeName]=parseInt(n.textContent);break}}}function te(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"technique":t.technique=re(n);break}}return t}function re(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"double_sided":t[n.nodeName]=parseInt(n.textContent);break}}return t}function ie(e){return e}function ne(e){return f(pt.effects[e],ie)}function ae(e){var t={name:e.getAttribute("name")};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"instance_effect":t.url=o(n.getAttribute("url"));break}}pt.materials[e.getAttribute("id")]=t}function oe(e){var t=ne(e.url);var r=t.profile.technique;var i=t.profile.extra;var n;switch(r.type){case"phong":case"blinn":n=new THREE.MeshPhongMaterial;break;case"lambert":n=new THREE.MeshLambertMaterial;break;default:n=new THREE.MeshBasicMaterial;break}n.name=e.name;function a(e){var r=t.profile.samplers[e.id];var i;if(void 0!==r){var n=t.profile.surfaces[r.source];i=H(n.init_from)}else{console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530).");i=H(e.id)}if(void 0!==i){var a=ct.load(i);var o=e.extra;if(void 0!==o&&void 0!==o.technique&&false===u(o.technique)){var s=o.technique;a.wrapS=s.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;a.wrapT=s.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;a.offset.set(s.offsetU||0,s.offsetV||0);a.repeat.set(s.repeatU||1,s.repeatV||1)}else{a.wrapS=THREE.RepeatWrapping;a.wrapT=THREE.RepeatWrapping}return a}console.error("THREE.ColladaLoader: Unable to load texture with ID:",e.id);return null}var o=r.parameters;for(var s in o){var c=o[s];switch(s){case"diffuse":c.color&&n.color.fromArray(c.color);c.texture&&(n.map=a(c.texture));break;case"specular":c.color&&n.specular&&n.specular.fromArray(c.color);c.texture&&(n.specularMap=a(c.texture));break;case"shininess":c.float&&n.shininess&&(n.shininess=c.float);break;case"emission":c.color&&n.emissive&&n.emissive.fromArray(c.color);break}}var l=o["transparent"];var h=o["transparency"];void 0===h&&l&&(h={float:1});void 0===l&&h&&(l={opaque:"A_ONE",data:{color:[1,1,1,1]}});if(l&&h)if(l.data.texture){n.alphaMap=a(l.data.texture);n.transparent=true}else{var d=l.data.color;switch(l.opaque){case"A_ONE":n.opacity=d[3]*h.float;break;case"RGB_ZERO":n.opacity=1-d[0]*h.float;break;case"A_ZERO":n.opacity=1-d[3]*h.float;break;case"RGB_ONE":n.opacity=d[0]*h.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',l.opaque)}n.opacity<1&&(n.transparent=true)}void 0!==i&&void 0!==i.technique&&1===i.technique.double_sided&&(n.side=THREE.DoubleSide);return n}function se(e){return f(pt.materials[e],oe)}function ue(e){var t={name:e.getAttribute("name")};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"optics":t.optics=ce(n);break}}pt.cameras[e.getAttribute("id")]=t}function ce(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"technique_common":return le(r)}}return{}}function le(e){var t={};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];switch(i.nodeName){case"perspective":case"orthographic":t.technique=i.nodeName;t.parameters=he(i);break}}return t}function he(e){var t={};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];switch(i.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[i.nodeName]=parseFloat(i.textContent);break}}return t}function de(e){var t;switch(e.optics.technique){case"perspective":t=new THREE.PerspectiveCamera(e.optics.parameters.yfov,e.optics.parameters.aspect_ratio,e.optics.parameters.znear,e.optics.parameters.zfar);break;case"orthographic":var r=e.optics.parameters.ymag;var i=e.optics.parameters.xmag;var n=e.optics.parameters.aspect_ratio;i=void 0===i?r*n:i;r=void 0===r?i/n:r;i*=.5;r*=.5;t=new THREE.OrthographicCamera(-i,i,r,-r,e.optics.parameters.znear,e.optics.parameters.zfar);break;default:t=new THREE.PerspectiveCamera;break}t.name=e.name;return t}function pe(e){var t=pt.cameras[e];if(void 0!==t)return f(t,de);console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e);return null}function fe(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"technique_common":t=ve(n);break}}pt.lights[e.getAttribute("id")]=t}function ve(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=n.nodeName;t.parameters=me(n)}}return t}function me(e){var t={};for(var r=0,i=e.childNodes.length;r<i;r++){var a=e.childNodes[r];if(1!==a.nodeType)continue;switch(a.nodeName){case"color":var o=n(a.textContent);t.color=(new THREE.Color).fromArray(o);break;case"falloff_angle":t.falloffAngle=parseFloat(a.textContent);break;case"quadratic_attenuation":var s=parseFloat(a.textContent);t.distance=s?Math.sqrt(1/s):0;break}}return t}function ge(e){var t;switch(e.technique){case"directional":t=new THREE.DirectionalLight;break;case"point":t=new THREE.PointLight;break;case"spot":t=new THREE.SpotLight;break;case"ambient":t=new THREE.AmbientLight;break}e.parameters.color&&t.color.copy(e.parameters.color);e.parameters.distance&&(t.distance=e.parameters.distance);return t}function ye(e){var t=pt.lights[e];if(void 0!==t)return f(t,ge);console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e);return null}function Ae(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]};var i=r(e,"mesh")[0];if(void 0===i)return;for(var n=0;n<i.childNodes.length;n++){var a=i.childNodes[n];if(1!==a.nodeType)continue;var o=a.getAttribute("id");switch(a.nodeName){case"source":t.sources[o]=Me(a);break;case"vertices":t.vertices=we(a);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",a.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(Ee(a));break;default:console.log(a)}}pt.geometries[e.getAttribute("id")]=t}function Me(e){var t={array:[],stride:3};for(var a=0;a<e.childNodes.length;a++){var o=e.childNodes[a];if(1!==o.nodeType)continue;switch(o.nodeName){case"float_array":t.array=n(o.textContent);break;case"Name_array":t.array=i(o.textContent);break;case"technique_common":var s=r(o,"accessor")[0];void 0!==s&&(t.stride=parseInt(s.getAttribute("stride")));break}}return t}function we(e){var t={};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;t[i.getAttribute("semantic")]=o(i.getAttribute("source"))}return t}function Ee(e){var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0};for(var r=0,i=e.childNodes.length;r<i;r++){var n=e.childNodes[r];if(1!==n.nodeType)continue;switch(n.nodeName){case"input":var s=o(n.getAttribute("source"));var u=n.getAttribute("semantic");var c=parseInt(n.getAttribute("offset"));t.inputs[u]={id:s,offset:c};t.stride=Math.max(t.stride,c+1);break;case"vcount":t.vcount=a(n.textContent);break;case"p":t.p=a(n.textContent);break}}return t}function xe(e){var t={};for(var r=0;r<e.length;r++){var i=e[r];void 0===t[i.type]&&(t[i.type]=[]);t[i.type].push(i)}return t}function be(e){var t={};var r=e.sources;var i=e.vertices;var n=e.primitives;if(0===n.length)return{};var a=xe(n);for(var o in a)t[o]=Te(a[o],r,i);return t}function Te(e,t,r){var i={};var n={array:[],stride:0};var a={array:[],stride:0};var o={array:[],stride:0};var s={array:[],stride:0};var u={array:[],stride:4};var c={array:[],stride:4};var l=new THREE.BufferGeometry;var h=[];var d=0,p=0;for(var f=0;f<e.length;f++){var v=e[f];var m=v.inputs;var g=1;v.vcount&&4===v.vcount[0]&&(g=2);p="lines"===v.type||"linestrips"===v.type?2*v.count:3*v.count*g;l.addGroup(d,p,f);d+=p;v.material&&h.push(v.material);for(var y in m){var A=m[y];switch(y){case"VERTEX":for(var M in r){var w=r[M];switch(M){case"POSITION":Le(v,t[w],A.offset,n.array);n.stride=t[w].stride;if(t.skinWeights&&t.skinIndices){Le(v,t.skinIndices,A.offset,u.array);Le(v,t.skinWeights,A.offset,c.array)}break;case"NORMAL":Le(v,t[w],A.offset,a.array);a.stride=t[w].stride;break;case"COLOR":Le(v,t[w],A.offset,s.array);s.stride=t[w].stride;break;case"TEXCOORD":Le(v,t[w],A.offset,o.array);o.stride=t[w].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',M)}}break;case"NORMAL":Le(v,t[A.id],A.offset,a.array);a.stride=t[A.id].stride;break;case"COLOR":Le(v,t[A.id],A.offset,s.array);s.stride=t[A.id].stride;break;case"TEXCOORD":Le(v,t[A.id],A.offset,o.array);o.stride=t[A.id].stride;break}}}n.array.length>0&&l.addAttribute("position",new THREE.Float32BufferAttribute(n.array,n.stride));a.array.length>0&&l.addAttribute("normal",new THREE.Float32BufferAttribute(a.array,a.stride));s.array.length>0&&l.addAttribute("color",new THREE.Float32BufferAttribute(s.array,s.stride));o.array.length>0&&l.addAttribute("uv",new THREE.Float32BufferAttribute(o.array,o.stride));u.array.length>0&&l.addAttribute("skinIndex",new THREE.Float32BufferAttribute(u.array,u.stride));c.array.length>0&&l.addAttribute("skinWeight",new THREE.Float32BufferAttribute(c.array,c.stride));i.data=l;i.type=e[0].type;i.materialKeys=h;return i}function Le(e,t,r,i){var n=e.p;var a=e.stride;var o=e.vcount;function s(e){var t=n[e+r]*l;var a=t+l;for(;t<a;t++)i.push(c[t])}var u=0;var c=t.array;var l=t.stride;if(void 0!==e.vcount){var h=0;for(var d=0,p=o.length;d<p;d++){var f=o[d];if(4===f){var v=h+0*a;var m=h+1*a;var g=h+2*a;var y=h+3*a;s(v);s(m);s(y);s(m);s(g);s(y)}else if(3===f){var v=h+0*a;var m=h+1*a;var g=h+2*a;s(v);s(m);s(g)}else u=Math.max(u,f);h+=a*f}u>0&&console.log("THREE.ColladaLoader: Geometry has faces with more than 4 vertices.")}else for(var d=0,p=n.length;d<p;d+=a)s(d)}function Ne(e){return f(pt.geometries[e],be)}function De(e){var t={name:e.getAttribute("name")||"",joints:{},links:[]};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"technique_common":Ie(i,t);break}}pt.kinematicsModels[e.getAttribute("id")]=t}function Ce(e){if(void 0!==e.build)return e.build;return e}function Se(e){return f(pt.kinematicsModels[e],Ce)}function Ie(e,t){for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"joint":t.joints[i.getAttribute("sid")]=_e(i);break;case"link":t.links.push(je(i));break}}}function _e(e){var t;for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"prismatic":case"revolute":t=Oe(i);break}}return t}function Oe(e,t){var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:e.nodeName,static:false,zeroPosition:0,middlePosition:0};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"axis":var a=n(i.textContent);t.axis.fromArray(a);break;case"limits":var o=i.getElementsByTagName("max")[0];var s=i.getElementsByTagName("min")[0];t.limits.max=parseFloat(o.textContent);t.limits.min=parseFloat(s.textContent);break}}t.limits.min>=t.limits.max&&(t.static=true);t.middlePosition=(t.limits.min+t.limits.max)/2;return t}function je(e){var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"attachment_full":t.attachments.push(Re(i));break;case"matrix":case"translate":case"rotate":t.transforms.push(ze(i));break}}return t}function Re(e){var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"link":t.links.push(je(i));break;case"matrix":case"translate":case"rotate":t.transforms.push(ze(i));break}}return t}function ze(e){var t={type:e.nodeName};var r=n(e.textContent);switch(t.type){case"matrix":t.obj=new THREE.Matrix4;t.obj.fromArray(r).transpose();break;case"translate":t.obj=new THREE.Vector3;t.obj.fromArray(r);break;case"rotate":t.obj=new THREE.Vector3;t.obj.fromArray(r);t.angle=THREE.Math.degToRad(r[3]);break}return t}function ke(e){var t={bindJointAxis:[]};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"bind_joint_axis":t.bindJointAxis.push(Pe(i));break}}pt.kinematicsScenes[o(e.getAttribute("url"))]=t}function Pe(e){var t={target:e.getAttribute("target").split("/").pop()};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"axis":var n=i.getElementsByTagName("param")[0];t.axis=n.textContent;var a=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=a.substr(0,a.length-1);break}}return t}function Ue(e){if(void 0!==e.build)return e.build;return e}function Be(e){return f(pt.kinematicsScenes[e],Ue)}function Fe(){var e=Object.keys(pt.kinematicsModels)[0];var t=Object.keys(pt.kinematicsScenes)[0];var r=Object.keys(pt.visualScenes)[0];if(void 0===e||void 0===t)return;var i=Se(e);var n=Be(t);var a=rt(r);var o=n.bindJointAxis;var s={};for(var u=0,c=o.length;u<c;u++){var l=o[u];var h=ot.querySelector('[sid="'+l.target+'"]');if(h){var d=h.parentElement;p(l.jointIndex,d)}}function p(e,t){var r=t.getAttribute("name");var n=i.joints[e];a.traverse(function(i){i.name===r&&(s[e]={object:i,transforms:Ge(t),joint:n,position:n.zeroPosition})})}var f=new THREE.Matrix4;ht={joints:i&&i.joints,getJointValue:function(e){var t=s[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(e,t){var r=s[e];if(r){var i=r.joint;if(t>i.limits.max||t<i.limits.min)console.warn("THREE.ColladaLoader: Joint "+e+" value "+t+" outside of limits (min: "+i.limits.min+", max: "+i.limits.max+").");else if(i.static)console.warn("THREE.ColladaLoader: Joint "+e+" is static.");else{var n=r.object;var a=i.axis;var o=r.transforms;Ve.identity();for(var u=0;u<o.length;u++){var c=o[u];if(c.sid&&-1!==c.sid.indexOf(e))switch(i.type){case"revolute":Ve.multiply(f.makeRotationAxis(a,THREE.Math.degToRad(t)));break;case"prismatic":Ve.multiply(f.makeTranslation(a.x*t,a.y*t,a.z*t));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+i.type);break}else switch(c.type){case"matrix":Ve.multiply(c.obj);break;case"translate":Ve.multiply(f.makeTranslation(c.obj.x,c.obj.y,c.obj.z));break;case"scale":Ve.scale(c.obj);break;case"rotate":Ve.multiply(f.makeRotationAxis(c.obj,c.angle));break}}n.matrix.copy(Ve);n.matrix.decompose(n.position,n.quaternion,n.scale);s[e].position=t}}else console.log("THREE.ColladaLoader: "+e+" does not exist.")}}}function Ge(e){var t=[];var r=ot.querySelector('[id="'+e.id+'"]');for(var i=0;i<r.childNodes.length;i++){var a=r.childNodes[i];if(1!==a.nodeType)continue;switch(a.nodeName){case"matrix":var o=n(a.textContent);var s=(new THREE.Matrix4).fromArray(o).transpose();t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:s});break;case"translate":case"scale":var o=n(a.textContent);var u=(new THREE.Vector3).fromArray(o);t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:u});break;case"rotate":var o=n(a.textContent);var u=(new THREE.Vector3).fromArray(o);var c=THREE.Math.degToRad(o[3]);t.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:u,angle:c});break}}return t}function He(e){var t=e.getElementsByTagName("node");for(var r=0;r<t.length;r++){var i=t[r];false===i.hasAttribute("id")&&i.setAttribute("id",s())}}var Ve=new THREE.Matrix4;var Qe=new THREE.Vector3;function Ye(e){var t={name:e.getAttribute("name")||"",type:e.getAttribute("type"),id:e.getAttribute("id"),sid:e.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1!==i.nodeType)continue;switch(i.nodeName){case"node":t.nodes.push(i.getAttribute("id"));Ye(i);break;case"instance_camera":t.instanceCameras.push(o(i.getAttribute("url")));break;case"instance_controller":t.instanceControllers.push(We(i));break;case"instance_light":t.instanceLights.push(o(i.getAttribute("url")));break;case"instance_geometry":t.instanceGeometries.push(We(i));break;case"instance_node":t.instanceNodes.push(o(i.getAttribute("url")));break;case"matrix":var a=n(i.textContent);t.matrix.multiply(Ve.fromArray(a).transpose());t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"translate":var a=n(i.textContent);Qe.fromArray(a);t.matrix.multiply(Ve.makeTranslation(Qe.x,Qe.y,Qe.z));t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"rotate":var a=n(i.textContent);var s=THREE.Math.degToRad(a[3]);t.matrix.multiply(Ve.makeRotationAxis(Qe.fromArray(a),s));t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"scale":var a=n(i.textContent);t.matrix.scale(Qe.fromArray(a));t.transforms[i.getAttribute("sid")]=i.nodeName;break;case"extra":break;default:console.log(i)}}pt.nodes[t.id]=t;return t}function We(e){var t={id:o(e.getAttribute("url")),materials:{},skeletons:[]};for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];switch(i.nodeName){case"bind_material":var n=i.getElementsByTagName("instance_material");for(var a=0;a<n.length;a++){var s=n[a];var u=s.getAttribute("symbol");var c=s.getAttribute("target");t.materials[u]=o(c)}break;case"skeleton":t.skeletons.push(o(i.textContent));break;default:break}}return t}function Xe(e,t){var r=[];var i=[];var n,a,o;for(n=0;n<e.length;n++){var s=e[n];var u=$e(s);qe(u,t,r)}for(n=0;n<t.length;n++)for(a=0;a<r.length;a++){o=r[a];if(o.bone.name===t[n].name){i[n]=o;o.processed=true;break}}for(n=0;n<r.length;n++){o=r[n];if(false===o.processed){i.push(o);o.processed=true}}var c=[];var l=[];for(n=0;n<i.length;n++){o=i[n];c.push(o.bone);l.push(o.boneInverse)}return new THREE.Skeleton(c,l)}function qe(e,t,r){e.traverse(function(e){if(true===e.isBone){var i;for(var n=0;n<t.length;n++){var a=t[n];if(a.name===e.name){i=a.boneInverse;break}}void 0===i&&(i=new THREE.Matrix4);r.push({bone:e,boneInverse:i,processed:false})}})}function Ze(e){var t=[];var r=e.matrix;var i=e.nodes;var n=e.type;var a=e.instanceCameras;var o=e.instanceControllers;var s=e.instanceLights;var u=e.instanceGeometries;var c=e.instanceNodes;for(var l=0,h=i.length;l<h;l++)t.push($e(i[l]));for(var l=0,h=a.length;l<h;l++){var d=pe(a[l]);null!==d&&t.push(d.clone())}for(var l=0,h=o.length;l<h;l++){var p=o[l];var f=B(p.id);var v=Ne(f.id);var m=Ke(v,p.materials);var g=p.skeletons;var y=f.skin.joints;var A=Xe(g,y);for(var M=0,w=m.length;M<w;M++){var E=m[M];if(E.isSkinnedMesh){E.bind(A,f.skin.bindMatrix);E.normalizeSkinWeights()}t.push(E)}}for(var l=0,h=s.length;l<h;l++){var x=ye(s[l]);null!==x&&t.push(x.clone())}for(var l=0,h=u.length;l<h;l++){var p=u[l];var v=Ne(p.id);var m=Ke(v,p.materials);for(var M=0,w=m.length;M<w;M++)t.push(m[M])}for(var l=0,h=c.length;l<h;l++)t.push($e(c[l]).clone());var E;if(0===i.length&&1===t.length)E=t[0];else{E="JOINT"===n?new THREE.Bone:new THREE.Group;for(var l=0;l<t.length;l++)E.add(t[l])}E.name="JOINT"===n?e.sid:e.name;E.matrix.copy(r);E.matrix.decompose(E.position,E.quaternion,E.scale);return E}function Je(e,t){var r=[];for(var i=0,n=e.length;i<n;i++){var a=t[e[i]];r.push(se(a))}return r}function Ke(e,t){var r=[];for(var i in e){var n=e[i];var a=Je(n.materialKeys,t);0===a.length&&("lines"===i||"linestrips"===i?a.push(new THREE.LineBasicMaterial):a.push(new THREE.MeshPhongMaterial));var o=void 0!==n.data.attributes.skinIndex;if(o)for(var s=0,u=a.length;s<u;s++)a[s].skinning=true;var c=1===a.length?a[0]:a;var l;switch(i){case"lines":l=new THREE.LineSegments(n.data,c);break;case"linestrips":l=new THREE.Line(n.data,c);break;case"triangles":case"polylist":l=o?new THREE.SkinnedMesh(n.data,c):new THREE.Mesh(n.data,c);break}r.push(l)}return r}function $e(e){return f(pt.nodes[e],Ze)}function et(e){var t={name:e.getAttribute("name"),children:[]};He(e);var i=r(e,"node");for(var n=0;n<i.length;n++)t.children.push(Ye(i[n]));pt.visualScenes[e.getAttribute("id")]=t}function tt(e){var t=new THREE.Group;t.name=e.name;var r=e.children;for(var i=0;i<r.length;i++){var n=r[i];null===n.id?t.add(Ze(n)):t.add($e(n.id))}return t}function rt(e){return f(pt.visualScenes[e],tt)}function it(e){var t=r(e,"instance_visual_scene")[0];return rt(o(t.getAttribute("url")))}function nt(){var e=pt.clips;if(true===u(e)){if(false===u(pt.animations)){var t=[];for(var r in pt.animations){var i=A(r);for(var n=0,a=i.length;n<a;n++)t.push(i[n])}lt.push(new THREE.AnimationClip("default",-1,t))}}else for(var r in e)lt.push(O(r))}console.time("THREE.ColladaLoader");if(0===e.length)return{scene:new THREE.Scene};console.time("THREE.ColladaLoader: DOMParser");var at=(new DOMParser).parseFromString(e,"application/xml");console.timeEnd("THREE.ColladaLoader: DOMParser");var ot=r(at,"COLLADA")[0];var st=ot.getAttribute("version");console.log("THREE.ColladaLoader: File version",st);var ut=c(r(ot,"asset")[0]);var ct=new THREE.TextureLoader(this.manager);ct.setPath(t).setCrossOrigin(this.crossOrigin);var lt=[];var ht={};var dt=0;var pt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},kinematicsScenes:{}};console.time("THREE.ColladaLoader: Parse");d(ot,"library_animations","animation",v);d(ot,"library_animation_clips","animation_clip",I);d(ot,"library_controllers","controller",j);d(ot,"library_images","image",F);d(ot,"library_effects","effect",V);d(ot,"library_materials","material",ae);d(ot,"library_cameras","camera",ue);d(ot,"library_lights","light",fe);d(ot,"library_geometries","geometry",Ae);d(ot,"library_nodes","node",Ye);d(ot,"library_visual_scenes","visual_scene",et);d(ot,"library_kinematics_models","kinematics_model",De);d(ot,"scene","instance_kinematics_scene",ke);console.timeEnd("THREE.ColladaLoader: Parse");console.time("THREE.ColladaLoader: Build");p(pt.animations,y);p(pt.clips,_);p(pt.controllers,P);p(pt.images,G);p(pt.effects,ie);p(pt.materials,oe);p(pt.cameras,de);p(pt.lights,ge);p(pt.geometries,be);p(pt.visualScenes,tt);console.timeEnd("THREE.ColladaLoader: Build");nt();Fe();var ft=it(r(ot,"scene")[0]);"Z_UP"===ut.upAxis&&(ft.rotation.x=-Math.PI/2);ft.scale.multiplyScalar(ut.unit);console.timeEnd("THREE.ColladaLoader");return{animations:lt,kinematics:ht,library:pt,scene:ft}}}},{}],42:[function(e,t,r){THREE.GLTFLoader=function(){function e(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager}e.prototype={constructor:e,crossOrigin:"Anonymous",load:function(e,t,r,i){var n=this;var a=void 0!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e);var o=new THREE.FileLoader(n.manager);o.setResponseType("arraybuffer");o.load(e,function(e){try{n.parse(e,a,t,i)}catch(e){if(void 0===i)throw e;i(e)}},r,i)},setCrossOrigin:function(e){this.crossOrigin=e;return this},setPath:function(e){this.path=e;return this},parse:function(e,t,n,o){var s;var l={};if("string"===typeof e)s=e;else{var h=THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4));if(h===a){try{l[r.KHR_BINARY_GLTF]=new u(e)}catch(e){o&&o(e);return}s=l[r.KHR_BINARY_GLTF].content}else s=THREE.LoaderUtils.decodeText(new Uint8Array(e))}var d=JSON.parse(s);if(void 0===d.asset||d.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));return}if(d.extensionsUsed){d.extensionsUsed.indexOf(r.KHR_LIGHTS)>=0&&(l[r.KHR_LIGHTS]=new i(d));d.extensionsUsed.indexOf(r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(l[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new c)}console.time("GLTFLoader");var p=new O(d,l,{path:t||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager});p.parse(function(e,t,r,i,a){console.timeEnd("GLTFLoader");var o={scene:e,scenes:t,cameras:r,animations:i,asset:a};n(o)},o)}};function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness"};function i(e){this.name=r.KHR_LIGHTS;this.lights={};var t=e.extensions&&e.extensions[r.KHR_LIGHTS]||{};var i=t.lights||{};for(var n in i){var a=i[n];var o;var s=(new THREE.Color).fromArray(a.color);switch(a.type){case"directional":o=new THREE.DirectionalLight(s);o.position.set(0,0,1);break;case"point":o=new THREE.PointLight(s);break;case"spot":o=new THREE.SpotLight(s);o.position.set(0,0,1);break;case"ambient":o=new THREE.AmbientLight(s);break}if(o){void 0!==a.constantAttenuation&&(o.intensity=a.constantAttenuation);void 0!==a.linearAttenuation&&(o.distance=1/a.linearAttenuation);void 0!==a.quadraticAttenuation&&(o.decay=a.quadraticAttenuation);void 0!==a.fallOffAngle&&(o.angle=a.fallOffAngle);void 0!==a.fallOffExponent&&console.warn("THREE.GLTFLoader:: light.fallOffExponent not currently supported.");o.name=a.name||"light_"+n;this.lights[n]=o}}}var n="binary_glTF";var a="glTF";var o=12;var s={JSON:1313821514,BIN:5130562};function u(e){this.name=r.KHR_BINARY_GLTF;this.content=null;this.body=null;var t=new DataView(e,0,o);this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,true),length:t.getUint32(8,true)};if(this.header.magic!==a)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");var i=new DataView(e,o);var n=0;while(n<i.byteLength){var u=i.getUint32(n,true);n+=4;var c=i.getUint32(n,true);n+=4;if(c===s.JSON){var l=new Uint8Array(e,o+n,u);this.content=THREE.LoaderUtils.decodeText(l)}else if(c===s.BIN){var h=o+n;this.body=e.slice(h,h+u)}n+=u}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function c(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return THREE.ShaderMaterial},extendParams:function(e,t,r){var i=t.extensions[this.name];var n=THREE.ShaderLib["standard"];var a=THREE.UniformsUtils.clone(n.uniforms);var o=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n");var s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n");var u=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n");var c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n");var l=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n");var h=n.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",u).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",l);delete a.roughness;delete a.metalness;delete a.roughnessMap;delete a.metalnessMap;a.specular={value:(new THREE.Color).setHex(1118481)};a.glossiness={value:.5};a.specularMap={value:null};a.glossinessMap={value:null};e.vertexShader=n.vertexShader;e.fragmentShader=h;e.uniforms=a;e.defines={STANDARD:""};e.color=new THREE.Color(1,1,1);e.opacity=1;var d=[];if(Array.isArray(i.diffuseFactor)){var p=i.diffuseFactor;e.color.fromArray(p);e.opacity=p[3]}void 0!==i.diffuseTexture&&d.push(r.assignTexture(e,"map",i.diffuseTexture.index));e.emissive=new THREE.Color(0,0,0);e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1;e.specular=new THREE.Color(1,1,1);Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor);if(void 0!==i.specularGlossinessTexture){var f=i.specularGlossinessTexture.index;d.push(r.assignTexture(e,"glossinessMap",f));d.push(r.assignTexture(e,"specularMap",f))}return Promise.all(d)},createMaterial:function(e){var t=new THREE.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:true,lights:true,opacity:e.opacity,transparent:e.transparent});t.isGLTFSpecularGlossinessMaterial=true;t.color=e.color;t.map=void 0===e.map?null:e.map;t.lightMap=null;t.lightMapIntensity=1;t.aoMap=void 0===e.aoMap?null:e.aoMap;t.aoMapIntensity=1;t.emissive=e.emissive;t.emissiveIntensity=1;t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap;t.bumpMap=void 0===e.bumpMap?null:e.bumpMap;t.bumpScale=1;t.normalMap=void 0===e.normalMap?null:e.normalMap;e.normalScale&&(t.normalScale=e.normalScale);t.displacementMap=null;t.displacementScale=1;t.displacementBias=0;t.specularMap=void 0===e.specularMap?null:e.specularMap;t.specular=e.specular;t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap;t.glossiness=e.glossiness;t.alphaMap=null;t.envMap=void 0===e.envMap?null:e.envMap;t.envMapIntensity=1;t.refractionRatio=.98;t.extensions.derivatives=true;return t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=true;var r=this.specularGlossinessParams;for(var i=0,n=r.length;i<n;i++)t[r[i]]=e[r[i]];return t},refreshUniforms:function(e,t,r,i,n,a){if(true!==n.isGLTFSpecularGlossinessMaterial)return;var o=n.uniforms;var s=n.defines;o.opacity.value=n.opacity;o.diffuse.value.copy(n.color);o.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity);o.map.value=n.map;o.specularMap.value=n.specularMap;o.alphaMap.value=n.alphaMap;o.lightMap.value=n.lightMap;o.lightMapIntensity.value=n.lightMapIntensity;o.aoMap.value=n.aoMap;o.aoMapIntensity.value=n.aoMapIntensity;var u;n.map?u=n.map:n.specularMap?u=n.specularMap:n.displacementMap?u=n.displacementMap:n.normalMap?u=n.normalMap:n.bumpMap?u=n.bumpMap:n.glossinessMap?u=n.glossinessMap:n.alphaMap?u=n.alphaMap:n.emissiveMap&&(u=n.emissiveMap);if(void 0!==u){u.isWebGLRenderTarget&&(u=u.texture);var c;var l;if(void 0!==u.matrix){if(true===u.matrixAutoUpdate){c=u.offset;l=u.repeat;var h=u.rotation;var d=u.center;u.matrix.setUvTransform(c.x,c.y,l.x,l.y,h,d.x,d.y)}o.uvTransform.value.copy(u.matrix)}else{c=u.offset;l=u.repeat;o.offsetRepeat.value.set(c.x,c.y,l.x,l.y)}}o.envMap.value=n.envMap;o.envMapIntensity.value=n.envMapIntensity;o.flipEnvMap.value=n.envMap&&n.envMap.isCubeTexture?-1:1;o.refractionRatio.value=n.refractionRatio;o.specular.value.copy(n.specular);o.glossiness.value=n.glossiness;o.glossinessMap.value=n.glossinessMap;o.emissiveMap.value=n.emissiveMap;o.bumpMap.value=n.bumpMap;o.normalMap.value=n.normalMap;o.displacementMap.value=n.displacementMap;o.displacementScale.value=n.displacementScale;o.displacementBias.value=n.displacementBias;if(null!==o.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP){s.USE_GLOSSINESSMAP="";s.USE_ROUGHNESSMAP=""}if(null===o.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP){delete s.USE_GLOSSINESSMAP;delete s.USE_ROUGHNESSMAP}}}}function l(e,t,r,i){THREE.Interpolant.call(this,e,t,r,i)}l.prototype=Object.create(THREE.Interpolant.prototype);l.prototype.constructor=l;l.prototype.interpolate_=function(e,t,r,i){var n=this.resultBuffer;var a=this.sampleValues;var o=this.valueSize;var s=2*o;var u=3*o;var c=i-t;var l=(r-t)/c;var h=l*l;var d=h*l;var p=e*u;var f=p-u;var v=2*d-3*h+1;var m=d-2*h+l;var g=-2*d+3*h;var y=d-h;for(var A=0;A!==o;A++){var M=a[f+A+o];var w=a[f+A+s]*c;var E=a[p+A+o];var x=a[p+A]*c;n[A]=v*M+m*w+g*E+y*x}return n};var h={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123};var d={5126:Number,35675:THREE.Matrix3,35676:THREE.Matrix4,35664:THREE.Vector2,35665:THREE.Vector3,35666:THREE.Vector4,35678:THREE.Texture};var p={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};var f={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipMapNearestFilter,9985:THREE.LinearMipMapNearestFilter,9986:THREE.NearestMipMapLinearFilter,9987:THREE.LinearMipMapLinearFilter};var v={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping};var m={6406:THREE.AlphaFormat,6407:THREE.RGBFormat,6408:THREE.RGBAFormat,6409:THREE.LuminanceFormat,6410:THREE.LuminanceAlphaFormat};var g={5121:THREE.UnsignedByteType,32819:THREE.UnsignedShort4444Type,32820:THREE.UnsignedShort5551Type,33635:THREE.UnsignedShort565Type};var y={1028:THREE.BackSide,1029:THREE.FrontSide};var A={512:THREE.NeverDepth,513:THREE.LessDepth,514:THREE.EqualDepth,515:THREE.LessEqualDepth,516:THREE.GreaterEqualDepth,517:THREE.NotEqualDepth,518:THREE.GreaterEqualDepth,519:THREE.AlwaysDepth};var M={32774:THREE.AddEquation,32778:THREE.SubtractEquation,32779:THREE.ReverseSubtractEquation};var w={0:THREE.ZeroFactor,1:THREE.OneFactor,768:THREE.SrcColorFactor,769:THREE.OneMinusSrcColorFactor,770:THREE.SrcAlphaFactor,771:THREE.OneMinusSrcAlphaFactor,772:THREE.DstAlphaFactor,773:THREE.OneMinusDstAlphaFactor,774:THREE.DstColorFactor,775:THREE.OneMinusDstColorFactor,776:THREE.SrcAlphaSaturateFactor};var E={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};var x={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"};var b={CUBICSPLINE:THREE.InterpolateSmooth,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete};var T={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"};var L={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function N(e,t){if("string"!==typeof e||""===e)return"";if(/^(https?:)?\/\//i.test(e))return e;if(/^data:.*,.*$/i.test(e))return e;if(/^blob:.*$/i.test(e))return e;return t+e}function D(){return new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:false,depthTest:true,side:THREE.FrontSide})}function C(e,t,r,i){var n=e.geometry;var a=e.material;var o=r.targets;var s=n.morphAttributes;s.position=[];s.normal=[];a.morphTargets=true;for(var u=0,c=o.length;u<c;u++){var l=o[u];var h="morphTarget"+u;var d,p;if(void 0!==l.POSITION){d=_(i[l.POSITION]);var f=n.attributes.position;for(var v=0,m=d.count;v<m;v++)d.setXYZ(v,d.getX(v)+f.getX(v),d.getY(v)+f.getY(v),d.getZ(v)+f.getZ(v))}else n.attributes.position&&(d=_(n.attributes.position));if(void 0!==d){d.name=h;s.position.push(d)}if(void 0!==l.NORMAL){a.morphNormals=true;p=_(i[l.NORMAL]);var g=n.attributes.normal;for(var v=0,m=p.count;v<m;v++)p.setXYZ(v,p.getX(v)+g.getX(v),p.getY(v)+g.getY(v),p.getZ(v)+g.getZ(v))}else void 0!==n.attributes.normal&&(p=_(n.attributes.normal));if(void 0!==p){p.name=h;s.normal.push(p)}}e.updateMorphTargets();if(void 0!==t.weights)for(var u=0,c=t.weights.length;u<c;u++)e.morphTargetInfluences[u]=t.weights[u]}function S(e,t){if(e.indices!==t.indices)return false;var r=e.attributes||{};var i=t.attributes||{};var n=Object.keys(r);var a=Object.keys(i);if(n.length!==a.length)return false;for(var o=0,s=n.length;o<s;o++){var u=n[o];if(r[u]!==i[u])return false}return true}function I(e,t){for(var r=0,i=e.length;r<i;r++){var n=e[r];if(S(n.primitive,t))return n.geometry}return null}function _(e){if(e.isInterleavedBufferAttribute){var t=e.count;var r=e.itemSize;var i=e.array.slice(0,t*r);for(var n=0;n<t;++n){i[n]=e.getX(n);r>=2&&(i[n+1]=e.getY(n));r>=3&&(i[n+2]=e.getZ(n));r>=4&&(i[n+3]=e.getW(n))}return new THREE.BufferAttribute(i,r,e.normalized)}return e.clone()}function O(e,r,i){this.json=e||{};this.extensions=r||{};this.options=i||{};this.cache=new t;this.primitiveCache=[];this.textureLoader=new THREE.TextureLoader(this.options.manager);this.textureLoader.setCrossOrigin(this.options.crossOrigin);this.fileLoader=new THREE.FileLoader(this.options.manager);this.fileLoader.setResponseType("arraybuffer")}O.prototype.parse=function(e,t){var r=this.json;this.cache.removeAll();this.markDefs();this.getMultiDependencies(["scene","animation","camera"]).then(function(t){var i=t.scenes||[];var n=i[r.scene||0];var a=t.animations||[];var o=r.asset;var s=t.cameras||[];e(n,i,s,a,o)}).catch(t)};O.prototype.markDefs=function(){var e=this.json.nodes||[];var t=this.json.skins||[];var r=this.json.meshes||[];var i={};var n={};for(var a=0,o=t.length;a<o;a++){var s=t[a].joints;for(var u=0,c=s.length;u<c;u++)e[s[u]].isBone=true}for(var l=0,h=e.length;l<h;l++){var d=e[l];if(void 0!==d.mesh){void 0===i[d.mesh]&&(i[d.mesh]=n[d.mesh]=0);i[d.mesh]++;void 0!==d.skin&&(r[d.mesh].isSkinnedMesh=true)}}this.json.meshReferences=i;this.json.meshUses=n};O.prototype.getDependency=function(e,t){var r=e+":"+t;var i=this.cache.get(r);if(!i){var n="load"+e.charAt(0).toUpperCase()+e.slice(1);i=this[n](t);this.cache.add(r,i)}return i};O.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this;var i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map(function(t,i){return r.getDependency(e,i)}));this.cache.add(e,t)}return t};O.prototype.getMultiDependencies=function(e){var t={};var r=[];for(var i=0,n=e.length;i<n;i++){var a=e[i];var o=this.getDependencies(a);o=o.then(function(e,r){t[e]=r}.bind(this,a+("mesh"===a?"es":"s")));r.push(o)}return Promise.all(r).then(function(){return t})};O.prototype.loadBuffer=function(e){var t=this.json.buffers[e];var i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var n=this.options;return new Promise(function(e,r){i.load(N(t.uri,n.path),e,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})};O.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0;var i=t.byteOffset||0;return e.slice(i,i+r)})};O.prototype.loadAccessor=function(e){var t=this;var r=this.json;var i=this.json.accessors[e];var n=[];void 0!==i.bufferView?n.push(this.getDependency("bufferView",i.bufferView)):n.push(null);if(void 0!==i.sparse){n.push(this.getDependency("bufferView",i.sparse.indices.bufferView));n.push(this.getDependency("bufferView",i.sparse.values.bufferView))}return Promise.all(n).then(function(e){var n=e[0];var a=E[i.type];var o=p[i.componentType];var s=o.BYTES_PER_ELEMENT;var u=s*a;var c=i.byteOffset||0;var l=r.bufferViews[i.bufferView].byteStride;var h=true===i.normalized;var d,f;if(l&&l!==u){var v="InterleavedBuffer:"+i.bufferView+":"+i.componentType;var m=t.cache.get(v);if(!m){d=new o(n);m=new THREE.InterleavedBuffer(d,l/s);t.cache.add(v,m)}f=new THREE.InterleavedBufferAttribute(m,a,c/s,h)}else{d=null===n?new o(i.count*a):new o(n,c,i.count*a);f=new THREE.BufferAttribute(d,a,h)}if(void 0!==i.sparse){var g=E.SCALAR;var y=p[i.sparse.indices.componentType];var A=i.sparse.indices.byteOffset||0;var M=i.sparse.values.byteOffset||0;var w=new y(e[1],A,i.sparse.count*g);var x=new o(e[2],M,i.sparse.count*a);null!==n&&f.setArray(f.array.slice());for(var b=0,T=w.length;b<T;b++){var L=w[b];f.setX(L,x[b*a]);a>=2&&f.setY(L,x[b*a+1]);a>=3&&f.setZ(L,x[b*a+2]);a>=4&&f.setW(L,x[b*a+3]);if(a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return f})};O.prototype.loadTexture=function(e){var t=this;var r=this.json;var i=this.options;var n=this.textureLoader;var a=window.URL||window.webkitURL;var o=r.textures[e];var s=r.images[o.source];var u=s.uri;var c=false;void 0!==s.bufferView&&(u=t.getDependency("bufferView",s.bufferView).then(function(e){c=true;var t=new Blob([e],{type:s.mimeType});u=a.createObjectURL(t);return u}));return Promise.resolve(u).then(function(e){var t=THREE.Loader.Handlers.get(e)||n;return new Promise(function(r,n){t.load(N(e,i.path),r,void 0,n)})}).then(function(e){true===c&&a.revokeObjectURL(u);e.flipY=false;void 0!==o.name&&(e.name=o.name);e.format=void 0!==o.format?m[o.format]:THREE.RGBAFormat;void 0!==o.internalFormat&&e.format!==m[o.internalFormat]&&console.warn("THREE.GLTFLoader: Three.js does not support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format.");e.type=void 0!==o.type?g[o.type]:THREE.UnsignedByteType;var t=r.samplers||{};var i=t[o.sampler]||{};e.magFilter=f[i.magFilter]||THREE.LinearFilter;e.minFilter=f[i.minFilter]||THREE.LinearMipMapLinearFilter;e.wrapS=v[i.wrapS]||THREE.RepeatWrapping;e.wrapT=v[i.wrapT]||THREE.RepeatWrapping;return e})};O.prototype.assignTexture=function(e,t,r){return this.getDependency("texture",r).then(function(r){e[t]=r})};O.prototype.loadMaterial=function(e){var t=this;var i=this.json;var n=this.extensions;var a=this.json.materials[e];var o;var s={};var u=a.extensions||{};var c=[];if(u[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=n[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=l.getMaterialType(a);c.push(l.extendParams(s,a,t))}else if(void 0!==a.pbrMetallicRoughness){o=THREE.MeshStandardMaterial;var h=a.pbrMetallicRoughness;s.color=new THREE.Color(1,1,1);s.opacity=1;if(Array.isArray(h.baseColorFactor)){var d=h.baseColorFactor;s.color.fromArray(d);s.opacity=d[3]}void 0!==h.baseColorTexture&&c.push(t.assignTexture(s,"map",h.baseColorTexture.index));s.metalness=void 0!==h.metallicFactor?h.metallicFactor:1;s.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1;if(void 0!==h.metallicRoughnessTexture){var p=h.metallicRoughnessTexture.index;c.push(t.assignTexture(s,"metalnessMap",p));c.push(t.assignTexture(s,"roughnessMap",p))}}else o=THREE.MeshPhongMaterial;true===a.doubleSided&&(s.side=THREE.DoubleSide);var f=a.alphaMode||L.OPAQUE;if(f===L.BLEND)s.transparent=true;else{s.transparent=false;f===L.MASK&&(s.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)}if(void 0!==a.normalTexture){c.push(t.assignTexture(s,"normalMap",a.normalTexture.index));s.normalScale=new THREE.Vector2(1,1);void 0!==a.normalTexture.scale&&s.normalScale.set(a.normalTexture.scale,a.normalTexture.scale)}if(void 0!==a.occlusionTexture){c.push(t.assignTexture(s,"aoMap",a.occlusionTexture.index));void 0!==a.occlusionTexture.strength&&(s.aoMapIntensity=a.occlusionTexture.strength)}void 0!==a.emissiveFactor&&(o===THREE.MeshBasicMaterial?s.color=(new THREE.Color).fromArray(a.emissiveFactor):s.emissive=(new THREE.Color).fromArray(a.emissiveFactor));void 0!==a.emissiveTexture&&(o===THREE.MeshBasicMaterial?c.push(t.assignTexture(s,"map",a.emissiveTexture.index)):c.push(t.assignTexture(s,"emissiveMap",a.emissiveTexture.index)));return Promise.all(c).then(function(){var e;e=o===THREE.ShaderMaterial?n[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new o(s);void 0!==a.name&&(e.name=a.name);e.normalScale&&(e.normalScale.x=-e.normalScale.x);e.map&&(e.map.encoding=THREE.sRGBEncoding);e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding);a.extras&&(e.userData=a.extras);return e})};O.prototype.loadGeometries=function(e){var t=this.primitiveCache;return this.getDependencies("accessor").then(function(r){var i=[];for(var n=0,a=e.length;n<a;n++){var o=e[n];var s=I(t,o);if(s)i.push(s);else{var u=new THREE.BufferGeometry;var c=o.attributes;for(var l in c){var h=c[l];var d=r[h];switch(l){case"POSITION":u.addAttribute("position",d);break;case"NORMAL":u.addAttribute("normal",d);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":u.addAttribute("uv",d);break;case"TEXCOORD_1":u.addAttribute("uv2",d);break;case"COLOR_0":case"COLOR0":case"COLOR":u.addAttribute("color",d);break;case"WEIGHTS_0":case"WEIGHT":u.addAttribute("skinWeight",d);break;case"JOINTS_0":case"JOINT":u.addAttribute("skinIndex",d);break}}void 0!==o.indices&&u.setIndex(r[o.indices]);t.push({primitive:o,geometry:u});i.push(u)}}return i})};O.prototype.loadMesh=function(e){var t=this;var i=this.json;var n=this.extensions;var a=this.json.meshes[e];return this.getMultiDependencies(["accessor","material"]).then(function(i){var o=new THREE.Group;var s=a.primitives;return t.loadGeometries(s).then(function(u){for(var c=0,l=s.length;c<l;c++){var d=s[c];var p=u[c];var f=void 0===d.material?D():i.materials[d.material];if(f.aoMap&&void 0===p.attributes.uv2&&void 0!==p.attributes.uv){console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap.");p.addAttribute("uv2",new THREE.BufferAttribute(p.attributes.uv.array,2))}var v=void 0!==p.attributes.color;var m=void 0===p.attributes.normal;var g=true===a.isSkinnedMesh;var y=void 0!==d.targets;if(v||m||g||y)if(f.isGLTFSpecularGlossinessMaterial){var A=n[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];f=A.cloneMaterial(f)}else f=f.clone();if(v){f.vertexColors=THREE.VertexColors;f.needsUpdate=true}m&&(f.flatShading=true);var M;if(d.mode===h.TRIANGLES||d.mode===h.TRIANGLE_STRIP||d.mode===h.TRIANGLE_FAN||void 0===d.mode){if(g){M=new THREE.SkinnedMesh(p,f);f.skinning=true}else M=new THREE.Mesh(p,f);d.mode===h.TRIANGLE_STRIP?M.drawMode=THREE.TriangleStripDrawMode:d.mode===h.TRIANGLE_FAN&&(M.drawMode=THREE.TriangleFanDrawMode)}else if(d.mode===h.LINES||d.mode===h.LINE_STRIP||d.mode===h.LINE_LOOP){var w="LineBasicMaterial:"+f.uuid;var E=t.cache.get(w);if(!E){E=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(E,f);E.color.copy(f.color);E.lights=false;t.cache.add(w,E)}f=E;M=d.mode===h.LINES?new THREE.LineSegments(p,f):d.mode===h.LINE_STRIP?new THREE.Line(p,f):new THREE.LineLoop(p,f)}else{if(d.mode!==h.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);var w="PointsMaterial:"+f.uuid;var x=t.cache.get(w);if(!x){x=new THREE.PointsMaterial;THREE.Material.prototype.copy.call(x,f);x.color.copy(f.color);x.map=f.map;x.lights=false;t.cache.add(w,x)}f=x;M=new THREE.Points(p,f)}M.name=a.name||"mesh_"+e;y&&C(M,a,d,i.accessors);void 0!==a.extras&&(M.userData=a.extras);void 0!==d.extras&&(M.geometry.userData=d.extras);true===f.isGLTFSpecularGlossinessMaterial&&(M.onBeforeRender=n[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms);if(!(s.length>1))return M;M.name+="_"+c;o.add(M)}return o})})};O.prototype.loadCamera=function(e){var t;var r=this.json.cameras[e];var i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}if("perspective"===r.type){var n=i.aspectRatio||1;var a=i.yfov*n;t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(a),n,i.znear||1,i.zfar||2e6)}else"orthographic"===r.type&&(t=new THREE.OrthographicCamera(i.xmag/-2,i.xmag/2,i.ymag/2,i.ymag/-2,i.znear,i.zfar));void 0!==r.name&&(t.name=r.name);r.extras&&(t.userData=r.extras);return Promise.resolve(t)};O.prototype.loadSkin=function(e){var t=this.json.skins[e];var r={joints:t.joints};if(void 0===t.inverseBindMatrices)return Promise.resolve(r);return this.getDependency("accessor",t.inverseBindMatrices).then(function(e){r.inverseBindMatrices=e;return r})};O.prototype.loadAnimation=function(e){var t=this.json;var r=this.json.animations[e];return this.getMultiDependencies(["accessor","node"]).then(function(t){var i=[];for(var n=0,a=r.channels.length;n<a;n++){var o=r.channels[n];var s=r.samplers[o.sampler];if(s){var u=o.target;var c=void 0!==u.node?u.node:u.id;var h=void 0!==r.parameters?r.parameters[s.input]:s.input;var d=void 0!==r.parameters?r.parameters[s.output]:s.output;var p=t.accessors[h];var f=t.accessors[d];var v=t.nodes[c];if(v){v.updateMatrix();v.matrixAutoUpdate=true;var m;switch(x[u.path]){case x.weights:m=THREE.NumberKeyframeTrack;break;case x.rotation:m=THREE.QuaternionKeyframeTrack;break;case x.position:case x.scale:default:m=THREE.VectorKeyframeTrack;break}var g=v.name?v.name:v.uuid;var y=void 0!==s.interpolation?b[s.interpolation]:THREE.InterpolateLinear;var A=[];x[u.path]===x.weights?v.traverse(function(e){true===e.isMesh&&true===e.material.morphTargets&&A.push(e.name?e.name:e.uuid)}):A.push(g);for(var M=0,w=A.length;M<w;M++){var E=new m(A[M]+"."+x[u.path],THREE.AnimationUtils.arraySlice(p.array,0),THREE.AnimationUtils.arraySlice(f.array,0),y);"CUBICSPLINE"===s.interpolation&&(E.createInterpolant=function(e){return new l(this.times,this.values,this.getValueSize()/3,e)});i.push(E)}}}}var c=void 0!==r.name?r.name:"animation_"+e;return new THREE.AnimationClip(c,void 0,i)})};O.prototype.loadNode=function(e){var t=this.json;var i=this.extensions;var n=this.json.meshReferences;var a=this.json.meshUses;var o=this.json.nodes[e];return this.getMultiDependencies(["mesh","skin","camera"]).then(function(e){var t;if(true===o.isBone)t=new THREE.Bone;else if(void 0!==o.mesh){var s=e.meshes[o.mesh];t=s.clone();if(true===s.isGroup)for(var u=0,c=s.children.length;u<c;u++){var l=s.children[u];l.material&&true===l.material.isGLTFSpecularGlossinessMaterial&&(t.children[u].onBeforeRender=l.onBeforeRender)}else s.material&&true===s.material.isGLTFSpecularGlossinessMaterial&&(t.onBeforeRender=s.onBeforeRender);n[o.mesh]>1&&(t.name+="_instance_"+a[o.mesh]++)}else if(void 0!==o.camera)t=e.cameras[o.camera];else if(o.extensions&&o.extensions[r.KHR_LIGHTS]&&void 0!==o.extensions[r.KHR_LIGHTS].light){var h=i[r.KHR_LIGHTS].lights;t=h[o.extensions[r.KHR_LIGHTS].light]}else t=new THREE.Object3D;void 0!==o.name&&(t.name=THREE.PropertyBinding.sanitizeNodeName(o.name));o.extras&&(t.userData=o.extras);if(void 0!==o.matrix){var d=new THREE.Matrix4;d.fromArray(o.matrix);t.applyMatrix(d)}else{void 0!==o.translation&&t.position.fromArray(o.translation);void 0!==o.rotation&&t.quaternion.fromArray(o.rotation);void 0!==o.scale&&t.scale.fromArray(o.scale)}return t})};O.prototype.loadScene=function(){function e(t,r,i,n,a){var o=n[t];var s=i.nodes[t];if(void 0!==s.skin){var u=true===o.isGroup?o.children:[o];for(var c=0,l=u.length;c<l;c++){var h=u[c];var d=a[s.skin];var p=[];var f=[];for(var v=0,m=d.joints.length;v<m;v++){var g=d.joints[v];var y=n[g];if(y){p.push(y);var A=new THREE.Matrix4;void 0!==d.inverseBindMatrices&&A.fromArray(d.inverseBindMatrices.array,16*v);f.push(A)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',g)}h.bind(new THREE.Skeleton(p,f),h.matrixWorld)}}r.add(o);if(s.children){var M=s.children;for(var c=0,l=M.length;c<l;c++){var w=M[c];e(w,o,i,n,a)}}}return function t(i){var n=this.json;var a=this.extensions;var o=this.json.scenes[i];return this.getMultiDependencies(["node","skin"]).then(function(t){var i=new THREE.Scene;void 0!==o.name&&(i.name=o.name);o.extras&&(i.userData=o.extras);var s=o.nodes||[];for(var u=0,c=s.length;u<c;u++)e(s[u],i,n,t.nodes,t.skins);if(o.extensions&&o.extensions[r.KHR_LIGHTS]&&void 0!==o.extensions[r.KHR_LIGHTS].light){var l=a[r.KHR_LIGHTS].lights;i.add(l[o.extensions[r.KHR_LIGHTS].light])}return i})}}();return e}()},{}],43:[function(e,t,r){THREE.MTLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,r,i){var n=this;var a=new THREE.FileLoader(this.manager);a.setPath(this.path);a.load(e,function(e){t(n.parse(e))},r,i)},setPath:function(e){this.path=e},setTexturePath:function(e){this.texturePath=e},setBaseUrl:function(e){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead.");this.setTexturePath(e)},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){var t=e.split("\n");var r={};var i=/\s+/;var n={};for(var a=0;a<t.length;a++){var o=t[a];o=o.trim();if(0===o.length||"#"===o.charAt(0))continue;var s=o.indexOf(" ");var u=s>=0?o.substring(0,s):o;u=u.toLowerCase();var c=s>=0?o.substring(s+1):"";c=c.trim();if("newmtl"===u){r={name:c};n[c]=r}else if(r)if("ka"===u||"kd"===u||"ks"===u){var l=c.split(i,3);r[u]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]}else r[u]=c}var h=new THREE.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);h.setCrossOrigin(this.crossOrigin);h.setManager(this.manager);h.setMaterials(n);return h}};THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e||"";this.options=t;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping};THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"Anonymous",setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var i=e[r];var n={};t[r]=n;for(var a in i){var o=true;var s=i[a];var u=a.toLowerCase();switch(u){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]);this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=false);break;default:break}o&&(n[u]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo){this.materialsArray[e]=this.create(t);this.nameLookup[t]=e;e++}return this.materialsArray},create:function(e){void 0===this.materials[e]&&this.createMaterial_(e);return this.materials[e]},createMaterial_:function(e){var t=this;var r=this.materialsInfo[e];var i={name:e,side:this.side};function n(e,t){if("string"!==typeof t||""===t)return"";if(/^https?:\/\//i.test(t))return t;return e+t}function a(e,r){if(i[e])return;var a=t.getTextureParams(r,i);var o=t.loadTexture(n(t.baseUrl,a.url));o.repeat.copy(a.scale);o.offset.copy(a.offset);o.wrapS=t.wrap;o.wrapT=t.wrap;i[e]=o}for(var o in r){var s=r[o];var u;if(""===s)continue;switch(o.toLowerCase()){case"kd":i.color=(new THREE.Color).fromArray(s);break;case"ks":i.specular=(new THREE.Color).fromArray(s);break;case"map_kd":a("map",s);break;case"map_ks":a("specularMap",s);break;case"norm":a("normalMap",s);break;case"map_bump":case"bump":a("bumpMap",s);break;case"ns":i.shininess=parseFloat(s);break;case"d":u=parseFloat(s);if(u<1){i.opacity=u;i.transparent=true}break;case"tr":u=parseFloat(s);this.options&&this.options.invertTrProperty&&(u=1-u);if(u>0){i.opacity=1-u;i.transparent=true}break;default:break}}this.materials[e]=new THREE.MeshPhongMaterial(i);return this.materials[e]},getTextureParams:function(e,t){var r={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)};var i=e.split(/\s+/);var n;n=i.indexOf("-bm");if(n>=0){t.bumpScale=parseFloat(i[n+1]);i.splice(n,2)}n=i.indexOf("-s");if(n>=0){r.scale.set(parseFloat(i[n+1]),parseFloat(i[n+2]));i.splice(n,4)}n=i.indexOf("-o");if(n>=0){r.offset.set(parseFloat(i[n+1]),parseFloat(i[n+2]));i.splice(n,4)}r.url=i.join(" ").trim();return r},loadTexture:function(e,t,r,i,n){var a;var o=THREE.Loader.Handlers.get(e);var s=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;null===o&&(o=new THREE.TextureLoader(s));o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin);a=o.load(e,r,i,n);void 0!==t&&(a.mapping=t);return a}}},{}],44:[function(e,t,r){THREE.OBJLoader=function(){var e=/^[og]\s*(.+)?/;var t=/^mtllib /;var r=/^usemtl /;function i(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&false===this.object.fromDeclaration){this.object.name=e;this.object.fromDeclaration=false!==t;return}var r=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;this.object&&"function"===typeof this.object._finalize&&this.object._finalize(true);this.object={name:e||"",fromDeclaration:false!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:true,startMaterial:function(e,t){var r=this._finalize(false);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var i={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:false,clone:function(e){var t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:false};t.clone=this.clone.bind(t);return t}};this.materials.push(i);return i},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1];return},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd){t.groupEnd=this.geometry.vertices.length/3;t.groupCount=t.groupEnd-t.groupStart;t.inherited=false}if(e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth});return t}};if(r&&r.name&&"function"===typeof r.clone){var i=r.clone(0);i.inherited=true;this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(true)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var i=this.vertices;var n=this.object.geometry.vertices;n.push(i[e+0],i[e+1],i[e+2]);n.push(i[t+0],i[t+1],i[t+2]);n.push(i[r+0],i[r+1],i[r+2])},addVertexPoint:function(e){var t=this.vertices;var r=this.object.geometry.vertices;r.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;var r=this.object.geometry.vertices;r.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var i=this.normals;var n=this.object.geometry.normals;n.push(i[e+0],i[e+1],i[e+2]);n.push(i[t+0],i[t+1],i[t+2]);n.push(i[r+0],i[r+1],i[r+2])},addColor:function(e,t,r){var i=this.colors;var n=this.object.geometry.colors;n.push(i[e+0],i[e+1],i[e+2]);n.push(i[t+0],i[t+1],i[t+2]);n.push(i[r+0],i[r+1],i[r+2])},addUV:function(e,t,r){var i=this.uvs;var n=this.object.geometry.uvs;n.push(i[e+0],i[e+1]);n.push(i[t+0],i[t+1]);n.push(i[r+0],i[r+1])},addUVLine:function(e){var t=this.uvs;var r=this.object.geometry.uvs;r.push(t[e+0],t[e+1])},addFace:function(e,t,r,i,n,a,o,s,u){var c=this.vertices.length;var l=this.parseVertexIndex(e,c);var h=this.parseVertexIndex(t,c);var d=this.parseVertexIndex(r,c);this.addVertex(l,h,d);if(void 0!==i){var p=this.uvs.length;l=this.parseUVIndex(i,p);h=this.parseUVIndex(n,p);d=this.parseUVIndex(a,p);this.addUV(l,h,d)}if(void 0!==o){var f=this.normals.length;l=this.parseNormalIndex(o,f);h=o===s?l:this.parseNormalIndex(s,f);d=o===u?l:this.parseNormalIndex(u,f);this.addNormal(l,h,d)}this.colors.length>0&&this.addColor(l,h,d)},addPointGeometry:function(e){this.object.geometry.type="Points";var t=this.vertices.length;for(var r=0,i=e.length;r<i;r++)this.addVertexPoint(this.parseVertexIndex(e[r],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";var r=this.vertices.length;var i=this.uvs.length;for(var n=0,a=e.length;n<a;n++)this.addVertexLine(this.parseVertexIndex(e[n],r));for(var o=0,a=t.length;o<a;o++)this.addUVLine(this.parseUVIndex(t[o],i))}};e.startObject("",false);return e}function n(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager;this.materials=null}n.prototype={constructor:n,load:function(e,t,r,i){var n=this;var a=new THREE.FileLoader(n.manager);a.setPath(this.path);a.load(e,function(e){t(n.parse(e))},r,i)},setPath:function(e){this.path=e},setMaterials:function(e){this.materials=e;return this},parse:function(n){console.time("OBJLoader");var a=new i;-1!==n.indexOf("\r\n")&&(n=n.replace(/\r\n/g,"\n"));-1!==n.indexOf("\\\n")&&(n=n.replace(/\\\n/g,""));var o=n.split("\n");var s="",u="";var c=0;var l=[];var h="function"===typeof"".trimLeft;for(var d=0,p=o.length;d<p;d++){s=o[d];s=h?s.trimLeft():s.trim();c=s.length;if(0===c)continue;u=s.charAt(0);if("#"===u)continue;if("v"===u){var f=s.split(/\s+/);switch(f[0]){case"v":a.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));8===f.length&&a.colors.push(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6]));break;case"vn":a.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":a.uvs.push(parseFloat(f[1]),parseFloat(f[2]));break}}else if("f"===u){var v=s.substr(1).trim();var m=v.split(/\s+/);var g=[];for(var y=0,A=m.length;y<A;y++){var M=m[y];if(M.length>0){var w=M.split("/");g.push(w)}}var E=g[0];for(var y=1,A=g.length-1;y<A;y++){var x=g[y];var b=g[y+1];a.addFace(E[0],x[0],b[0],E[1],x[1],b[1],E[2],x[2],b[2])}}else if("l"===u){var T=s.substring(1).trim().split(" ");var L=[],N=[];if(-1===s.indexOf("/"))L=T;else for(var D=0,C=T.length;D<C;D++){var S=T[D].split("/");""!==S[0]&&L.push(S[0]);""!==S[1]&&N.push(S[1])}a.addLineGeometry(L,N)}else if("p"===u){var v=s.substr(1).trim();var I=v.split(" ");a.addPointGeometry(I)}else if(null!==(l=e.exec(s))){var _=(" "+l[0].substr(1).trim()).substr(1);a.startObject(_)}else if(r.test(s))a.object.startMaterial(s.substring(7).trim(),a.materialLibraries);else if(t.test(s))a.materialLibraries.push(s.substring(7).trim());else{if("s"!==u){if("\0"===s)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+s+'"')}l=s.split(" ");if(l.length>1){var O=l[1].trim().toLowerCase();a.object.smooth="0"!==O&&"off"!==O}else a.object.smooth=true;var j=a.object.currentMaterial();j&&(j.smooth=a.object.smooth)}}a.finalize();var R=new THREE.Group;R.materialLibraries=[].concat(a.materialLibraries);for(var d=0,p=a.objects.length;d<p;d++){var z=a.objects[d];var k=z.geometry;var P=z.materials;var U="Line"===k.type;var B="Points"===k.type;var F=false;if(0===k.vertices.length)continue;var G=new THREE.BufferGeometry;G.addAttribute("position",new THREE.Float32BufferAttribute(k.vertices,3));k.normals.length>0?G.addAttribute("normal",new THREE.Float32BufferAttribute(k.normals,3)):G.computeVertexNormals();if(k.colors.length>0){F=true;G.addAttribute("color",new THREE.Float32BufferAttribute(k.colors,3))}k.uvs.length>0&&G.addAttribute("uv",new THREE.Float32BufferAttribute(k.uvs,2));var H=[];for(var V=0,Q=P.length;V<Q;V++){var Y=P[V];var j=void 0;if(null!==this.materials){j=this.materials.create(Y.name);if(!U||!j||j instanceof THREE.LineBasicMaterial){if(B&&j&&!(j instanceof THREE.PointsMaterial)){var W=new THREE.PointsMaterial({size:10,sizeAttenuation:false});X.copy(j);j=W}}else{var X=new THREE.LineBasicMaterial;X.copy(j);X.lights=false;j=X}}if(!j){j=U?new THREE.LineBasicMaterial:B?new THREE.PointsMaterial({size:1,sizeAttenuation:false}):new THREE.MeshPhongMaterial;j.name=Y.name}j.flatShading=!Y.smooth;j.vertexColors=F?THREE.VertexColors:THREE.NoColors;H.push(j)}var q;if(H.length>1){for(var V=0,Q=P.length;V<Q;V++){var Y=P[V];G.addGroup(Y.groupStart,Y.groupCount,V)}q=U?new THREE.LineSegments(G,H):B?new THREE.Points(G,H):new THREE.Mesh(G,H)}else q=U?new THREE.LineSegments(G,H[0]):B?new THREE.Points(G,H[0]):new THREE.Mesh(G,H[0]);q.name=z.name;R.add(q)}console.timeEnd("OBJLoader");return R}};return n}()},{}],45:[function(e,t,r){r=t.exports=i;function i(e){return e.replace(/^\s*|\s*$/g,"")}r.left=function(e){return e.replace(/^\s*/,"")};r.right=function(e){return e.replace(/\s*$/,"")}},{}],46:[function(e,i,n){(function(e){(function(e,r){"object"===typeof n&&"undefined"!==typeof i?i.exports=r():"function"===typeof t&&t.amd?t(r):e.WebVRPolyfill=r()})(this,function(){"use strict";var t="undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function i(e,t){return t={exports:{}},e(t,t.exports),t.exports}var n=function e(t){if(Promise.race)return Promise.race(t);return new Promise(function(e,r){for(var i=0;i<t.length;i++)t[i].then(e,r)})};var a=function e(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)};var o=function e(t,r){for(var i=0,n=t.length;i<n;i++)r[i]=t[i]};var s=function e(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t};var u=i(function(e,r){(function(t,r){e.exports=r()})(t,function(){var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(e,i.key,i)}}return function(t,r,i){r&&e(t.prototype,r);i&&e(t,i);return t}}();var i=function(){function e(e,t){var r=[];var i=true;var n=false;var a=void 0;try{for(var o=e[Symbol.iterator](),s;!(i=(s=o.next()).done);i=true){r.push(s.value);if(t&&r.length===t)break}}catch(e){n=true;a=e}finally{try{!i&&o["return"]&&o["return"]()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var n=.001;var a=1;var o=function e(t,r){return"data:"+t+";base64,"+r};var s=function e(t,r,i){return t+(r-t)*i};var u=function(){var e=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return e}}();var c=function(){var e=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return e}}();var l=function(){var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return e}}();var h=function(){var e=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return e}}();var d=function(){var e=navigator.userAgent.match(/.*Chrome\/([0-9]+)/);var t=e?parseInt(e[1],10):null;return function(){return t}}();var p=function(){var e=false;if(65===d()){var t=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(t){var r=t[1].split("."),n=i(r,4),a=n[0],o=n[1],s=n[2],u=n[3];e=3325===parseInt(s,10)&&parseInt(u,10)<148}}return function(){return e}}();var f=function(){var e=-1!==navigator.userAgent.indexOf("R7 Build");return function(){return e}}();var v=function e(){var t=90==window.orientation||-90==window.orientation;return f()?!t:t};var m=function e(t){if(isNaN(t))return false;if(t<=n)return false;if(t>a)return false;return true};var g=function e(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio};var y=function e(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio};var A=function e(t){if(c())return false;if(t.requestFullscreen)t.requestFullscreen();else if(t.webkitRequestFullscreen)t.webkitRequestFullscreen();else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else{if(!t.msRequestFullscreen)return false;t.msRequestFullscreen()}return true};var M=function e(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return false;document.msExitFullscreen()}return true};var w=function e(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement};var E=function e(t,r,i,n){var a=t.createShader(t.VERTEX_SHADER);t.shaderSource(a,r);t.compileShader(a);var o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(o,i);t.compileShader(o);var s=t.createProgram();t.attachShader(s,a);t.attachShader(s,o);for(var u in n)t.bindAttribLocation(s,n[u],u);t.linkProgram(s);t.deleteShader(a);t.deleteShader(o);return s};var x=function e(t,r){var i={};var n=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);var a="";for(var o=0;o<n;o++){var s=t.getActiveUniform(r,o);a=s.name.replace("[0]","");i[a]=t.getUniformLocation(r,a)}return i};var b=function e(t,r,i,n,a,o,s){var u=1/(r-i),c=1/(n-a),l=1/(o-s);t[0]=-2*u;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=-2*c;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=2*l;t[11]=0;t[12]=(r+i)*u;t[13]=(a+n)*c;t[14]=(s+o)*l;t[15]=1;return t};var T=function e(){var t=false;(function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=true)})(navigator.userAgent||navigator.vendor||window.opera);return t};var L=function e(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t};var N=function e(t){if(u()){var r=t.style.width;var i=t.style.height;t.style.width=parseInt(r)+1+"px";t.style.height=parseInt(i)+"px";setTimeout(function(){t.style.width=r;t.style.height=i},100)}window.canvas=t};var D=function(){var e=Math.PI/180;var t=.25*Math.PI;function r(r,i,n,a){var o=Math.tan(i?i.upDegrees*e:t),s=Math.tan(i?i.downDegrees*e:t),u=Math.tan(i?i.leftDegrees*e:t),c=Math.tan(i?i.rightDegrees*e:t),l=2/(u+c),h=2/(o+s);r[0]=l;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=h;r[6]=0;r[7]=0;r[8]=-(u-c)*l*.5;r[9]=(o-s)*h*.5;r[10]=a/(n-a);r[11]=-1;r[12]=0;r[13]=0;r[14]=a*n/(n-a);r[15]=0;return r}function i(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=i+i,u=n+n,c=a+a,l=i*s,h=i*u,d=i*c,p=n*u,f=n*c,v=a*c,m=o*s,g=o*u,y=o*c;e[0]=1-(p+v);e[1]=h+y;e[2]=d-g;e[3]=0;e[4]=h-y;e[5]=1-(l+v);e[6]=f+m;e[7]=0;e[8]=d+g;e[9]=f-m;e[10]=1-(l+p);e[11]=0;e[12]=r[0];e[13]=r[1];e[14]=r[2];e[15]=1;return e}function n(e,t,r){var i=r[0],n=r[1],a=r[2],o,s,u,c,l,h,d,p,f,v,m,g;if(t===e){e[12]=t[0]*i+t[4]*n+t[8]*a+t[12];e[13]=t[1]*i+t[5]*n+t[9]*a+t[13];e[14]=t[2]*i+t[6]*n+t[10]*a+t[14];e[15]=t[3]*i+t[7]*n+t[11]*a+t[15]}else{o=t[0];s=t[1];u=t[2];c=t[3];l=t[4];h=t[5];d=t[6];p=t[7];f=t[8];v=t[9];m=t[10];g=t[11];e[0]=o;e[1]=s;e[2]=u;e[3]=c;e[4]=l;e[5]=h;e[6]=d;e[7]=p;e[8]=f;e[9]=v;e[10]=m;e[11]=g;e[12]=o*i+l*n+f*a+t[12];e[13]=s*i+h*n+v*a+t[13];e[14]=u*i+d*n+m*a+t[14];e[15]=c*i+p*n+g*a+t[15]}return e}function a(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],d=t[10],p=t[11],f=t[12],v=t[13],m=t[14],g=t[15],y=r*s-i*o,A=r*u-n*o,M=r*c-a*o,w=i*u-n*s,E=i*c-a*s,x=n*c-a*u,b=l*v-h*f,T=l*m-d*f,L=l*g-p*f,N=h*m-d*v,D=h*g-p*v,C=d*g-p*m,S=y*C-A*D+M*N+w*L-E*T+x*b;if(!S)return null;S=1/S;e[0]=(s*C-u*D+c*N)*S;e[1]=(n*D-i*C-a*N)*S;e[2]=(v*x-m*E+g*w)*S;e[3]=(d*E-h*x-p*w)*S;e[4]=(u*L-o*C-c*T)*S;e[5]=(r*C-n*L+a*T)*S;e[6]=(m*M-f*x-g*A)*S;e[7]=(l*x-d*M+p*A)*S;e[8]=(o*D-s*L+c*b)*S;e[9]=(i*L-r*D-a*b)*S;e[10]=(f*E-v*M+g*y)*S;e[11]=(h*M-l*E-p*y)*S;e[12]=(s*T-o*N-u*b)*S;e[13]=(r*N-i*T+n*b)*S;e[14]=(v*A-f*w-m*y)*S;e[15]=(l*w-h*A+d*y)*S;return e}var o=new Float32Array([0,0,0,1]);var s=new Float32Array([0,0,0]);function u(e,t,u,c,l,h){r(e,c||null,h.depthNear,h.depthFar);var d=u.orientation||o;var p=u.position||s;i(t,d,p);l&&n(t,t,l);a(t,t)}return function(e,t,r){if(!e||!t)return false;e.pose=t;e.timestamp=t.timestamp;u(e.leftProjectionMatrix,e.leftViewMatrix,t,r._getFieldOfView("left"),r._getEyeOffset("left"),r);u(e.rightProjectionMatrix,e.rightViewMatrix,t,r._getFieldOfView("right"),r._getEyeOffset("right"),r);return true}}();var C=function e(){var t=window.self!==window.top;var r=S(document.referrer);var i=S(window.location.href);return t&&r!==i};var S=function e(t){var r;var i=t.indexOf("://");r=-1!==i?i+3:0;var n=t.indexOf("/",r);-1===n&&(n=t.length);return t.substring(0,n)};var I=function e(t){if(t.w>1){console.warn("getQuaternionAngle: w > 1");return 0}var r=2*Math.acos(t.w);return r};var _=function(){var e={};return function(t,r){if(void 0===e[t]){console.warn("webvr-polyfill: "+r);e[t]=true}}}();var O=function e(t,r){var i=r?"Please use "+r+" instead.":"";_(t,t+" has been deprecated. This may not work on native WebVR displays. "+i)};function j(e,t,r){if(!t){r(e);return}var i=[];var n=null;for(var a=0;a<t.length;++a){var o=t[a];switch(o){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:var s=t[++a];if(s<e.TEXTURE0||s>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit");i.push(null,null);break}n||(n=e.getParameter(e.ACTIVE_TEXTURE));e.activeTexture(s);i.push(e.getParameter(o),null);break;case e.ACTIVE_TEXTURE:n=e.getParameter(e.ACTIVE_TEXTURE);i.push(null);break;default:i.push(e.getParameter(o));break}}r(e);for(var a=0;a<t.length;++a){var o=t[a];var u=i[a];switch(o){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,u);break;case e.COLOR_CLEAR_VALUE:e.clearColor(u[0],u[1],u[2],u[3]);break;case e.COLOR_WRITEMASK:e.colorMask(u[0],u[1],u[2],u[3]);break;case e.CURRENT_PROGRAM:e.useProgram(u);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,u);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,u);break;case e.TEXTURE_BINDING_2D:var s=t[++a];if(s<e.TEXTURE0||s>e.TEXTURE31)break;e.activeTexture(s);e.bindTexture(e.TEXTURE_2D,u);break;case e.TEXTURE_BINDING_CUBE_MAP:var s=t[++a];if(s<e.TEXTURE0||s>e.TEXTURE31)break;e.activeTexture(s);e.bindTexture(e.TEXTURE_CUBE_MAP,u);break;case e.VIEWPORT:e.viewport(u[0],u[1],u[2],u[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:u?e.enable(o):e.disable(o);break;default:console.log("No GL restore behavior for 0x"+o.toString(16));break}n&&e.activeTexture(n)}}var R=j;var z=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n");var k=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");function P(e,t,r,i){this.gl=e;this.cardboardUI=t;this.bufferScale=r;this.dirtySubmitFrameBindings=i;this.ctxAttribs=e.getContextAttributes();this.meshWidth=20;this.meshHeight=20;this.bufferWidth=e.drawingBufferWidth;this.bufferHeight=e.drawingBufferHeight;this.realBindFramebuffer=e.bindFramebuffer;this.realEnable=e.enable;this.realDisable=e.disable;this.realColorMask=e.colorMask;this.realClearColor=e.clearColor;this.realViewport=e.viewport;if(!u()){this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width");this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")}this.isPatched=false;this.lastBoundFramebuffer=null;this.cullFace=false;this.depthTest=false;this.blend=false;this.scissorTest=false;this.stencilTest=false;this.viewport=[0,0,0,0];this.colorMask=[true,true,true,true];this.clearColor=[0,0,0,0];this.attribs={position:0,texCoord:1};this.program=E(e,z,k,this.attribs);this.uniforms=x(e,this.program);this.viewportOffsetScale=new Float32Array(8);this.setTextureBounds();this.vertexBuffer=e.createBuffer();this.indexBuffer=e.createBuffer();this.indexCount=0;this.renderTarget=e.createTexture();this.framebuffer=e.createFramebuffer();this.depthStencilBuffer=null;this.depthBuffer=null;this.stencilBuffer=null;this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=e.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=e.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=e.createRenderbuffer());this.patch();this.onResize()}P.prototype.destroy=function(){var e=this.gl;this.unpatch();e.deleteProgram(this.program);e.deleteBuffer(this.vertexBuffer);e.deleteBuffer(this.indexBuffer);e.deleteTexture(this.renderTarget);e.deleteFramebuffer(this.framebuffer);this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer);this.depthBuffer&&e.deleteRenderbuffer(this.depthBuffer);this.stencilBuffer&&e.deleteRenderbuffer(this.stencilBuffer);this.cardboardUI&&this.cardboardUI.destroy()};P.prototype.onResize=function(){var e=this.gl;var t=this;var r=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];R(e,r,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null);t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST);t.realColorMask.call(e,true,true,true,true);t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight);t.realClearColor.call(e,0,0,0,1);e.clear(e.COLOR_BUFFER_BIT);t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.framebuffer);e.bindTexture(e.TEXTURE_2D,t.renderTarget);e.texImage2D(e.TEXTURE_2D,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,t.bufferWidth,t.bufferHeight,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.renderTarget,0);if(t.ctxAttribs.depth&&t.ctxAttribs.stencil){e.bindRenderbuffer(e.RENDERBUFFER,t.depthStencilBuffer);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.bufferWidth,t.bufferHeight);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t.depthStencilBuffer)}else if(t.ctxAttribs.depth){e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.bufferWidth,t.bufferHeight);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer)}else if(t.ctxAttribs.stencil){e.bindRenderbuffer(e.RENDERBUFFER,t.stencilBuffer);e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,t.bufferWidth,t.bufferHeight);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,t.stencilBuffer)}!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!");t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer);t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST);t.realColorMask.apply(e,t.colorMask);t.realViewport.apply(e,t.viewport);t.realClearColor.apply(e,t.clearColor)});this.cardboardUI&&this.cardboardUI.onResize()};P.prototype.patch=function(){if(this.isPatched)return;var e=this;var t=this.gl.canvas;var r=this.gl;if(!u()){t.width=g()*this.bufferScale;t.height=y()*this.bufferScale;Object.defineProperty(t,"width",{configurable:true,enumerable:true,get:function t(){return e.bufferWidth},set:function r(i){e.bufferWidth=i;e.realCanvasWidth.set.call(t,i);e.onResize()}});Object.defineProperty(t,"height",{configurable:true,enumerable:true,get:function t(){return e.bufferHeight},set:function r(i){e.bufferHeight=i;e.realCanvasHeight.set.call(t,i);e.onResize()}})}this.lastBoundFramebuffer=r.getParameter(r.FRAMEBUFFER_BINDING);if(null==this.lastBoundFramebuffer){this.lastBoundFramebuffer=this.framebuffer;this.gl.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer)}this.gl.bindFramebuffer=function(t,i){e.lastBoundFramebuffer=i||e.framebuffer;e.realBindFramebuffer.call(r,t,e.lastBoundFramebuffer)};this.cullFace=r.getParameter(r.CULL_FACE);this.depthTest=r.getParameter(r.DEPTH_TEST);this.blend=r.getParameter(r.BLEND);this.scissorTest=r.getParameter(r.SCISSOR_TEST);this.stencilTest=r.getParameter(r.STENCIL_TEST);r.enable=function(t){switch(t){case r.CULL_FACE:e.cullFace=true;break;case r.DEPTH_TEST:e.depthTest=true;break;case r.BLEND:e.blend=true;break;case r.SCISSOR_TEST:e.scissorTest=true;break;case r.STENCIL_TEST:e.stencilTest=true;break}e.realEnable.call(r,t)};r.disable=function(t){switch(t){case r.CULL_FACE:e.cullFace=false;break;case r.DEPTH_TEST:e.depthTest=false;break;case r.BLEND:e.blend=false;break;case r.SCISSOR_TEST:e.scissorTest=false;break;case r.STENCIL_TEST:e.stencilTest=false;break}e.realDisable.call(r,t)};this.colorMask=r.getParameter(r.COLOR_WRITEMASK);r.colorMask=function(t,i,n,a){e.colorMask[0]=t;e.colorMask[1]=i;e.colorMask[2]=n;e.colorMask[3]=a;e.realColorMask.call(r,t,i,n,a)};this.clearColor=r.getParameter(r.COLOR_CLEAR_VALUE);r.clearColor=function(t,i,n,a){e.clearColor[0]=t;e.clearColor[1]=i;e.clearColor[2]=n;e.clearColor[3]=a;e.realClearColor.call(r,t,i,n,a)};this.viewport=r.getParameter(r.VIEWPORT);r.viewport=function(t,i,n,a){e.viewport[0]=t;e.viewport[1]=i;e.viewport[2]=n;e.viewport[3]=a;e.realViewport.call(r,t,i,n,a)};this.isPatched=true;N(t)};P.prototype.unpatch=function(){if(!this.isPatched)return;var e=this.gl;var t=this.gl.canvas;if(!u()){Object.defineProperty(t,"width",this.realCanvasWidth);Object.defineProperty(t,"height",this.realCanvasHeight)}t.width=this.bufferWidth;t.height=this.bufferHeight;e.bindFramebuffer=this.realBindFramebuffer;e.enable=this.realEnable;e.disable=this.realDisable;e.colorMask=this.realColorMask;e.clearColor=this.realClearColor;e.viewport=this.realViewport;this.lastBoundFramebuffer==this.framebuffer&&e.bindFramebuffer(e.FRAMEBUFFER,null);this.isPatched=false;setTimeout(function(){N(t)},1)};P.prototype.setTextureBounds=function(e,t){e||(e=[0,0,.5,1]);t||(t=[.5,0,.5,1]);this.viewportOffsetScale[0]=e[0];this.viewportOffsetScale[1]=e[1];this.viewportOffsetScale[2]=e[2];this.viewportOffsetScale[3]=e[3];this.viewportOffsetScale[4]=t[0];this.viewportOffsetScale[5]=t[1];this.viewportOffsetScale[6]=t[2];this.viewportOffsetScale[7]=t[3]};P.prototype.submitFrame=function(){var e=this.gl;var t=this;var r=[];this.dirtySubmitFrameBindings||r.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0);R(e,r,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null);t.cullFace&&t.realDisable.call(e,e.CULL_FACE);t.depthTest&&t.realDisable.call(e,e.DEPTH_TEST);t.blend&&t.realDisable.call(e,e.BLEND);t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST);t.stencilTest&&t.realDisable.call(e,e.STENCIL_TEST);t.realColorMask.call(e,true,true,true,true);t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight);if(t.ctxAttribs.alpha||u()){t.realClearColor.call(e,0,0,0,1);e.clear(e.COLOR_BUFFER_BIT)}e.useProgram(t.program);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer);e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer);e.enableVertexAttribArray(t.attribs.position);e.enableVertexAttribArray(t.attribs.texCoord);e.vertexAttribPointer(t.attribs.position,2,e.FLOAT,false,20,0);e.vertexAttribPointer(t.attribs.texCoord,3,e.FLOAT,false,20,8);e.activeTexture(e.TEXTURE0);e.uniform1i(t.uniforms.diffuse,0);e.bindTexture(e.TEXTURE_2D,t.renderTarget);e.uniform4fv(t.uniforms.viewportOffsetScale,t.viewportOffsetScale);e.drawElements(e.TRIANGLES,t.indexCount,e.UNSIGNED_SHORT,0);t.cardboardUI&&t.cardboardUI.renderNoState();t.realBindFramebuffer.call(t.gl,e.FRAMEBUFFER,t.framebuffer);if(!t.ctxAttribs.preserveDrawingBuffer){t.realClearColor.call(e,0,0,0,0);e.clear(e.COLOR_BUFFER_BIT)}t.dirtySubmitFrameBindings||t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer);t.cullFace&&t.realEnable.call(e,e.CULL_FACE);t.depthTest&&t.realEnable.call(e,e.DEPTH_TEST);t.blend&&t.realEnable.call(e,e.BLEND);t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST);t.stencilTest&&t.realEnable.call(e,e.STENCIL_TEST);t.realColorMask.apply(e,t.colorMask);t.realViewport.apply(e,t.viewport);!t.ctxAttribs.alpha&&t.ctxAttribs.preserveDrawingBuffer||t.realClearColor.apply(e,t.clearColor)});if(u()){var i=e.canvas;if(i.width!=t.bufferWidth||i.height!=t.bufferHeight){t.bufferWidth=i.width;t.bufferHeight=i.height;t.onResize()}}};P.prototype.updateDeviceInfo=function(e){var t=this.gl;var r=this;var i=[t.ARRAY_BUFFER_BINDING,t.ELEMENT_ARRAY_BUFFER_BINDING];R(t,i,function(t){var i=r.computeMeshVertices_(r.meshWidth,r.meshHeight,e);t.bindBuffer(t.ARRAY_BUFFER,r.vertexBuffer);t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW);if(!r.indexCount){var n=r.computeMeshIndices_(r.meshWidth,r.meshHeight);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW);r.indexCount=n.length}})};P.prototype.computeMeshVertices_=function(e,t,r){var i=new Float32Array(2*e*t*5);var n=r.getLeftEyeVisibleTanAngles();var a=r.getLeftEyeNoLensTanAngles();var o=r.getLeftEyeVisibleScreenRect(a);var u=0;for(var c=0;c<2;c++){for(var l=0;l<t;l++)for(var h=0;h<e;h++,u++){var d=h/(e-1);var p=l/(t-1);var f=d;var v=p;var m=s(n[0],n[2],d);var g=s(n[3],n[1],p);var y=Math.sqrt(m*m+g*g);var A=r.distortion.distortInverse(y);var M=m*A/y;var w=g*A/y;d=(M-a[0])/(a[2]-a[0]);p=(w-a[3])/(a[1]-a[3]);d=2*(o.x+d*o.width-.5);p=2*(o.y+p*o.height-.5);i[5*u+0]=d;i[5*u+1]=p;i[5*u+2]=f;i[5*u+3]=v;i[5*u+4]=c}var E=n[2]-n[0];n[0]=-(E+n[0]);n[2]=E-n[2];E=a[2]-a[0];a[0]=-(E+a[0]);a[2]=E-a[2];o.x=1-(o.x+o.width)}return i};P.prototype.computeMeshIndices_=function(e,t){var r=new Uint16Array(2*(e-1)*(t-1)*6);var i=e/2;var n=t/2;var a=0;var o=0;for(var s=0;s<2;s++)for(var u=0;u<t;u++)for(var c=0;c<e;c++,a++){if(0==c||0==u)continue;if(c<=i==u<=n){r[o++]=a;r[o++]=a-e-1;r[o++]=a-e;r[o++]=a-e-1;r[o++]=a;r[o++]=a-1}else{r[o++]=a-1;r[o++]=a-e;r[o++]=a;r[o++]=a-e;r[o++]=a-1;r[o++]=a-e-1}}return r};P.prototype.getOwnPropertyDescriptor_=function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r.get||void 0===r.set){r.configurable=true;r.enumerable=true;r.get=function(){return this.getAttribute(t)};r.set=function(e){this.setAttribute(t,e)}}return r};var U=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n");var B=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n");var F=Math.PI/180;var G=60;var H=12;var V=20;var Q=1;var Y=.75;var W=.3125;var X=4;var q=28;var Z=1.5;function J(e){this.gl=e;this.attribs={position:0};this.program=E(e,U,B,this.attribs);this.uniforms=x(e,this.program);this.vertexBuffer=e.createBuffer();this.gearOffset=0;this.gearVertexCount=0;this.arrowOffset=0;this.arrowVertexCount=0;this.projMat=new Float32Array(16);this.listener=null;this.onResize()}J.prototype.destroy=function(){var e=this.gl;this.listener&&e.canvas.removeEventListener("click",this.listener,false);e.deleteProgram(this.program);e.deleteBuffer(this.vertexBuffer)};J.prototype.listen=function(e,t){var r=this.gl.canvas;this.listener=function(i){var n=r.clientWidth/2;var a=q*Z;i.clientX>n-a&&i.clientX<n+a&&i.clientY>r.clientHeight-a?e(i):i.clientX<a&&i.clientY<a&&t(i)};r.addEventListener("click",this.listener,false)};J.prototype.onResize=function(){var e=this.gl;var t=this;var r=[e.ARRAY_BUFFER_BINDING];R(e,r,function(e){var r=[];var i=e.drawingBufferWidth/2;var n=Math.max(screen.width,screen.height)*window.devicePixelRatio;var a=e.drawingBufferWidth/n;var o=a*window.devicePixelRatio;var s=X*o/2;var u=q*Z*o;var c=q*o/2;var l=(q*Z-q)*o;r.push(i-s,u);r.push(i-s,e.drawingBufferHeight);r.push(i+s,u);r.push(i+s,e.drawingBufferHeight);t.gearOffset=r.length/2;function h(e,t){var n=(90-e)*F;var a=Math.cos(n);var o=Math.sin(n);r.push(W*a*c+i,W*o*c+c);r.push(t*a*c+i,t*o*c+c)}for(var d=0;d<=6;d++){var p=d*G;h(p,Q);h(p+H,Q);h(p+V,Y);h(p+(G-V),Y);h(p+(G-H),Q)}t.gearVertexCount=r.length/2-t.gearOffset;t.arrowOffset=r.length/2;function f(t,i){r.push(l+t,e.drawingBufferHeight-l-i)}var v=s/Math.sin(45*F);f(0,c);f(c,0);f(c+v,v);f(v,c+v);f(v,c-v);f(0,c);f(c,2*c);f(c+v,2*c-v);f(v,c-v);f(0,c);f(v,c-s);f(q*o,c-s);f(v,c+s);f(q*o,c+s);t.arrowVertexCount=r.length/2-t.arrowOffset;e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer);e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW)})};J.prototype.render=function(){var e=this.gl;var t=this;var r=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];R(e,r,function(e){e.disable(e.CULL_FACE);e.disable(e.DEPTH_TEST);e.disable(e.BLEND);e.disable(e.SCISSOR_TEST);e.disable(e.STENCIL_TEST);e.colorMask(true,true,true,true);e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight);t.renderNoState()})};J.prototype.renderNoState=function(){var e=this.gl;e.useProgram(this.program);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.enableVertexAttribArray(this.attribs.position);e.vertexAttribPointer(this.attribs.position,2,e.FLOAT,false,8,0);e.uniform4f(this.uniforms.color,1,1,1,1);b(this.projMat,0,e.drawingBufferWidth,0,e.drawingBufferHeight,.1,1024);e.uniformMatrix4fv(this.uniforms.projectionMat,false,this.projMat);e.drawArrays(e.TRIANGLE_STRIP,0,4);e.drawArrays(e.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount);e.drawArrays(e.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function K(e){this.coefficients=e}K.prototype.distortInverse=function(e){var t=0;var r=1;var i=e-this.distort(t);while(Math.abs(r-t)>1e-4){var n=e-this.distort(r);var a=r-n*((r-t)/(n-i));t=r;r=a;i=n}return r};K.prototype.distort=function(e){var t=e*e;var r=0;for(var i=0;i<this.coefficients.length;i++)r=t*(r+this.coefficients[i]);return(r+1)*e};var $=Math.PI/180;var ee=180/Math.PI;var te=function e(t,r,i){this.x=t||0;this.y=r||0;this.z=i||0};te.prototype={constructor:te,set:function e(t,r,i){this.x=t;this.y=r;this.z=i;return this},copy:function e(t){this.x=t.x;this.y=t.y;this.z=t.z;return this},length:function e(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function e(){var t=this.length();if(0!==t){var r=1/t;this.multiplyScalar(r)}else{this.x=0;this.y=0;this.z=0}return this},multiplyScalar:function e(t){this.x*=t;this.y*=t;this.z*=t},applyQuaternion:function e(t){var r=this.x;var i=this.y;var n=this.z;var a=t.x;var o=t.y;var s=t.z;var u=t.w;var c=u*r+o*n-s*i;var l=u*i+s*r-a*n;var h=u*n+a*i-o*r;var d=-a*r-o*i-s*n;this.x=c*u+d*-a+l*-s-h*-o;this.y=l*u+d*-o+h*-a-c*-s;this.z=h*u+d*-s+c*-o-l*-a;return this},dot:function e(t){return this.x*t.x+this.y*t.y+this.z*t.z},crossVectors:function e(t,r){var i=t.x,n=t.y,a=t.z;var o=r.x,s=r.y,u=r.z;this.x=n*u-a*s;this.y=a*o-i*u;this.z=i*s-n*o;return this}};var re=function e(t,r,i,n){this.x=t||0;this.y=r||0;this.z=i||0;this.w=void 0!==n?n:1};re.prototype={constructor:re,set:function e(t,r,i,n){this.x=t;this.y=r;this.z=i;this.w=n;return this},copy:function e(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w;return this},setFromEulerXYZ:function e(t,r,i){var n=Math.cos(t/2);var a=Math.cos(r/2);var o=Math.cos(i/2);var s=Math.sin(t/2);var u=Math.sin(r/2);var c=Math.sin(i/2);this.x=s*a*o+n*u*c;this.y=n*u*o-s*a*c;this.z=n*a*c+s*u*o;this.w=n*a*o-s*u*c;return this},setFromEulerYXZ:function e(t,r,i){var n=Math.cos(t/2);var a=Math.cos(r/2);var o=Math.cos(i/2);var s=Math.sin(t/2);var u=Math.sin(r/2);var c=Math.sin(i/2);this.x=s*a*o+n*u*c;this.y=n*u*o-s*a*c;this.z=n*a*c-s*u*o;this.w=n*a*o+s*u*c;return this},setFromAxisAngle:function e(t,r){var i=r/2,n=Math.sin(i);this.x=t.x*n;this.y=t.y*n;this.z=t.z*n;this.w=Math.cos(i);return this},multiply:function e(t){return this.multiplyQuaternions(this,t)},multiplyQuaternions:function e(t,r){var i=t.x,n=t.y,a=t.z,o=t.w;var s=r.x,u=r.y,c=r.z,l=r.w;this.x=i*l+o*s+n*c-a*u;this.y=n*l+o*u+a*s-i*c;this.z=a*l+o*c+i*u-n*s;this.w=o*l-i*s-n*u-a*c;return this},inverse:function e(){this.x*=-1;this.y*=-1;this.z*=-1;this.normalize();return this},normalize:function e(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0===t){this.x=0;this.y=0;this.z=0;this.w=1}else{t=1/t;this.x=this.x*t;this.y=this.y*t;this.z=this.z*t;this.w=this.w*t}return this},slerp:function e(t,r){if(0===r)return this;if(1===r)return this.copy(t);var i=this.x,n=this.y,a=this.z,o=this.w;var s=o*t.w+i*t.x+n*t.y+a*t.z;if(s<0){this.w=-t.w;this.x=-t.x;this.y=-t.y;this.z=-t.z;s=-s}else this.copy(t);if(s>=1){this.w=o;this.x=i;this.y=n;this.z=a;return this}var u=Math.acos(s);var c=Math.sqrt(1-s*s);if(Math.abs(c)<.001){this.w=.5*(o+this.w);this.x=.5*(i+this.x);this.y=.5*(n+this.y);this.z=.5*(a+this.z);return this}var l=Math.sin((1-r)*u)/c,h=Math.sin(r*u)/c;this.w=o*l+this.w*h;this.x=i*l+this.x*h;this.y=n*l+this.y*h;this.z=a*l+this.z*h;return this},setFromUnitVectors:function(){var e,t;var r=1e-6;return function(i,n){void 0===e&&(e=new te);t=i.dot(n)+1;if(t<r){t=0;Math.abs(i.x)>Math.abs(i.z)?e.set(-i.y,i.x,0):e.set(0,-i.z,i.y)}else e.crossVectors(i,n);this.x=e.x;this.y=e.y;this.z=e.z;this.w=t;this.normalize();return this}}()};function ie(e){this.width=e.width||g();this.height=e.height||y();this.widthMeters=e.widthMeters;this.heightMeters=e.heightMeters;this.bevelMeters=e.bevelMeters}var ne=new ie({widthMeters:.11,heightMeters:.062,bevelMeters:.004});var ae=new ie({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004});var oe={CardboardV1:new ue({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new ue({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function se(e){this.viewer=oe.CardboardV2;this.updateDeviceParams(e);this.distortion=new K(this.viewer.distortionCoefficients)}se.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device};se.prototype.getDevice=function(){return this.device};se.prototype.setViewer=function(e){this.viewer=e;this.distortion=new K(this.viewer.distortionCoefficients)};se.prototype.determineDevice_=function(e){if(!e){if(u()){console.warn("Using fallback iOS device measurements.");return ae}console.warn("Using fallback Android device measurements.");return ne}var t=.0254;var r=t/e.xdpi;var i=t/e.ydpi;var n=g();var a=y();return new ie({widthMeters:r*n,heightMeters:i*a,bevelMeters:.001*e.bevelMm})};se.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer;var t=this.device;var r=this.distortion;var i=e.screenLensDistance;var n=(t.widthMeters-e.interLensDistance)/2;var a=e.interLensDistance/2;var o=e.baselineLensDistance-t.bevelMeters;var s=t.heightMeters-o;var u=ee*Math.atan(r.distort(n/i));var c=ee*Math.atan(r.distort(a/i));var l=ee*Math.atan(r.distort(o/i));var h=ee*Math.atan(r.distort(s/i));return{leftDegrees:Math.min(u,e.fov),rightDegrees:Math.min(c,e.fov),downDegrees:Math.min(l,e.fov),upDegrees:Math.min(h,e.fov)}};se.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer;var t=this.device;var r=this.distortion;var i=Math.tan(-$*e.fov);var n=Math.tan($*e.fov);var a=Math.tan($*e.fov);var o=Math.tan(-$*e.fov);var s=t.widthMeters/4;var u=t.heightMeters/2;var c=e.baselineLensDistance-t.bevelMeters-u;var l=e.interLensDistance/2-s;var h=-c;var d=e.screenLensDistance;var p=r.distort((l-s)/d);var f=r.distort((h+u)/d);var v=r.distort((l+s)/d);var m=r.distort((h-u)/d);var g=new Float32Array(4);g[0]=Math.max(i,p);g[1]=Math.min(n,f);g[2]=Math.min(a,v);g[3]=Math.max(o,m);return g};se.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer;var t=this.device;var r=this.distortion;var i=new Float32Array(4);var n=r.distortInverse(Math.tan(-$*e.fov));var a=r.distortInverse(Math.tan($*e.fov));var o=r.distortInverse(Math.tan($*e.fov));var s=r.distortInverse(Math.tan(-$*e.fov));var u=t.widthMeters/4;var c=t.heightMeters/2;var l=e.baselineLensDistance-t.bevelMeters-c;var h=e.interLensDistance/2-u;var d=-l;var p=e.screenLensDistance;var f=(h-u)/p;var v=(d+c)/p;var m=(h+u)/p;var g=(d-c)/p;i[0]=Math.max(n,f);i[1]=Math.min(a,v);i[2]=Math.min(o,m);i[3]=Math.max(s,g);return i};se.prototype.getLeftEyeVisibleScreenRect=function(e){var t=this.viewer;var r=this.device;var i=t.screenLensDistance;var n=(r.widthMeters-t.interLensDistance)/2;var a=t.baselineLensDistance-r.bevelMeters;var o=(e[0]*i+n)/r.widthMeters;var s=(e[1]*i+a)/r.heightMeters;var u=(e[2]*i+n)/r.widthMeters;var c=(e[3]*i+a)/r.heightMeters;return{x:o,y:c,width:u-o,height:s-c}};se.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()};se.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}};se.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:ee*Math.atan(e.outerDist),rightDegrees:ee*Math.atan(e.innerDist),downDegrees:ee*Math.atan(e.bottomDist),upDegrees:ee*Math.atan(e.topDist)}};se.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_();var t=this.viewer;var r=this.device;var i=t.screenLensDistance;var n=r.widthMeters/i;var a=r.heightMeters/i;var o=r.width/n;var s=r.height/a;var u=Math.round((e.eyePosX-e.outerDist)*o);var c=Math.round((e.eyePosY-e.bottomDist)*s);return{x:u,y:c,width:Math.round((e.eyePosX+e.innerDist)*o)-u,height:Math.round((e.eyePosY+e.topDist)*s)-c}};se.prototype.getUndistortedParams_=function(){var e=this.viewer;var t=this.device;var r=this.distortion;var i=e.screenLensDistance;var n=e.interLensDistance/2/i;var a=t.widthMeters/i;var o=t.heightMeters/i;var s=a/2-n;var u=(e.baselineLensDistance-t.bevelMeters)/i;var c=e.fov;var l=r.distortInverse(Math.tan($*c));var h=Math.min(s,l);var d=Math.min(n,l);var p=Math.min(u,l);var f=Math.min(o-u,l);return{outerDist:h,innerDist:d,topDist:f,bottomDist:p,eyePosX:s,eyePosY:u}};function ue(e){this.id=e.id;this.label=e.label;this.fov=e.fov;this.interLensDistance=e.interLensDistance;this.baselineLensDistance=e.baselineLensDistance;this.screenLensDistance=e.screenLensDistance;this.distortionCoefficients=e.distortionCoefficients;this.inverseCoefficients=e.inverseCoefficients}se.Viewers=oe;var ce=1;var le="2018-02-20T22:55:10Z";var he=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3}];var de={format:ce,last_updated:le,devices:he};function pe(e,t){this.dpdb=de;this.recalculateDeviceParams_();if(e){this.onDeviceParamsUpdated=t;var r=new XMLHttpRequest;var i=this;r.open("GET",e,true);r.addEventListener("load",function(){i.loading=false;if(r.status>=200&&r.status<=299){i.dpdb=JSON.parse(r.response);i.recalculateDeviceParams_()}else console.error("Error loading online DPDB!")});r.send()}}pe.prototype.getDeviceParams=function(){return this.deviceParams};pe.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();if(e){this.deviceParams=e;this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)}else console.error("Failed to recalculate device parameters.")};pe.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e){console.error("DPDB not available.");return null}if(1!=e.format){console.error("DPDB has unexpected format version.");return null}if(!e.devices||!e.devices.length){console.error("DPDB does not have a devices section.");return null}var t=navigator.userAgent||navigator.vendor||window.opera;var r=g();var i=y();if(!e.devices){console.error("DPDB has no devices section.");return null}for(var n=0;n<e.devices.length;n++){var a=e.devices[n];if(!a.rules){console.warn("Device["+n+"] has no rules section.");continue}if("ios"!=a.type&&"android"!=a.type){console.warn("Device["+n+"] has invalid type.");continue}if(u()!=("ios"==a.type))continue;var o=false;for(var s=0;s<a.rules.length;s++){var c=a.rules[s];if(this.matchRule_(c,t,r,i)){o=true;break}}if(!o)continue;var l=a.dpi[0]||a.dpi;var h=a.dpi[1]||a.dpi;return new fe({xdpi:l,ydpi:h,bevelMm:a.bw})}console.warn("No DPDB device match.");return null};pe.prototype.matchRule_=function(e,t,r,i){if(!e.ua&&!e.res)return false;if(e.ua&&t.indexOf(e.ua)<0)return false;if(e.res){if(!e.res[0]||!e.res[1])return false;var n=e.res[0];var a=e.res[1];if(Math.min(r,i)!=Math.min(n,a)||Math.max(r,i)!=Math.max(n,a))return false}return true};function fe(e){this.xdpi=e.xdpi;this.ydpi=e.ydpi;this.bevelMm=e.bevelMm}function ve(e,t){this.set(e,t)}ve.prototype.set=function(e,t){this.sample=e;this.timestampS=t};ve.prototype.copy=function(e){this.set(e.sample,e.timestampS)};function me(e,t){this.kFilter=e;this.isDebug=t;this.currentAccelMeasurement=new ve;this.currentGyroMeasurement=new ve;this.previousGyroMeasurement=new ve;u()?this.filterQ=new re(-1,0,0,1):this.filterQ=new re(1,0,0,1);this.previousFilterQ=new re;this.previousFilterQ.copy(this.filterQ);this.accelQ=new re;this.isOrientationInitialized=false;this.estimatedGravity=new te;this.measuredGravity=new te;this.gyroIntegralQ=new re}me.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)};me.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var r=t-this.previousGyroMeasurement.timestampS;m(r)&&this.run_();this.previousGyroMeasurement.copy(this.currentGyroMeasurement)};me.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample);this.previousFilterQ.copy(this.accelQ);this.isOrientationInitialized=true;return}var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS;var t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t);this.filterQ.copy(this.previousFilterQ);this.filterQ.multiply(t);var r=new re;r.copy(this.filterQ);r.inverse();this.estimatedGravity.set(0,0,-1);this.estimatedGravity.applyQuaternion(r);this.estimatedGravity.normalize();this.measuredGravity.copy(this.currentAccelMeasurement.sample);this.measuredGravity.normalize();var i=new re;i.setFromUnitVectors(this.estimatedGravity,this.measuredGravity);i.inverse();this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",ee*I(i),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var n=new re;n.copy(this.filterQ);n.multiply(i);this.filterQ.slerp(n,1-this.kFilter);this.previousFilterQ.copy(this.filterQ)};me.prototype.getOrientation=function(){return this.filterQ};me.prototype.accelToQuaternion_=function(e){var t=new te;t.copy(e);t.normalize();var r=new re;r.setFromUnitVectors(new te(0,0,-1),t);r.inverse();return r};me.prototype.gyroToQuaternionDelta_=function(e,t){var r=new re;var i=new te;i.copy(e);i.normalize();r.setFromAxisAngle(i,e.length()*t);return r};function ge(e,t){this.predictionTimeS=e;this.isDebug=t;this.previousQ=new re;this.previousTimestampS=null;this.deltaQ=new re;this.outQ=new re}ge.prototype.getPrediction=function(e,t,r){if(!this.previousTimestampS){this.previousQ.copy(e);this.previousTimestampS=r;return e}var i=new te;i.copy(t);i.normalize();var n=t.length();if(n<20*$){this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(ee*n).toFixed(1));this.outQ.copy(e);this.previousQ.copy(e);return this.outQ}var a=n*this.predictionTimeS;this.deltaQ.setFromAxisAngle(i,a);this.outQ.copy(this.previousQ);this.outQ.multiply(this.deltaQ);this.previousQ.copy(e);this.previousTimestampS=r;return this.outQ};function ye(e,t,r,i){this.yawOnly=r;this.accelerometer=new te;this.gyroscope=new te;this.filter=new me(e,i);this.posePredictor=new ge(t,i);this.isFirefoxAndroid=h();this.isIOS=u();var n=d();this.isDeviceMotionInRadians=!this.isIOS&&n&&n<66;this.isWithoutDeviceMotion=p();this.filterToWorldQ=new re;u()?this.filterToWorldQ.setFromAxisAngle(new te(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new te(1,0,0),-Math.PI/2);this.inverseWorldToScreenQ=new re;this.worldToScreenQ=new re;this.originalPoseAdjustQ=new re;this.originalPoseAdjustQ.setFromAxisAngle(new te(0,0,1),-window.orientation*Math.PI/180);this.setScreenTransform_();v()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ);this.resetQ=new re;this.orientationOut_=new Float32Array(4);this.start()}ye.prototype.getPosition=function(){return null};ye.prototype.getOrientation=function(){var e=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var e=(new re).setFromAxisAngle(new te(0,0,-1),0);var t=new re;-90===window.orientation?t.setFromAxisAngle(new te(0,1,0),Math.PI/-2):t.setFromAxisAngle(new te(0,1,0),Math.PI/2);return e.multiply(t)}();this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var e=new re;e.setFromAxisAngle(new te(1,0,0),-Math.PI/2);return e}();e=this._deviceOrientationQ;var t=new re;t.copy(e);t.multiply(this.deviceOrientationFilterToWorldQ);t.multiply(this.resetQ);t.multiply(this.worldToScreenQ);t.multiplyQuaternions(this.deviceOrientationFixQ,t);if(this.yawOnly){t.x=0;t.z=0;t.normalize()}this.orientationOut_[0]=t.x;this.orientationOut_[1]=t.y;this.orientationOut_[2]=t.z;this.orientationOut_[3]=t.w;return this.orientationOut_}var r=this.filter.getOrientation();e=this.posePredictor.getPrediction(r,this.gyroscope,this.previousTimestampS);var t=new re;t.copy(this.filterToWorldQ);t.multiply(this.resetQ);t.multiply(e);t.multiply(this.worldToScreenQ);if(this.yawOnly){t.x=0;t.z=0;t.normalize()}this.orientationOut_[0]=t.x;this.orientationOut_[1]=t.y;this.orientationOut_[2]=t.z;this.orientationOut_[3]=t.w;return this.orientationOut_};ye.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation());this.resetQ.x=0;this.resetQ.y=0;this.resetQ.z*=-1;this.resetQ.normalize();v()&&this.resetQ.multiply(this.inverseWorldToScreenQ);this.resetQ.multiply(this.originalPoseAdjustQ)};ye.prototype.onDeviceOrientation_=function(e){this._deviceOrientationQ=this._deviceOrientationQ||new re;var t=e.alpha,r=e.beta,i=e.gamma;t=(t||0)*Math.PI/180;r=(r||0)*Math.PI/180;i=(i||0)*Math.PI/180;this._deviceOrientationQ.setFromEulerYXZ(r,t,-i)};ye.prototype.onDeviceMotion_=function(e){this.updateDeviceMotion_(e)};ye.prototype.updateDeviceMotion_=function(e){var t=e.accelerationIncludingGravity;var r=e.rotationRate;var i=e.timeStamp/1e3;var o=i-this.previousTimestampS;if(o<0){_("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion");this.previousTimestampS=i;return}if(o<=n||o>a){_("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range.");this.previousTimestampS=i;return}this.accelerometer.set(-t.x,-t.y,-t.z);f()?this.gyroscope.set(-r.beta,r.alpha,r.gamma):this.gyroscope.set(r.alpha,r.beta,r.gamma);this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180);this.filter.addAccelMeasurement(this.accelerometer,i);this.filter.addGyroMeasurement(this.gyroscope,i);this.previousTimestampS=i};ye.prototype.onOrientationChange_=function(e){this.setScreenTransform_()};ye.prototype.onMessage_=function(e){var t=e.data;if(!t||!t.type)return;var r=t.type.toLowerCase();if("devicemotion"!==r)return;this.updateDeviceMotion_(t.deviceMotionEvent)};ye.prototype.setScreenTransform_=function(){this.worldToScreenQ.set(0,0,0,1);switch(window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new te(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new te(0,0,1),Math.PI/2);break;case 180:break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ);this.inverseWorldToScreenQ.inverse()};ye.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this);this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this);this.onMessageCallback_=this.onMessage_.bind(this);this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this);u()&&C()&&window.addEventListener("message",this.onMessageCallback_);window.addEventListener("orientationchange",this.onOrientationChangeCallback_);this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)};ye.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_);window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_);window.removeEventListener("orientationchange",this.onOrientationChangeCallback_);window.removeEventListener("message",this.onMessageCallback_)};var Ae=60;var Me=new te(1,0,0);var we=new te(0,0,1);var Ee={};screen.orientation?Ee=screen.orientation:screen.msOrientation?Ee=screen.msOrientation:Object.defineProperty(Ee,"angle",{get:function e(){return window.orientation||0}});var xe=new re;xe.setFromAxisAngle(Me,-Math.PI/2);xe.multiply((new re).setFromAxisAngle(we,Math.PI/2));var be=function(){function t(r){e(this,t);this.config=r;this.sensor=null;this.fusionSensor=null;this._out=new Float32Array(4);this.api=null;this.errors=[];this._sensorQ=new re;this._worldToScreenQ=new re;this._outQ=new re;this._onSensorRead=this._onSensorRead.bind(this);this._onSensorError=this._onSensorError.bind(this);this._onOrientationChange=this._onOrientationChange.bind(this);this._onOrientationChange();this.init()}r(t,[{key:"init",value:function e(){var t=null;try{t=new RelativeOrientationSensor({frequency:Ae});t.addEventListener("error",this._onSensorError)}catch(e){this.errors.push(e);if("SecurityError"===e.name){console.error("Cannot construct sensors due to the Feature Policy");console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.');this.useDeviceMotion()}else"ReferenceError"===e.name?this.useDeviceMotion():console.error(e)}if(t){this.api="sensor";this.sensor=t;this.sensor.addEventListener("reading",this._onSensorRead);this.sensor.start()}window.addEventListener("orientationchange",this._onOrientationChange)}},{key:"useDeviceMotion",value:function e(){this.api="devicemotion";this.fusionSensor=new ye(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG)}},{key:"getOrientation",value:function e(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion){this._out[0]=this._out[1]=this._out[2]=0;this._out[3]=1;return this._out}var t=this.sensor.quaternion;this._sensorQ.set(t[0],t[1],t[2],t[3]);var r=this._outQ;r.copy(xe);r.multiply(this._sensorQ);r.multiply(this._worldToScreenQ);if(this.config.YAW_ONLY){r.x=r.z=0;r.normalize()}this._out[0]=r.x;this._out[1]=r.y;this._out[2]=r.z;this._out[3]=r.w;return this._out}},{key:"_onSensorError",value:function e(t){this.errors.push(t.error);"NotAllowedError"===t.error.name?console.error("Permission to access sensor was denied"):"NotReadableError"===t.error.name?console.error("Sensor could not be read"):console.error(t.error)}},{key:"_onSensorRead",value:function e(){}},{key:"_onOrientationChange",value:function e(){var t=-Ee.angle*Math.PI/180;this._worldToScreenQ.setFromAxisAngle(we,t)}}]);return t}();var Te="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjE5OHB4IiBoZWlnaHQ9IjI0MHB4IiB2aWV3Qm94PSIwIDAgMTk4IDI0MCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDMuMy4zICgxMjA4MSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+dHJhbnNpdGlvbjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHNrZXRjaDp0eXBlPSJNU1BhZ2UiPgogICAgICAgIDxnIGlkPSJ0cmFuc2l0aW9uIiBza2V0Y2g6dHlwZT0iTVNBcnRib2FyZEdyb3VwIj4KICAgICAgICAgICAgPGcgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTQtKy1JbXBvcnRlZC1MYXllcnMtQ29weS0rLUltcG9ydGVkLUxheWVycy1Db3B5LTItQ29weSIgc2tldGNoOnR5cGU9Ik1TTGF5ZXJHcm91cCI+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHktNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDEwNy4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjYyNSwyLjUyNyBDMTQ5LjYyNSwyLjUyNyAxNTUuODA1LDYuMDk2IDE1Ni4zNjIsNi40MTggTDE1Ni4zNjIsNy4zMDQgQzE1Ni4zNjIsNy40ODEgMTU2LjM3NSw3LjY2NCAxNTYuNCw3Ljg1MyBDMTU2LjQxLDcuOTM0IDE1Ni40Miw4LjAxNSAxNTYuNDI3LDguMDk1IEMxNTYuNTY3LDkuNTEgMTU3LjQwMSwxMS4wOTMgMTU4LjUzMiwxMi4wOTQgTDE2NC4yNTIsMTcuMTU2IEwxNjQuMzMzLDE3LjA2NiBDMTY0LjMzMywxNy4wNjYgMTY4LjcxNSwxNC41MzYgMTY5LjU2OCwxNC4wNDIgQzE3MS4wMjUsMTQuODgzIDE5NS41MzgsMjkuMDM1IDE5NS41MzgsMjkuMDM1IEwxOTUuNTM4LDgzLjAzNiBDMTk1LjUzOCw4My44MDcgMTk1LjE1Miw4NC4yNTMgMTk0LjU5LDg0LjI1MyBDMTk0LjM1Nyw4NC4yNTMgMTk0LjA5NSw4NC4xNzcgMTkzLjgxOCw4NC4wMTcgTDE2OS44NTEsNzAuMTc5IEwxNjkuODM3LDcwLjIwMyBMMTQyLjUxNSw4NS45NzggTDE0MS42NjUsODQuNjU1IEMxMzYuOTM0LDgzLjEyNiAxMzEuOTE3LDgxLjkxNSAxMjYuNzE0LDgxLjA0NSBDMTI2LjcwOSw4MS4wNiAxMjYuNzA3LDgxLjA2OSAxMjYuNzA3LDgxLjA2OSBMMTIxLjY0LDk4LjAzIEwxMTMuNzQ5LDEwMi41ODYgTDExMy43MTIsMTAyLjUyMyBMMTEzLjcxMiwxMzAuMTEzIEMxMTMuNzEyLDEzMC44ODUgMTEzLjMyNiwxMzEuMzMgMTEyLjc2NCwxMzEuMzMgQzExMi41MzIsMTMxLjMzIDExMi4yNjksMTMxLjI1NCAxMTEuOTkyLDEzMS4wOTQgTDY5LjUxOSwxMDYuNTcyIEM2OC41NjksMTA2LjAyMyA2Ny43OTksMTA0LjY5NSA2Ny43OTksMTAzLjYwNSBMNjcuNzk5LDEwMi41NyBMNjcuNzc4LDEwMi42MTcgQzY3LjI3LDEwMi4zOTMgNjYuNjQ4LDEwMi4yNDkgNjUuOTYyLDEwMi4yMTggQzY1Ljg3NSwxMDIuMjE0IDY1Ljc4OCwxMDIuMjEyIDY1LjcwMSwxMDIuMjEyIEM2NS42MDYsMTAyLjIxMiA2NS41MTEsMTAyLjIxNSA2NS40MTYsMTAyLjIxOSBDNjUuMTk1LDEwMi4yMjkgNjQuOTc0LDEwMi4yMzUgNjQuNzU0LDEwMi4yMzUgQzY0LjMzMSwxMDIuMjM1IDYzLjkxMSwxMDIuMjE2IDYzLjQ5OCwxMDIuMTc4IEM2MS44NDMsMTAyLjAyNSA2MC4yOTgsMTAxLjU3OCA1OS4wOTQsMTAwLjg4MiBMMTIuNTE4LDczLjk5MiBMMTIuNTIzLDc0LjAwNCBMMi4yNDUsNTUuMjU0IEMxLjI0NCw1My40MjcgMi4wMDQsNTEuMDM4IDMuOTQzLDQ5LjkxOCBMNTkuOTU0LDE3LjU3MyBDNjAuNjI2LDE3LjE4NSA2MS4zNSwxNy4wMDEgNjIuMDUzLDE3LjAwMSBDNjMuMzc5LDE3LjAwMSA2NC42MjUsMTcuNjYgNjUuMjgsMTguODU0IEw2NS4yODUsMTguODUxIEw2NS41MTIsMTkuMjY0IEw2NS41MDYsMTkuMjY4IEM2NS45MDksMjAuMDAzIDY2LjQwNSwyMC42OCA2Ni45ODMsMjEuMjg2IEw2Ny4yNiwyMS41NTYgQzY5LjE3NCwyMy40MDYgNzEuNzI4LDI0LjM1NyA3NC4zNzMsMjQuMzU3IEM3Ni4zMjIsMjQuMzU3IDc4LjMyMSwyMy44NCA4MC4xNDgsMjIuNzg1IEM4MC4xNjEsMjIuNzg1IDg3LjQ2NywxOC41NjYgODcuNDY3LDE4LjU2NiBDODguMTM5LDE4LjE3OCA4OC44NjMsMTcuOTk0IDg5LjU2NiwxNy45OTQgQzkwLjg5MiwxNy45OTQgOTIuMTM4LDE4LjY1MiA5Mi43OTIsMTkuODQ3IEw5Ni4wNDIsMjUuNzc1IEw5Ni4wNjQsMjUuNzU3IEwxMDIuODQ5LDI5LjY3NCBMMTAyLjc0NCwyOS40OTIgTDE0OS42MjUsMi41MjcgTTE0OS42MjUsMC44OTIgQzE0OS4zNDMsMC44OTIgMTQ5LjA2MiwwLjk2NSAxNDguODEsMS4xMSBMMTAyLjY0MSwyNy42NjYgTDk3LjIzMSwyNC41NDIgTDk0LjIyNiwxOS4wNjEgQzkzLjMxMywxNy4zOTQgOTEuNTI3LDE2LjM1OSA4OS41NjYsMTYuMzU4IEM4OC41NTUsMTYuMzU4IDg3LjU0NiwxNi42MzIgODYuNjQ5LDE3LjE1IEM4My44NzgsMTguNzUgNzkuNjg3LDIxLjE2OSA3OS4zNzQsMjEuMzQ1IEM3OS4zNTksMjEuMzUzIDc5LjM0NSwyMS4zNjEgNzkuMzMsMjEuMzY5IEM3Ny43OTgsMjIuMjU0IDc2LjA4NCwyMi43MjIgNzQuMzczLDIyLjcyMiBDNzIuMDgxLDIyLjcyMiA2OS45NTksMjEuODkgNjguMzk3LDIwLjM4IEw2OC4xNDUsMjAuMTM1IEM2Ny43MDYsMTkuNjcyIDY3LjMyMywxOS4xNTYgNjcuMDA2LDE4LjYwMSBDNjYuOTg4LDE4LjU1OSA2Ni45NjgsMTguNTE5IDY2Ljk0NiwxOC40NzkgTDY2LjcxOSwxOC4wNjUgQzY2LjY5LDE4LjAxMiA2Ni42NTgsMTcuOTYgNjYuNjI0LDE3LjkxMSBDNjUuNjg2LDE2LjMzNyA2My45NTEsMTUuMzY2IDYyLjA1MywxNS4zNjYgQzYxLjA0MiwxNS4zNjYgNjAuMDMzLDE1LjY0IDU5LjEzNiwxNi4xNTggTDMuMTI1LDQ4LjUwMiBDMC40MjYsNTAuMDYxIC0wLjYxMyw1My40NDIgMC44MTEsNTYuMDQgTDExLjA4OSw3NC43OSBDMTEuMjY2LDc1LjExMyAxMS41MzcsNzUuMzUzIDExLjg1LDc1LjQ5NCBMNTguMjc2LDEwMi4yOTggQzU5LjY3OSwxMDMuMTA4IDYxLjQzMywxMDMuNjMgNjMuMzQ4LDEwMy44MDYgQzYzLjgxMiwxMDMuODQ4IDY0LjI4NSwxMDMuODcgNjQuNzU0LDEwMy44NyBDNjUsMTAzLjg3IDY1LjI0OSwxMDMuODY0IDY1LjQ5NCwxMDMuODUyIEM2NS41NjMsMTAzLjg0OSA2NS42MzIsMTAzLjg0NyA2NS43MDEsMTAzLjg0NyBDNjUuNzY0LDEwMy44NDcgNjUuODI4LDEwMy44NDkgNjUuODksMTAzLjg1MiBDNjUuOTg2LDEwMy44NTYgNjYuMDgsMTAzLjg2MyA2Ni4xNzMsMTAzLjg3NCBDNjYuMjgyLDEwNS40NjcgNjcuMzMyLDEwNy4xOTcgNjguNzAyLDEwNy45ODggTDExMS4xNzQsMTMyLjUxIEMxMTEuNjk4LDEzMi44MTIgMTEyLjIzMiwxMzIuOTY1IDExMi43NjQsMTMyLjk2NSBDMTE0LjI2MSwxMzIuOTY1IDExNS4zNDcsMTMxLjc2NSAxMTUuMzQ3LDEzMC4xMTMgTDExNS4zNDcsMTAzLjU1MSBMMTIyLjQ1OCw5OS40NDYgQzEyMi44MTksOTkuMjM3IDEyMy4wODcsOTguODk4IDEyMy4yMDcsOTguNDk4IEwxMjcuODY1LDgyLjkwNSBDMTMyLjI3OSw4My43MDIgMTM2LjU1Nyw4NC43NTMgMTQwLjYwNyw4Ni4wMzMgTDE0MS4xNCw4Ni44NjIgQzE0MS40NTEsODcuMzQ2IDE0MS45NzcsODcuNjEzIDE0Mi41MTYsODcuNjEzIEMxNDIuNzk0LDg3LjYxMyAxNDMuMDc2LDg3LjU0MiAxNDMuMzMzLDg3LjM5MyBMMTY5Ljg2NSw3Mi4wNzYgTDE5Myw4NS40MzMgQzE5My41MjMsODUuNzM1IDE5NC4wNTgsODUuODg4IDE5NC41OSw4NS44ODggQzE5Ni4wODcsODUuODg4IDE5Ny4xNzMsODQuNjg5IDE5Ny4xNzMsODMuMDM2IEwxOTcuMTczLDI5LjAzNSBDMTk3LjE3MywyOC40NTEgMTk2Ljg2MSwyNy45MTEgMTk2LjM1NSwyNy42MTkgQzE5Ni4zNTUsMjcuNjE5IDE3MS44NDMsMTMuNDY3IDE3MC4zODUsMTIuNjI2IEMxNzAuMTMyLDEyLjQ4IDE2OS44NSwxMi40MDcgMTY5LjU2OCwxMi40MDcgQzE2OS4yODUsMTIuNDA3IDE2OS4wMDIsMTIuNDgxIDE2OC43NDksMTIuNjI3IEMxNjguMTQzLDEyLjk3OCAxNjUuNzU2LDE0LjM1NyAxNjQuNDI0LDE1LjEyNSBMMTU5LjYxNSwxMC44NyBDMTU4Ljc5NiwxMC4xNDUgMTU4LjE1NCw4LjkzNyAxNTguMDU0LDcuOTM0IEMxNTguMDQ1LDcuODM3IDE1OC4wMzQsNy43MzkgMTU4LjAyMSw3LjY0IEMxNTguMDA1LDcuNTIzIDE1Ny45OTgsNy40MSAxNTcuOTk4LDcuMzA0IEwxNTcuOTk4LDYuNDE4IEMxNTcuOTk4LDUuODM0IDE1Ny42ODYsNS4yOTUgMTU3LjE4MSw1LjAwMiBDMTU2LjYyNCw0LjY4IDE1MC40NDIsMS4xMTEgMTUwLjQ0MiwxLjExMSBDMTUwLjE4OSwwLjk2NSAxNDkuOTA3LDAuODkyIDE0OS42MjUsMC44OTIiIGlkPSJGaWxsLTEiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTYuMDI3LDI1LjYzNiBMMTQyLjYwMyw1Mi41MjcgQzE0My44MDcsNTMuMjIyIDE0NC41ODIsNTQuMTE0IDE0NC44NDUsNTUuMDY4IEwxNDQuODM1LDU1LjA3NSBMNjMuNDYxLDEwMi4wNTcgTDYzLjQ2LDEwMi4wNTcgQzYxLjgwNiwxMDEuOTA1IDYwLjI2MSwxMDEuNDU3IDU5LjA1NywxMDAuNzYyIEwxMi40ODEsNzMuODcxIEw5Ni4wMjcsMjUuNjM2IiBpZD0iRmlsbC0yIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYzLjQ2MSwxMDIuMTc0IEM2My40NTMsMTAyLjE3NCA2My40NDYsMTAyLjE3NCA2My40MzksMTAyLjE3MiBDNjEuNzQ2LDEwMi4wMTYgNjAuMjExLDEwMS41NjMgNTguOTk4LDEwMC44NjMgTDEyLjQyMiw3My45NzMgQzEyLjM4Niw3My45NTIgMTIuMzY0LDczLjkxNCAxMi4zNjQsNzMuODcxIEMxMi4zNjQsNzMuODMgMTIuMzg2LDczLjc5MSAxMi40MjIsNzMuNzcgTDk1Ljk2OCwyNS41MzUgQzk2LjAwNCwyNS41MTQgOTYuMDQ5LDI1LjUxNCA5Ni4wODUsMjUuNTM1IEwxNDIuNjYxLDUyLjQyNiBDMTQzLjg4OCw1My4xMzQgMTQ0LjY4Miw1NC4wMzggMTQ0Ljk1Nyw1NS4wMzcgQzE0NC45Nyw1NS4wODMgMTQ0Ljk1Myw1NS4xMzMgMTQ0LjkxNSw1NS4xNjEgQzE0NC45MTEsNTUuMTY1IDE0NC44OTgsNTUuMTc0IDE0NC44OTQsNTUuMTc3IEw2My41MTksMTAyLjE1OCBDNjMuNTAxLDEwMi4xNjkgNjMuNDgxLDEwMi4xNzQgNjMuNDYxLDEwMi4xNzQgTDYzLjQ2MSwxMDIuMTc0IFogTTEyLjcxNCw3My44NzEgTDU5LjExNSwxMDAuNjYxIEM2MC4yOTMsMTAxLjM0MSA2MS43ODYsMTAxLjc4MiA2My40MzUsMTAxLjkzNyBMMTQ0LjcwNyw1NS4wMTUgQzE0NC40MjgsNTQuMTA4IDE0My42ODIsNTMuMjg1IDE0Mi41NDQsNTIuNjI4IEw5Ni4wMjcsMjUuNzcxIEwxMi43MTQsNzMuODcxIEwxMi43MTQsNzMuODcxIFoiIGlkPSJGaWxsLTMiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ4LjMyNyw1OC40NzEgQzE0OC4xNDUsNTguNDggMTQ3Ljk2Miw1OC40OCAxNDcuNzgxLDU4LjQ3MiBDMTQ1Ljg4Nyw1OC4zODkgMTQ0LjQ3OSw1Ny40MzQgMTQ0LjYzNiw1Ni4zNCBDMTQ0LjY4OSw1NS45NjcgMTQ0LjY2NCw1NS41OTcgMTQ0LjU2NCw1NS4yMzUgTDYzLjQ2MSwxMDIuMDU3IEM2NC4wODksMTAyLjExNSA2NC43MzMsMTAyLjEzIDY1LjM3OSwxMDIuMDk5IEM2NS41NjEsMTAyLjA5IDY1Ljc0MywxMDIuMDkgNjUuOTI1LDEwMi4wOTggQzY3LjgxOSwxMDIuMTgxIDY5LjIyNywxMDMuMTM2IDY5LjA3LDEwNC4yMyBMMTQ4LjMyNyw1OC40NzEiIGlkPSJGaWxsLTQiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNjkuMDcsMTA0LjM0NyBDNjkuMDQ4LDEwNC4zNDcgNjkuMDI1LDEwNC4zNCA2OS4wMDUsMTA0LjMyNyBDNjguOTY4LDEwNC4zMDEgNjguOTQ4LDEwNC4yNTcgNjguOTU1LDEwNC4yMTMgQzY5LDEwMy44OTYgNjguODk4LDEwMy41NzYgNjguNjU4LDEwMy4yODggQzY4LjE1MywxMDIuNjc4IDY3LjEwMywxMDIuMjY2IDY1LjkyLDEwMi4yMTQgQzY1Ljc0MiwxMDIuMjA2IDY1LjU2MywxMDIuMjA3IDY1LjM4NSwxMDIuMjE1IEM2NC43NDIsMTAyLjI0NiA2NC4wODcsMTAyLjIzMiA2My40NSwxMDIuMTc0IEM2My4zOTksMTAyLjE2OSA2My4zNTgsMTAyLjEzMiA2My4zNDcsMTAyLjA4MiBDNjMuMzM2LDEwMi4wMzMgNjMuMzU4LDEwMS45ODEgNjMuNDAyLDEwMS45NTYgTDE0NC41MDYsNTUuMTM0IEMxNDQuNTM3LDU1LjExNiAxNDQuNTc1LDU1LjExMyAxNDQuNjA5LDU1LjEyNyBDMTQ0LjY0Miw1NS4xNDEgMTQ0LjY2OCw1NS4xNyAxNDQuNjc3LDU1LjIwNCBDMTQ0Ljc4MSw1NS41ODUgMTQ0LjgwNiw1NS45NzIgMTQ0Ljc1MSw1Ni4zNTcgQzE0NC43MDYsNTYuNjczIDE0NC44MDgsNTYuOTk0IDE0NS4wNDcsNTcuMjgyIEMxNDUuNTUzLDU3Ljg5MiAxNDYuNjAyLDU4LjMwMyAxNDcuNzg2LDU4LjM1NSBDMTQ3Ljk2NCw1OC4zNjMgMTQ4LjE0Myw1OC4zNjMgMTQ4LjMyMSw1OC4zNTQgQzE0OC4zNzcsNTguMzUyIDE0OC40MjQsNTguMzg3IDE0OC40MzksNTguNDM4IEMxNDguNDU0LDU4LjQ5IDE0OC40MzIsNTguNTQ1IDE0OC4zODUsNTguNTcyIEw2OS4xMjksMTA0LjMzMSBDNjkuMTExLDEwNC4zNDIgNjkuMDksMTA0LjM0NyA2OS4wNywxMDQuMzQ3IEw2OS4wNywxMDQuMzQ3IFogTTY1LjY2NSwxMDEuOTc1IEM2NS43NTQsMTAxLjk3NSA2NS44NDIsMTAxLjk3NyA2NS45MywxMDEuOTgxIEM2Ny4xOTYsMTAyLjAzNyA2OC4yODMsMTAyLjQ2OSA2OC44MzgsMTAzLjEzOSBDNjkuMDY1LDEwMy40MTMgNjkuMTg4LDEwMy43MTQgNjkuMTk4LDEwNC4wMjEgTDE0Ny44ODMsNTguNTkyIEMxNDcuODQ3LDU4LjU5MiAxNDcuODExLDU4LjU5MSAxNDcuNzc2LDU4LjU4OSBDMTQ2LjUwOSw1OC41MzMgMTQ1LjQyMiw1OC4xIDE0NC44NjcsNTcuNDMxIEMxNDQuNTg1LDU3LjA5MSAxNDQuNDY1LDU2LjcwNyAxNDQuNTIsNTYuMzI0IEMxNDQuNTYzLDU2LjAyMSAxNDQuNTUyLDU1LjcxNiAxNDQuNDg4LDU1LjQxNCBMNjMuODQ2LDEwMS45NyBDNjQuMzUzLDEwMi4wMDIgNjQuODY3LDEwMi4wMDYgNjUuMzc0LDEwMS45ODIgQzY1LjQ3MSwxMDEuOTc3IDY1LjU2OCwxMDEuOTc1IDY1LjY2NSwxMDEuOTc1IEw2NS42NjUsMTAxLjk3NSBaIiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTIuMjA4LDU1LjEzNCBDMS4yMDcsNTMuMzA3IDEuOTY3LDUwLjkxNyAzLjkwNiw0OS43OTcgTDU5LjkxNywxNy40NTMgQzYxLjg1NiwxNi4zMzMgNjQuMjQxLDE2LjkwNyA2NS4yNDMsMTguNzM0IEw2NS40NzUsMTkuMTQ0IEM2NS44NzIsMTkuODgyIDY2LjM2OCwyMC41NiA2Ni45NDUsMjEuMTY1IEw2Ny4yMjMsMjEuNDM1IEM3MC41NDgsMjQuNjQ5IDc1LjgwNiwyNS4xNTEgODAuMTExLDIyLjY2NSBMODcuNDMsMTguNDQ1IEM4OS4zNywxNy4zMjYgOTEuNzU0LDE3Ljg5OSA5Mi43NTUsMTkuNzI3IEw5Ni4wMDUsMjUuNjU1IEwxMi40ODYsNzMuODg0IEwyLjIwOCw1NS4xMzQgWiIgaWQ9IkZpbGwtNiIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi40ODYsNzQuMDAxIEMxMi40NzYsNzQuMDAxIDEyLjQ2NSw3My45OTkgMTIuNDU1LDczLjk5NiBDMTIuNDI0LDczLjk4OCAxMi4zOTksNzMuOTY3IDEyLjM4NCw3My45NCBMMi4xMDYsNTUuMTkgQzEuMDc1LDUzLjMxIDEuODU3LDUwLjg0NSAzLjg0OCw0OS42OTYgTDU5Ljg1OCwxNy4zNTIgQzYwLjUyNSwxNi45NjcgNjEuMjcxLDE2Ljc2NCA2Mi4wMTYsMTYuNzY0IEM2My40MzEsMTYuNzY0IDY0LjY2NiwxNy40NjYgNjUuMzI3LDE4LjY0NiBDNjUuMzM3LDE4LjY1NCA2NS4zNDUsMTguNjYzIDY1LjM1MSwxOC42NzQgTDY1LjU3OCwxOS4wODggQzY1LjU4NCwxOS4xIDY1LjU4OSwxOS4xMTIgNjUuNTkxLDE5LjEyNiBDNjUuOTg1LDE5LjgzOCA2Ni40NjksMjAuNDk3IDY3LjAzLDIxLjA4NSBMNjcuMzA1LDIxLjM1MSBDNjkuMTUxLDIzLjEzNyA3MS42NDksMjQuMTIgNzQuMzM2LDI0LjEyIEM3Ni4zMTMsMjQuMTIgNzguMjksMjMuNTgyIDgwLjA1MywyMi41NjMgQzgwLjA2NCwyMi41NTcgODAuMDc2LDIyLjU1MyA4MC4wODgsMjIuNTUgTDg3LjM3MiwxOC4zNDQgQzg4LjAzOCwxNy45NTkgODguNzg0LDE3Ljc1NiA4OS41MjksMTcuNzU2IEM5MC45NTYsMTcuNzU2IDkyLjIwMSwxOC40NzIgOTIuODU4LDE5LjY3IEw5Ni4xMDcsMjUuNTk5IEM5Ni4xMzgsMjUuNjU0IDk2LjExOCwyNS43MjQgOTYuMDYzLDI1Ljc1NiBMMTIuNTQ1LDczLjk4NSBDMTIuNTI2LDczLjk5NiAxMi41MDYsNzQuMDAxIDEyLjQ4Niw3NC4wMDEgTDEyLjQ4Niw3NC4wMDEgWiBNNjIuMDE2LDE2Ljk5NyBDNjEuMzEyLDE2Ljk5NyA2MC42MDYsMTcuMTkgNTkuOTc1LDE3LjU1NCBMMy45NjUsNDkuODk5IEMyLjA4Myw1MC45ODUgMS4zNDEsNTMuMzA4IDIuMzEsNTUuMDc4IEwxMi41MzEsNzMuNzIzIEw5NS44NDgsMjUuNjExIEw5Mi42NTMsMTkuNzgyIEM5Mi4wMzgsMTguNjYgOTAuODcsMTcuOTkgODkuNTI5LDE3Ljk5IEM4OC44MjUsMTcuOTkgODguMTE5LDE4LjE4MiA4Ny40ODksMTguNTQ3IEw4MC4xNzIsMjIuNzcyIEM4MC4xNjEsMjIuNzc4IDgwLjE0OSwyMi43ODIgODAuMTM3LDIyLjc4NSBDNzguMzQ2LDIzLjgxMSA3Ni4zNDEsMjQuMzU0IDc0LjMzNiwyNC4zNTQgQzcxLjU4OCwyNC4zNTQgNjkuMDMzLDIzLjM0NyA2Ny4xNDIsMjEuNTE5IEw2Ni44NjQsMjEuMjQ5IEM2Ni4yNzcsMjAuNjM0IDY1Ljc3NCwxOS45NDcgNjUuMzY3LDE5LjIwMyBDNjUuMzYsMTkuMTkyIDY1LjM1NiwxOS4xNzkgNjUuMzU0LDE5LjE2NiBMNjUuMTYzLDE4LjgxOSBDNjUuMTU0LDE4LjgxMSA2NS4xNDYsMTguODAxIDY1LjE0LDE4Ljc5IEM2NC41MjUsMTcuNjY3IDYzLjM1NywxNi45OTcgNjIuMDE2LDE2Ljk5NyBMNjIuMDE2LDE2Ljk5NyBaIiBpZD0iRmlsbC03IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTQyLjQzNCw0OC44MDggTDQyLjQzNCw0OC44MDggQzM5LjkyNCw0OC44MDcgMzcuNzM3LDQ3LjU1IDM2LjU4Miw0NS40NDMgQzM0Ljc3MSw0Mi4xMzkgMzYuMTQ0LDM3LjgwOSAzOS42NDEsMzUuNzg5IEw1MS45MzIsMjguNjkxIEM1My4xMDMsMjguMDE1IDU0LjQxMywyNy42NTggNTUuNzIxLDI3LjY1OCBDNTguMjMxLDI3LjY1OCA2MC40MTgsMjguOTE2IDYxLjU3MywzMS4wMjMgQzYzLjM4NCwzNC4zMjcgNjIuMDEyLDM4LjY1NyA1OC41MTQsNDAuNjc3IEw0Ni4yMjMsNDcuNzc1IEM0NS4wNTMsNDguNDUgNDMuNzQyLDQ4LjgwOCA0Mi40MzQsNDguODA4IEw0Mi40MzQsNDguODA4IFogTTU1LjcyMSwyOC4xMjUgQzU0LjQ5NSwyOC4xMjUgNTMuMjY1LDI4LjQ2MSA1Mi4xNjYsMjkuMDk2IEwzOS44NzUsMzYuMTk0IEMzNi41OTYsMzguMDg3IDM1LjMwMiw0Mi4xMzYgMzYuOTkyLDQ1LjIxOCBDMzguMDYzLDQ3LjE3MyA0MC4wOTgsNDguMzQgNDIuNDM0LDQ4LjM0IEM0My42NjEsNDguMzQgNDQuODksNDguMDA1IDQ1Ljk5LDQ3LjM3IEw1OC4yODEsNDAuMjcyIEM2MS41NiwzOC4zNzkgNjIuODUzLDM0LjMzIDYxLjE2NCwzMS4yNDggQzYwLjA5MiwyOS4yOTMgNTguMDU4LDI4LjEyNSA1NS43MjEsMjguMTI1IEw1NS43MjEsMjguMTI1IFoiIGlkPSJGaWxsLTgiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjU4OCwyLjQwNyBDMTQ5LjU4OCwyLjQwNyAxNTUuNzY4LDUuOTc1IDE1Ni4zMjUsNi4yOTcgTDE1Ni4zMjUsNy4xODQgQzE1Ni4zMjUsNy4zNiAxNTYuMzM4LDcuNTQ0IDE1Ni4zNjIsNy43MzMgQzE1Ni4zNzMsNy44MTQgMTU2LjM4Miw3Ljg5NCAxNTYuMzksNy45NzUgQzE1Ni41Myw5LjM5IDE1Ny4zNjMsMTAuOTczIDE1OC40OTUsMTEuOTc0IEwxNjUuODkxLDE4LjUxOSBDMTY2LjA2OCwxOC42NzUgMTY2LjI0OSwxOC44MTQgMTY2LjQzMiwxOC45MzQgQzE2OC4wMTEsMTkuOTc0IDE2OS4zODIsMTkuNCAxNjkuNDk0LDE3LjY1MiBDMTY5LjU0MywxNi44NjggMTY5LjU1MSwxNi4wNTcgMTY5LjUxNywxNS4yMjMgTDE2OS41MTQsMTUuMDYzIEwxNjkuNTE0LDEzLjkxMiBDMTcwLjc4LDE0LjY0MiAxOTUuNTAxLDI4LjkxNSAxOTUuNTAxLDI4LjkxNSBMMTk1LjUwMSw4Mi45MTUgQzE5NS41MDEsODQuMDA1IDE5NC43MzEsODQuNDQ1IDE5My43ODEsODMuODk3IEwxNTEuMzA4LDU5LjM3NCBDMTUwLjM1OCw1OC44MjYgMTQ5LjU4OCw1Ny40OTcgMTQ5LjU4OCw1Ni40MDggTDE0OS41ODgsMjIuMzc1IiBpZD0iRmlsbC05IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE5NC41NTMsODQuMjUgQzE5NC4yOTYsODQuMjUgMTk0LjAxMyw4NC4xNjUgMTkzLjcyMiw4My45OTcgTDE1MS4yNSw1OS40NzYgQzE1MC4yNjksNTguOTA5IDE0OS40NzEsNTcuNTMzIDE0OS40NzEsNTYuNDA4IEwxNDkuNDcxLDIyLjM3NSBMMTQ5LjcwNSwyMi4zNzUgTDE0OS43MDUsNTYuNDA4IEMxNDkuNzA1LDU3LjQ1OSAxNTAuNDUsNTguNzQ0IDE1MS4zNjYsNTkuMjc0IEwxOTMuODM5LDgzLjc5NSBDMTk0LjI2Myw4NC4wNCAxOTQuNjU1LDg0LjA4MyAxOTQuOTQyLDgzLjkxNyBDMTk1LjIyNyw4My43NTMgMTk1LjM4NCw4My4zOTcgMTk1LjM4NCw4Mi45MTUgTDE5NS4zODQsMjguOTgyIEMxOTQuMTAyLDI4LjI0MiAxNzIuMTA0LDE1LjU0MiAxNjkuNjMxLDE0LjExNCBMMTY5LjYzNCwxNS4yMiBDMTY5LjY2OCwxNi4wNTIgMTY5LjY2LDE2Ljg3NCAxNjkuNjEsMTcuNjU5IEMxNjkuNTU2LDE4LjUwMyAxNjkuMjE0LDE5LjEyMyAxNjguNjQ3LDE5LjQwNSBDMTY4LjAyOCwxOS43MTQgMTY3LjE5NywxOS41NzggMTY2LjM2NywxOS4wMzIgQzE2Ni4xODEsMTguOTA5IDE2NS45OTUsMTguNzY2IDE2NS44MTQsMTguNjA2IEwxNTguNDE3LDEyLjA2MiBDMTU3LjI1OSwxMS4wMzYgMTU2LjQxOCw5LjQzNyAxNTYuMjc0LDcuOTg2IEMxNTYuMjY2LDcuOTA3IDE1Ni4yNTcsNy44MjcgMTU2LjI0Nyw3Ljc0OCBDMTU2LjIyMSw3LjU1NSAxNTYuMjA5LDcuMzY1IDE1Ni4yMDksNy4xODQgTDE1Ni4yMDksNi4zNjQgQzE1NS4zNzUsNS44ODMgMTQ5LjUyOSwyLjUwOCAxNDkuNTI5LDIuNTA4IEwxNDkuNjQ2LDIuMzA2IEMxNDkuNjQ2LDIuMzA2IDE1NS44MjcsNS44NzQgMTU2LjM4NCw2LjE5NiBMMTU2LjQ0Miw2LjIzIEwxNTYuNDQyLDcuMTg0IEMxNTYuNDQyLDcuMzU1IDE1Ni40NTQsNy41MzUgMTU2LjQ3OCw3LjcxNyBDMTU2LjQ4OSw3LjggMTU2LjQ5OSw3Ljg4MiAxNTYuNTA3LDcuOTYzIEMxNTYuNjQ1LDkuMzU4IDE1Ny40NTUsMTAuODk4IDE1OC41NzIsMTEuODg2IEwxNjUuOTY5LDE4LjQzMSBDMTY2LjE0MiwxOC41ODQgMTY2LjMxOSwxOC43MiAxNjYuNDk2LDE4LjgzNyBDMTY3LjI1NCwxOS4zMzYgMTY4LDE5LjQ2NyAxNjguNTQzLDE5LjE5NiBDMTY5LjAzMywxOC45NTMgMTY5LjMyOSwxOC40MDEgMTY5LjM3NywxNy42NDUgQzE2OS40MjcsMTYuODY3IDE2OS40MzQsMTYuMDU0IDE2OS40MDEsMTUuMjI4IEwxNjkuMzk3LDE1LjA2NSBMMTY5LjM5NywxMy43MSBMMTY5LjU3MiwxMy44MSBDMTcwLjgzOSwxNC41NDEgMTk1LjU1OSwyOC44MTQgMTk1LjU1OSwyOC44MTQgTDE5NS42MTgsMjguODQ3IEwxOTUuNjE4LDgyLjkxNSBDMTk1LjYxOCw4My40ODQgMTk1LjQyLDgzLjkxMSAxOTUuMDU5LDg0LjExOSBDMTk0LjkwOCw4NC4yMDYgMTk0LjczNyw4NC4yNSAxOTQuNTUzLDg0LjI1IiBpZD0iRmlsbC0xMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDUuNjg1LDU2LjE2MSBMMTY5LjgsNzAuMDgzIEwxNDMuODIyLDg1LjA4MSBMMTQyLjM2LDg0Ljc3NCBDMTM1LjgyNiw4Mi42MDQgMTI4LjczMiw4MS4wNDYgMTIxLjM0MSw4MC4xNTggQzExNi45NzYsNzkuNjM0IDExMi42NzgsODEuMjU0IDExMS43NDMsODMuNzc4IEMxMTEuNTA2LDg0LjQxNCAxMTEuNTAzLDg1LjA3MSAxMTEuNzMyLDg1LjcwNiBDMTEzLjI3LDg5Ljk3MyAxMTUuOTY4LDk0LjA2OSAxMTkuNzI3LDk3Ljg0MSBMMTIwLjI1OSw5OC42ODYgQzEyMC4yNiw5OC42ODUgOTQuMjgyLDExMy42ODMgOTQuMjgyLDExMy42ODMgTDcwLjE2Nyw5OS43NjEgTDE0NS42ODUsNTYuMTYxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik05NC4yODIsMTEzLjgxOCBMOTQuMjIzLDExMy43ODUgTDY5LjkzMyw5OS43NjEgTDcwLjEwOCw5OS42NiBMMTQ1LjY4NSw1Ni4wMjYgTDE0NS43NDMsNTYuMDU5IEwxNzAuMDMzLDcwLjA4MyBMMTQzLjg0Miw4NS4yMDUgTDE0My43OTcsODUuMTk1IEMxNDMuNzcyLDg1LjE5IDE0Mi4zMzYsODQuODg4IDE0Mi4zMzYsODQuODg4IEMxMzUuNzg3LDgyLjcxNCAxMjguNzIzLDgxLjE2MyAxMjEuMzI3LDgwLjI3NCBDMTIwLjc4OCw4MC4yMDkgMTIwLjIzNiw4MC4xNzcgMTE5LjY4OSw4MC4xNzcgQzExNS45MzEsODAuMTc3IDExMi42MzUsODEuNzA4IDExMS44NTIsODMuODE5IEMxMTEuNjI0LDg0LjQzMiAxMTEuNjIxLDg1LjA1MyAxMTEuODQyLDg1LjY2NyBDMTEzLjM3Nyw4OS45MjUgMTE2LjA1OCw5My45OTMgMTE5LjgxLDk3Ljc1OCBMMTE5LjgyNiw5Ny43NzkgTDEyMC4zNTIsOTguNjE0IEMxMjAuMzU0LDk4LjYxNyAxMjAuMzU2LDk4LjYyIDEyMC4zNTgsOTguNjI0IEwxMjAuNDIyLDk4LjcyNiBMMTIwLjMxNyw5OC43ODcgQzEyMC4yNjQsOTguODE4IDk0LjU5OSwxMTMuNjM1IDk0LjM0LDExMy43ODUgTDk0LjI4MiwxMTMuODE4IEw5NC4yODIsMTEzLjgxOCBaIE03MC40MDEsOTkuNzYxIEw5NC4yODIsMTEzLjU0OSBMMTE5LjA4NCw5OS4yMjkgQzExOS42Myw5OC45MTQgMTE5LjkzLDk4Ljc0IDEyMC4xMDEsOTguNjU0IEwxMTkuNjM1LDk3LjkxNCBDMTE1Ljg2NCw5NC4xMjcgMTEzLjE2OCw5MC4wMzMgMTExLjYyMiw4NS43NDYgQzExMS4zODIsODUuMDc5IDExMS4zODYsODQuNDA0IDExMS42MzMsODMuNzM4IEMxMTIuNDQ4LDgxLjUzOSAxMTUuODM2LDc5Ljk0MyAxMTkuNjg5LDc5Ljk0MyBDMTIwLjI0Niw3OS45NDMgMTIwLjgwNiw3OS45NzYgMTIxLjM1NSw4MC4wNDIgQzEyOC43NjcsODAuOTMzIDEzNS44NDYsODIuNDg3IDE0Mi4zOTYsODQuNjYzIEMxNDMuMjMyLDg0LjgzOCAxNDMuNjExLDg0LjkxNyAxNDMuNzg2LDg0Ljk2NyBMMTY5LjU2Niw3MC4wODMgTDE0NS42ODUsNTYuMjk1IEw3MC40MDEsOTkuNzYxIEw3MC40MDEsOTkuNzYxIFoiIGlkPSJGaWxsLTEyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2Ny4yMywxOC45NzkgTDE2Ny4yMyw2OS44NSBMMTM5LjkwOSw4NS42MjMgTDEzMy40NDgsNzEuNDU2IEMxMzIuNTM4LDY5LjQ2IDEzMC4wMiw2OS43MTggMTI3LjgyNCw3Mi4wMyBDMTI2Ljc2OSw3My4xNCAxMjUuOTMxLDc0LjU4NSAxMjUuNDk0LDc2LjA0OCBMMTE5LjAzNCw5Ny42NzYgTDkxLjcxMiwxMTMuNDUgTDkxLjcxMiw2Mi41NzkgTDE2Ny4yMywxOC45NzkiIGlkPSJGaWxsLTEzIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkxLjcxMiwxMTMuNTY3IEM5MS42OTIsMTEzLjU2NyA5MS42NzIsMTEzLjU2MSA5MS42NTMsMTEzLjU1MSBDOTEuNjE4LDExMy41MyA5MS41OTUsMTEzLjQ5MiA5MS41OTUsMTEzLjQ1IEw5MS41OTUsNjIuNTc5IEM5MS41OTUsNjIuNTM3IDkxLjYxOCw2Mi40OTkgOTEuNjUzLDYyLjQ3OCBMMTY3LjE3MiwxOC44NzggQzE2Ny4yMDgsMTguODU3IDE2Ny4yNTIsMTguODU3IDE2Ny4yODgsMTguODc4IEMxNjcuMzI0LDE4Ljg5OSAxNjcuMzQ3LDE4LjkzNyAxNjcuMzQ3LDE4Ljk3OSBMMTY3LjM0Nyw2OS44NSBDMTY3LjM0Nyw2OS44OTEgMTY3LjMyNCw2OS45MyAxNjcuMjg4LDY5Ljk1IEwxMzkuOTY3LDg1LjcyNSBDMTM5LjkzOSw4NS43NDEgMTM5LjkwNSw4NS43NDUgMTM5Ljg3Myw4NS43MzUgQzEzOS44NDIsODUuNzI1IDEzOS44MTYsODUuNzAyIDEzOS44MDIsODUuNjcyIEwxMzMuMzQyLDcxLjUwNCBDMTMyLjk2Nyw3MC42ODIgMTMyLjI4LDcwLjIyOSAxMzEuNDA4LDcwLjIyOSBDMTMwLjMxOSw3MC4yMjkgMTI5LjA0NCw3MC45MTUgMTI3LjkwOCw3Mi4xMSBDMTI2Ljg3NCw3My4yIDEyNi4wMzQsNzQuNjQ3IDEyNS42MDYsNzYuMDgyIEwxMTkuMTQ2LDk3LjcwOSBDMTE5LjEzNyw5Ny43MzggMTE5LjExOCw5Ny43NjIgMTE5LjA5Miw5Ny43NzcgTDkxLjc3LDExMy41NTEgQzkxLjc1MiwxMTMuNTYxIDkxLjczMiwxMTMuNTY3IDkxLjcxMiwxMTMuNTY3IEw5MS43MTIsMTEzLjU2NyBaIE05MS44MjksNjIuNjQ3IEw5MS44MjksMTEzLjI0OCBMMTE4LjkzNSw5Ny41OTggTDEyNS4zODIsNzYuMDE1IEMxMjUuODI3LDc0LjUyNSAxMjYuNjY0LDczLjA4MSAxMjcuNzM5LDcxLjk1IEMxMjguOTE5LDcwLjcwOCAxMzAuMjU2LDY5Ljk5NiAxMzEuNDA4LDY5Ljk5NiBDMTMyLjM3Nyw2OS45OTYgMTMzLjEzOSw3MC40OTcgMTMzLjU1NCw3MS40MDcgTDEzOS45NjEsODUuNDU4IEwxNjcuMTEzLDY5Ljc4MiBMMTY3LjExMywxOS4xODEgTDkxLjgyOSw2Mi42NDcgTDkxLjgyOSw2Mi42NDcgWiIgaWQ9IkZpbGwtMTQiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTY4LjU0MywxOS4yMTMgTDE2OC41NDMsNzAuMDgzIEwxNDEuMjIxLDg1Ljg1NyBMMTM0Ljc2MSw3MS42ODkgQzEzMy44NTEsNjkuNjk0IDEzMS4zMzMsNjkuOTUxIDEyOS4xMzcsNzIuMjYzIEMxMjguMDgyLDczLjM3NCAxMjcuMjQ0LDc0LjgxOSAxMjYuODA3LDc2LjI4MiBMMTIwLjM0Niw5Ny45MDkgTDkzLjAyNSwxMTMuNjgzIEw5My4wMjUsNjIuODEzIEwxNjguNTQzLDE5LjIxMyIgaWQ9IkZpbGwtMTUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTMuMDI1LDExMy44IEM5My4wMDUsMTEzLjggOTIuOTg0LDExMy43OTUgOTIuOTY2LDExMy43ODUgQzkyLjkzMSwxMTMuNzY0IDkyLjkwOCwxMTMuNzI1IDkyLjkwOCwxMTMuNjg0IEw5Mi45MDgsNjIuODEzIEM5Mi45MDgsNjIuNzcxIDkyLjkzMSw2Mi43MzMgOTIuOTY2LDYyLjcxMiBMMTY4LjQ4NCwxOS4xMTIgQzE2OC41MiwxOS4wOSAxNjguNTY1LDE5LjA5IDE2OC42MDEsMTkuMTEyIEMxNjguNjM3LDE5LjEzMiAxNjguNjYsMTkuMTcxIDE2OC42NiwxOS4yMTIgTDE2OC42Niw3MC4wODMgQzE2OC42Niw3MC4xMjUgMTY4LjYzNyw3MC4xNjQgMTY4LjYwMSw3MC4xODQgTDE0MS4yOCw4NS45NTggQzE0MS4yNTEsODUuOTc1IDE0MS4yMTcsODUuOTc5IDE0MS4xODYsODUuOTY4IEMxNDEuMTU0LDg1Ljk1OCAxNDEuMTI5LDg1LjkzNiAxNDEuMTE1LDg1LjkwNiBMMTM0LjY1NSw3MS43MzggQzEzNC4yOCw3MC45MTUgMTMzLjU5Myw3MC40NjMgMTMyLjcyLDcwLjQ2MyBDMTMxLjYzMiw3MC40NjMgMTMwLjM1Nyw3MS4xNDggMTI5LjIyMSw3Mi4zNDQgQzEyOC4xODYsNzMuNDMzIDEyNy4zNDcsNzQuODgxIDEyNi45MTksNzYuMzE1IEwxMjAuNDU4LDk3Ljk0MyBDMTIwLjQ1LDk3Ljk3MiAxMjAuNDMxLDk3Ljk5NiAxMjAuNDA1LDk4LjAxIEw5My4wODMsMTEzLjc4NSBDOTMuMDY1LDExMy43OTUgOTMuMDQ1LDExMy44IDkzLjAyNSwxMTMuOCBMOTMuMDI1LDExMy44IFogTTkzLjE0Miw2Mi44ODEgTDkzLjE0MiwxMTMuNDgxIEwxMjAuMjQ4LDk3LjgzMiBMMTI2LjY5NSw3Ni4yNDggQzEyNy4xNCw3NC43NTggMTI3Ljk3Nyw3My4zMTUgMTI5LjA1Miw3Mi4xODMgQzEzMC4yMzEsNzAuOTQyIDEzMS41NjgsNzAuMjI5IDEzMi43Miw3MC4yMjkgQzEzMy42ODksNzAuMjI5IDEzNC40NTIsNzAuNzMxIDEzNC44NjcsNzEuNjQxIEwxNDEuMjc0LDg1LjY5MiBMMTY4LjQyNiw3MC4wMTYgTDE2OC40MjYsMTkuNDE1IEw5My4xNDIsNjIuODgxIEw5My4xNDIsNjIuODgxIFoiIGlkPSJGaWxsLTE2IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS44LDcwLjA4MyBMMTQyLjQ3OCw4NS44NTcgTDEzNi4wMTgsNzEuNjg5IEMxMzUuMTA4LDY5LjY5NCAxMzIuNTksNjkuOTUxIDEzMC4zOTMsNzIuMjYzIEMxMjkuMzM5LDczLjM3NCAxMjguNSw3NC44MTkgMTI4LjA2NCw3Ni4yODIgTDEyMS42MDMsOTcuOTA5IEw5NC4yODIsMTEzLjY4MyBMOTQuMjgyLDYyLjgxMyBMMTY5LjgsMTkuMjEzIEwxNjkuOCw3MC4wODMgWiIgaWQ9IkZpbGwtMTciIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTQuMjgyLDExMy45MTcgQzk0LjI0MSwxMTMuOTE3IDk0LjIwMSwxMTMuOTA3IDk0LjE2NSwxMTMuODg2IEM5NC4wOTMsMTEzLjg0NSA5NC4wNDgsMTEzLjc2NyA5NC4wNDgsMTEzLjY4NCBMOTQuMDQ4LDYyLjgxMyBDOTQuMDQ4LDYyLjczIDk0LjA5Myw2Mi42NTIgOTQuMTY1LDYyLjYxMSBMMTY5LjY4MywxOS4wMSBDMTY5Ljc1NSwxOC45NjkgMTY5Ljg0NCwxOC45NjkgMTY5LjkxNywxOS4wMSBDMTY5Ljk4OSwxOS4wNTIgMTcwLjAzMywxOS4xMjkgMTcwLjAzMywxOS4yMTIgTDE3MC4wMzMsNzAuMDgzIEMxNzAuMDMzLDcwLjE2NiAxNjkuOTg5LDcwLjI0NCAxNjkuOTE3LDcwLjI4NSBMMTQyLjU5NSw4Ni4wNiBDMTQyLjUzOCw4Ni4wOTIgMTQyLjQ2OSw4Ni4xIDE0Mi40MDcsODYuMDggQzE0Mi4zNDQsODYuMDYgMTQyLjI5Myw4Ni4wMTQgMTQyLjI2Niw4NS45NTQgTDEzNS44MDUsNzEuNzg2IEMxMzUuNDQ1LDcwLjk5NyAxMzQuODEzLDcwLjU4IDEzMy45NzcsNzAuNTggQzEzMi45MjEsNzAuNTggMTMxLjY3Niw3MS4yNTIgMTMwLjU2Miw3Mi40MjQgQzEyOS41NCw3My41MDEgMTI4LjcxMSw3NC45MzEgMTI4LjI4Nyw3Ni4zNDggTDEyMS44MjcsOTcuOTc2IEMxMjEuODEsOTguMDM0IDEyMS43NzEsOTguMDgyIDEyMS43Miw5OC4xMTIgTDk0LjM5OCwxMTMuODg2IEM5NC4zNjIsMTEzLjkwNyA5NC4zMjIsMTEzLjkxNyA5NC4yODIsMTEzLjkxNyBMOTQuMjgyLDExMy45MTcgWiBNOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDExMy4yNzkgTDEyMS40MDYsOTcuNzU0IEwxMjcuODQsNzYuMjE1IEMxMjguMjksNzQuNzA4IDEyOS4xMzcsNzMuMjQ3IDEzMC4yMjQsNzIuMTAzIEMxMzEuNDI1LDcwLjgzOCAxMzIuNzkzLDcwLjExMiAxMzMuOTc3LDcwLjExMiBDMTM0Ljk5NSw3MC4xMTIgMTM1Ljc5NSw3MC42MzggMTM2LjIzLDcxLjU5MiBMMTQyLjU4NCw4NS41MjYgTDE2OS41NjYsNjkuOTQ4IEwxNjkuNTY2LDE5LjYxNyBMOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDYyLjk0OCBaIiBpZD0iRmlsbC0xOCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMDkuODk0LDkyLjk0MyBMMTA5Ljg5NCw5Mi45NDMgQzEwOC4xMiw5Mi45NDMgMTA2LjY1Myw5Mi4yMTggMTA1LjY1LDkwLjgyMyBDMTA1LjU4Myw5MC43MzEgMTA1LjU5Myw5MC42MSAxMDUuNjczLDkwLjUyOSBDMTA1Ljc1Myw5MC40NDggMTA1Ljg4LDkwLjQ0IDEwNS45NzQsOTAuNTA2IEMxMDYuNzU0LDkxLjA1MyAxMDcuNjc5LDkxLjMzMyAxMDguNzI0LDkxLjMzMyBDMTEwLjA0Nyw5MS4zMzMgMTExLjQ3OCw5MC44OTQgMTEyLjk4LDkwLjAyNyBDMTE4LjI5MSw4Ni45NiAxMjIuNjExLDc5LjUwOSAxMjIuNjExLDczLjQxNiBDMTIyLjYxMSw3MS40ODkgMTIyLjE2OSw2OS44NTYgMTIxLjMzMyw2OC42OTIgQzEyMS4yNjYsNjguNiAxMjEuMjc2LDY4LjQ3MyAxMjEuMzU2LDY4LjM5MiBDMTIxLjQzNiw2OC4zMTEgMTIxLjU2Myw2OC4yOTkgMTIxLjY1Niw2OC4zNjUgQzEyMy4zMjcsNjkuNTM3IDEyNC4yNDcsNzEuNzQ2IDEyNC4yNDcsNzQuNTg0IEMxMjQuMjQ3LDgwLjgyNiAxMTkuODIxLDg4LjQ0NyAxMTQuMzgyLDkxLjU4NyBDMTEyLjgwOCw5Mi40OTUgMTExLjI5OCw5Mi45NDMgMTA5Ljg5NCw5Mi45NDMgTDEwOS44OTQsOTIuOTQzIFogTTEwNi45MjUsOTEuNDAxIEMxMDcuNzM4LDkyLjA1MiAxMDguNzQ1LDkyLjI3OCAxMDkuODkzLDkyLjI3OCBMMTA5Ljg5NCw5Mi4yNzggQzExMS4yMTUsOTIuMjc4IDExMi42NDcsOTEuOTUxIDExNC4xNDgsOTEuMDg0IEMxMTkuNDU5LDg4LjAxNyAxMjMuNzgsODAuNjIxIDEyMy43OCw3NC41MjggQzEyMy43OCw3Mi41NDkgMTIzLjMxNyw3MC45MjkgMTIyLjQ1NCw2OS43NjcgQzEyMi44NjUsNzAuODAyIDEyMy4wNzksNzIuMDQyIDEyMy4wNzksNzMuNDAyIEMxMjMuMDc5LDc5LjY0NSAxMTguNjUzLDg3LjI4NSAxMTMuMjE0LDkwLjQyNSBDMTExLjY0LDkxLjMzNCAxMTAuMTMsOTEuNzQyIDEwOC43MjQsOTEuNzQyIEMxMDguMDgzLDkxLjc0MiAxMDcuNDgxLDkxLjU5MyAxMDYuOTI1LDkxLjQwMSBMMTA2LjkyNSw5MS40MDEgWiIgaWQ9IkZpbGwtMTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjA5Nyw5MC4yMyBDMTE4LjQ4MSw4Ny4xMjIgMTIyLjg0NSw3OS41OTQgMTIyLjg0NSw3My40MTYgQzEyMi44NDUsNzEuMzY1IDEyMi4zNjIsNjkuNzI0IDEyMS41MjIsNjguNTU2IEMxMTkuNzM4LDY3LjMwNCAxMTcuMTQ4LDY3LjM2MiAxMTQuMjY1LDY5LjAyNiBDMTA4Ljg4MSw3Mi4xMzQgMTA0LjUxNyw3OS42NjIgMTA0LjUxNyw4NS44NCBDMTA0LjUxNyw4Ny44OTEgMTA1LDg5LjUzMiAxMDUuODQsOTAuNyBDMTA3LjYyNCw5MS45NTIgMTEwLjIxNCw5MS44OTQgMTEzLjA5Nyw5MC4yMyIgaWQ9IkZpbGwtMjAiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTA4LjcyNCw5MS42MTQgTDEwOC43MjQsOTEuNjE0IEMxMDcuNTgyLDkxLjYxNCAxMDYuNTY2LDkxLjQwMSAxMDUuNzA1LDkwLjc5NyBDMTA1LjY4NCw5MC43ODMgMTA1LjY2NSw5MC44MTEgMTA1LjY1LDkwLjc5IEMxMDQuNzU2LDg5LjU0NiAxMDQuMjgzLDg3Ljg0MiAxMDQuMjgzLDg1LjgxNyBDMTA0LjI4Myw3OS41NzUgMTA4LjcwOSw3MS45NTMgMTE0LjE0OCw2OC44MTIgQzExNS43MjIsNjcuOTA0IDExNy4yMzIsNjcuNDQ5IDExOC42MzgsNjcuNDQ5IEMxMTkuNzgsNjcuNDQ5IDEyMC43OTYsNjcuNzU4IDEyMS42NTYsNjguMzYyIEMxMjEuNjc4LDY4LjM3NyAxMjEuNjk3LDY4LjM5NyAxMjEuNzEyLDY4LjQxOCBDMTIyLjYwNiw2OS42NjIgMTIzLjA3OSw3MS4zOSAxMjMuMDc5LDczLjQxNSBDMTIzLjA3OSw3OS42NTggMTE4LjY1Myw4Ny4xOTggMTEzLjIxNCw5MC4zMzggQzExMS42NCw5MS4yNDcgMTEwLjEzLDkxLjYxNCAxMDguNzI0LDkxLjYxNCBMMTA4LjcyNCw5MS42MTQgWiBNMTA2LjAwNiw5MC41MDUgQzEwNi43OCw5MS4wMzcgMTA3LjY5NCw5MS4yODEgMTA4LjcyNCw5MS4yODEgQzExMC4wNDcsOTEuMjgxIDExMS40NzgsOTAuODY4IDExMi45OCw5MC4wMDEgQzExOC4yOTEsODYuOTM1IDEyMi42MTEsNzkuNDk2IDEyMi42MTEsNzMuNDAzIEMxMjIuNjExLDcxLjQ5NCAxMjIuMTc3LDY5Ljg4IDEyMS4zNTYsNjguNzE4IEMxMjAuNTgyLDY4LjE4NSAxMTkuNjY4LDY3LjkxOSAxMTguNjM4LDY3LjkxOSBDMTE3LjMxNSw2Ny45MTkgMTE1Ljg4Myw2OC4zNiAxMTQuMzgyLDY5LjIyNyBDMTA5LjA3MSw3Mi4yOTMgMTA0Ljc1MSw3OS43MzMgMTA0Ljc1MSw4NS44MjYgQzEwNC43NTEsODcuNzM1IDEwNS4xODUsODkuMzQzIDEwNi4wMDYsOTAuNTA1IEwxMDYuMDA2LDkwLjUwNSBaIiBpZD0iRmlsbC0yMSIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDkuMzE4LDcuMjYyIEwxMzkuMzM0LDE2LjE0IEwxNTUuMjI3LDI3LjE3MSBMMTYwLjgxNiwyMS4wNTkgTDE0OS4zMTgsNy4yNjIiIGlkPSJGaWxsLTIyIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS42NzYsMTMuODQgTDE1OS45MjgsMTkuNDY3IEMxNTYuMjg2LDIxLjU3IDE1MC40LDIxLjU4IDE0Ni43ODEsMTkuNDkxIEMxNDMuMTYxLDE3LjQwMiAxNDMuMTgsMTQuMDAzIDE0Ni44MjIsMTEuOSBMMTU2LjMxNyw2LjI5MiBMMTQ5LjU4OCwyLjQwNyBMNjcuNzUyLDQ5LjQ3OCBMMTEzLjY3NSw3NS45OTIgTDExNi43NTYsNzQuMjEzIEMxMTcuMzg3LDczLjg0OCAxMTcuNjI1LDczLjMxNSAxMTcuMzc0LDcyLjgyMyBDMTE1LjAxNyw2OC4xOTEgMTE0Ljc4MSw2My4yNzcgMTE2LjY5MSw1OC41NjEgQzEyMi4zMjksNDQuNjQxIDE0MS4yLDMzLjc0NiAxNjUuMzA5LDMwLjQ5MSBDMTczLjQ3OCwyOS4zODggMTgxLjk4OSwyOS41MjQgMTkwLjAxMywzMC44ODUgQzE5MC44NjUsMzEuMDMgMTkxLjc4OSwzMC44OTMgMTkyLjQyLDMwLjUyOCBMMTk1LjUwMSwyOC43NSBMMTY5LjY3NiwxMy44NCIgaWQ9IkZpbGwtMjMiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3Ni40NTkgQzExMy41OTQsNzYuNDU5IDExMy41MTQsNzYuNDM4IDExMy40NDIsNzYuMzk3IEw2Ny41MTgsNDkuODgyIEM2Ny4zNzQsNDkuNzk5IDY3LjI4NCw0OS42NDUgNjcuMjg1LDQ5LjQ3OCBDNjcuMjg1LDQ5LjMxMSA2Ny4zNzQsNDkuMTU3IDY3LjUxOSw0OS4wNzMgTDE0OS4zNTUsMi4wMDIgQzE0OS40OTksMS45MTkgMTQ5LjY3NywxLjkxOSAxNDkuODIxLDIuMDAyIEwxNTYuNTUsNS44ODcgQzE1Ni43NzQsNi4wMTcgMTU2Ljg1LDYuMzAyIDE1Ni43MjIsNi41MjYgQzE1Ni41OTIsNi43NDkgMTU2LjMwNyw2LjgyNiAxNTYuMDgzLDYuNjk2IEwxNDkuNTg3LDIuOTQ2IEw2OC42ODcsNDkuNDc5IEwxMTMuNjc1LDc1LjQ1MiBMMTE2LjUyMyw3My44MDggQzExNi43MTUsNzMuNjk3IDExNy4xNDMsNzMuMzk5IDExNi45NTgsNzMuMDM1IEMxMTQuNTQyLDY4LjI4NyAxMTQuMyw2My4yMjEgMTE2LjI1OCw1OC4zODUgQzExOS4wNjQsNTEuNDU4IDEyNS4xNDMsNDUuMTQzIDEzMy44NCw0MC4xMjIgQzE0Mi40OTcsMzUuMTI0IDE1My4zNTgsMzEuNjMzIDE2NS4yNDcsMzAuMDI4IEMxNzMuNDQ1LDI4LjkyMSAxODIuMDM3LDI5LjA1OCAxOTAuMDkxLDMwLjQyNSBDMTkwLjgzLDMwLjU1IDE5MS42NTIsMzAuNDMyIDE5Mi4xODYsMzAuMTI0IEwxOTQuNTY3LDI4Ljc1IEwxNjkuNDQyLDE0LjI0NCBDMTY5LjIxOSwxNC4xMTUgMTY5LjE0MiwxMy44MjkgMTY5LjI3MSwxMy42MDYgQzE2OS40LDEzLjM4MiAxNjkuNjg1LDEzLjMwNiAxNjkuOTA5LDEzLjQzNSBMMTk1LjczNCwyOC4zNDUgQzE5NS44NzksMjguNDI4IDE5NS45NjgsMjguNTgzIDE5NS45NjgsMjguNzUgQzE5NS45NjgsMjguOTE2IDE5NS44NzksMjkuMDcxIDE5NS43MzQsMjkuMTU0IEwxOTIuNjUzLDMwLjkzMyBDMTkxLjkzMiwzMS4zNSAxOTAuODksMzEuNTA4IDE4OS45MzUsMzEuMzQ2IEMxODEuOTcyLDI5Ljk5NSAxNzMuNDc4LDI5Ljg2IDE2NS4zNzIsMzAuOTU0IEMxNTMuNjAyLDMyLjU0MyAxNDIuODYsMzUuOTkzIDEzNC4zMDcsNDAuOTMxIEMxMjUuNzkzLDQ1Ljg0NyAxMTkuODUxLDUyLjAwNCAxMTcuMTI0LDU4LjczNiBDMTE1LjI3LDYzLjMxNCAxMTUuNTAxLDY4LjExMiAxMTcuNzksNzIuNjExIEMxMTguMTYsNzMuMzM2IDExNy44NDUsNzQuMTI0IDExNi45OSw3NC42MTcgTDExMy45MDksNzYuMzk3IEMxMTMuODM2LDc2LjQzOCAxMTMuNzU2LDc2LjQ1OSAxMTMuNjc1LDc2LjQ1OSIgaWQ9IkZpbGwtMjQiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUzLjMxNiwyMS4yNzkgQzE1MC45MDMsMjEuMjc5IDE0OC40OTUsMjAuNzUxIDE0Ni42NjQsMTkuNjkzIEMxNDQuODQ2LDE4LjY0NCAxNDMuODQ0LDE3LjIzMiAxNDMuODQ0LDE1LjcxOCBDMTQzLjg0NCwxNC4xOTEgMTQ0Ljg2LDEyLjc2MyAxNDYuNzA1LDExLjY5OCBMMTU2LjE5OCw2LjA5MSBDMTU2LjMwOSw2LjAyNSAxNTYuNDUyLDYuMDYyIDE1Ni41MTgsNi4xNzMgQzE1Ni41ODMsNi4yODQgMTU2LjU0Nyw2LjQyNyAxNTYuNDM2LDYuNDkzIEwxNDYuOTQsMTIuMTAyIEMxNDUuMjQ0LDEzLjA4MSAxNDQuMzEyLDE0LjM2NSAxNDQuMzEyLDE1LjcxOCBDMTQ0LjMxMiwxNy4wNTggMTQ1LjIzLDE4LjMyNiAxNDYuODk3LDE5LjI4OSBDMTUwLjQ0NiwyMS4zMzggMTU2LjI0LDIxLjMyNyAxNTkuODExLDE5LjI2NSBMMTY5LjU1OSwxMy42MzcgQzE2OS42NywxMy41NzMgMTY5LjgxMywxMy42MTEgMTY5Ljg3OCwxMy43MjMgQzE2OS45NDMsMTMuODM0IDE2OS45MDQsMTMuOTc3IDE2OS43OTMsMTQuMDQyIEwxNjAuMDQ1LDE5LjY3IEMxNTguMTg3LDIwLjc0MiAxNTUuNzQ5LDIxLjI3OSAxNTMuMzE2LDIxLjI3OSIgaWQ9IkZpbGwtMjUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3NS45OTIgTDY3Ljc2Miw0OS40ODQiIGlkPSJGaWxsLTI2IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMy42NzUsNzYuMzQyIEMxMTMuNjE1LDc2LjM0MiAxMTMuNTU1LDc2LjMyNyAxMTMuNSw3Ni4yOTUgTDY3LjU4Nyw0OS43ODcgQzY3LjQxOSw0OS42OSA2Ny4zNjIsNDkuNDc2IDY3LjQ1OSw0OS4zMDkgQzY3LjU1Niw0OS4xNDEgNjcuNzcsNDkuMDgzIDY3LjkzNyw0OS4xOCBMMTEzLjg1LDc1LjY4OCBDMTE0LjAxOCw3NS43ODUgMTE0LjA3NSw3NiAxMTMuOTc4LDc2LjE2NyBDMTEzLjkxNCw3Ni4yNzkgMTEzLjc5Niw3Ni4zNDIgMTEzLjY3NSw3Ni4zNDIiIGlkPSJGaWxsLTI3IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY3Ljc2Miw0OS40ODQgTDY3Ljc2MiwxMDMuNDg1IEM2Ny43NjIsMTA0LjU3NSA2OC41MzIsMTA1LjkwMyA2OS40ODIsMTA2LjQ1MiBMMTExLjk1NSwxMzAuOTczIEMxMTIuOTA1LDEzMS41MjIgMTEzLjY3NSwxMzEuMDgzIDExMy42NzUsMTI5Ljk5MyBMMTEzLjY3NSw3NS45OTIiIGlkPSJGaWxsLTI4IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMi43MjcsMTMxLjU2MSBDMTEyLjQzLDEzMS41NjEgMTEyLjEwNywxMzEuNDY2IDExMS43OCwxMzEuMjc2IEw2OS4zMDcsMTA2Ljc1NSBDNjguMjQ0LDEwNi4xNDIgNjcuNDEyLDEwNC43MDUgNjcuNDEyLDEwMy40ODUgTDY3LjQxMiw0OS40ODQgQzY3LjQxMiw0OS4yOSA2Ny41NjksNDkuMTM0IDY3Ljc2Miw0OS4xMzQgQzY3Ljk1Niw0OS4xMzQgNjguMTEzLDQ5LjI5IDY4LjExMyw0OS40ODQgTDY4LjExMywxMDMuNDg1IEM2OC4xMTMsMTA0LjQ0NSA2OC44MiwxMDUuNjY1IDY5LjY1NywxMDYuMTQ4IEwxMTIuMTMsMTMwLjY3IEMxMTIuNDc0LDEzMC44NjggMTEyLjc5MSwxMzAuOTEzIDExMywxMzAuNzkyIEMxMTMuMjA2LDEzMC42NzMgMTEzLjMyNSwxMzAuMzgxIDExMy4zMjUsMTI5Ljk5MyBMMTEzLjMyNSw3NS45OTIgQzExMy4zMjUsNzUuNzk4IDExMy40ODIsNzUuNjQxIDExMy42NzUsNzUuNjQxIEMxMTMuODY5LDc1LjY0MSAxMTQuMDI1LDc1Ljc5OCAxMTQuMDI1LDc1Ljk5MiBMMTE0LjAyNSwxMjkuOTkzIEMxMTQuMDI1LDEzMC42NDggMTEzLjc4NiwxMzEuMTQ3IDExMy4zNSwxMzEuMzk5IEMxMTMuMTYyLDEzMS41MDcgMTEyLjk1MiwxMzEuNTYxIDExMi43MjcsMTMxLjU2MSIgaWQ9IkZpbGwtMjkiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEyLjg2LDQwLjUxMiBDMTEyLjg2LDQwLjUxMiAxMTIuODYsNDAuNTEyIDExMi44NTksNDAuNTEyIEMxMTAuNTQxLDQwLjUxMiAxMDguMzYsMzkuOTkgMTA2LjcxNywzOS4wNDEgQzEwNS4wMTIsMzguMDU3IDEwNC4wNzQsMzYuNzI2IDEwNC4wNzQsMzUuMjkyIEMxMDQuMDc0LDMzLjg0NyAxMDUuMDI2LDMyLjUwMSAxMDYuNzU0LDMxLjUwNCBMMTE4Ljc5NSwyNC41NTEgQzEyMC40NjMsMjMuNTg5IDEyMi42NjksMjMuMDU4IDEyNS4wMDcsMjMuMDU4IEMxMjcuMzI1LDIzLjA1OCAxMjkuNTA2LDIzLjU4MSAxMzEuMTUsMjQuNTMgQzEzMi44NTQsMjUuNTE0IDEzMy43OTMsMjYuODQ1IDEzMy43OTMsMjguMjc4IEMxMzMuNzkzLDI5LjcyNCAxMzIuODQxLDMxLjA2OSAxMzEuMTEzLDMyLjA2NyBMMTE5LjA3MSwzOS4wMTkgQzExNy40MDMsMzkuOTgyIDExNS4xOTcsNDAuNTEyIDExMi44Niw0MC41MTIgTDExMi44Niw0MC41MTIgWiBNMTI1LjAwNywyMy43NTkgQzEyMi43OSwyMy43NTkgMTIwLjcwOSwyNC4yNTYgMTE5LjE0NiwyNS4xNTggTDEwNy4xMDQsMzIuMTEgQzEwNS42MDIsMzIuOTc4IDEwNC43NzQsMzQuMTA4IDEwNC43NzQsMzUuMjkyIEMxMDQuNzc0LDM2LjQ2NSAxMDUuNTg5LDM3LjU4MSAxMDcuMDY3LDM4LjQzNCBDMTA4LjYwNSwzOS4zMjMgMTEwLjY2MywzOS44MTIgMTEyLjg1OSwzOS44MTIgTDExMi44NiwzOS44MTIgQzExNS4wNzYsMzkuODEyIDExNy4xNTgsMzkuMzE1IDExOC43MjEsMzguNDEzIEwxMzAuNzYyLDMxLjQ2IEMxMzIuMjY0LDMwLjU5MyAxMzMuMDkyLDI5LjQ2MyAxMzMuMDkyLDI4LjI3OCBDMTMzLjA5MiwyNy4xMDYgMTMyLjI3OCwyNS45OSAxMzAuOCwyNS4xMzYgQzEyOS4yNjEsMjQuMjQ4IDEyNy4yMDQsMjMuNzU5IDEyNS4wMDcsMjMuNzU5IEwxMjUuMDA3LDIzLjc1OSBaIiBpZD0iRmlsbC0zMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNjUuNjMsMTYuMjE5IEwxNTkuODk2LDE5LjUzIEMxNTYuNzI5LDIxLjM1OCAxNTEuNjEsMjEuMzY3IDE0OC40NjMsMTkuNTUgQzE0NS4zMTYsMTcuNzMzIDE0NS4zMzIsMTQuNzc4IDE0OC40OTksMTIuOTQ5IEwxNTQuMjMzLDkuNjM5IEwxNjUuNjMsMTYuMjE5IiBpZD0iRmlsbC0zMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNTQuMjMzLDEwLjQ0OCBMMTY0LjIyOCwxNi4yMTkgTDE1OS41NDYsMTguOTIzIEMxNTguMTEyLDE5Ljc1IDE1Ni4xOTQsMjAuMjA2IDE1NC4xNDcsMjAuMjA2IEMxNTIuMTE4LDIwLjIwNiAxNTAuMjI0LDE5Ljc1NyAxNDguODE0LDE4Ljk0MyBDMTQ3LjUyNCwxOC4xOTkgMTQ2LjgxNCwxNy4yNDkgMTQ2LjgxNCwxNi4yNjkgQzE0Ni44MTQsMTUuMjc4IDE0Ny41MzcsMTQuMzE0IDE0OC44NSwxMy41NTYgTDE1NC4yMzMsMTAuNDQ4IE0xNTQuMjMzLDkuNjM5IEwxNDguNDk5LDEyLjk0OSBDMTQ1LjMzMiwxNC43NzggMTQ1LjMxNiwxNy43MzMgMTQ4LjQ2MywxOS41NSBDMTUwLjAzMSwyMC40NTUgMTUyLjA4NiwyMC45MDcgMTU0LjE0NywyMC45MDcgQzE1Ni4yMjQsMjAuOTA3IDE1OC4zMDYsMjAuNDQ3IDE1OS44OTYsMTkuNTMgTDE2NS42MywxNi4yMTkgTDE1NC4yMzMsOS42MzkiIGlkPSJGaWxsLTMyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NS40NDUsNzIuNjY3IEwxNDUuNDQ1LDcyLjY2NyBDMTQzLjY3Miw3Mi42NjcgMTQyLjIwNCw3MS44MTcgMTQxLjIwMiw3MC40MjIgQzE0MS4xMzUsNzAuMzMgMTQxLjE0NSw3MC4xNDcgMTQxLjIyNSw3MC4wNjYgQzE0MS4zMDUsNjkuOTg1IDE0MS40MzIsNjkuOTQ2IDE0MS41MjUsNzAuMDExIEMxNDIuMzA2LDcwLjU1OSAxNDMuMjMxLDcwLjgyMyAxNDQuMjc2LDcwLjgyMiBDMTQ1LjU5OCw3MC44MjIgMTQ3LjAzLDcwLjM3NiAxNDguNTMyLDY5LjUwOSBDMTUzLjg0Miw2Ni40NDMgMTU4LjE2Myw1OC45ODcgMTU4LjE2Myw1Mi44OTQgQzE1OC4xNjMsNTAuOTY3IDE1Ny43MjEsNDkuMzMyIDE1Ni44ODQsNDguMTY4IEMxNTYuODE4LDQ4LjA3NiAxNTYuODI4LDQ3Ljk0OCAxNTYuOTA4LDQ3Ljg2NyBDMTU2Ljk4OCw0Ny43ODYgMTU3LjExNCw0Ny43NzQgMTU3LjIwOCw0Ny44NCBDMTU4Ljg3OCw0OS4wMTIgMTU5Ljc5OCw1MS4yMiAxNTkuNzk4LDU0LjA1OSBDMTU5Ljc5OCw2MC4zMDEgMTU1LjM3Myw2OC4wNDYgMTQ5LjkzMyw3MS4xODYgQzE0OC4zNiw3Mi4wOTQgMTQ2Ljg1LDcyLjY2NyAxNDUuNDQ1LDcyLjY2NyBMMTQ1LjQ0NSw3Mi42NjcgWiBNMTQyLjQ3Niw3MSBDMTQzLjI5LDcxLjY1MSAxNDQuMjk2LDcyLjAwMiAxNDUuNDQ1LDcyLjAwMiBDMTQ2Ljc2Nyw3Mi4wMDIgMTQ4LjE5OCw3MS41NSAxNDkuNyw3MC42ODIgQzE1NS4wMSw2Ny42MTcgMTU5LjMzMSw2MC4xNTkgMTU5LjMzMSw1NC4wNjUgQzE1OS4zMzEsNTIuMDg1IDE1OC44NjgsNTAuNDM1IDE1OC4wMDYsNDkuMjcyIEMxNTguNDE3LDUwLjMwNyAxNTguNjMsNTEuNTMyIDE1OC42Myw1Mi44OTIgQzE1OC42Myw1OS4xMzQgMTU0LjIwNSw2Ni43NjcgMTQ4Ljc2NSw2OS45MDcgQzE0Ny4xOTIsNzAuODE2IDE0NS42ODEsNzEuMjgzIDE0NC4yNzYsNzEuMjgzIEMxNDMuNjM0LDcxLjI4MyAxNDMuMDMzLDcxLjE5MiAxNDIuNDc2LDcxIEwxNDIuNDc2LDcxIFoiIGlkPSJGaWxsLTMzIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0OC42NDgsNjkuNzA0IEMxNTQuMDMyLDY2LjU5NiAxNTguMzk2LDU5LjA2OCAxNTguMzk2LDUyLjg5MSBDMTU4LjM5Niw1MC44MzkgMTU3LjkxMyw0OS4xOTggMTU3LjA3NCw0OC4wMyBDMTU1LjI4OSw0Ni43NzggMTUyLjY5OSw0Ni44MzYgMTQ5LjgxNiw0OC41MDEgQzE0NC40MzMsNTEuNjA5IDE0MC4wNjgsNTkuMTM3IDE0MC4wNjgsNjUuMzE0IEMxNDAuMDY4LDY3LjM2NSAxNDAuNTUyLDY5LjAwNiAxNDEuMzkxLDcwLjE3NCBDMTQzLjE3Niw3MS40MjcgMTQ1Ljc2NSw3MS4zNjkgMTQ4LjY0OCw2OS43MDQiIGlkPSJGaWxsLTM0IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NC4yNzYsNzEuMjc2IEwxNDQuMjc2LDcxLjI3NiBDMTQzLjEzMyw3MS4yNzYgMTQyLjExOCw3MC45NjkgMTQxLjI1Nyw3MC4zNjUgQzE0MS4yMzYsNzAuMzUxIDE0MS4yMTcsNzAuMzMyIDE0MS4yMDIsNzAuMzExIEMxNDAuMzA3LDY5LjA2NyAxMzkuODM1LDY3LjMzOSAxMzkuODM1LDY1LjMxNCBDMTM5LjgzNSw1OS4wNzMgMTQ0LjI2LDUxLjQzOSAxNDkuNyw0OC4yOTggQzE1MS4yNzMsNDcuMzkgMTUyLjc4NCw0Ni45MjkgMTU0LjE4OSw0Ni45MjkgQzE1NS4zMzIsNDYuOTI5IDE1Ni4zNDcsNDcuMjM2IDE1Ny4yMDgsNDcuODM5IEMxNTcuMjI5LDQ3Ljg1NCAxNTcuMjQ4LDQ3Ljg3MyAxNTcuMjYzLDQ3Ljg5NCBDMTU4LjE1Nyw0OS4xMzggMTU4LjYzLDUwLjg2NSAxNTguNjMsNTIuODkxIEMxNTguNjMsNTkuMTMyIDE1NC4yMDUsNjYuNzY2IDE0OC43NjUsNjkuOTA3IEMxNDcuMTkyLDcwLjgxNSAxNDUuNjgxLDcxLjI3NiAxNDQuMjc2LDcxLjI3NiBMMTQ0LjI3Niw3MS4yNzYgWiBNMTQxLjU1OCw3MC4xMDQgQzE0Mi4zMzEsNzAuNjM3IDE0My4yNDUsNzEuMDA1IDE0NC4yNzYsNzEuMDA1IEMxNDUuNTk4LDcxLjAwNSAxNDcuMDMsNzAuNDY3IDE0OC41MzIsNjkuNiBDMTUzLjg0Miw2Ni41MzQgMTU4LjE2Myw1OS4wMzMgMTU4LjE2Myw1Mi45MzkgQzE1OC4xNjMsNTEuMDMxIDE1Ny43MjksNDkuMzg1IDE1Ni45MDcsNDguMjIzIEMxNTYuMTMzLDQ3LjY5MSAxNTUuMjE5LDQ3LjQwOSAxNTQuMTg5LDQ3LjQwOSBDMTUyLjg2Nyw0Ny40MDkgMTUxLjQzNSw0Ny44NDIgMTQ5LjkzMyw0OC43MDkgQzE0NC42MjMsNTEuNzc1IDE0MC4zMDIsNTkuMjczIDE0MC4zMDIsNjUuMzY2IEMxNDAuMzAyLDY3LjI3NiAxNDAuNzM2LDY4Ljk0MiAxNDEuNTU4LDcwLjEwNCBMMTQxLjU1OCw3MC4xMDQgWiIgaWQ9IkZpbGwtMzUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUwLjcyLDY1LjM2MSBMMTUwLjM1Nyw2NS4wNjYgQzE1MS4xNDcsNjQuMDkyIDE1MS44NjksNjMuMDQgMTUyLjUwNSw2MS45MzggQzE1My4zMTMsNjAuNTM5IDE1My45NzgsNTkuMDY3IDE1NC40ODIsNTcuNTYzIEwxNTQuOTI1LDU3LjcxMiBDMTU0LjQxMiw1OS4yNDUgMTUzLjczMyw2MC43NDUgMTUyLjkxLDYyLjE3MiBDMTUyLjI2Miw2My4yOTUgMTUxLjUyNSw2NC4zNjggMTUwLjcyLDY1LjM2MSIgaWQ9IkZpbGwtMzYiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE1LjkxNyw4NC41MTQgTDExNS41NTQsODQuMjIgQzExNi4zNDQsODMuMjQ1IDExNy4wNjYsODIuMTk0IDExNy43MDIsODEuMDkyIEMxMTguNTEsNzkuNjkyIDExOS4xNzUsNzguMjIgMTE5LjY3OCw3Ni43MTcgTDEyMC4xMjEsNzYuODY1IEMxMTkuNjA4LDc4LjM5OCAxMTguOTMsNzkuODk5IDExOC4xMDYsODEuMzI2IEMxMTcuNDU4LDgyLjQ0OCAxMTYuNzIyLDgzLjUyMSAxMTUuOTE3LDg0LjUxNCIgaWQ9IkZpbGwtMzciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE0LDEzMC40NzYgTDExNCwxMzAuMDA4IEwxMTQsNzYuMDUyIEwxMTQsNzUuNTg0IEwxMTQsNzYuMDUyIEwxMTQsMTMwLjAwOCBMMTE0LDEzMC40NzYiIGlkPSJGaWxsLTM4IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYyLjAwMDAwMCwgMC4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTkuODIyLDM3LjQ3NCBDMTkuODM5LDM3LjMzOSAxOS43NDcsMzcuMTk0IDE5LjU1NSwzNy4wODIgQzE5LjIyOCwzNi44OTQgMTguNzI5LDM2Ljg3MiAxOC40NDYsMzcuMDM3IEwxMi40MzQsNDAuNTA4IEMxMi4zMDMsNDAuNTg0IDEyLjI0LDQwLjY4NiAxMi4yNDMsNDAuNzkzIEMxMi4yNDUsNDAuOTI1IDEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQxLjM3MSBMMTIuMjQ1LDQxLjQxNCBMMTIuMjM4LDQxLjU0MiBDOC4xNDgsNDMuODg3IDUuNjQ3LDQ1LjMyMSA1LjY0Nyw0NS4zMjEgQzUuNjQ2LDQ1LjMyMSAzLjU3LDQ2LjM2NyAyLjg2LDUwLjUxMyBDMi44Niw1MC41MTMgMS45NDgsNTcuNDc0IDEuOTYyLDcwLjI1OCBDMS45NzcsODIuODI4IDIuNTY4LDg3LjMyOCAzLjEyOSw5MS42MDkgQzMuMzQ5LDkzLjI5MyA2LjEzLDkzLjczNCA2LjEzLDkzLjczNCBDNi40NjEsOTMuNzc0IDYuODI4LDkzLjcwNyA3LjIxLDkzLjQ4NiBMODIuNDgzLDQ5LjkzNSBDODQuMjkxLDQ4Ljg2NiA4NS4xNSw0Ni4yMTYgODUuNTM5LDQzLjY1MSBDODYuNzUyLDM1LjY2MSA4Ny4yMTQsMTAuNjczIDg1LjI2NCwzLjc3MyBDODUuMDY4LDMuMDggODQuNzU0LDIuNjkgODQuMzk2LDIuNDkxIEw4Mi4zMSwxLjcwMSBDODEuNTgzLDEuNzI5IDgwLjg5NCwyLjE2OCA4MC43NzYsMi4yMzYgQzgwLjYzNiwyLjMxNyA0MS44MDcsMjQuNTg1IDIwLjAzMiwzNy4wNzIgTDE5LjgyMiwzNy40NzQiIGlkPSJGaWxsLTEiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNODIuMzExLDEuNzAxIEw4NC4zOTYsMi40OTEgQzg0Ljc1NCwyLjY5IDg1LjA2OCwzLjA4IDg1LjI2NCwzLjc3MyBDODcuMjEzLDEwLjY3MyA4Ni43NTEsMzUuNjYgODUuNTM5LDQzLjY1MSBDODUuMTQ5LDQ2LjIxNiA4NC4yOSw0OC44NjYgODIuNDgzLDQ5LjkzNSBMNy4yMSw5My40ODYgQzYuODk3LDkzLjY2NyA2LjU5NSw5My43NDQgNi4zMTQsOTMuNzQ0IEw2LjEzMSw5My43MzMgQzYuMTMxLDkzLjczNCAzLjM0OSw5My4yOTMgMy4xMjgsOTEuNjA5IEMyLjU2OCw4Ny4zMjcgMS45NzcsODIuODI4IDEuOTYzLDcwLjI1OCBDMS45NDgsNTcuNDc0IDIuODYsNTAuNTEzIDIuODYsNTAuNTEzIEMzLjU3LDQ2LjM2NyA1LjY0Nyw0NS4zMjEgNS42NDcsNDUuMzIxIEM1LjY0Nyw0NS4zMjEgOC4xNDgsNDMuODg3IDEyLjIzOCw0MS41NDIgTDEyLjI0NSw0MS40MTQgTDEyLjI0NSw0MS4zNzEgQzEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQwLjkyNSAxMi4yNDMsNDAuNzkzIEMxMi4yNCw0MC42ODYgMTIuMzAyLDQwLjU4MyAxMi40MzQsNDAuNTA4IEwxOC40NDYsMzcuMDM2IEMxOC41NzQsMzYuOTYyIDE4Ljc0NiwzNi45MjYgMTguOTI3LDM2LjkyNiBDMTkuMTQ1LDM2LjkyNiAxOS4zNzYsMzYuOTc5IDE5LjU1NCwzNy4wODIgQzE5Ljc0NywzNy4xOTQgMTkuODM5LDM3LjM0IDE5LjgyMiwzNy40NzQgTDIwLjAzMywzNy4wNzIgQzQxLjgwNiwyNC41ODUgODAuNjM2LDIuMzE4IDgwLjc3NywyLjIzNiBDODAuODk0LDIuMTY4IDgxLjU4MywxLjcyOSA4Mi4zMTEsMS43MDEgTTgyLjMxMSwwLjcwNCBMODIuMjcyLDAuNzA1IEM4MS42NTQsMC43MjggODAuOTg5LDAuOTQ5IDgwLjI5OCwxLjM2MSBMODAuMjc3LDEuMzczIEM4MC4xMjksMS40NTggNTkuNzY4LDEzLjEzNSAxOS43NTgsMzYuMDc5IEMxOS41LDM1Ljk4MSAxOS4yMTQsMzUuOTI5IDE4LjkyNywzNS45MjkgQzE4LjU2MiwzNS45MjkgMTguMjIzLDM2LjAxMyAxNy45NDcsMzYuMTczIEwxMS45MzUsMzkuNjQ0IEMxMS40OTMsMzkuODk5IDExLjIzNiw0MC4zMzQgMTEuMjQ2LDQwLjgxIEwxMS4yNDcsNDAuOTYgTDUuMTY3LDQ0LjQ0NyBDNC43OTQsNDQuNjQ2IDIuNjI1LDQ1Ljk3OCAxLjg3Nyw1MC4zNDUgTDEuODcxLDUwLjM4NCBDMS44NjIsNTAuNDU0IDAuOTUxLDU3LjU1NyAwLjk2NSw3MC4yNTkgQzAuOTc5LDgyLjg3OSAxLjU2OCw4Ny4zNzUgMi4xMzcsOTEuNzI0IEwyLjEzOSw5MS43MzkgQzIuNDQ3LDk0LjA5NCA1LjYxNCw5NC42NjIgNS45NzUsOTQuNzE5IEw2LjAwOSw5NC43MjMgQzYuMTEsOTQuNzM2IDYuMjEzLDk0Ljc0MiA2LjMxNCw5NC43NDIgQzYuNzksOTQuNzQyIDcuMjYsOTQuNjEgNy43MSw5NC4zNSBMODIuOTgzLDUwLjc5OCBDODQuNzk0LDQ5LjcyNyA4NS45ODIsNDcuMzc1IDg2LjUyNSw0My44MDEgQzg3LjcxMSwzNS45ODcgODguMjU5LDEwLjcwNSA4Ni4yMjQsMy41MDIgQzg1Ljk3MSwyLjYwOSA4NS41MiwxLjk3NSA4NC44ODEsMS42MiBMODQuNzQ5LDEuNTU4IEw4Mi42NjQsMC43NjkgQzgyLjU1MSwwLjcyNSA4Mi40MzEsMC43MDQgODIuMzExLDAuNzA0IiBpZD0iRmlsbC0yIiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY2LjI2NywxMS41NjUgTDY3Ljc2MiwxMS45OTkgTDExLjQyMyw0NC4zMjUiIGlkPSJGaWxsLTMiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMjAyLDkwLjU0NSBDMTIuMDI5LDkwLjU0NSAxMS44NjIsOTAuNDU1IDExLjc2OSw5MC4yOTUgQzExLjYzMiw5MC4wNTcgMTEuNzEzLDg5Ljc1MiAxMS45NTIsODkuNjE0IEwzMC4zODksNzguOTY5IEMzMC42MjgsNzguODMxIDMwLjkzMyw3OC45MTMgMzEuMDcxLDc5LjE1MiBDMzEuMjA4LDc5LjM5IDMxLjEyNyw3OS42OTYgMzAuODg4LDc5LjgzMyBMMTIuNDUxLDkwLjQ3OCBMMTIuMjAyLDkwLjU0NSIgaWQ9IkZpbGwtNCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy43NjQsNDIuNjU0IEwxMy42NTYsNDIuNTkyIEwxMy43MDIsNDIuNDIxIEwxOC44MzcsMzkuNDU3IEwxOS4wMDcsMzkuNTAyIEwxOC45NjIsMzkuNjczIEwxMy44MjcsNDIuNjM3IEwxMy43NjQsNDIuNjU0IiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTguNTIsOTAuMzc1IEw4LjUyLDQ2LjQyMSBMOC41ODMsNDYuMzg1IEw3NS44NCw3LjU1NCBMNzUuODQsNTEuNTA4IEw3NS43NzgsNTEuNTQ0IEw4LjUyLDkwLjM3NSBMOC41Miw5MC4zNzUgWiBNOC43Nyw0Ni41NjQgTDguNzcsODkuOTQ0IEw3NS41OTEsNTEuMzY1IEw3NS41OTEsNy45ODUgTDguNzcsNDYuNTY0IEw4Ljc3LDQ2LjU2NCBaIiBpZD0iRmlsbC02IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTI0Ljk4Niw4My4xODIgQzI0Ljc1Niw4My4zMzEgMjQuMzc0LDgzLjU2NiAyNC4xMzcsODMuNzA1IEwxMi42MzIsOTAuNDA2IEMxMi4zOTUsOTAuNTQ1IDEyLjQyNiw5MC42NTggMTIuNyw5MC42NTggTDEzLjI2NSw5MC42NTggQzEzLjU0LDkwLjY1OCAxMy45NTgsOTAuNTQ1IDE0LjE5NSw5MC40MDYgTDI1LjcsODMuNzA1IEMyNS45MzcsODMuNTY2IDI2LjEyOCw4My40NTIgMjYuMTI1LDgzLjQ0OSBDMjYuMTIyLDgzLjQ0NyAyNi4xMTksODMuMjIgMjYuMTE5LDgyLjk0NiBDMjYuMTE5LDgyLjY3MiAyNS45MzEsODIuNTY5IDI1LjcwMSw4Mi43MTkgTDI0Ljk4Niw4My4xODIiIGlkPSJGaWxsLTciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTMuMjY2LDkwLjc4MiBMMTIuNyw5MC43ODIgQzEyLjUsOTAuNzgyIDEyLjM4NCw5MC43MjYgMTIuMzU0LDkwLjYxNiBDMTIuMzI0LDkwLjUwNiAxMi4zOTcsOTAuMzk5IDEyLjU2OSw5MC4yOTkgTDI0LjA3NCw4My41OTcgQzI0LjMxLDgzLjQ1OSAyNC42ODksODMuMjI2IDI0LjkxOCw4My4wNzggTDI1LjYzMyw4Mi42MTQgQzI1LjcyMyw4Mi41NTUgMjUuODEzLDgyLjUyNSAyNS44OTksODIuNTI1IEMyNi4wNzEsODIuNTI1IDI2LjI0NCw4Mi42NTUgMjYuMjQ0LDgyLjk0NiBDMjYuMjQ0LDgzLjE2IDI2LjI0NSw4My4zMDkgMjYuMjQ3LDgzLjM4MyBMMjYuMjUzLDgzLjM4NyBMMjYuMjQ5LDgzLjQ1NiBDMjYuMjQ2LDgzLjUzMSAyNi4yNDYsODMuNTMxIDI1Ljc2Myw4My44MTIgTDE0LjI1OCw5MC41MTQgQzE0LDkwLjY2NSAxMy41NjQsOTAuNzgyIDEzLjI2Niw5MC43ODIgTDEzLjI2Niw5MC43ODIgWiBNMTIuNjY2LDkwLjUzMiBMMTIuNyw5MC41MzMgTDEzLjI2Niw5MC41MzMgQzEzLjUxOCw5MC41MzMgMTMuOTE1LDkwLjQyNSAxNC4xMzIsOTAuMjk5IEwyNS42MzcsODMuNTk3IEMyNS44MDUsODMuNDk5IDI1LjkzMSw4My40MjQgMjUuOTk4LDgzLjM4MyBDMjUuOTk0LDgzLjI5OSAyNS45OTQsODMuMTY1IDI1Ljk5NCw4Mi45NDYgTDI1Ljg5OSw4Mi43NzUgTDI1Ljc2OCw4Mi44MjQgTDI1LjA1NCw4My4yODcgQzI0LjgyMiw4My40MzcgMjQuNDM4LDgzLjY3MyAyNC4yLDgzLjgxMiBMMTIuNjk1LDkwLjUxNCBMMTIuNjY2LDkwLjUzMiBMMTIuNjY2LDkwLjUzMiBaIiBpZD0iRmlsbC04IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEzLjI2Niw4OS44NzEgTDEyLjcsODkuODcxIEMxMi41LDg5Ljg3MSAxMi4zODQsODkuODE1IDEyLjM1NCw4OS43MDUgQzEyLjMyNCw4OS41OTUgMTIuMzk3LDg5LjQ4OCAxMi41NjksODkuMzg4IEwyNC4wNzQsODIuNjg2IEMyNC4zMzIsODIuNTM1IDI0Ljc2OCw4Mi40MTggMjUuMDY3LDgyLjQxOCBMMjUuNjMyLDgyLjQxOCBDMjUuODMyLDgyLjQxOCAyNS45NDgsODIuNDc0IDI1Ljk3OCw4Mi41ODQgQzI2LjAwOCw4Mi42OTQgMjUuOTM1LDgyLjgwMSAyNS43NjMsODIuOTAxIEwxNC4yNTgsODkuNjAzIEMxNCw4OS43NTQgMTMuNTY0LDg5Ljg3MSAxMy4yNjYsODkuODcxIEwxMy4yNjYsODkuODcxIFogTTEyLjY2Niw4OS42MjEgTDEyLjcsODkuNjIyIEwxMy4yNjYsODkuNjIyIEMxMy41MTgsODkuNjIyIDEzLjkxNSw4OS41MTUgMTQuMTMyLDg5LjM4OCBMMjUuNjM3LDgyLjY4NiBMMjUuNjY3LDgyLjY2OCBMMjUuNjMyLDgyLjY2NyBMMjUuMDY3LDgyLjY2NyBDMjQuODE1LDgyLjY2NyAyNC40MTgsODIuNzc1IDI0LjIsODIuOTAxIEwxMi42OTUsODkuNjAzIEwxMi42NjYsODkuNjIxIEwxMi42NjYsODkuNjIxIFoiIGlkPSJGaWxsLTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMzcsOTAuODAxIEwxMi4zNyw4OS41NTQgTDEyLjM3LDkwLjgwMSIgaWQ9IkZpbGwtMTAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi4xMyw5My45MDEgQzUuMzc5LDkzLjgwOCA0LjgxNiw5My4xNjQgNC42OTEsOTIuNTI1IEMzLjg2LDg4LjI4NyAzLjU0LDgzLjc0MyAzLjUyNiw3MS4xNzMgQzMuNTExLDU4LjM4OSA0LjQyMyw1MS40MjggNC40MjMsNTEuNDI4IEM1LjEzNCw0Ny4yODIgNy4yMSw0Ni4yMzYgNy4yMSw0Ni4yMzYgQzcuMjEsNDYuMjM2IDgxLjY2NywzLjI1IDgyLjA2OSwzLjAxNyBDODIuMjkyLDIuODg4IDg0LjU1NiwxLjQzMyA4NS4yNjQsMy45NCBDODcuMjE0LDEwLjg0IDg2Ljc1MiwzNS44MjcgODUuNTM5LDQzLjgxOCBDODUuMTUsNDYuMzgzIDg0LjI5MSw0OS4wMzMgODIuNDgzLDUwLjEwMSBMNy4yMSw5My42NTMgQzYuODI4LDkzLjg3NCA2LjQ2MSw5My45NDEgNi4xMyw5My45MDEgQzYuMTMsOTMuOTAxIDMuMzQ5LDkzLjQ2IDMuMTI5LDkxLjc3NiBDMi41NjgsODcuNDk1IDEuOTc3LDgyLjk5NSAxLjk2Miw3MC40MjUgQzEuOTQ4LDU3LjY0MSAyLjg2LDUwLjY4IDIuODYsNTAuNjggQzMuNTcsNDYuNTM0IDUuNjQ3LDQ1LjQ4OSA1LjY0Nyw0NS40ODkgQzUuNjQ2LDQ1LjQ4OSA4LjA2NSw0NC4wOTIgMTIuMjQ1LDQxLjY3OSBMMTMuMTE2LDQxLjU2IEwxOS43MTUsMzcuNzMgTDE5Ljc2MSwzNy4yNjkgTDYuMTMsOTMuOTAxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjMxNyw5NC4xNjEgTDYuMTAyLDk0LjE0OCBMNi4xMDEsOTQuMTQ4IEw1Ljg1Nyw5NC4xMDEgQzUuMTM4LDkzLjk0NSAzLjA4NSw5My4zNjUgMi44ODEsOTEuODA5IEMyLjMxMyw4Ny40NjkgMS43MjcsODIuOTk2IDEuNzEzLDcwLjQyNSBDMS42OTksNTcuNzcxIDIuNjA0LDUwLjcxOCAyLjYxMyw1MC42NDggQzMuMzM4LDQ2LjQxNyA1LjQ0NSw0NS4zMSA1LjUzNSw0NS4yNjYgTDEyLjE2Myw0MS40MzkgTDEzLjAzMyw0MS4zMiBMMTkuNDc5LDM3LjU3OCBMMTkuNTEzLDM3LjI0NCBDMTkuNTI2LDM3LjEwNyAxOS42NDcsMzcuMDA4IDE5Ljc4NiwzNy4wMjEgQzE5LjkyMiwzNy4wMzQgMjAuMDIzLDM3LjE1NiAyMC4wMDksMzcuMjkzIEwxOS45NSwzNy44ODIgTDEzLjE5OCw0MS44MDEgTDEyLjMyOCw0MS45MTkgTDUuNzcyLDQ1LjcwNCBDNS43NDEsNDUuNzIgMy43ODIsNDYuNzcyIDMuMTA2LDUwLjcyMiBDMy4wOTksNTAuNzgyIDIuMTk4LDU3LjgwOCAyLjIxMiw3MC40MjQgQzIuMjI2LDgyLjk2MyAyLjgwOSw4Ny40MiAzLjM3Myw5MS43MjkgQzMuNDY0LDkyLjQyIDQuMDYyLDkyLjg4MyA0LjY4Miw5My4xODEgQzQuNTY2LDkyLjk4NCA0LjQ4Niw5Mi43NzYgNC40NDYsOTIuNTcyIEMzLjY2NSw4OC41ODggMy4yOTEsODQuMzcgMy4yNzYsNzEuMTczIEMzLjI2Miw1OC41MiA0LjE2Nyw1MS40NjYgNC4xNzYsNTEuMzk2IEM0LjkwMSw0Ny4xNjUgNy4wMDgsNDYuMDU5IDcuMDk4LDQ2LjAxNCBDNy4wOTQsNDYuMDE1IDgxLjU0MiwzLjAzNCA4MS45NDQsMi44MDIgTDgxLjk3MiwyLjc4NSBDODIuODc2LDIuMjQ3IDgzLjY5MiwyLjA5NyA4NC4zMzIsMi4zNTIgQzg0Ljg4NywyLjU3MyA4NS4yODEsMy4wODUgODUuNTA0LDMuODcyIEM4Ny41MTgsMTEgODYuOTY0LDM2LjA5MSA4NS43ODUsNDMuODU1IEM4NS4yNzgsNDcuMTk2IDg0LjIxLDQ5LjM3IDgyLjYxLDUwLjMxNyBMNy4zMzUsOTMuODY5IEM2Ljk5OSw5NC4wNjMgNi42NTgsOTQuMTYxIDYuMzE3LDk0LjE2MSBMNi4zMTcsOTQuMTYxIFogTTYuMTcsOTMuNjU0IEM2LjQ2Myw5My42OSA2Ljc3NCw5My42MTcgNy4wODUsOTMuNDM3IEw4Mi4zNTgsNDkuODg2IEM4NC4xODEsNDguODA4IDg0Ljk2LDQ1Ljk3MSA4NS4yOTIsNDMuNzggQzg2LjQ2NiwzNi4wNDkgODcuMDIzLDExLjA4NSA4NS4wMjQsNC4wMDggQzg0Ljg0NiwzLjM3NyA4NC41NTEsMi45NzYgODQuMTQ4LDIuODE2IEM4My42NjQsMi42MjMgODIuOTgyLDIuNzY0IDgyLjIyNywzLjIxMyBMODIuMTkzLDMuMjM0IEM4MS43OTEsMy40NjYgNy4zMzUsNDYuNDUyIDcuMzM1LDQ2LjQ1MiBDNy4zMDQsNDYuNDY5IDUuMzQ2LDQ3LjUyMSA0LjY2OSw1MS40NzEgQzQuNjYyLDUxLjUzIDMuNzYxLDU4LjU1NiAzLjc3NSw3MS4xNzMgQzMuNzksODQuMzI4IDQuMTYxLDg4LjUyNCA0LjkzNiw5Mi40NzYgQzUuMDI2LDkyLjkzNyA1LjQxMiw5My40NTkgNS45NzMsOTMuNjE1IEM2LjA4Nyw5My42NCA2LjE1OCw5My42NTIgNi4xNjksOTMuNjU0IEw2LjE3LDkzLjY1NCBMNi4xNyw5My42NTQgWiIgaWQ9IkZpbGwtMTIiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4zMTcsNjguOTgyIEM3LjgwNiw2OC43MDEgOC4yMDIsNjguOTI2IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNi44MjksNzEuMjk0IDYuNDMzLDcxLjA2OSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIiBpZD0iRmlsbC0xMyIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjkyLDcxLjEzMyBDNi42MzEsNzEuMTMzIDYuNDMzLDcwLjkwNSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIEM3LjQ2LDY4LjkgNy41OTUsNjguODYxIDcuNzE0LDY4Ljg2MSBDOC4wMDMsNjguODYxIDguMjAyLDY5LjA5IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNy4xNzQsNzEuMDk0IDcuMDM5LDcxLjEzMyA2LjkyLDcxLjEzMyBNNy43MTQsNjguNjc0IEM3LjU1Nyw2OC42NzQgNy4zOTIsNjguNzIzIDcuMjI0LDY4LjgyMSBDNi42NzYsNjkuMTM4IDYuMjQ2LDY5Ljg3OSA2LjI0Niw3MC41MDggQzYuMjQ2LDcwLjk5NCA2LjUxNyw3MS4zMiA2LjkyLDcxLjMyIEM3LjA3OCw3MS4zMiA3LjI0Myw3MS4yNzEgNy40MTEsNzEuMTc0IEM3Ljk1OSw3MC44NTcgOC4zODksNzAuMTE3IDguMzg5LDY5LjQ4NyBDOC4zODksNjkuMDAxIDguMTE3LDY4LjY3NCA3LjcxNCw2OC42NzQiIGlkPSJGaWxsLTE0IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYuOTIsNzAuOTQ3IEM2LjY0OSw3MC45NDcgNi42MjEsNzAuNjQgNi42MjEsNzAuNTA4IEM2LjYyMSw3MC4wMTcgNi45ODIsNjkuMzkyIDcuNDExLDY5LjE0NSBDNy41MjEsNjkuMDgyIDcuNjI1LDY5LjA0OSA3LjcxNCw2OS4wNDkgQzcuOTg2LDY5LjA0OSA4LjAxNSw2OS4zNTUgOC4wMTUsNjkuNDg3IEM4LjAxNSw2OS45NzggNy42NTIsNzAuNjAzIDcuMjI0LDcwLjg1MSBDNy4xMTUsNzAuOTE0IDcuMDEsNzAuOTQ3IDYuOTIsNzAuOTQ3IE03LjcxNCw2OC44NjEgQzcuNTk1LDY4Ljg2MSA3LjQ2LDY4LjkgNy4zMTcsNjguOTgyIEM2LjgyOSw2OS4yNjUgNi40MzMsNjkuOTQ4IDYuNDMzLDcwLjUwOCBDNi40MzMsNzAuOTA1IDYuNjMxLDcxLjEzMyA2LjkyLDcxLjEzMyBDNy4wMzksNzEuMTMzIDcuMTc0LDcxLjA5NCA3LjMxNyw3MS4wMTIgQzcuODA2LDcwLjczIDguMjAyLDcwLjA0NyA4LjIwMiw2OS40ODcgQzguMjAyLDY5LjA5IDguMDAzLDY4Ljg2MSA3LjcxNCw2OC44NjEiIGlkPSJGaWxsLTE1IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcuNDQ0LDg1LjM1IEM3LjcwOCw4NS4xOTggNy45MjEsODUuMzE5IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuOTI1IDcuNzA4LDg2LjI5MiA3LjQ0NCw4Ni40NDQgQzcuMTgxLDg2LjU5NyA2Ljk2Nyw4Ni40NzUgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IiBpZD0iRmlsbC0xNiIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik03LjIzLDg2LjUxIEM3LjA3NCw4Ni41MSA2Ljk2Nyw4Ni4zODcgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IEM3LjUyMSw4NS4zMDUgNy41OTQsODUuMjg0IDcuNjU4LDg1LjI4NCBDNy44MTQsODUuMjg0IDcuOTIxLDg1LjQwOCA3LjkyMSw4NS42MjIgQzcuOTIxLDg1LjkyNSA3LjcwOCw4Ni4yOTIgNy40NDQsODYuNDQ0IEM3LjM2Nyw4Ni40ODkgNy4yOTQsODYuNTEgNy4yMyw4Ni41MSBNNy42NTgsODUuMDk4IEM3LjU1OCw4NS4wOTggNy40NTUsODUuMTI3IDcuMzUxLDg1LjE4OCBDNy4wMzEsODUuMzczIDYuNzgxLDg1LjgwNiA2Ljc4MSw4Ni4xNzMgQzYuNzgxLDg2LjQ4MiA2Ljk2Niw4Ni42OTcgNy4yMyw4Ni42OTcgQzcuMzMsODYuNjk3IDcuNDMzLDg2LjY2NiA3LjUzOCw4Ni42MDcgQzcuODU4LDg2LjQyMiA4LjEwOCw4NS45ODkgOC4xMDgsODUuNjIyIEM4LjEwOCw4NS4zMTMgNy45MjMsODUuMDk4IDcuNjU4LDg1LjA5OCIgaWQ9IkZpbGwtMTciIGZpbGw9IiM4MDk3QTIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4yMyw4Ni4zMjIgTDcuMTU0LDg2LjE3MyBDNy4xNTQsODUuOTM4IDcuMzMzLDg1LjYyOSA3LjUzOCw4NS41MTIgTDcuNjU4LDg1LjQ3MSBMNy43MzQsODUuNjIyIEM3LjczNCw4NS44NTYgNy41NTUsODYuMTY0IDcuMzUxLDg2LjI4MiBMNy4yMyw4Ni4zMjIgTTcuNjU4LDg1LjI4NCBDNy41OTQsODUuMjg0IDcuNTIxLDg1LjMwNSA3LjQ0NCw4NS4zNSBDNy4xODEsODUuNTAyIDYuOTY3LDg1Ljg3MSA2Ljk2Nyw4Ni4xNzMgQzYuOTY3LDg2LjM4NyA3LjA3NCw4Ni41MSA3LjIzLDg2LjUxIEM3LjI5NCw4Ni41MSA3LjM2Nyw4Ni40ODkgNy40NDQsODYuNDQ0IEM3LjcwOCw4Ni4yOTIgNy45MjEsODUuOTI1IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuNDA4IDcuODE0LDg1LjI4NCA3LjY1OCw4NS4yODQiIGlkPSJGaWxsLTE4IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTc3LjI3OCw3Ljc2OSBMNzcuMjc4LDUxLjQzNiBMMTAuMjA4LDkwLjE2IEwxMC4yMDgsNDYuNDkzIEw3Ny4yNzgsNy43NjkiIGlkPSJGaWxsLTE5IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEwLjA4Myw5MC4zNzUgTDEwLjA4Myw0Ni40MjEgTDEwLjE0Niw0Ni4zODUgTDc3LjQwMyw3LjU1NCBMNzcuNDAzLDUxLjUwOCBMNzcuMzQxLDUxLjU0NCBMMTAuMDgzLDkwLjM3NSBMMTAuMDgzLDkwLjM3NSBaIE0xMC4zMzMsNDYuNTY0IEwxMC4zMzMsODkuOTQ0IEw3Ny4xNTQsNTEuMzY1IEw3Ny4xNTQsNy45ODUgTDEwLjMzMyw0Ni41NjQgTDEwLjMzMyw0Ni41NjQgWiIgaWQ9IkZpbGwtMjAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMjUuNzM3LDg4LjY0NyBMMTE4LjA5OCw5MS45ODEgTDExOC4wOTgsODQgTDEwNi42MzksODguNzEzIEwxMDYuNjM5LDk2Ljk4MiBMOTksMTAwLjMxNSBMMTEyLjM2OSwxMDMuOTYxIEwxMjUuNzM3LDg4LjY0NyIgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTIiIGZpbGw9IiM0NTVBNjQiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+";function Le(){this.loadIcon_();var e=document.createElement("div");var t=e.style;t.position="fixed";t.top=0;t.right=0;t.bottom=0;t.left=0;t.backgroundColor="gray";t.fontFamily="sans-serif";t.zIndex=1e6;var r=document.createElement("img");r.src=this.icon;var t=r.style;t.marginLeft="25%";t.marginTop="25%";t.width="50%";e.appendChild(r);var i=document.createElement("div");var t=i.style;t.textAlign="center";t.fontSize="16px";t.lineHeight="24px";t.margin="24px 25%";t.width="50%";i.innerHTML="Place your phone into your Cardboard viewer.";e.appendChild(i);var n=document.createElement("div");var t=n.style;t.backgroundColor="#CFD8DC";t.position="fixed";t.bottom=0;t.width="100%";t.height="48px";t.padding="14px 24px";t.boxSizing="border-box";t.color="#656A6B";e.appendChild(n);var a=document.createElement("div");a.style.float="left";a.innerHTML="No Cardboard viewer?";var o=document.createElement("a");o.href="https://www.google.com/get/cardboard/get-cardboard/";o.innerHTML="get one";o.target="_blank";var t=o.style;t.float="right";t.fontWeight=600;t.textTransform="uppercase";t.borderLeft="1px solid gray";t.paddingLeft="24px";t.textDecoration="none";t.color="#656A6B";n.appendChild(a);n.appendChild(o);this.overlay=e;this.text=i;this.hide()}Le.prototype.show=function(e){if(e||this.overlay.parentElement){if(e){this.overlay.parentElement&&this.overlay.parentElement!=e&&this.overlay.parentElement.removeChild(this.overlay);e.appendChild(this.overlay)}}else document.body.appendChild(this.overlay);this.overlay.style.display="block";var t=this.overlay.querySelector("img");var r=t.style;if(v()){r.width="20%";r.marginLeft="40%";r.marginTop="3%"}else{r.width="50%";r.marginLeft="25%";r.marginTop="25%"}};Le.prototype.hide=function(){this.overlay.style.display="none"};Le.prototype.showTemporarily=function(e,t){this.show(t);this.timer=setTimeout(this.hide.bind(this),e)};Le.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)};Le.prototype.update=function(){this.disableShowTemporarily();!v()&&T()?this.show():this.hide()};Le.prototype.loadIcon_=function(){this.icon=o("image/svg+xml",Te)};var Ne="CardboardV1";var De="WEBVR_CARDBOARD_VIEWER";var Ce="webvr-polyfill-viewer-selector";function Se(){try{this.selectedKey=localStorage.getItem(De)}catch(e){console.error("Failed to load viewer profile: %s",e)}this.selectedKey||(this.selectedKey=Ne);this.dialog=this.createDialog_(se.Viewers);this.root=null;this.onChangeCallbacks_=[]}Se.prototype.show=function(e){this.root=e;e.appendChild(this.dialog);var t=this.dialog.querySelector("#"+this.selectedKey);t.checked=true;this.dialog.style.display="block"};Se.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog);this.dialog.style.display="none"};Se.prototype.getCurrentViewer=function(){return se.Viewers[this.selectedKey]};Se.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");if(e)return e.id;return null};Se.prototype.onChange=function(e){this.onChangeCallbacks_.push(e)};Se.prototype.fireOnChange_=function(e){for(var t=0;t<this.onChangeCallbacks_.length;t++)this.onChangeCallbacks_[t](e)};Se.prototype.onSave_=function(){this.selectedKey=this.getSelectedKey_();if(!this.selectedKey||!se.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(se.Viewers[this.selectedKey]);try{localStorage.setItem(De,this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()};Se.prototype.createDialog_=function(e){var t=document.createElement("div");t.classList.add(Ce);t.style.display="none";var r=document.createElement("div");var i=r.style;i.position="fixed";i.left=0;i.top=0;i.width="100%";i.height="100%";i.background="rgba(0, 0, 0, 0.3)";r.addEventListener("click",this.hide.bind(this));var n=280;var a=document.createElement("div");var i=a.style;i.boxSizing="border-box";i.position="fixed";i.top="24px";i.left="50%";i.marginLeft=-n/2+"px";i.width=n+"px";i.padding="24px";i.overflow="hidden";i.background="#fafafa";i.fontFamily="'Roboto', sans-serif";i.boxShadow="0px 5px 20px #666";a.appendChild(this.createH1_("Select your viewer"));for(var o in e)a.appendChild(this.createChoice_(o,e[o].label));a.appendChild(this.createButton_("Save",this.onSave_.bind(this)));t.appendChild(r);t.appendChild(a);return t};Se.prototype.createH1_=function(e){var t=document.createElement("h1");var r=t.style;r.color="black";r.fontSize="20px";r.fontWeight="bold";r.marginTop=0;r.marginBottom="24px";t.innerHTML=e;return t};Se.prototype.createChoice_=function(e,t){var r=document.createElement("div");r.style.marginTop="8px";r.style.color="black";var i=document.createElement("input");i.style.fontSize="30px";i.setAttribute("id",e);i.setAttribute("type","radio");i.setAttribute("value",e);i.setAttribute("name","field");var n=document.createElement("label");n.style.marginLeft="4px";n.setAttribute("for",e);n.innerHTML=t;r.appendChild(i);r.appendChild(n);return r};Se.prototype.createButton_=function(e,t){var r=document.createElement("button");r.innerHTML=e;var i=r.style;i.float="right";i.textTransform="uppercase";i.color="#1094f7";i.fontSize="14px";i.letterSpacing=0;i.border=0;i.background="none";i.marginTop="16px";r.addEventListener("click",t);return r};var Ie="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{};function _e(e){return e&&e.__esModule?e["default"]:e}function Oe(e,t){return t={exports:{}},e(t,t.exports),t.exports}var je=Oe(function(e,t){(function t(r,i){e.exports=i()})(Ie,function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:false,exports:{}};e[i].call(n.exports,n,n.exports,r);n.l=true;return n.exports}r.m=e;r.c=t;r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:false,enumerable:true,get:i})};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=0)}([function(e,t,r){var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(e,i.key,i)}}return function(t,r,i){r&&e(t.prototype,r);i&&e(t,i);return t}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=r(1);var o="undefined"!==typeof navigator&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream;var s=function(){function e(){n(this,e);if(o)this.noSleepTimer=null;else{this.noSleepVideo=document.createElement("video");this.noSleepVideo.setAttribute("playsinline","");this.noSleepVideo.setAttribute("src",a);this.noSleepVideo.addEventListener("timeupdate",function(e){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this))}}i(e,[{key:"enable",value:function e(){if(o){this.disable();this.noSleepTimer=window.setInterval(function(){window.location.href="/";window.setTimeout(window.stop,0)},15e3)}else this.noSleepVideo.play()}},{key:"disable",value:function e(){if(o){if(this.noSleepTimer){window.clearInterval(this.noSleepTimer);this.noSleepTimer=null}}else this.noSleepVideo.pause()}}]);return e}();e.exports=s},function(e,t,r){e.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})});var Re=_e(je);var ze=1e3;var ke=[0,0,.5,1];var Pe=[.5,0,.5,1];var Ue=window.requestAnimationFrame;var Be=window.cancelAnimationFrame;function Fe(){this.leftProjectionMatrix=new Float32Array(16);this.leftViewMatrix=new Float32Array(16);this.rightProjectionMatrix=new Float32Array(16);this.rightViewMatrix=new Float32Array(16);this.pose=null}function Ge(e){Object.defineProperties(this,{hasPosition:{writable:false,enumerable:true,value:e.hasPosition},hasExternalDisplay:{writable:false,enumerable:true,value:e.hasExternalDisplay},canPresent:{writable:false,enumerable:true,value:e.canPresent},maxLayers:{writable:false,enumerable:true,value:e.maxLayers},hasOrientation:{enumerable:true,get:function t(){O("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData");return e.hasOrientation}}})}function He(e){e=e||{};var t=!("wakelock"in e)||e.wakelock;this.isPolyfilled=true;this.displayId=ze++;this.displayName="";this.depthNear=.01;this.depthFar=1e4;this.isPresenting=false;Object.defineProperty(this,"isConnected",{get:function e(){O("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay");return false}});this.capabilities=new Ge({hasPosition:false,hasOrientation:false,hasExternalDisplay:false,canPresent:false,maxLayers:1});this.stageParameters=null;this.waitingForPresent_=false;this.layer_=null;this.originalParent_=null;this.fullscreenElement_=null;this.fullscreenWrapper_=null;this.fullscreenElementCachedStyle_=null;this.fullscreenEventTarget_=null;this.fullscreenChangeHandler_=null;this.fullscreenErrorHandler_=null;t&&T()&&(this.wakelock_=new Re)}He.prototype.getFrameData=function(e){return D(e,this._getPose(),this)};He.prototype.getPose=function(){O("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData");return this._getPose()};He.prototype.resetPose=function(){O("VRDisplay.prototype.resetPose");return this._resetPose()};He.prototype.getImmediatePose=function(){O("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData");return this._getPose()};He.prototype.requestAnimationFrame=function(e){return Ue(e)};He.prototype.cancelAnimationFrame=function(e){return Be(e)};He.prototype.wrapForFullscreen=function(e){if(u())return e;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var t=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",t.join("; ")+";");this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e)return this.fullscreenWrapper_;this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_));this.fullscreenElement_=e;this.originalParent_=e.parentElement;this.originalParent_||document.body.appendChild(e);if(!this.fullscreenWrapper_.parentElement){var r=this.fullscreenElement_.parentElement;r.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_);r.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild);this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var i=this;function n(){if(!i.fullscreenElement_)return;var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];i.fullscreenElement_.setAttribute("style",e.join("; ")+";")}n();return this.fullscreenWrapper_};He.prototype.removeFullscreenWrapper=function(){if(!this.fullscreenElement_)return;var e=this.fullscreenElement_;this.fullscreenElementCachedStyle_?e.setAttribute("style",this.fullscreenElementCachedStyle_):e.removeAttribute("style");this.fullscreenElement_=null;this.fullscreenElementCachedStyle_=null;var t=this.fullscreenWrapper_.parentElement;this.fullscreenWrapper_.removeChild(e);this.originalParent_===t?t.insertBefore(e,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(e);t.removeChild(this.fullscreenWrapper_);return e};He.prototype.requestPresent=function(e){var t=this.isPresenting;var r=this;if(!(e instanceof Array)){O("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument");e=[e]}return new Promise(function(i,n){if(!r.capabilities.canPresent){n(new Error("VRDisplay is not capable of presenting."));return}if(0==e.length||e.length>r.capabilities.maxLayers){n(new Error("Invalid number of layers."));return}var a=e[0];if(!a.source){i();return}var o=a.leftBounds||ke;var s=a.rightBounds||Pe;if(t){var l=r.layer_;l.source!==a.source&&(l.source=a.source);for(var h=0;h<4;h++){l.leftBounds[h]=o[h];l.rightBounds[h]=s[h]}r.wrapForFullscreen(r.layer_.source);r.updatePresent_();i();return}r.layer_={predistorted:a.predistorted,source:a.source,leftBounds:o.slice(0),rightBounds:s.slice(0)};r.waitingForPresent_=false;if(r.layer_&&r.layer_.source){var d=r.wrapForFullscreen(r.layer_.source);var p=function e(){var t=w();r.isPresenting=d===t;if(r.isPresenting){screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(e){console.error("screen.orientation.lock() failed due to",e.message)});r.waitingForPresent_=false;r.beginPresent_();i()}else{screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();r.removeFullscreenWrapper();r.disableWakeLock();r.endPresent_();r.removeFullscreenListeners_()}r.fireVRDisplayPresentChange_()};var f=function e(){if(!r.waitingForPresent_)return;r.removeFullscreenWrapper();r.removeFullscreenListeners_();r.disableWakeLock();r.waitingForPresent_=false;r.isPresenting=false;n(new Error("Unable to present."))};r.addFullscreenListeners_(d,p,f);if(A(d)){r.enableWakeLock();r.waitingForPresent_=true}else if(u()||c()){r.enableWakeLock();r.isPresenting=true;r.beginPresent_();r.fireVRDisplayPresentChange_();i()}}if(!r.waitingForPresent_&&!u()){M();n(new Error("Unable to present."))}})};He.prototype.exitPresent=function(){var e=this.isPresenting;var t=this;this.isPresenting=false;this.layer_=null;this.disableWakeLock();return new Promise(function(r,i){if(e){if(!M()&&u()){t.endPresent_();t.fireVRDisplayPresentChange_()}if(c()){t.removeFullscreenWrapper();t.removeFullscreenListeners_();t.endPresent_();t.fireVRDisplayPresentChange_()}r()}else i(new Error("Was not presenting to VRDisplay."))})};He.prototype.getLayers=function(){if(this.layer_)return[this.layer_];return[]};He.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)};He.prototype.fireVRDisplayConnect_=function(){var e=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(e)};He.prototype.addFullscreenListeners_=function(e,t,r){this.removeFullscreenListeners_();this.fullscreenEventTarget_=e;this.fullscreenChangeHandler_=t;this.fullscreenErrorHandler_=r;t&&(document.fullscreenEnabled?e.addEventListener("fullscreenchange",t,false):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenchange",t,false):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",t,false):document.msFullscreenEnabled&&e.addEventListener("msfullscreenchange",t,false));r&&(document.fullscreenEnabled?e.addEventListener("fullscreenerror",r,false):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenerror",r,false):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",r,false):document.msFullscreenEnabled&&e.addEventListener("msfullscreenerror",r,false))};He.prototype.removeFullscreenListeners_=function(){if(!this.fullscreenEventTarget_)return;var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var t=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",t,false);e.removeEventListener("webkitfullscreenchange",t,false);document.removeEventListener("mozfullscreenchange",t,false);e.removeEventListener("msfullscreenchange",t,false)}if(this.fullscreenErrorHandler_){var r=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",r,false);e.removeEventListener("webkitfullscreenerror",r,false);document.removeEventListener("mozfullscreenerror",r,false);e.removeEventListener("msfullscreenerror",r,false)}this.fullscreenEventTarget_=null;this.fullscreenChangeHandler_=null;this.fullscreenErrorHandler_=null};He.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()};He.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()};He.prototype.beginPresent_=function(){};He.prototype.endPresent_=function(){};He.prototype.submitFrame=function(e){};He.prototype.getEyeParameters=function(e){return null};var Ve={MOBILE_WAKE_LOCK:true,DEBUG:false,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:false,ROTATE_INSTRUCTIONS_DISABLED:false,YAW_ONLY:false,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:false};var Qe={LEFT:"left",RIGHT:"right"};function Ye(e){var t=L({},Ve);e=L(t,e||{});He.call(this,{wakelock:e.MOBILE_WAKE_LOCK});this.config=e;this.displayName="Cardboard VRDisplay";this.capabilities=new Ge({hasPosition:false,hasOrientation:true,hasExternalDisplay:false,canPresent:true,maxLayers:1});this.stageParameters=null;this.bufferScale_=this.config.BUFFER_SCALE;this.poseSensor_=new be(this.config);this.distorter_=null;this.cardboardUI_=null;this.dpdb_=new pe(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this));this.deviceInfo_=new se(this.dpdb_.getDeviceParams());this.viewerSelector_=new Se;this.viewerSelector_.onChange(this.onViewerChanged_.bind(this));this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer());this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new Le);u()&&window.addEventListener("resize",this.onResize_.bind(this))}Ye.prototype=Object.create(He.prototype);Ye.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}};Ye.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()};Ye.prototype._getFieldOfView=function(e){var t;if(e==Qe.LEFT)t=this.deviceInfo_.getFieldOfViewLeftEye();else{if(e!=Qe.RIGHT){console.error("Invalid eye provided: %s",e);return null}t=this.deviceInfo_.getFieldOfViewRightEye()}return t};Ye.prototype._getEyeOffset=function(e){var t;if(e==Qe.LEFT)t=[.5*-this.deviceInfo_.viewer.interLensDistance,0,0];else{if(e!=Qe.RIGHT){console.error("Invalid eye provided: %s",e);return null}t=[.5*this.deviceInfo_.viewer.interLensDistance,0,0]}return t};Ye.prototype.getEyeParameters=function(e){var t=this._getEyeOffset(e);var r=this._getFieldOfView(e);var i={offset:t,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};Object.defineProperty(i,"fieldOfView",{enumerable:true,get:function e(){O("VRFieldOfView","VRFrameData's projection matrices");return r}});return i};Ye.prototype.onDeviceParamsUpdated_=function(e){this.config.DEBUG&&console.log("DPDB reported that device params were updated.");this.deviceInfo_.updateDeviceParams(e);this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)};Ye.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)};Ye.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");e||(e=this.layer_.source.getContext("experimental-webgl"));e||(e=this.layer_.source.getContext("webgl2"));if(!e)return;if(this.layer_.predistorted){if(!this.config.CARDBOARD_UI_DISABLED){e.canvas.width=g()*this.bufferScale_;e.canvas.height=y()*this.bufferScale_;this.cardboardUI_=new J(e)}}else{this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new J(e));this.distorter_=new P(e,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS);this.distorter_.updateDeviceInfo(this.deviceInfo_)}this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement);e.stopPropagation();e.preventDefault()}.bind(this),function(e){this.exitPresent();e.stopPropagation();e.preventDefault()}.bind(this));this.rotateInstructions_&&(v()&&T()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update());this.orientationHandler=this.onOrientationChange_.bind(this);window.addEventListener("orientationchange",this.orientationHandler);this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this);window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler);this.fireVRDisplayDeviceParamsChange_()};Ye.prototype.endPresent_=function(){if(this.distorter_){this.distorter_.destroy();this.distorter_=null}if(this.cardboardUI_){this.cardboardUI_.destroy();this.cardboardUI_=null}this.rotateInstructions_&&this.rotateInstructions_.hide();this.viewerSelector_.hide();window.removeEventListener("orientationchange",this.orientationHandler);window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)};Ye.prototype.updatePresent_=function(){this.endPresent_();this.beginPresent_()};Ye.prototype.submitFrame=function(e){if(this.distorter_){this.updateBounds_();this.distorter_.submitFrame()}else if(this.cardboardUI_&&this.layer_){var t=this.layer_.source.getContext("webgl").canvas;t.width==this.lastWidth&&t.height==this.lastHeight||this.cardboardUI_.onResize();this.lastWidth=t.width;this.lastHeight=t.height;this.cardboardUI_.render()}};Ye.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide();this.rotateInstructions_&&this.rotateInstructions_.update();this.onResize_()};Ye.prototype.onResize_=function(e){if(this.layer_){var t=this.layer_.source.getContext("webgl");var r=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];t.canvas.setAttribute("style",r.join("; ")+";");N(t.canvas)}};Ye.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e);this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_);this.fireVRDisplayDeviceParamsChange_()};Ye.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)};Ye.VRFrameData=Fe;Ye.VRDisplay=He;return Ye})});var c=r(u);var l="0.10.5";var h={PROVIDE_MOBILE_VRDISPLAY:true,GET_VR_DISPLAYS_TIMEOUT:1e3,MOBILE_WAKE_LOCK:true,DEBUG:false,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,TOUCH_PANNER_DISABLED:true,CARDBOARD_UI_DISABLED:false,ROTATE_INSTRUCTIONS_DISABLED:false,YAW_ONLY:false,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:false};function d(e){this.config=s(s({},h),e);this.polyfillDisplays=[];this.enabled=false;this.hasNative="getVRDisplays"in navigator;this.native={};this.native.getVRDisplays=navigator.getVRDisplays;this.native.VRFrameData=window.VRFrameData;this.native.VRDisplay=window.VRDisplay;if(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&a()){this.enable();this.getVRDisplays().then(function(e){e&&e[0]&&e[0].fireVRDisplayConnect_&&e[0].fireVRDisplayConnect_()})}}d.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(a()){var e=new c({MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,TOUCH_PANNER_DISABLED:this.config.TOUCH_PANNER_DISABLED,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(e)}this._polyfillDisplaysPopulated=true;return this.polyfillDisplays};d.prototype.enable=function(){this.enabled=true;if(this.hasNative&&this.native.VRFrameData){var e=this.native.VRFrameData;var t=new this.native.VRFrameData;var r=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(i){if(i instanceof e){r.call(this,i);return}r.call(this,t);i.pose=t.pose;o(t.leftProjectionMatrix,i.leftProjectionMatrix);o(t.rightProjectionMatrix,i.rightProjectionMatrix);o(t.leftViewMatrix,i.leftViewMatrix);o(t.rightViewMatrix,i.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this);window.VRDisplay=c.VRDisplay;window.VRFrameData=c.VRFrameData};d.prototype.getVRDisplays=function(){var e=this;var t=this.config;if(!this.hasNative)return Promise.resolve(this.getPolyfillDisplays());var r;var i=this.native.getVRDisplays.call(navigator);var a=new Promise(function(e){r=setTimeout(function(){console.warn("Native WebVR implementation detected, but `getVRDisplays()` failed to resolve. Falling back to polyfill.");e([])},t.GET_VR_DISPLAYS_TIMEOUT)});return n([i,a]).then(function(t){clearTimeout(r);return t.length>0?t:e.getPolyfillDisplays()})};d.version=l;d.VRFrameData=c.VRFrameData;d.VRDisplay=c.VRDisplay;var p=Object.freeze({default:d});var f=p&&d||p;if("undefined"!==typeof t&&t.window){t.document||(t.document=t.window.document);t.navigator||(t.navigator=t.window.navigator)}var v=f;return v})}).call(this,"undefined"!==typeof r?r:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],47:[function(e,t,r){var i=/\n/;var n="\n";var a=/\s/;t.exports=function(e,r){var i=t.exports.lines(e,r);return i.map(function(t){return e.substring(t.start,t.end)}).join("\n")};t.exports.lines=function e(t,r){r=r||{};if(0===r.width&&"nowrap"!==r.mode)return[];t=t||"";var i="number"===typeof r.width?r.width:Number.MAX_VALUE;var n=Math.max(0,r.start||0);var a="number"===typeof r.end?r.end:t.length;var o=r.mode;var s=r.measure||l;return"pre"===o?u(s,t,n,a,i):c(s,t,n,a,i,o)};function o(e,t,r,i){var n=e.indexOf(t,r);if(-1===n||n>i)return i;return n}function s(e){return a.test(e)}function u(e,t,r,n,a){var o=[];var s=r;for(var u=r;u<n&&u<t.length;u++){var c=t.charAt(u);var l=i.test(c);if(l||u===n-1){var h=l?u:u+1;var d=e(t,s,h,a);o.push(d);s=u+1}}return o}function c(e,t,r,i,a,u){var c=[];var l=a;"nowrap"===u&&(l=Number.MAX_VALUE);while(r<i&&r<t.length){var h=o(t,n,r,i);while(r<h){if(!s(t.charAt(r)))break;r++}var d=e(t,r,h,l);var p=r+(d.end-d.start);var f=p+n.length;if(p<h){while(p>r){if(s(t.charAt(p)))break;p--}if(p===r){f>r+n.length&&f--;p=f}else{f=p;while(p>r){if(!s(t.charAt(p-n.length)))break;p--}}}if(p>=r){var v=e(t,r,p,l);c.push(v)}r=f}return c}function l(e,t,r,i){var n=Math.min(i,r-t);return{start:t,end:t+n}}},{}],48:[function(e,t,r){"use strict";var i=e("global/window");var n=e("is-function");var a=e("parse-headers");var o=e("xtend");t.exports=l;l.XMLHttpRequest=i.XMLHttpRequest||p;l.XDomainRequest="withCredentials"in new l.XMLHttpRequest?l.XMLHttpRequest:i.XDomainRequest;s(["get","put","post","patch","head","delete"],function(e){l["delete"===e?"del":e]=function(t,r,i){r=c(t,r,i);r.method=e.toUpperCase();return h(r)}});function s(e,t){for(var r=0;r<e.length;r++)t(e[r])}function u(e){for(var t in e)if(e.hasOwnProperty(t))return false;return true}function c(e,t,r){var i=e;if(n(t)){r=t;"string"===typeof e&&(i={uri:e})}else i=o(t,{uri:e});i.callback=r;return i}function l(e,t,r){t=c(e,t,r);return h(t)}function h(e){if("undefined"===typeof e.callback)throw new Error("callback argument missing");var t=false;var r=function r(i,n,a){if(!t){t=true;e.callback(i,n,a)}};function i(){4===c.readyState&&setTimeout(s,0)}function n(){var e=void 0;e=c.response?c.response:c.responseText||d(c);if(A)try{e=JSON.parse(e)}catch(e){}return e}function o(e){clearTimeout(M);e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error")));e.statusCode=0;return r(e,w)}function s(){if(p)return;var t;clearTimeout(M);t=e.useXDR&&void 0===c.status?200:1223===c.status?204:c.status;var i=w;var o=null;if(0!==t){i={body:n(),statusCode:t,method:v,headers:{},url:f,rawRequest:c};c.getAllResponseHeaders&&(i.headers=a(c.getAllResponseHeaders()))}else o=new Error("Internal XMLHttpRequest Error");return r(o,i,i.body)}var c=e.xhr||null;c||(c=e.cors||e.useXDR?new l.XDomainRequest:new l.XMLHttpRequest);var h;var p;var f=c.url=e.uri||e.url;var v=c.method=e.method||"GET";var m=e.body||e.data;var g=c.headers=e.headers||{};var y=!!e.sync;var A=false;var M;var w={body:void 0,headers:{},statusCode:0,method:v,url:f,rawRequest:c};if("json"in e&&false!==e.json){A=true;g["accept"]||g["Accept"]||(g["Accept"]="application/json");if("GET"!==v&&"HEAD"!==v){g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json");m=JSON.stringify(true===e.json?m:e.json)}}c.onreadystatechange=i;c.onload=s;c.onerror=o;c.onprogress=function(){};c.onabort=function(){p=true};c.ontimeout=o;c.open(v,f,!y,e.username,e.password);y||(c.withCredentials=!!e.withCredentials);!y&&e.timeout>0&&(M=setTimeout(function(){if(p)return;p=true;c.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT";o(e)},e.timeout));if(c.setRequestHeader)for(h in g)g.hasOwnProperty(h)&&c.setRequestHeader(h,g[h]);else if(e.headers&&!u(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");"responseType"in e&&(c.responseType=e.responseType);"beforeSend"in e&&"function"===typeof e.beforeSend&&e.beforeSend(c);c.send(m||null);return c}function d(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}function p(){}},{"global/window":15,"is-function":19,"parse-headers":30,xtend:50}],49:[function(e,t,r){t.exports=function e(){if("undefined"!==typeof self.DOMParser)return function(e){var t=new self.DOMParser;return t.parseFromString(e,"application/xml")};if("undefined"!==typeof self.ActiveXObject&&new self.ActiveXObject("Microsoft.XMLDOM"))return function(e){var t=new self.ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e);return t};return function(e){var t=document.createElement("div");t.innerHTML=e;return t}}()},{}],50:[function(e,t,r){t.exports=n;var i=Object.prototype.hasOwnProperty;function n(){var e={};for(var t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)i.call(r,n)&&(e[n]=r[n])}return e}},{}],51:[function(e,t,r){t.exports={name:"aframe",version:"0.8.2",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [envify --INSPECTOR_VERSION dev] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",prerelease:"node scripts/release.js 0.7.1 0.8.0",start:"npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",dependencies:{"@tweenjs/tween.js":"^16.8.0","browserify-css":"^0.8.2",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7",envify:"^3.4.1","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","style-attr":"^1.0.2",three:"github:supermedium/three.js#r90fixMTLLoader","three-bmfont-text":"^2.1.0","webvr-polyfill":"^0.10.5"},devDependencies:{browserify:"^13.1.0","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.0.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:true,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:true},engines:{node:">= 4.6.0",npm:"^2.15.9"}}},{}],52:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../lib/three");t.exports.Component=i("camera",{schema:{active:{default:true},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:false},zoom:{default:1,min:0}},init:function(){var e;var t=this.el;e=this.camera=new n.PerspectiveCamera;t.setObject3D("camera",e)},update:function(e){var t=this.data;var r=this.camera;r.aspect=t.aspect||window.innerWidth/window.innerHeight;r.far=t.far;r.fov=t.fov;r.near=t.near;r.zoom=t.zoom;r.updateProjectionMatrix();this.updateActiveCamera(e);this.updateSpectatorCamera(e)},updateActiveCamera:function(e){var t=this.data;var r=this.el;var i=this.system;if(e&&e.active===t.active||t.spectator)return;t.active&&i.activeCameraEl!==r?i.setActiveCamera(r):t.active||i.activeCameraEl!==r||i.disableActiveCamera()},updateSpectatorCamera:function(e){var t=this.data;var r=this.el;var i=this.system;if(e&&e.spectator===t.spectator)return;t.spectator&&i.spectatorCameraEl!==r?i.setSpectatorCamera(r):t.spectator||i.spectatorCameraEl!==r||i.disableSpectatorCamera()},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":102,"../lib/three":150}],53:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../lib/three");t.exports.Component=i("collada-model",{schema:{type:"asset"},init:function(){this.model=null;this.loader=new n.ColladaLoader;this.loader.options.convertUpAxis=true},update:function(){var e=this;var t=this.el;var r=this.data;if(!r)return;this.remove();this.loader.load(r,function(r){e.model=r.scene;t.setObject3D("mesh",e.model);t.emit("model-loaded",{format:"collada",model:e.model})})},remove:function(){if(!this.model)return;this.el.removeObject3D("mesh")}})},{"../core/component":102,"../lib/three":150}],54:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../utils/");var a=n.bind;var o={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"};var s={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"};var u={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]};t.exports.Component=i("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:n.device.isMobile()},fuseTimeout:{default:1500,min:0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var e=this;this.fuseTimeout=void 0;this.cursorDownEl=null;this.intersectedEl=null;this.canvasBounds=document.body.getBoundingClientRect();this.updateCanvasBounds=n.debounce(function t(){e.canvasBounds=e.el.sceneEl.canvas.getBoundingClientRect()},1e3);this.eventDetail={};this.intersectedEventDetail={cursorEl:this.el};this.onCursorDown=a(this.onCursorDown,this);this.onCursorUp=a(this.onCursorUp,this);this.onIntersection=a(this.onIntersection,this);this.onIntersectionCleared=a(this.onIntersectionCleared,this);this.onMouseMove=a(this.onMouseMove,this)},update:function(e){if(this.data.rayOrigin===e.rayOrigin)return;this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var e=this.el;e.removeState(s.HOVERING);e.removeState(s.FUSING);clearTimeout(this.fuseTimeout);this.intersectedEl&&this.intersectedEl.removeState(s.HOVERED);this.removeEventListeners()},addEventListeners:function(){var e;var t=this.data;var r=this.el;var i=this;function n(){e=r.sceneEl.canvas;if(t.downEvents.length||t.upEvents.length)return;u.DOWN.forEach(function(t){e.addEventListener(t,i.onCursorDown)});u.UP.forEach(function(t){e.addEventListener(t,i.onCursorUp)})}e=r.sceneEl.canvas;e?n():r.sceneEl.addEventListener("render-target-loaded",n);t.downEvents.forEach(function(e){r.addEventListener(e,i.onCursorDown)});t.upEvents.forEach(function(e){r.addEventListener(e,i.onCursorUp)});r.addEventListener("raycaster-intersection",this.onIntersection);r.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared);window.addEventListener("resize",this.updateCanvasBounds)},removeEventListeners:function(){var e;var t=this.data;var r=this.el;var i=this;e=r.sceneEl.canvas;if(e&&!t.downEvents.length&&!t.upEvents.length){u.DOWN.forEach(function(t){e.removeEventListener(t,i.onCursorDown)});u.UP.forEach(function(t){e.removeEventListener(t,i.onCursorUp)})}t.downEvents.forEach(function(e){r.removeEventListener(e,i.onCursorDown)});t.upEvents.forEach(function(e){r.removeEventListener(e,i.onCursorUp)});r.removeEventListener("raycaster-intersection",this.onIntersection);r.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared);e.removeEventListener("mousemove",this.onMouseMove);e.removeEventListener("touchstart",this.onMouseMove);e.removeEventListener("touchmove",this.onMouseMove);e.removeEventListener("resize",this.updateCanvasBounds)},updateMouseEventListeners:function(){var e;var t=this.el;e=t.sceneEl.canvas;e.removeEventListener("mousemove",this.onMouseMove);e.removeEventListener("touchmove",this.onMouseMove);t.setAttribute("raycaster","useWorldCoordinates",false);if("mouse"!==this.data.rayOrigin)return;e.addEventListener("mousemove",this.onMouseMove,false);e.addEventListener("touchmove",this.onMouseMove,false);t.setAttribute("raycaster","useWorldCoordinates",true);this.updateCanvasBounds()},onMouseMove:function(){var e=new THREE.Vector3;var t=new THREE.Vector2;var r=new THREE.Vector3;var i={origin:r,direction:e};return function(n){var a=this.canvasBounds;var o=this.el.sceneEl.camera;var s;var u;var c;o.parent.updateMatrixWorld();u="touchmove"===n.type||"touchstart"===n.type?n.touches.item(0):n;s=u.clientX-a.left;c=u.clientY-a.top;t.x=s/a.width*2-1;t.y=-c/a.height*2+1;r.setFromMatrixPosition(o.matrixWorld);e.set(t.x,t.y,.5).unproject(o).sub(r).normalize();this.el.setAttribute("raycaster",i);"touchmove"===n.type&&n.preventDefault()}}(),onCursorDown:function(e){if("mouse"===this.data.rayOrigin&&"touchstart"===e.type){this.onMouseMove(e);this.el.components.raycaster.checkIntersections();e.preventDefault()}this.twoWayEmit(o.MOUSEDOWN);this.cursorDownEl=this.intersectedEl},onCursorUp:function(e){this.twoWayEmit(o.MOUSEUP);if(this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl){this.intersectedEventDetail.intersection=null;this.cursorDownEl.emit(o.MOUSEUP,this.intersectedEventDetail)}!this.data.fuse&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(o.CLICK);this.cursorDownEl=null;"touchend"===e.type&&e.preventDefault()},onIntersection:function(e){var t;var r=this.el;var i;var n;var a;i=e.detail.els[0]===r?1:0;a=e.detail.intersections[i];n=e.detail.els[i];if(!n)return;if(this.intersectedEl===n)return;if(this.intersectedEl){t=this.el.components.raycaster.getIntersection(this.intersectedEl);if(t.distance<=a.distance)return}this.clearCurrentIntersection(true);this.setIntersection(n,a)},onIntersectionCleared:function(e){var t=e.detail.clearedEls;if(-1===t.indexOf(this.intersectedEl))return;this.clearCurrentIntersection()},setIntersection:function(e,t){var r=this.el;var i=this.data;var n=this;if(this.intersectedEl===e)return;this.intersectedEl=e;r.addState(s.HOVERING);e.addState(s.HOVERED);this.twoWayEmit(o.MOUSEENTER);if(0===i.fuseTimeout||!i.fuse)return;r.addState(s.FUSING);this.twoWayEmit(o.FUSING);this.fuseTimeout=setTimeout(function e(){r.removeState(s.FUSING);n.twoWayEmit(o.CLICK)},i.fuseTimeout)},clearCurrentIntersection:function(e){var t;var r;var i;var n=this.el;if(!this.intersectedEl)return;this.intersectedEl.removeState(s.HOVERED);n.removeState(s.HOVERING);n.removeState(s.FUSING);this.twoWayEmit(o.MOUSELEAVE);this.intersectedEl=null;clearTimeout(this.fuseTimeout);if(true===e)return;i=this.el.components.raycaster.intersections;if(0===i.length)return;t=i[0].object.el===n?1:0;r=i[t];if(!r)return;this.setIntersection(r.object.el,r)},twoWayEmit:function(e){var t=this.el;var r=this.intersectedEl;var i;i=this.el.components.raycaster.getIntersection(r);this.eventDetail.intersectedEl=r;this.eventDetail.intersection=i;t.emit(e,this.eventDetail);if(!r)return;this.intersectedEventDetail.intersection=i;r.emit(e,this.intersectedEventDetail)}})},{"../core/component":102,"../utils/":172}],55:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../utils/bind");var a=e("../utils/tracked-controls").checkControllerPresentAndSetup;var o=e("../utils/tracked-controls");var s=o.emitIfAxesChanged;var u=o.onButtonEvent;var c="https://cdn.aframe.io/controllers/google/";var l=c+"vr_controller_daydream.obj";var h=c+"vr_controller_daydream.mtl";var d="Daydream Controller";t.exports.Component=i("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:true},orientationOffset:{type:"vec3"},armModel:{default:true}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},bindMethods:function(){this.onModelLoaded=n(this.onModelLoaded,this);this.onControllersUpdate=n(this.onControllersUpdate,this);this.checkIfControllerPresent=n(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=n(this.removeControllersUpdateListener,this);this.onAxisMoved=n(this.onAxisMoved,this)},init:function(){var e=this;this.animationActive="pointing";this.onButtonChanged=n(this.onButtonChanged,this);this.onButtonDown=function(t){u(t.detail.id,"down",e)};this.onButtonUp=function(t){u(t.detail.id,"up",e)};this.onButtonTouchStart=function(t){u(t.detail.id,"touchstart",e)};this.onButtonTouchEnd=function(t){u(t.detail.id,"touchend",e)};this.onAxisMoved=n(this.onAxisMoved,this);this.controllerPresent=false;this.lastControllerCheck=0;this.bindMethods();this.checkControllerPresentAndSetup=a;this.emitIfAxesChanged=s},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged);e.addEventListener("buttondown",this.onButtonDown);e.addEventListener("buttonup",this.onButtonUp);e.addEventListener("touchstart",this.onButtonTouchStart);e.addEventListener("touchend",this.onButtonTouchEnd);e.addEventListener("model-loaded",this.onModelLoaded);e.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=true},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged);e.removeEventListener("buttondown",this.onButtonDown);e.removeEventListener("buttonup",this.onButtonUp);e.removeEventListener("touchstart",this.onButtonTouchStart);e.removeEventListener("touchend",this.onButtonTouchEnd);e.removeEventListener("model-loaded",this.onModelLoaded);e.removeEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=false},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,d,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=this.el;var t=this.data;e.setAttribute("tracked-controls",{armModel:t.armModel,hand:t.hand,idPrefix:d,orientationOffset:t.orientationOffset});if(!this.data.model)return;this.el.setAttribute("obj-model",{obj:l,mtl:h})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,false)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var t=e.detail.model;var r;if(!this.data.model)return;r=this.buttonMeshes={};r.menu=t.getObjectByName("AppButton_AppButton_Cylinder.004");r.system=t.getObjectByName("HomeButton_HomeButton_Cylinder.005");r.trackpad=t.getObjectByName("TouchPad_TouchPad_Cylinder.003");t.position.set(0,0,-.04)},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];if(!t)return;this.el.emit(t+"changed",e.detail.state)},updateModel:function(e,t){if(!this.data.model)return;this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var r=this.buttonMeshes;if(!r||!r[e])return;var i;switch(t){case"down":i=this.data.buttonHighlightColor;break;case"touchstart":i=this.data.buttonTouchedColor;break;default:i=this.data.buttonColor}r[e].material.color.set(i)}})},{"../core/component":102,"../utils/bind":166,"../utils/tracked-controls":178}],56:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../utils/bind");var a=e("../utils/tracked-controls");var o=a.checkControllerPresentAndSetup;var s=a.emitIfAxesChanged;var u=a.onButtonEvent;var c="https://cdn.aframe.io/controllers/samsung/";var l=c+"gear_vr_controller.obj";var h=c+"gear_vr_controller.mtl";var d="Gear VR|GearVR|Oculus Go";t.exports.Component=i("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:true},orientationOffset:{type:"vec3"},armModel:{default:true}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=n(this.onModelLoaded,this);this.onControllersUpdate=n(this.onControllersUpdate,this);this.checkIfControllerPresent=n(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=n(this.removeControllersUpdateListener,this);this.onAxisMoved=n(this.onAxisMoved,this)},init:function(){var e=this;this.animationActive="pointing";this.onButtonChanged=n(this.onButtonChanged,this);this.onButtonDown=function(t){u(t.detail.id,"down",e)};this.onButtonUp=function(t){u(t.detail.id,"up",e)};this.onButtonTouchStart=function(t){u(t.detail.id,"touchstart",e)};this.onButtonTouchEnd=function(t){u(t.detail.id,"touchend",e)};this.onAxisMoved=n(this.onAxisMoved,this);this.controllerPresent=false;this.lastControllerCheck=0;this.bindMethods();this.checkControllerPresentAndSetup=o;this.emitIfAxesChanged=s},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged);e.addEventListener("buttondown",this.onButtonDown);e.addEventListener("buttonup",this.onButtonUp);e.addEventListener("touchstart",this.onButtonTouchStart);e.addEventListener("touchend",this.onButtonTouchEnd);e.addEventListener("model-loaded",this.onModelLoaded);e.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=true;this.addControllersUpdateListener()},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged);e.removeEventListener("buttondown",this.onButtonDown);e.removeEventListener("buttonup",this.onButtonUp);e.removeEventListener("touchstart",this.onButtonTouchStart);e.removeEventListener("touchend",this.onButtonTouchEnd);e.removeEventListener("model-loaded",this.onModelLoaded);e.removeEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=false;this.removeControllersUpdateListener()},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,d,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},injectTrackedControls:function(){var e=this.el;var t=this.data;e.setAttribute("tracked-controls",{armModel:t.armModel,idPrefix:d,orientationOffset:t.orientationOffset});if(!this.data.model)return;this.el.setAttribute("obj-model",{obj:l,mtl:h})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,false)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(e){var t=e.detail.model;var r;if(!this.data.model)return;r=this.buttonMeshes={};r.trigger=t.children[2];r.trackpad=t.children[1]},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];if(!t)return;this.el.emit(t+"changed",e.detail.state)},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},updateModel:function(e,t){if(!this.data.model)return;this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var r=this.buttonMeshes;if(!r||!r[e])return;var i;switch(t){case"down":i=this.data.buttonHighlightColor;break;case"touchstart":i=this.data.buttonTouchedColor;break;default:i=this.data.buttonColor}r[e].material.color.set(i)}})},{"../core/component":102,"../utils/bind":166,"../utils/tracked-controls":178}],57:[function(e,t,r){var i=e("../core/geometry").geometries;var n=e("../core/geometry").geometryNames;var a=e("../core/component").registerComponent;var o=e("../lib/three");var s=new o.Geometry;t.exports.Component=a("geometry",{schema:{buffer:{default:true},primitive:{default:"box",oneOf:n},skipCache:{default:false}},init:function(){this.geometry=null},update:function(e){var t=this.data;var r=this.el;var i;var n=this.system;if(this.geometry){n.unuseGeometry(e);this.geometry=null}this.geometry=n.getOrCreateGeometry(t);i=r.getObject3D("mesh");if(i)i.geometry=this.geometry;else{i=new o.Mesh;i.geometry=this.geometry;r.setObject3D("mesh",i)}},remove:function(){this.system.unuseGeometry(this.data);this.el.getObject3D("mesh").geometry=s;this.geometry=null},updateSchema:function(e){var t=e.primitive;var r=this.data&&this.data.primitive;var n=i[t]&&i[t].schema;if(!n)throw new Error("Unknown geometry schema `"+t+"`");if(r&&r===t)return;this.extendSchema(n)}})},{"../core/component":102,"../core/geometry":103,"../lib/three":150}],58:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../lib/three");var a=e("../utils/");var o=a.debug("components:gltf-model:warn");t.exports.Component=i("gltf-model",{schema:{type:"model"},init:function(){this.model=null;this.loader=new n.GLTFLoader},update:function(){var e=this;var t=this.el;var r=this.data;if(!r)return;this.remove();this.loader.load(r,function r(i){e.model=i.scene||i.scenes[0];e.model.animations=i.animations;t.setObject3D("mesh",e.model);t.emit("model-loaded",{format:"gltf",model:e.model})},void 0,function e(i){var n=i&&i.message?i.message:"Failed to load glTF model";o(n);t.emit("model-error",{format:"gltf",src:r})})},remove:function(){if(!this.model)return;this.el.removeObject3D("mesh")}})},{"../core/component":102,"../lib/three":150,"../utils/":172}],59:[function(e,t,r){var i=e("../core/component").registerComponent;var n={left:"https://cdn.aframe.io/controllers/oculus-hands/v2/leftHand.json",right:"https://cdn.aframe.io/controllers/oculus-hands/v2/rightHand.json"};var a={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"};var o={};o[a.fist]="grip";o[a.thumbUp]="pistol";o[a.point]="pointing";o[a.thumb]="thumb";t.exports.Component=i("hand-controls",{schema:{default:"left"},init:function(){var e=this;var t=this.el;this.gesture=a.open;this.pressedButtons={};this.touchedButtons={};this.loader=new THREE.ObjectLoader;this.loader.setCrossOrigin("anonymous");this.onGripDown=function(){e.handleButton("grip","down")};this.onGripUp=function(){e.handleButton("grip","up")};this.onTrackpadDown=function(){e.handleButton("trackpad","down")};this.onTrackpadUp=function(){e.handleButton("trackpad","up")};this.onTrackpadTouchStart=function(){e.handleButton("trackpad","touchstart")};this.onTrackpadTouchEnd=function(){e.handleButton("trackpad","touchend")};this.onTriggerDown=function(){e.handleButton("trigger","down")};this.onTriggerUp=function(){e.handleButton("trigger","up")};this.onTriggerTouchStart=function(){e.handleButton("trigger","touchstart")};this.onTriggerTouchEnd=function(){e.handleButton("trigger","touchend")};this.onGripTouchStart=function(){e.handleButton("grip","touchstart")};this.onGripTouchEnd=function(){e.handleButton("grip","touchend")};this.onThumbstickDown=function(){e.handleButton("thumbstick","down")};this.onThumbstickUp=function(){e.handleButton("thumbstick","up")};this.onAorXTouchStart=function(){e.handleButton("AorX","touchstart")};this.onAorXTouchEnd=function(){e.handleButton("AorX","touchend")};this.onBorYTouchStart=function(){e.handleButton("BorY","touchstart")};this.onBorYTouchEnd=function(){e.handleButton("BorY","touchend")};this.onSurfaceTouchStart=function(){e.handleButton("surface","touchstart")};this.onSurfaceTouchEnd=function(){e.handleButton("surface","touchend")};this.onControllerConnected=function(){e.setModelVisibility(true)};this.onControllerDisconnected=function(){e.setModelVisibility(false)};t.addEventListener("controllerconnected",this.onControllerConnected);t.addEventListener("controllerdisconnected",this.onControllerDisconnected)},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(e,t){var r=this.el.getObject3D("mesh");if(!r||!r.mixer)return;r.mixer.update(t/1e3)},addEventListeners:function(){var e=this.el;e.addEventListener("gripdown",this.onGripDown);e.addEventListener("gripup",this.onGripUp);e.addEventListener("trackpaddown",this.onTrackpadDown);e.addEventListener("trackpadup",this.onTrackpadUp);e.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart);e.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd);e.addEventListener("triggerdown",this.onTriggerDown);e.addEventListener("triggerup",this.onTriggerUp);e.addEventListener("triggertouchstart",this.onTriggerTouchStart);e.addEventListener("triggertouchend",this.onTriggerTouchEnd);e.addEventListener("griptouchstart",this.onGripTouchStart);e.addEventListener("griptouchend",this.onGripTouchEnd);e.addEventListener("thumbstickdown",this.onThumbstickDown);e.addEventListener("thumbstickup",this.onThumbstickUp);e.addEventListener("abuttontouchstart",this.onAorXTouchStart);e.addEventListener("abuttontouchend",this.onAorXTouchEnd);e.addEventListener("bbuttontouchstart",this.onBorYTouchStart);e.addEventListener("bbuttontouchend",this.onBorYTouchEnd);e.addEventListener("xbuttontouchstart",this.onAorXTouchStart);e.addEventListener("xbuttontouchend",this.onAorXTouchEnd);e.addEventListener("ybuttontouchstart",this.onBorYTouchStart);e.addEventListener("ybuttontouchend",this.onBorYTouchEnd);e.addEventListener("surfacetouchstart",this.onSurfaceTouchStart);e.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var e=this.el;e.removeEventListener("gripdown",this.onGripDown);e.removeEventListener("gripup",this.onGripUp);e.removeEventListener("trackpaddown",this.onTrackpadDown);e.removeEventListener("trackpadup",this.onTrackpadUp);e.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart);e.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd);e.removeEventListener("triggerdown",this.onTriggerDown);e.removeEventListener("triggerup",this.onTriggerUp);e.removeEventListener("triggertouchstart",this.onTriggerTouchStart);e.removeEventListener("triggertouchend",this.onTriggerTouchEnd);e.removeEventListener("griptouchstart",this.onGripTouchStart);e.removeEventListener("griptouchend",this.onGripTouchEnd);e.removeEventListener("thumbstickdown",this.onThumbstickDown);e.removeEventListener("thumbstickup",this.onThumbstickUp);e.removeEventListener("abuttontouchstart",this.onAorXTouchStart);e.removeEventListener("abuttontouchend",this.onAorXTouchEnd);e.removeEventListener("bbuttontouchstart",this.onBorYTouchStart);e.removeEventListener("bbuttontouchend",this.onBorYTouchEnd);e.removeEventListener("xbuttontouchstart",this.onAorXTouchStart);e.removeEventListener("xbuttontouchend",this.onAorXTouchEnd);e.removeEventListener("ybuttontouchstart",this.onBorYTouchStart);e.removeEventListener("ybuttontouchend",this.onBorYTouchEnd);e.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart);e.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(e){var t;var r=this.el;var i=this.data;t={hand:i,model:false,orientationOffset:{x:0,y:0,z:"left"===i?90:-90}};i!==e&&this.loader.load(n[i],function(e){var i=e.getObjectByName("Hand");i.material.skinning=true;i.mixer=new THREE.AnimationMixer(i);r.setObject3D("mesh",i);i.position.set(0,0,0);i.rotation.set(0,0,0);i.visible=false;r.setAttribute("vive-controls",t);r.setAttribute("oculus-touch-controls",t);r.setAttribute("windows-motion-controls",t)})},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(e,t){var r;var i="down"===t;var n="touchstart"===t;if(0===t.indexOf("touch")){if(n===this.touchedButtons[e])return;this.touchedButtons[e]=n}else{if(i===this.pressedButtons[e])return;this.pressedButtons[e]=i}r=this.gesture;this.gesture=this.determineGesture();if(this.gesture===r)return;this.animateGesture(this.gesture,r);this.emitGestureEvents(this.gesture,r)},determineGesture:function(){var e;var t=this.pressedButtons["grip"];var r=this.pressedButtons["surface"]||this.touchedButtons["surface"];var i=this.pressedButtons["trackpad"]||this.touchedButtons["trackpad"];var n=this.pressedButtons["trigger"]||this.touchedButtons["trigger"];var o=this.touchedButtons["AorX"]||this.touchedButtons["BorY"];var s=u(this.el.components["tracked-controls"]);t?e=s?a.fist:r||o||i?n?a.fist:a.point:n?a.thumbUp:a.pointThumb:n?e=s?a.fist:a.hold:s&&i&&(e=a.point);return e},animateGesture:function(e,t){if(e){this.playAnimation(e||a.open,t,false);return}this.playAnimation(t,t,true)},emitGestureEvents:function(e,t){var r=this.el;var i;if(t===e)return;i=s(t,false);i&&r.emit(i);i=s(e,true);i&&r.emit(i)},playAnimation:function(e,t,r){var i;var n=this.el.getObject3D("mesh");var a;if(!n)return;a=n.mixer.clipAction(e);a.clampWhenFinished=true;a.loop=THREE.LoopRepeat;a.repetitions=0;a.timeScale=r?-1:1;a.weight=1;if(!t||e===t){n.mixer.stopAllAction();a.play();return}i=n.mixer.clipAction(t);n.mixer.stopAllAction();i.weight=.15;i.play();a.play();i.crossFadeTo(a,.15,true)},setModelVisibility:function(e){var t=this.el.getObject3D("mesh");if(!t)return;t.visible=e}});function s(e,t){var r;if(!e)return;r=o[e];if("grip"===r)return r+(t?"close":"open");if("point"===r||"thumb"===r)return r+(t?"up":"down");if("pointing"===r||"pistol"===r)return r+(t?"start":"end");return}function u(e){var t=e&&e.controller&&e.controller.id;return t&&0===t.indexOf("OpenVR ")}},{"../core/component":102}],60:[function(e,t,r){e("./camera");e("./collada-model");e("./cursor");e("./daydream-controls");e("./gearvr-controls");e("./geometry");e("./gltf-model");e("./hand-controls");e("./laser-controls");e("./light");e("./line");e("./link");e("./look-controls");e("./material");e("./obj-model");e("./oculus-touch-controls");e("./position");e("./raycaster");e("./rotation");e("./scale");e("./shadow");e("./sound");e("./text");e("./tracked-controls");e("./visible");e("./vive-controls");e("./wasd-controls");e("./windows-motion-controls");e("./scene/background");e("./scene/debug");e("./scene/embedded");e("./scene/inspector");e("./scene/fog");e("./scene/keyboard-shortcuts");e("./scene/pool");e("./scene/renderer");e("./scene/screenshot");e("./scene/stats");e("./scene/vr-mode-ui")},{"./camera":52,"./collada-model":53,"./cursor":54,"./daydream-controls":55,"./gearvr-controls":56,"./geometry":57,"./gltf-model":58,"./hand-controls":59,"./laser-controls":61,"./light":62,"./line":63,"./link":64,"./look-controls":65,"./material":66,"./obj-model":67,"./oculus-touch-controls":68,"./position":69,"./raycaster":70,"./rotation":71,"./scale":72,"./scene/background":73,"./scene/debug":74,"./scene/embedded":75,"./scene/fog":76,"./scene/inspector":77,"./scene/keyboard-shortcuts":78,"./scene/pool":79,"./scene/renderer":80,"./scene/screenshot":81,"./scene/stats":82,"./scene/vr-mode-ui":83,"./shadow":84,"./sound":85,"./text":86,"./tracked-controls":87,"./visible":88,"./vive-controls":89,"./wasd-controls":90,"./windows-motion-controls":91}],61:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../utils/");i("laser-controls",{schema:{hand:{default:"right"}},init:function(){var e=this.config;var t=this.data;var r=this.el;var i=this;r.setAttribute("daydream-controls",{hand:t.hand});r.setAttribute("gearvr-controls",{hand:t.hand});r.setAttribute("oculus-touch-controls",{hand:t.hand});r.setAttribute("vive-controls",{hand:t.hand});r.setAttribute("windows-motion-controls",{hand:t.hand});r.addEventListener("controllerconnected",a);r.addEventListener("controllerdisconnected",o);r.addEventListener("controllermodelready",function(e){a(e);i.modelReady=true});function a(t){var a=e[t.detail.name];if(!a)return;var o=n.extend({showLine:true},a.raycaster||{});if(t.detail.rayOrigin){o.origin=t.detail.rayOrigin.origin;o.direction=t.detail.rayOrigin.direction;o.showLine=true}t.detail.rayOrigin||!i.modelReady?r.setAttribute("raycaster",o):r.setAttribute("raycaster","showLine",true);r.setAttribute("cursor",n.extend({fuse:false},a.cursor))}function o(){r.setAttribute("raycaster","showLine",false)}},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown"],upEvents:["trackpadup"]}},"gearvr-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:false}}}})},{"../core/component":102,"../utils/":172}],62:[function(e,t,r){var i=e("../utils/bind");var n=e("../utils").diff;var a=e("../utils/debug");var o=e("../core/component").registerComponent;var s=e("../lib/three");var u=s.Math.degToRad;var c=a("components:light:warn");t.exports.Component=o("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"]},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:false,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:true}},shadowCameraFar:{default:500,if:{castShadow:true}},shadowCameraFov:{default:90,if:{castShadow:true}},shadowCameraNear:{default:.5,if:{castShadow:true}},shadowCameraTop:{default:5,if:{castShadow:true}},shadowCameraRight:{default:5,if:{castShadow:true}},shadowCameraBottom:{default:-5,if:{castShadow:true}},shadowCameraLeft:{default:-5,if:{castShadow:true}},shadowCameraVisible:{default:false,if:{castShadow:true}},shadowMapHeight:{default:512,if:{castShadow:true}},shadowMapWidth:{default:512,if:{castShadow:true}}},init:function(){var e=this.el;this.light=null;this.defaultTarget=null;this.system.registerLight(e)},update:function(e){var t=this.data;var r=n(t,e);var a=this.light;var o=this;if(a&&!("type"in r)){var s=false;Object.keys(r).forEach(function(e){var r=t[e];switch(e){case"color":a.color.set(r);break;case"groundColor":a.groundColor.set(r);break;case"angle":a.angle=u(r);break;case"target":null===r?"spot"!==t.type&&"directional"!==t.type||(a.target=o.defaultTarget):r.hasLoaded?o.onSetTarget(r,a):r.addEventListener("loaded",i(o.onSetTarget,o,r,a));break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":if(!s){o.updateShadow();s=true}break;default:a[e]=r}});return}this.setLight(this.data);this.updateShadow()},setLight:function(e){var t=this.el;var r=this.getLight(e);if(r){this.light&&t.removeObject3D("light");this.light=r;this.light.el=t;t.setObject3D("light",this.light);"spot"!==e.type&&"directional"!==e.type&&"hemisphere"!==e.type||t.getObject3D("light").translateY(-1);if("spot"===e.type){t.setObject3D("light-target",this.defaultTarget);t.getObject3D("light-target").position.set(0,0,-1)}}},updateShadow:function(){var e=this.el;var t=this.data;var r=this.light;r.castShadow=t.castShadow;var i=e.getObject3D("cameraHelper");t.shadowCameraVisible&&!i?e.setObject3D("cameraHelper",new s.CameraHelper(r.shadow.camera)):!t.shadowCameraVisible&&i&&e.removeObject3D("cameraHelper");if(!t.castShadow)return r;r.shadow.bias=t.shadowBias;r.shadow.mapSize.height=t.shadowMapHeight;r.shadow.mapSize.width=t.shadowMapWidth;r.shadow.camera.near=t.shadowCameraNear;r.shadow.camera.far=t.shadowCameraFar;if(r.shadow.camera instanceof s.OrthographicCamera){r.shadow.camera.top=t.shadowCameraTop;r.shadow.camera.right=t.shadowCameraRight;r.shadow.camera.bottom=t.shadowCameraBottom;r.shadow.camera.left=t.shadowCameraLeft}else r.shadow.camera.fov=t.shadowCameraFov;r.shadow.camera.updateProjectionMatrix();i&&i.update()},getLight:function(e){var t=e.angle;var r=new s.Color(e.color).getHex();var n=e.decay;var a=e.distance;var o=new s.Color(e.groundColor).getHex();var l=e.intensity;var h=e.type;var d=e.target;var p=null;switch(h.toLowerCase()){case"ambient":return new s.AmbientLight(r,l);case"directional":p=new s.DirectionalLight(r,l);this.defaultTarget=p.target;d&&(d.hasLoaded?this.onSetTarget(d,p):d.addEventListener("loaded",i(this.onSetTarget,this,d,p)));return p;case"hemisphere":return new s.HemisphereLight(r,o,l);case"point":return new s.PointLight(r,l,a,n);case"spot":p=new s.SpotLight(r,l,a,u(t),e.penumbra,n);this.defaultTarget=p.target;d&&(d.hasLoaded?this.onSetTarget(d,p):d.addEventListener("loaded",i(this.onSetTarget,this,d,p)));return p;default:c("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",h)}},onSetTarget:function(e,t){t.target=e.object3D},remove:function(){var e=this.el;e.removeObject3D("light");e.getObject3D("cameraHelper")&&e.removeObject3D("cameraHelper")}})},{"../core/component":102,"../lib/three":150,"../utils":172,"../utils/bind":166,"../utils/debug":168}],63:[function(e,t,r){var i=e("../core/component").registerComponent;t.exports.Component=i("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:true}},multiple:true,init:function(){var e=this.data;var t;var r;r=this.material=new THREE.LineBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.opacity<1,visible:e.visible});t=this.geometry=new THREE.BufferGeometry;t.addAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3));this.line=new THREE.Line(t,r);this.el.setObject3D(this.attrName,this.line)},update:function(e){var t=this.data;var r=this.geometry;var i=false;var a=this.material;var o=r.attributes.position.array;if(!n(t.start,e.start)){o[0]=t.start.x;o[1]=t.start.y;o[2]=t.start.z;i=true}if(!n(t.end,e.end)){o[3]=t.end.x;o[4]=t.end.y;o[5]=t.end.z;i=true}if(i){r.attributes.position.needsUpdate=true;r.computeBoundingSphere()}a.color.setStyle(t.color);a.opacity=t.opacity;a.transparent=t.opacity<1;a.visible=t.visible},remove:function(){this.el.removeObject3D("line",this.line)}});function n(e,t){if(!e||!t)return false;return e.x===t.x&&e.y===t.y&&e.z===t.z}},{"../core/component":102}],64:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../core/shader").registerShader;var a=e("../lib/three");t.exports.Component=i("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:false},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:false},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:true}},init:function(){this.navigate=this.navigate.bind(this);this.previousQuaternion=void 0;this.quaternionClone=new a.Quaternion;this.hiddenEls=[];this.initVisualAspect()},update:function(e){var t=this.data;var r=this.el;var i;var n;i=t.highlighted?t.highlightedColor:t.backgroundColor;n=t.highlighted?t.highlightedColor:t.borderColor;r.setAttribute("material","backgroundColor",i);r.setAttribute("material","strokeColor",n);t.on!==e.on&&this.updateEventListener();t.visualAspectEnabled&&void 0!==e.peekMode&&t.peekMode!==e.peekMode&&this.updatePeekMode();if(!t.image||e.image===t.image)return;r.setAttribute("material","pano","string"===typeof t.image?t.image:t.image.src)},updatePeekMode:function(){var e=this.el;var t=this.sphereEl;if(this.data.peekMode){this.hideAll();e.getObject3D("mesh").visible=false;t.setAttribute("visible",true)}else{this.showAll();e.getObject3D("mesh").visible=true;t.setAttribute("visible",false)}},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var e=this.el;if(!e.isPlaying)return;this.removeEventListener();e.addEventListener(this.data.on,this.navigate)},removeEventListener:function(){var e=this.data.on;if(!e)return;this.el.removeEventListener(e,this.navigate)},initVisualAspect:function(){var e=this.el;var t;var r;var i;if(!this.data.visualAspectEnabled)return;i=this.textEl=this.textEl||document.createElement("a-entity");r=this.sphereEl=this.sphereEl||document.createElement("a-entity");t=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity");e.setAttribute("geometry",{primitive:"circle",radius:1,segments:64});e.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"});i.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4});i.setAttribute("position","0 1.5 0");e.appendChild(i);t.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360});t.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"});t.setAttribute("rotation","0 180 0");t.setAttribute("position","0 0 0");t.setAttribute("visible",false);e.appendChild(t);r.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64});r.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"});r.setAttribute("visible",false);e.appendChild(r)},navigate:function(){window.location=this.data.href},tick:function(){var e=new a.Vector3;var t=new a.Vector3;var r=new a.Quaternion;var i=new a.Vector3;return function(){var n=this.el;var a=n.object3D;var o=n.sceneEl.camera;var s;var u;var c=this.textEl;if(!this.data.visualAspectEnabled)return;a.updateMatrixWorld();o.parent.updateMatrixWorld();o.updateMatrixWorld();a.matrix.decompose(t,r,i);t.setFromMatrixPosition(a.matrixWorld);e.setFromMatrixPosition(o.matrixWorld);u=t.distanceTo(e);if(u>20){if(!this.previousQuaternion){this.quaternionClone.copy(r);this.previousQuaternion=this.quaternionClone}a.lookAt(e)}else{s=this.calculateCameraPortalOrientation();if(u<.5){if(true===this.semiSphereEl.getAttribute("visible"))return;c.setAttribute("text","width",1.5);if(s<=0){c.setAttribute("position","0 0 0.75");c.setAttribute("rotation","0 180 0");this.semiSphereEl.setAttribute("rotation","0 0 0")}else{c.setAttribute("position","0 0 -0.75");c.setAttribute("rotation","0 0 0");this.semiSphereEl.setAttribute("rotation","0 180 0")}n.getObject3D("mesh").visible=false;this.semiSphereEl.setAttribute("visible",true);this.peekCameraPortalOrientation=s}else{s<=0?c.setAttribute("rotation","0 180 0"):c.setAttribute("rotation","0 0 0");c.setAttribute("text","width",5);c.setAttribute("position","0 1.5 0");n.getObject3D("mesh").visible=true;this.semiSphereEl.setAttribute("visible",false);this.peekCameraPortalOrientation=void 0}if(this.previousQuaternion){a.quaternion.copy(this.previousQuaternion);this.previousQuaternion=void 0}}}}(),hideAll:function(){var e=this.el;var t=this.hiddenEls;var r=this;if(t.length>0)return;e.sceneEl.object3D.traverse(function(i){if(i&&i.el&&i.el.hasAttribute("link-controls"))return;if(!i.el||i===e.sceneEl.object3D||i.el===e||i.el===r.sphereEl||i.el===e.sceneEl.cameraEl||false===i.el.getAttribute("visible")||i.el===r.textEl||i.el===r.semiSphereEl)return;i.el.setAttribute("visible",false);t.push(i.el)})},showAll:function(){this.hiddenEls.forEach(function(e){e.setAttribute("visible",true)});this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var e=new a.Matrix4;var t=new a.Vector3;var r=new a.Vector3(0,0,1);var i=new a.Vector3(0,0,0);return function(){var n=this.el;var a=n.sceneEl.camera;t.set(0,0,0);r.set(0,0,1);i.set(0,0,0);n.object3D.matrixWorld.extractRotation(e);r.applyMatrix4(e);n.object3D.updateMatrixWorld();n.object3D.localToWorld(i);a.parent.parent.updateMatrixWorld();a.parent.updateMatrixWorld();a.updateMatrixWorld();a.localToWorld(t);t.sub(i).normalize();r.normalize();return Math.sign(r.dot(t))}}(),remove:function(){this.removeEventListener()}});n("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = saturate(direction.y * 0.5  + 0.5);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join("\n")})},{"../core/component":102,"../core/shader":111,"../lib/three":150}],65:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../lib/three");var a=e("../utils/");var o=a.bind;var s=e("../utils").device.PolyfillControls;var u="a-grabbing";var c=Math.PI/2;var l=a.device.checkHasPositionalTracking;t.exports.Component=i("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:true},hmdEnabled:{default:true},pointerLockEnabled:{default:false},reverseMouseDrag:{default:false},touchEnabled:{default:true}},init:function(){this.previousHMDPosition=new n.Vector3;this.hmdQuaternion=new n.Quaternion;this.hmdEuler=new n.Euler;this.position=new n.Vector3;this.savedRotation=new n.Vector3;this.savedPosition=new n.Vector3;this.polyfillObject=new n.Object3D;this.polyfillControls=new s(this.polyfillObject);this.rotation={};this.deltaRotation={};this.savedPose=null;this.pointerLocked=false;this.setupMouseControls();this.bindMethods();this.savedPose={position:new n.Vector3,rotation:new n.Euler};this.el.sceneEl.is("vr-mode")&&this.onEnterVR()},update:function(e){var t=this.data;t.enabled!==e.enabled&&this.updateGrabCursor(t.enabled);if(e&&!t.hmdEnabled&&!e.hmdEnabled){this.pitchObject.rotation.set(0,0,0);this.yawObject.rotation.set(0,0,0)}if(e&&!t.pointerLockEnabled!==e.pointerLockEnabled){this.removeEventListeners();this.addEventListeners();this.pointerLocked&&document.exitPointerLock()}},tick:function(e){var t=this.data;if(!t.enabled)return;this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.removeEventListeners()},bindMethods:function(){this.onMouseDown=o(this.onMouseDown,this);this.onMouseMove=o(this.onMouseMove,this);this.onMouseUp=o(this.onMouseUp,this);this.onTouchStart=o(this.onTouchStart,this);this.onTouchMove=o(this.onTouchMove,this);this.onTouchEnd=o(this.onTouchEnd,this);this.onEnterVR=o(this.onEnterVR,this);this.onExitVR=o(this.onExitVR,this);this.onPointerLockChange=o(this.onPointerLockChange,this);this.onPointerLockError=o(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=false;this.pitchObject=new n.Object3D;this.yawObject=new n.Object3D;this.yawObject.position.y=10;this.yawObject.add(this.pitchObject)},addEventListeners:function(){var e=this.el.sceneEl;var t=e.canvas;if(!t){e.addEventListener("render-target-loaded",o(this.addEventListeners,this));return}t.addEventListener("mousedown",this.onMouseDown,false);window.addEventListener("mousemove",this.onMouseMove,false);window.addEventListener("mouseup",this.onMouseUp,false);t.addEventListener("touchstart",this.onTouchStart);window.addEventListener("touchmove",this.onTouchMove);window.addEventListener("touchend",this.onTouchEnd);e.addEventListener("enter-vr",this.onEnterVR);e.addEventListener("exit-vr",this.onExitVR);if(this.data.pointerLockEnabled){document.addEventListener("pointerlockchange",this.onPointerLockChange,false);document.addEventListener("mozpointerlockchange",this.onPointerLockChange,false);document.addEventListener("pointerlockerror",this.onPointerLockError,false)}},removeEventListeners:function(){var e=this.el.sceneEl;var t=e&&e.canvas;if(!t)return;t.removeEventListener("mousedown",this.onMouseDown);window.removeEventListener("mousemove",this.onMouseMove);window.removeEventListener("mouseup",this.onMouseUp);t.removeEventListener("touchstart",this.onTouchStart);window.removeEventListener("touchmove",this.onTouchMove);window.removeEventListener("touchend",this.onTouchEnd);e.removeEventListener("enter-vr",this.onEnterVR);e.removeEventListener("exit-vr",this.onExitVR);document.removeEventListener("pointerlockchange",this.onPointerLockChange,false);document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,false);document.removeEventListener("pointerlockerror",this.onPointerLockError,false)},updateOrientation:function(){var e=this.el;var t=this.hmdEuler;var r=this.pitchObject;var i=this.yawObject;var n=this.el.sceneEl;if(n.is("vr-mode")&&n.checkHeadsetConnected())return;this.polyfillControls.update();t.setFromQuaternion(this.polyfillObject.quaternion,"YXZ");e.object3D.rotation.x=t.x+r.rotation.x;e.object3D.rotation.y=t.y+i.rotation.y;e.object3D.rotation.z=0},onMouseMove:function(e){var t;var r;var i;var n=this.pitchObject;var a=this.previousMouseEvent;var o=this.yawObject;if(!this.data.enabled||!this.mouseDown&&!this.pointerLocked)return;if(this.pointerLocked){r=e.movementX||e.mozMovementX||0;i=e.movementY||e.mozMovementY||0}else{r=e.screenX-a.screenX;i=e.screenY-a.screenY}this.previousMouseEvent=e;t=this.data.reverseMouseDrag?1:-1;o.rotation.y+=.002*r*t;n.rotation.x+=.002*i*t;n.rotation.x=Math.max(-c,Math.min(c,n.rotation.x))},onMouseDown:function(e){if(!this.data.enabled)return;if(0!==e.button)return;var t=this.el.sceneEl;var r=t&&t.canvas;this.mouseDown=true;this.previousMouseEvent=e;document.body.classList.add(u);this.data.pointerLockEnabled&&!this.pointerLocked&&(r.requestPointerLock?r.requestPointerLock():r.mozRequestPointerLock&&r.mozRequestPointerLock())},onMouseUp:function(){this.mouseDown=false;document.body.classList.remove(u)},onTouchStart:function(e){if(1!==e.touches.length||!this.data.touchEnabled)return;this.touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY};this.touchStarted=true},onTouchMove:function(e){var t=this.el.sceneEl.canvas;var r;var i=this.yawObject;if(!this.touchStarted||!this.data.touchEnabled)return;r=2*Math.PI*(e.touches[0].pageX-this.touchStart.x)/t.clientWidth;i.rotation.y-=.5*r;this.touchStart={x:e.touches[0].pageX,y:e.touches[0].pageY}},onTouchEnd:function(){this.touchStarted=false},onEnterVR:function(){this.saveCameraPose()},onExitVR:function(){this.restoreCameraPose();this.previousHMDPosition.set(0,0,0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=false},updateGrabCursor:function(e){var t=this.el.sceneEl;function r(){t.canvas.classList.add("a-grab-cursor")}function i(){t.canvas.classList.remove("a-grab-cursor")}if(!t.canvas){e?t.addEventListener("render-target-loaded",r):t.addEventListener("render-target-loaded",i);return}if(e){r();return}i()},saveCameraPose:function(){var e=this.el;var t=void 0!==this.hasPositionalTracking?this.hasPositionalTracking:l();if(this.hasSavedPose||!t)return;this.savedPose.position.copy(e.object3D.position);this.savedPose.rotation.copy(e.object3D.rotation);this.hasSavedPose=true},restoreCameraPose:function(){var e=this.el;var t=this.savedPose;var r=void 0!==this.hasPositionalTracking?this.hasPositionalTracking:l();if(!this.hasSavedPose||!r)return;e.object3D.position.copy(t.position);e.object3D.rotation.copy(t.rotation);this.hasSavedPose=false}})},{"../core/component":102,"../lib/three":150,"../utils":172,"../utils/":172}],66:[function(e,t,r){var i=e("../utils/");var n=e("../core/component");var a=e("../lib/three");var o=e("../core/shader");var s=i.debug("components:material:error");var u=n.registerComponent;var c=o.shaders;var l=o.shaderNames;t.exports.Component=u("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:true},depthWrite:{default:true},flatShading:{default:false},npot:{default:false},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:l},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:false},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:true}},init:function(){this.material=null},update:function(e){var t=this.data;this.shader&&t.shader===e.shader||this.updateShader(t.shader);this.shader.update(this.data);this.updateMaterial(e)},updateSchema:function(e){var t=e.shader;var r=this.data&&this.data.shader;var i=t||r;var n=c[i]&&c[i].schema;n||s("Unknown shader schema "+i);if(r&&t===r)return;this.extendSchema(n);this.updateBehavior()},updateBehavior:function(){var e=this.schema;var t=this;var r=this.el.sceneEl;var i={};var n=function(e,r){Object.keys(i).forEach(function t(r){i[r]=e});t.shader.update(i)};this.tick=void 0;Object.keys(e).forEach(function(r){if("time"===e[r].type){t.tick=n;i[r]=true}});if(!r)return;this.tick?r.addBehavior(this):r.removeBehavior(this)},updateShader:function(e){var t=this.data;var r=c[e]&&c[e].Shader;var i;if(!r)throw new Error("Unknown shader "+e);i=this.shader=new r;i.el=this.el;i.init(t);this.setMaterial(i.material);this.updateSchema(t)},updateMaterial:function(e){var t=this.data;var r=this.material;r.alphaTest=t.alphaTest;r.depthTest=false!==t.depthTest;r.depthWrite=false!==t.depthWrite;r.opacity=t.opacity;r.flatShading=t.flatShading;r.side=h(t.side);r.transparent=false!==t.transparent||t.opacity<1;r.vertexColors=d(t.vertexColors);r.visible=t.visible;!Object.keys(e).length||e.alphaTest===t.alphaTest&&e.side===t.side&&e.vertexColors===t.vertexColors||(r.needsUpdate=true)},remove:function(){var e=new a.MeshBasicMaterial;var t=this.material;var r=this.el.getObject3D("mesh");r&&(r.material=e);p(t,this.system)},setMaterial:function(e){var t=this.el;var r;var i=this.system;this.material&&p(this.material,i);this.material=e;i.registerMaterial(e);r=t.getObject3D("mesh");r?r.material=e:t.addEventListener("object3dset",function r(i){if("mesh"!==i.detail.type||i.target!==t)return;t.getObject3D("mesh").material=e;t.removeEventListener("object3dset",r)})}});function h(e){switch(e){case"back":return a.BackSide;case"double":return a.DoubleSide;default:return a.FrontSide}}function d(e){switch(e){case"face":return a.FaceColors;case"vertex":return a.VertexColors;default:return a.NoColors}}function p(e,t){e.dispose();t.unregisterMaterial(e)}},{"../core/component":102,"../core/shader":111,"../lib/three":150,"../utils/":172}],67:[function(e,t,r){var i=e("../utils/debug");var n=e("../core/component").registerComponent;var a=e("../lib/three");var o=i("components:obj-model:warn");t.exports.Component=n("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){this.model=null;this.objLoader=new a.OBJLoader;this.mtlLoader=new a.MTLLoader(this.objLoader.manager);this.mtlLoader.crossOrigin=""},update:function(){var e=this.data;if(!e.obj)return;this.remove();this.loadObj(e.obj,e.mtl)},remove:function(){if(!this.model)return;this.el.removeObject3D("mesh")},loadObj:function(e,t){var r=this;var i=this.el;var n=this.mtlLoader;var s=this.objLoader;if(t){i.hasAttribute("material")&&o("Material component properties are ignored when a .MTL is provided");n.setTexturePath(t.substr(0,t.lastIndexOf("/")+1));n.load(t,function(t){t.preload();s.setMaterials(t);s.load(e,function(e){r.model=e;i.setObject3D("mesh",e);i.emit("model-loaded",{format:"obj",model:e})})});return}s.load(e,function e(t){var n=i.components.material;n&&t.traverse(function(e){e instanceof a.Mesh&&(e.material=n.material)});r.model=t;i.setObject3D("mesh",t);i.emit("model-loaded",{format:"obj",model:t})})}})},{"../core/component":102,"../lib/three":150,"../utils/debug":168}],68:[function(e,t,r){var i=e("../utils/bind");var n=e("../core/component").registerComponent;var a=e("../utils/tracked-controls");var o=e("../lib/three");var s=a.onButtonEvent;var u="https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-";var c=u+"left.obj";var l=u+"left.mtl";var h=u+"right.obj";var d=u+"right.mtl";var p="Oculus Touch";var f=new o.Vector3(0,0,-.053);var v={left:{origin:{x:.008,y:-.008,z:0},direction:{x:0,y:-.8,z:-1}},right:{origin:{x:-.008,y:-.008,z:0},direction:{x:0,y:-.8,z:-1}}};t.exports.Component=n("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:true},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:{left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},bindMethods:function(){this.onModelLoaded=i(this.onModelLoaded,this);this.onControllersUpdate=i(this.onControllersUpdate,this);this.checkIfControllerPresent=i(this.checkIfControllerPresent,this);this.onAxisMoved=i(this.onAxisMoved,this)},init:function(){var e=this;this.onButtonChanged=i(this.onButtonChanged,this);this.onButtonDown=function(t){s(t.detail.id,"down",e,e.data.hand)};this.onButtonUp=function(t){s(t.detail.id,"up",e,e.data.hand)};this.onButtonTouchStart=function(t){s(t.detail.id,"touchstart",e,e.data.hand)};this.onButtonTouchEnd=function(t){s(t.detail.id,"touchend",e,e.data.hand)};this.controllerPresent=false;this.lastControllerCheck=0;this.previousButtonValues={};this.bindMethods();this.emitIfAxesChanged=a.emitIfAxesChanged;this.checkControllerPresentAndSetup=a.checkControllerPresentAndSetup},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged);e.addEventListener("buttondown",this.onButtonDown);e.addEventListener("buttonup",this.onButtonUp);e.addEventListener("touchstart",this.onButtonTouchStart);e.addEventListener("touchend",this.onButtonTouchEnd);e.addEventListener("axismove",this.onAxisMoved);e.addEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=true},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged);e.removeEventListener("buttondown",this.onButtonDown);e.removeEventListener("buttonup",this.onButtonUp);e.removeEventListener("touchstart",this.onButtonTouchStart);e.removeEventListener("touchend",this.onButtonTouchEnd);e.removeEventListener("axismove",this.onAxisMoved);e.removeEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=false},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,p,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},updateControllerModel:function(){var e,t;if(!this.data.model)return;if("right"===this.data.hand){e="url("+h+")";t="url("+d+")"}else{e="url("+c+")";t="url("+l+")"}this.el.setAttribute("obj-model",{obj:e,mtl:t})},injectTrackedControls:function(){var e=this.data;this.el.setAttribute("tracked-controls",{id:"right"===e.hand?"Oculus Touch (Right)":"Oculus Touch (Left)",controller:0,orientationOffset:e.orientationOffset});this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,false)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var t=this.mapping[this.data.hand].buttons[e.detail.id];var r=this.buttonMeshes;var i;if(!t)return;"trigger"!==t&&"grip"!==t||(i=e.detail.state.value);if(r){"trigger"===t&&r.trigger&&(r.trigger.rotation.x=-i*(Math.PI/24));"grip"===t&&r.grip&&(r.grip.rotation.y=("left"===this.data.hand?-1:1)*i*(Math.PI/60))}this.el.emit(t+"changed",e.detail.state)},onModelLoaded:function(e){var t=e.detail.model;var r;if(!this.data.model)return;var i="left"===this.data.hand;r=this.buttonMeshes={};r.grip=t.getObjectByName(i?"buttonHand_oculus-touch-controller-left.004":"buttonHand_oculus-touch-controller-right.005");r.thumbstick=t.getObjectByName(i?"stick_oculus-touch-controller-left.007":"stick_oculus-touch-controller-right.004");r.trigger=t.getObjectByName(i?"buttonTrigger_oculus-touch-controller-left.005":"buttonTrigger_oculus-touch-controller-right.006");r.xbutton=t.getObjectByName("buttonX_oculus-touch-controller-left.002");r.abutton=t.getObjectByName("buttonA_oculus-touch-controller-right.002");r.ybutton=t.getObjectByName("buttonY_oculus-touch-controller-left.001");r.bbutton=t.getObjectByName("buttonB_oculus-touch-controller-right.003");t.position.copy(f);this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:v[this.data.hand]})},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping[this.data.hand].axes,e)},updateModel:function(e,t){if(!this.data.model)return;this.updateButtonModel(e,t)},updateButtonModel:function(e,t){var r="up"===t||"touchend"===t?this.data.buttonColor:"touchstart"===t?this.data.buttonTouchColor:this.data.buttonHighlightColor;var i=this.buttonMeshes;if(!this.data.model)return;i&&i[e]&&i[e].material.color.set(r)}})},{"../core/component":102,"../lib/three":150,"../utils/bind":166,"../utils/tracked-controls":178}],69:[function(e,t,r){var i=e("../core/component").registerComponent;t.exports.Component=i("position",{schema:{type:"vec3"},update:function(){var e=this.el.object3D;var t=this.data;e.position.set(t.x,t.y,t.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":102}],70:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../lib/three");var a=e("../utils/");var o=a.debug("components:raycaster:warn");var s=/^[\w\s-.,[\]#]*$/;var u={childList:true,attributes:true,subtree:true};t.exports.Component=i("raycaster",{schema:{autoRefresh:{default:true},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:true},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},recursive:{default:true},showLine:{default:false},useWorldCoordinates:{default:false}},init:function(){this.clearedIntersectedEls=[];this.unitLineEndVec3=new n.Vector3;this.intersectedEls=[];this.intersections=[];this.newIntersectedEls=[];this.newIntersections=[];this.objects=[];this.prevCheckTime=void 0;this.prevIntersectedEls=[];this.rawIntersections=[];this.raycaster=new n.Raycaster;this.updateOriginDirection();this.setDirty=this.setDirty.bind(this);this.observer=new MutationObserver(this.setDirty);this.dirty=true;this.lineEndVec3=new n.Vector3;this.otherLineEndVec3=new n.Vector3;this.lineData={end:this.lineEndVec3};this.intersectedClearedDetail={el:this.el};this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls};this.intersectionDetail={}},update:function(e){var t=this.data;var r=this.el;var i=this.raycaster;i.far=t.far;i.near=t.near;if(t.showLine&&(t.far!==e.far||t.origin!==e.origin||t.direction!==e.direction||!e.showLine)){this.unitLineEndVec3.copy(t.origin).add(t.direction).normalize();this.drawLine()}!t.showLine&&e.showLine&&r.removeAttribute("line");t.objects===e.objects||s.test(t.objects)||o('Selector "'+t.objects+'" may not update automatically with DOM changes.');t.autoRefresh!==e.autoRefresh&&r.isPlaying&&(t.autoRefresh?this.addEventListeners():this.removeEventListeners());this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line")},addEventListeners:function(){if(!this.data.autoRefresh)return;this.observer.observe(this.el.sceneEl,u);this.el.sceneEl.addEventListener("object3dset",this.setDirty);this.el.sceneEl.addEventListener("object3dremove",this.setDirty)},removeEventListeners:function(){this.observer.disconnect();this.el.sceneEl.removeEventListener("object3dset",this.setDirty);this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=true},refreshObjects:function(){var e=this.data;var t;t=e.objects?this.el.sceneEl.querySelectorAll(e.objects):this.el.sceneEl.children;this.objects=this.flattenChildrenShallow(t);this.dirty=false},tick:function(e){var t=this.data;var r=this.prevCheckTime;if(r&&e-r<t.interval)return;this.prevCheckTime=e;this.checkIntersections()},checkIntersections:function(){var e=this.clearedIntersectedEls;var t=this.el;var r=this.data;var i;var n=this.intersectedEls;var a;var o=this.intersections;var s;var u=this.newIntersectedEls;var l=this.newIntersections;var h=this.prevIntersectedEls;var d=this.rawIntersections;var p=this;if(!this.data.enabled)return;this.dirty&&this.refreshObjects();c(this.prevIntersectedEls,this.intersectedEls);this.updateOriginDirection();d.length=0;this.raycaster.intersectObjects(this.objects,r.recursive,d);o.length=0;n.length=0;for(i=0;i<d.length;i++){a=d[i];if(r.showLine&&a.object===t.getObject3D("line"))continue;if(a.object.el){o.push(a);n.push(a.object.el)}}l.length=0;u.length=0;for(i=0;i<o.length;i++)if(-1===h.indexOf(o[i].object.el)){l.push(o[i]);u.push(o[i].object.el)}e.length=0;for(i=0;i<h.length;i++){if(-1!==n.indexOf(h[i]))continue;h[i].emit("raycaster-intersected-cleared",this.intersectedClearedDetail);e.push(h[i])}e.length&&t.emit("raycaster-intersection-cleared",this.intersectionClearedDetail);for(i=0;i<u.length;i++)u[i].emit("raycaster-intersected",{el:t,intersection:l[i]});if(l.length){this.intersectionDetail.els=u;this.intersectionDetail.intersections=l;t.emit("raycaster-intersection",this.intersectionDetail)}setTimeout(function(){if(p.data.showLine){o.length&&(s=o[0].object.el===t&&o[1]?o[1].distance:o[0].distance);p.drawLine(s)}})},getIntersection:function(e){var t;var r;for(t=0;t<this.intersections.length;t++){r=this.intersections[t];if(r.object.el===e)return r}return null},updateOriginDirection:function(){var e=new n.Vector3;var t=new n.Vector3;return function r(){var i=this.el;var n=this.data;if(n.useWorldCoordinates){this.raycaster.set(n.origin,n.direction);return}i.object3D.updateMatrixWorld();i.object3D.getWorldPosition(t);0===n.origin.x&&0===n.origin.y&&0===n.origin.z||(t=i.object3D.localToWorld(t.copy(n.origin)));e.copy(n.direction).transformDirection(i.object3D.matrixWorld).normalize();this.raycaster.set(t,e)}}(),drawLine:function(e){var t=this.data;var r=this.el;var i;i=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3;void 0===e&&(e=Infinity===t.far?1e3:t.far);this.lineData.start=t.origin;this.lineData.end=i.copy(this.unitLineEndVec3).multiplyScalar(e);r.setAttribute("line",this.lineData)},flattenChildrenShallow:function(){var e=[];return function(t){var r;var i;var n=this.objects;e.length=0;for(i=0;i<t.length;i++)t[i].object3D&&e.push(t[i].object3D);n.length=0;for(i=0;i<e.length;i++){r=e[i].children;r&&r.length&&n.push.apply(n,r)}return n}}()});function c(e,t){var r;e.length=t.length;for(r=0;r<t.length;r++)e[r]=t[r]}},{"../core/component":102,"../lib/three":150,"../utils/":172}],71:[function(e,t,r){var i=e("../lib/three").Math.degToRad;var n=e("../core/component").registerComponent;t.exports.Component=n("rotation",{schema:{type:"vec3"},update:function(){var e=this.data;var t=this.el.object3D;t.rotation.set(i(e.x),i(e.y),i(e.z));t.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":102,"../lib/three":150}],72:[function(e,t,r){var i=e("../core/component").registerComponent;var n=1e-5;t.exports.Component=i("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var e=this.data;var t=this.el.object3D;var r=0===e.x?n:e.x;var i=0===e.y?n:e.y;var a=0===e.z?n:e.z;t.scale.set(r,i,a)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":102}],73:[function(e,t,r){var i=e("../../core/component").registerComponent;t.exports.Component=i("background",{schema:{color:{type:"color",default:"black"},transparent:{default:false}},update:function(){var e=this.data;var t=this.el.object3D;if(e.transparent){t.background=null;return}t.background=new THREE.Color(e.color)}})},{"../../core/component":102}],74:[function(e,t,r){var i=e("../../core/component").registerComponent;t.exports.Component=i("debug",{schema:{default:true}})},{"../../core/component":102}],75:[function(e,t,r){var i=e("../../core/component").registerComponent;t.exports.Component=i("embedded",{dependencies:["vr-mode-ui"],schema:{default:true},update:function(){var e=this.el;var t=e.querySelector(".a-enter-vr");if(true===this.data){t&&t.classList.add("embedded");e.removeFullScreenStyles()}else{t&&t.classList.remove("embedded");e.addFullScreenStyles()}}})},{"../../core/component":102}],76:[function(e,t,r){var i=e("../../core/component").registerComponent;var n=e("../../lib/three");var a=e("../../utils/debug");var o=a("components:fog:warn");t.exports.Component=i("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var e=this.data;var t=this.el;var r=this.el.object3D.fog;if(!t.isScene){o("Fog component can only be applied to <a-scene>");return}if(!r||e.type!==r.name){t.object3D.fog=s(e);t.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(t){var i=e[t];"color"===t&&(i=new n.Color(i));r[t]=i})},remove:function(){var e=this.el.object3D.fog;if(!e)return;e.far=0;e.near=.1}});function s(e){var t;t="exponential"===e.type?new n.FogExp2(e.color,e.density):new n.Fog(e.color,e.near,e.far);t.name=e.type;return t}},{"../../core/component":102,"../../lib/three":150,"../../utils/debug":168}],77:[function(e,t,r){(function(r){var i=e("../../constants").AFRAME_INJECTED;var n=e("../../utils/bind");var a=e("../../../package");var o=e("../../core/component").registerComponent;function s(e){var t=e.split(".");t[2]="x";return t.join(".")}var u="https://aframe.io/aframe-inspector/dist/aframe-inspector.js";var c="https://unpkg.com/aframe-inspector@"+s(a.version)+"/dist/aframe-inspector.min.js";var l="dev"===r.env.INSPECTOR_VERSION?u:c;var h="Loading Inspector";var d="Error loading Inspector";t.exports.Component=o("inspector",{schema:{url:{default:l}},init:function(){this.onKeydown=n(this.onKeydown,this);this.onMessage=n(this.onMessage,this);this.initOverlay();window.addEventListener("keydown",this.onKeydown);window.addEventListener("message",this.onMessage)},initOverlay:function(){var e='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div");this.loadingMessageEl.classList.add("a-inspector-loader");this.loadingMessageEl.innerHTML=h+e},remove:function(){this.removeEventListeners()},onKeydown:function(e){var t=73===e.keyCode&&e.ctrlKey&&e.altKey;if(!this.data||!t)return;this.injectInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(e){"INJECT_AFRAME_INSPECTOR"===e.data&&this.injectInspector()},injectInspector:function(){var e=this;var t;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected)return;this.showLoader();t=document.createElement("script");t.src=this.data.url;t.setAttribute("data-name","aframe-inspector");t.setAttribute(i,"");t.onload=function(){AFRAME.INSPECTOR.open();e.hideLoader();e.removeEventListeners()};t.onerror=function(){e.loadingMessageEl.innerHTML=d};document.head.appendChild(t);AFRAME.inspectorInjected=true},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown);window.removeEventListener("message",this.onMessage)}})}).call(this,e("_process"))},{"../../../package":51,"../../constants":93,"../../core/component":102,"../../utils/bind":166,_process:32}],78:[function(e,t,r){var i=e("../../core/component").registerComponent;var n=e("../../utils/").shouldCaptureKeyEvent;t.exports.Component=i("keyboard-shortcuts",{schema:{enterVR:{default:true},exitVR:{default:true}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(e){var t=this.data;this.enterVREnabled=t.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,false)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(e){var t=this.el;if(!n(e))return;this.enterVREnabled&&70===e.keyCode&&t.enterVR();this.enterVREnabled&&27===e.keyCode&&t.exitVR()}})},{"../../core/component":102,"../../utils/":172}],79:[function(e,t,r){var i=e("../../utils/debug");var n=e("../../core/component").registerComponent;var a=i("components:pool:warn");t.exports.Component=n("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:false}},multiple:true,initPool:function(){var e;this.availableEls=[];this.usedEls=[];this.data.mixin||a("No mixin provided for pool component.");if(this.data.container){this.container=document.querySelector(this.data.container);this.container||a("Container "+this.data.container+" not found.")}this.container=this.container||this.el;for(e=0;e<this.data.size;++e)this.createEntity()},update:function(e){var t=this.data;e.mixin===t.mixin&&e.size===t.size||this.initPool()},createEntity:function(){var e;e=document.createElement("a-entity");e.play=this.wrapPlay(e.play);e.setAttribute("mixin",this.data.mixin);e.object3D.visible=false;e.pause();this.container.appendChild(e);this.availableEls.push(e)},wrapPlay:function(e){var t=this.usedEls;return function(){if(-1===t.indexOf(this))return;e.call(this)}},requestEntity:function(){var e;if(0===this.availableEls.length){if(false===this.data.dynamic){a("Requested entity from empty pool: "+this.name);return}a("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.name);this.createEntity()}e=this.availableEls.shift();this.usedEls.push(e);e.object3D.visible=true;return e},returnEntity:function(e){var t=this.usedEls.indexOf(e);if(-1===t){a("The returned entity was not previously pooled from "+this.name);return}this.usedEls.splice(t,1);this.availableEls.push(e);e.object3D.visible=false;e.pause();return e}})},{"../../core/component":102,"../../utils/debug":168}],80:[function(e,t,r){var i=e("../../core/component").registerComponent;var n=e("../../utils/debug");var a=n("components:renderer:warn");t.exports.Component=i("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},gammaOutput:{default:false},physicallyCorrectLights:{default:false},sortObjects:{default:false}},init:function(){var e=this.el;e.isScene||a("Renderer component can only be applied to <a-scene>")},update:function(e){var t=this.data;var r=this.el;var i=r.renderer;var n=false;r.time>0&&t.antialias!==e.antialias&&a('Property "antialias" cannot be changed after scene initialization');t.sortObjects!==e.sortObjects&&(i.sortObjects=t.sortObjects);if(t.gammaOutput!==e.gammaOutput){i.gammaOutput=t.gammaOutput;n=true}if(t.physicallyCorrectLights!==e.physicallyCorrectLights){i.physicallyCorrectLights=t.physicallyCorrectLights;n=true}if(!n||0===r.time)return;a("Modifying renderer properties at runtime requires shader update and may drop frames.");r.object3D.traverse(function(e){if(!e.isMesh)return;Array.isArray(e.material)?e.material.forEach(function(e){e.needsUpdate=true}):e.material.needsUpdate=true})}})},{"../../core/component":102,"../../utils/debug":168}],81:[function(e,t,r){var i=e("../../core/component").registerComponent;var n=e("../../lib/three");var a=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n");var o=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join("\n");t.exports.Component=i("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var e=this.el;var t=this;e.renderer?r():e.addEventListener("render-target-loaded",r);function r(){var r=e.renderer.getContext();if(!r)return;t.cubeMapSize=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE);t.material=new n.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:a,fragmentShader:o,side:n.DoubleSide});t.quad=new n.Mesh(new n.PlaneBufferGeometry(1,1),t.material);t.quad.visible=false;t.camera=new n.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4);t.canvas=document.createElement("canvas");t.ctx=t.canvas.getContext("2d");e.camera&&e.camera.add(t.quad);t.onKeyDown=t.onKeyDown.bind(t);t.onCameraActive=t.onCameraActive.bind(t);e.addEventListener("camera-set-active",t.onCameraActive)}},getRenderTarget:function(e,t){return new n.WebGLRenderTarget(e,t,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,wrapS:n.ClampToEdgeWrapping,wrapT:n.ClampToEdgeWrapping,format:n.RGBAFormat,type:n.UnsignedByteType})},resize:function(e,t){this.quad.scale.set(e,t,1);this.camera.left=-1*e/2;this.camera.right=e/2;this.camera.top=t/2;this.camera.bottom=-1*t/2;this.camera.updateProjectionMatrix();this.canvas.width=e;this.canvas.height=t},play:function(){window.addEventListener("keydown",this.onKeyDown)},onCameraActive:function(e){var t=this.quad.parent;t&&t.remove(this.quad);e.detail.cameraEl.getObject3D("camera").add(this.quad)},onKeyDown:function(e){var t=83===e.keyCode&&e.ctrlKey&&e.altKey;if(!this.data||!t)return;var r=e.shiftKey?"equirectangular":"perspective";this.capture(r)},setCapture:function(e){var t=this.el;var r;var i;var a;if("perspective"===e){this.quad.visible=false;i=this.data.camera&&this.data.camera.components.camera.camera||t.camera;r={width:this.data.width,height:this.data.height}}else{i=this.camera;i.position.copy(t.camera.getWorldPosition());i.rotation.copy(t.camera.getWorldRotation());a=new n.CubeCamera(t.camera.near,t.camera.far,Math.min(this.cubeMapSize,2048));a.position.copy(t.camera.getWorldPosition());a.rotation.copy(t.camera.getWorldRotation());a.updateCubeMap(t.renderer,t.object3D);this.quad.material.uniforms.map.value=a.renderTarget.texture;r={width:this.data.width,height:this.data.height};this.quad.visible=true}return{camera:i,size:r,projection:e}},capture:function(e){var t=this.setCapture(e);this.renderCapture(t.camera,t.size,t.projection);this.saveCapture()},getCanvas:function(e){var t=this.setCapture(e);this.renderCapture(t.camera,t.size,t.projection);return this.canvas},renderCapture:function(e,t,r){var i=this.el.renderer.autoClear;var n=this.el;var a;var o;var s;var u=this.el.renderer;o=this.getRenderTarget(t.width,t.height);s=new Uint8Array(4*t.width*t.height);this.resize(t.width,t.height);u.autoClear=true;u.render(n.object3D,e,o,true);u.autoClear=i;u.readRenderTargetPixels(o,0,0,t.width,t.height,s);"perspective"===r&&(s=this.flipPixelsVertically(s,t.width,t.height));a=new ImageData(new Uint8ClampedArray(s),t.width,t.height);this.quad.visible=false;this.ctx.putImageData(a,0,0)},flipPixelsVertically:function(e,t,r){var i=e.slice(0);for(var n=0;n<t;++n)for(var a=0;a<r;++a){i[4*n+a*t*4]=e[4*n+(r-a)*t*4];i[4*n+1+a*t*4]=e[4*n+1+(r-a)*t*4];i[4*n+2+a*t*4]=e[4*n+2+(r-a)*t*4];i[4*n+3+a*t*4]=e[4*n+3+(r-a)*t*4]}return i},saveCapture:function(){this.canvas.toBlob(function(e){var t="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png";var r=document.createElement("a");var i=URL.createObjectURL(e);r.href=i;r.setAttribute("download",t);r.innerHTML="downloading...";r.style.display="none";document.body.appendChild(r);setTimeout(function(){r.click();document.body.removeChild(r)},1)},"image/png")}})},{"../../core/component":102,"../../lib/three":150}],82:[function(e,t,r){var i=e("../../core/component").registerComponent;var n=e("../../../vendor/rStats");var a=e("../../utils");e("../../../vendor/rStats.extras");e("../../lib/rStatsAframe");var o=window.aframeStats;var s=a.bind;var u="a-hidden";var c=window.threeStats;t.exports.Component=i("stats",{schema:{default:true},init:function(){var e=this.el;if("false"===a.getUrlParameter("stats"))return;this.stats=l(e);this.statsEl=document.querySelector(".rs-base");this.hideBound=s(this.hide,this);this.showBound=s(this.show,this);e.addEventListener("enter-vr",this.hideBound);e.addEventListener("exit-vr",this.showBound)},update:function(){if(!this.stats)return;return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound);this.el.removeEventListener("exit-vr",this.showBound);if(!this.statsEl)return;this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var e=this.stats;if(!e)return;e("rAF").tick();e("FPS").frame();e().update()},hide:function(){this.statsEl.classList.add(u)},show:function(){this.statsEl.classList.remove(u)}});function l(e){var t=new c(e.renderer);var r=new o(e);var i=e.isMobile?[]:[t,r];return new n({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:i})}},{"../../../vendor/rStats":180,"../../../vendor/rStats.extras":179,"../../core/component":102,"../../lib/rStatsAframe":149,"../../utils":172}],83:[function(e,t,r){var i=e("../../core/component").registerComponent;var n=e("../../constants/");var a=e("../../utils/");var o=a.bind;var s="a-enter-vr";var u="a-enter-vr-button";var c="a-hidden";var l="a-orientation-modal";t.exports.Component=i("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:true}},init:function(){var e=this;var t=this.el;if("false"===a.getUrlParameter("ui"))return;this.insideLoader=false;this.enterVREl=null;this.orientationModalEl=null;this.bindMethods();t.addEventListener("enter-vr",this.updateEnterVRInterface);t.addEventListener("exit-vr",this.updateEnterVRInterface);window.addEventListener("message",function(t){if("loaderReady"===t.data.type){e.insideLoader=true;e.remove()}});window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded)},bindMethods:function(){this.onEnterVRButtonClick=o(this.onEnterVRButtonClick,this);this.onModalClick=o(this.onModalClick,this);this.toggleOrientationModalIfNeeded=o(this.toggleOrientationModalIfNeeded,this);this.updateEnterVRInterface=o(this.updateEnterVRInterface,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},update:function(){var e=this.el;if(!this.data.enabled||this.insideLoader||"false"===a.getUrlParameter("ui"))return this.remove();if(this.enterVREl||this.orientationModalEl)return;this.enterVREl=h(this.onEnterVRButtonClick);e.appendChild(this.enterVREl);this.orientationModalEl=d(this.onModalClick);e.appendChild(this.orientationModalEl);this.updateEnterVRInterface()},remove:function(){[this.enterVREl,this.orientationModalEl].forEach(function(e){e&&e.parentNode&&e.parentNode.removeChild(e)})},updateEnterVRInterface:function(){this.toggleEnterVRButtonIfNeeded();this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var e=this.el;if(!this.enterVREl)return;e.is("vr-mode")?this.enterVREl.classList.add(c):this.enterVREl.classList.remove(c)},toggleOrientationModalIfNeeded:function(){var e=this.el;var t=this.orientationModalEl;if(!t||!e.isMobile)return;!a.device.isLandscape()&&e.is("vr-mode")?t.classList.remove(c):t.classList.add(c)}});function h(e){var t;var r;r=document.createElement("div");r.classList.add(s);r.setAttribute(n.AFRAME_INJECTED,"");t=document.createElement("button");t.className=u;t.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information.");t.setAttribute(n.AFRAME_INJECTED,"");r.appendChild(t);t.addEventListener("click",function(t){e();t.stopPropagation()});return r}function d(e){var t=document.createElement("div");t.className=l;t.classList.add(c);t.setAttribute(n.AFRAME_INJECTED,"");var r=document.createElement("button");r.setAttribute(n.AFRAME_INJECTED,"");r.innerHTML="Exit VR";r.addEventListener("click",e);t.appendChild(r);return t}},{"../../constants/":93,"../../core/component":102,"../../utils/":172}],84:[function(e,t,r){var i=e("../core/component");var n=e("../lib/three");var a=e("../utils/bind");var o=i.registerComponent;t.exports.Component=o("shadow",{schema:{cast:{default:true},receive:{default:true}},init:function(){this.onMeshChanged=a(this.update,this);this.el.addEventListener("object3dset",this.onMeshChanged);this.system.setShadowMapEnabled(true)},update:function(){var e=this.data;this.updateDescendants(e.cast,e.receive)},remove:function(){var e=this.el;e.removeEventListener("object3dset",this.onMeshChanged);this.updateDescendants(false,false)},updateDescendants:function(e,t){var r=this.el.sceneEl;this.el.object3D.traverse(function(i){if(!(i instanceof n.Mesh))return;i.castShadow=e;i.receiveShadow=t;if(r.hasLoaded&&i.material){var a=Array.isArray(i.material)?i.material:[i.material];for(var o=0;o<a.length;o++)a[o].needsUpdate=true}})}})},{"../core/component":102,"../lib/three":150,"../utils/bind":166}],85:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../utils/debug");var a=e("../utils/bind");var o=e("../lib/three");var s=n("components:sound:warn");t.exports.Component=i("sound",{schema:{autoplay:{default:false},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:false},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:true},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:true,init:function(){this.listener=null;this.audioLoader=new o.AudioLoader;this.pool=new o.Group;this.loaded=false;this.mustPlay=false;this.playSound=a(this.playSound,this)},update:function(e){var t=this.data;var r=t.src!==e.src;if(r){if(!t.src){s("Audio source was not specified with `src`");return}this.setupSound()}this.pool.children.forEach(function(e){if(t.positional){e.setDistanceModel(t.distanceModel);e.setMaxDistance(t.maxDistance);e.setRefDistance(t.refDistance);e.setRolloffFactor(t.rolloffFactor)}e.setLoop(t.loop);e.setVolume(t.volume);e.isPaused=false});t.on!==e.on&&this.updateEventListener(e.on);if(r){var i=this;this.loaded=false;this.audioLoader.load(t.src,function(e){i.pool.children.forEach(function(t){t.setBuffer(e)});i.loaded=true;o.Cache.remove(t.src);(i.data.autoplay||i.mustPlay)&&i.playSound();i.el.emit("sound-loaded",i.evtDetail)})}},pause:function(){this.stopSound();this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound();this.updateEventListener()},remove:function(){this.removeEventListener();this.el.removeObject3D(this.attrName);try{this.pool.children.forEach(function(e){e.disconnect()})}catch(e){s("Audio source not properly disconnected")}},updateEventListener:function(e){var t=this.el;e&&t.removeEventListener(e,this.playSound);t.addEventListener(this.data.on,this.playSound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSound)},setupSound:function(){var e=this;var t=this.el;var r=t.sceneEl;if(this.pool.children.length>0){this.stopSound();t.removeObject3D("sound")}var i=this.listener=r.audioListener||new o.AudioListener;r.audioListener=i;r.camera&&r.camera.add(i);r.addEventListener("camera-set-active",function(e){e.detail.cameraEl.getObject3D("camera").add(i)});this.pool=new o.Group;for(var n=0;n<this.data.poolSize;n++){var a=this.data.positional?new o.PositionalAudio(i):new o.Audio(i);this.pool.add(a)}t.setObject3D(this.attrName,this.pool);this.pool.children.forEach(function(r){r.onEnded=function(){r.isPlaying=false;t.emit("sound-ended",e.evtDetail)}})},pauseSound:function(){this.isPlaying=false;this.pool.children.forEach(function(e){if(!e.source||!e.source.buffer||!e.isPlaying||e.isPaused)return;e.isPaused=true;e.pause()})},playSound:function(){if(!this.loaded){s("Sound not loaded yet. It will be played once it finished loading");this.mustPlay=true;return}var e=false;this.isPlaying=true;this.pool.children.forEach(function(t){if(!t.isPlaying&&t.buffer&&!e){t.play();t.isPaused=false;e=true;return}});if(!e){s("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=false},stopSound:function(){this.isPlaying=false;this.pool.children.forEach(function(e){if(!e.source||!e.source.buffer)return;e.stop()})}})},{"../core/component":102,"../lib/three":150,"../utils/bind":166,"../utils/debug":168}],86:[function(e,t,r){var i=e("three-bmfont-text");var n=e("load-bmfont");var a=e("../core/component").registerComponent;var o=e("../core/shader");var s=e("../lib/three");var u=e("../utils/");var c=u.debug("components:text:error");var l=o.shaders;var h=u.debug("components:text:warn");var d=1;var p=16;var f="https://cdn.aframe.io/fonts/";var v={aileronsemibold:f+"Aileron-Semibold.fnt",dejavu:f+"DejaVu-sdf.fnt",exo2bold:f+"Exo2Bold.fnt",exo2semibold:f+"Exo2SemiBold.fnt",kelsonsans:f+"KelsonSans.fnt",monoid:f+"Monoid.fnt",mozillavr:f+"mozillavr.fnt",roboto:f+"Roboto-msdf.json",sourcecodepro:f+"SourceCodePro.fnt"};var m=["roboto"];var g="roboto";t.exports.FONTS=v;var y=new D;var A={};var M={};t.exports.Component=a("text",{multiple:true,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:g},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:true},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:l},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:true},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={};this.geometry=i();this.createOrUpdateMaterial();this.mesh=new s.Mesh(this.geometry,this.material);this.el.setObject3D(this.attrName,this.mesh)},update:function(e){var t=E(this.data);var r=this.currentFont;var i=this.getFontImageSrc();if(M[i])this.texture=M[i];else{this.texture=M[i]=new s.Texture;this.texture.anisotropy=p}this.createOrUpdateMaterial();if(e.font!==t.font){this.updateFont();return}if(r){this.updateGeometry(this.geometry,t,r);this.updateLayout(t)}},remove:function(){this.geometry.dispose();this.geometry=null;this.el.removeObject3D(this.attrName);this.material.dispose();this.material=null;this.texture.dispose();this.texture=null;this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var e=this.data;var t;var r=this.material;var i;var n=this.shaderData;var a;a=e.shader;-1!==m.indexOf(e.font)||e.font.indexOf("-msdf.")>=0?a="msdf":e.font in v&&-1===m.indexOf(e.font)&&(a="sdf");t=(this.shaderObject&&this.shaderObject.name)!==a;n.alphaTest=e.alphaTest;n.color=e.color;n.map=this.texture;n.opacity=e.opacity;n.side=w(e.side);n.transparent=e.transparent;n.negate=e.negate;if(!t){this.shaderObject.update(n);r.transparent=n.transparent;r.side=n.side;return}i=T(this.el,a,n);this.material=i.material;this.shaderObject=i.shader;this.material.side=n.side;this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var e=this.data;var t=this.el;var r;var i=this.geometry;var n=this;e.font||h("No font specified. Using the default font.");this.mesh.visible=false;r=this.lookupFont(e.font||g)||e.font;y.get(r,function t(){return x(r,e.yOffset)}).then(function a(o){var s;var u;if(1!==o.pages.length)throw new Error("Currently only single-page bitmap fonts are supported.");A[r]||(o.widthFactor=A[o]=N(o));s=E(e);n.updateGeometry(i,n.data,o);n.currentFont=o;n.updateLayout(s);u=n.getFontImageSrc();y.get(u,function(){return b(u)}).then(function(r){var i=n.texture;i.image=r;i.needsUpdate=true;M[u]=i;n.texture=i;n.mesh.visible=true;t.emit("textfontset",{font:e.font,fontObj:o})}).catch(function(e){c(e);throw e})}).catch(function(e){c(e);throw e})},getFontImageSrc:function(){var e=this.lookupFont(this.data.font||g)||this.data.font;return this.data.fontImage||e.replace(/(\.fnt)|(\.json)/,".png")},updateLayout:function(e){var t;var r;var i=this.el;var n=this.geometry;var a=i.getAttribute("geometry");var o;var s=n.layout;var u=this.mesh;var c;var l;var h;var p;var f;a=i.getAttribute("geometry");h=e.width||a&&a.width||d;c=L(e.wrapPixels,e.wrapCount,this.currentFont.widthFactor);l=h/c;o=l*(s.height+s.descender);if(a){a.width||i.setAttribute("geometry","width",h);a.height||i.setAttribute("geometry","height",o)}t="align"===e.anchor?e.align:e.anchor;if("left"===t)p=0;else if("right"===t)p=-1*s.width;else{if("center"!==t)throw new TypeError("Invalid text.anchor property value",t);p=-1*s.width/2}r=e.baseline;if("bottom"===r)f=0;else if("top"===r)f=-1*s.height+s.ascender;else{if("center"!==r)throw new TypeError("Invalid text.baseline property value",r);f=-1*s.height/2}u.position.x=p*l+e.xOffset;u.position.y=f*l;u.position.z=e.zOffset;u.scale.set(l,-1*l,l);this.geometry.computeBoundingSphere()},lookupFont:function(e){return v[e]},updateGeometry:function(e,t,r){e.update(u.extend({},t,{font:r,width:L(t.wrapPixels,t.wrapCount,r.widthFactor),text:t.value.toString().replace(/\\n/g,"\n").replace(/\\t/g,"\t"),lineHeight:t.lineHeight||r.common.lineHeight}))}});function w(e){switch(e){case"back":return s.FrontSide;case"double":return s.DoubleSide;default:return s.BackSide}}function E(e){e=u.clone(e);if(void 0!==e.lineHeight){e.lineHeight=parseFloat(e.lineHeight);isFinite(e.lineHeight)||(e.lineHeight=void 0)}if(void 0!==e.width){e.width=parseFloat(e.width);isFinite(e.width)||(e.width=void 0)}return e}function x(e,t){return new Promise(function(r,i){n(e,function(n,a){if(n){c("Error loading font",e);i(n);return}e.indexOf("/Roboto-msdf.json")>=0&&(t=30);t&&a.chars.map(function e(r){r.yoffset+=t});r(a)})})}function b(e){return new Promise(function(t,r){(new s.ImageLoader).load(e,function(e){t(e)},void 0,function(){c("Error loading font image",e);r(null)})})}function T(e,t,r){var i;var n;n=new l[t].Shader;n.el=e;n.init(r);n.update(r);i=n.material;i.transparent=r.transparent;return{material:i,shader:n}}function L(e,t,r){return e||(.5+t)*r}function N(e){var t=0;var r=0;var i=0;e.chars.map(function(e){t+=e.xadvance;if(e.id>=48&&e.id<=57){i++;r+=e.xadvance}});return i?r/i:t/e.chars.length}function D(){var e=this.cache={};this.get=function(t,r){if(t in e)return e[t];e[t]=r();return e[t]}}},{"../core/component":102,"../core/shader":111,"../lib/three":150,"../utils/":172,"load-bmfont":23,"three-bmfont-text":36}],87:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../utils/tracked-controls");var a=e("../constants").DEFAULT_CAMERA_HEIGHT;var o=e("../lib/three");var s=e("../constants").DEFAULT_HANDEDNESS;var u={x:.175,y:-.3,z:-.03};var c={x:0,y:0,z:-.175};t.exports.Component=i("tracked-controls",{schema:{controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:true},headElement:{type:"selector"}},init:function(){this.axis=[0,0,0];this.buttonStates={};this.changedAxes=[];this.targetControllerNumber=this.data.controller;this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes};this.deltaControllerPosition=new o.Vector3;this.controllerQuaternion=new o.Quaternion;this.controllerEuler=new o.Euler;this.updateGamepad();this.el.object3D.matrixAutoUpdate=false},tick:function(e,t){var r=this.el.getObject3D("mesh");r&&r.update&&r.update(t/1e3);this.updateGamepad();this.updatePose();this.updateButtons()},defaultUserHeight:function(){return a},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var e=this.data;var t=n.findMatchingController(this.system.controllers,e.id,e.idPrefix,e.hand,e.controller);this.controller=t},applyArmModel:function(e){var t=this.controller;var r=this.controllerEuler;var i=this.controllerQuaternion;var n=this.deltaControllerPosition;var a;var o;var l;var h;var d;o=this.getHeadElement();l=o.object3D;d=this.defaultUserHeight();h=t.pose;a=(t?t.hand:void 0)||s;e.copy(l.position);n.set(u.x*("left"===a?-1:"right"===a?1:0),u.y,u.z);n.multiplyScalar(d);n.applyAxisAngle(l.up,l.rotation.y);e.add(n);n.set(c.x,c.y,c.z);n.multiplyScalar(d);h.orientation?i.fromArray(h.orientation):i.copy(l.quaternion);r.setFromQuaternion(i);r.set(r.x,r.y,0);n.applyEuler(r);e.add(n)},updatePose:function(){var e=this.controller;var t=this.data;var r=this.el.object3D;var i;var n=this.system.vrDisplay;var a;if(!e)return;i=e.pose;i.position?r.position.fromArray(i.position):t.armModel&&this.applyArmModel(r.position);i.orientation&&r.quaternion.fromArray(i.orientation);if(n&&i.position){a=this.el.sceneEl.renderer.vr.getStandingMatrix();r.matrixAutoUpdate=false;r.matrix.compose(r.position,r.quaternion,r.scale);r.matrix.multiplyMatrices(a,r.matrix);r.matrix.decompose(r.position,r.quaternion,r.scale)}r.rotateX(this.data.orientationOffset.x*o.Math.DEG2RAD);r.rotateY(this.data.orientationOffset.y*o.Math.DEG2RAD);r.rotateZ(this.data.orientationOffset.z*o.Math.DEG2RAD);r.updateMatrix();r.matrixWorldNeedsUpdate=true},updateButtons:function(){var e;var t=this.controller;var r;if(!t)return;for(r=0;r<t.buttons.length;++r){this.buttonStates[r]||(this.buttonStates[r]={pressed:false,touched:false,value:0});e=t.buttons[r];this.handleButton(r,e)}this.handleAxes()},handleButton:function(e,t){var r=this.handlePress(e,t)|this.handleTouch(e,t)|this.handleValue(e,t);if(!r)return false;this.el.emit("buttonchanged",{id:e,state:t});return true},handleAxes:function(){var e=false;var t=this.controller.axes;var r;var i=this.axis;var n=this.changedAxes;this.changedAxes.length=0;for(r=0;r<t.length;++r){n.push(i[r]!==t[r]);n[r]&&(e=true)}if(!e)return false;this.axis.length=0;for(r=0;r<t.length;r++)this.axis.push(t[r]);this.el.emit("axismove",this.axisMoveEventDetail);return true},handlePress:function(e,t){var r;var i=this.buttonStates[e];if(t.pressed===i.pressed)return false;r=t.pressed?"down":"up";this.el.emit("button"+r,{id:e,state:t});i.pressed=t.pressed;return true},handleTouch:function(e,t){var r;var i=this.buttonStates[e];if(t.touched===i.touched)return false;r=t.touched?"start":"end";this.el.emit("touch"+r,{id:e,state:t},true,{touches:[]});i.touched=t.touched;return true},handleValue:function(e,t){var r=this.buttonStates[e];if(t.value===r.value)return false;r.value=t.value;return true}})},{"../constants":93,"../core/component":102,"../lib/three":150,"../utils/tracked-controls":178}],88:[function(e,t,r){var i=e("../core/component").registerComponent;t.exports.Component=i("visible",{schema:{default:true},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":102}],89:[function(e,t,r){var i=e("../core/component").registerComponent;var n=e("../utils/");var a=n.bind;var o=e("../utils/tracked-controls");var s=o.checkControllerPresentAndSetup;var u=o.emitIfAxesChanged;var c=o.onButtonEvent;var l="https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj";var h="https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl";var d="OpenVR ";t.exports.Component=i("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:true},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},init:function(){var e=this;this.animationActive="pointing";this.checkControllerPresentAndSetup=s;this.controllerPresent=false;this.emitIfAxesChanged=u;this.lastControllerCheck=0;this.onButtonChanged=a(this.onButtonChanged,this);this.onButtonDown=function(t){c(t.detail.id,"down",e)};this.onButtonUp=function(t){c(t.detail.id,"up",e)};this.onButtonTouchEnd=function(t){c(t.detail.id,"touchend",e)};this.onButtonTouchStart=function(t){c(t.detail.id,"touchstart",e)};this.onAxisMoved=a(this.onAxisMoved,this);this.previousButtonValues={};this.bindMethods()},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=a(this.onModelLoaded,this);this.onControllersUpdate=a(this.onControllersUpdate,this);this.checkIfControllerPresent=a(this.checkIfControllerPresent,this);this.removeControllersUpdateListener=a(this.removeControllersUpdateListener,this);this.onAxisMoved=a(this.onAxisMoved,this)},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged);e.addEventListener("buttondown",this.onButtonDown);e.addEventListener("buttonup",this.onButtonUp);e.addEventListener("touchend",this.onButtonTouchEnd);e.addEventListener("touchstart",this.onButtonTouchStart);e.addEventListener("model-loaded",this.onModelLoaded);e.addEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=true},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged);e.removeEventListener("buttondown",this.onButtonDown);e.removeEventListener("buttonup",this.onButtonUp);e.removeEventListener("touchend",this.onButtonTouchEnd);e.removeEventListener("touchstart",this.onButtonTouchStart);e.removeEventListener("model-loaded",this.onModelLoaded);e.removeEventListener("axismove",this.onAxisMoved);this.controllerEventsActive=false},checkIfControllerPresent:function(){var e=this.data;var t="right"===e.hand?0:"left"===e.hand?1:2;this.checkControllerPresentAndSetup(this,d,{index:t})},injectTrackedControls:function(){var e=this.el;var t=this.data;e.setAttribute("tracked-controls",{idPrefix:d,controller:"right"===t.hand?0:"left"===t.hand?1:2,orientationOffset:t.orientationOffset});if(!this.data.model)return;this.el.setAttribute("obj-model",{obj:l,mtl:h})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,false)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];var r=this.buttonMeshes;var i;if(!t)return;if("trigger"===t){i=e.detail.state.value;r&&r.trigger&&(r.trigger.rotation.x=-i*(Math.PI/12))}this.el.emit(t+"changed",e.detail.state)},onModelLoaded:function(e){var t;var r=e.detail.model;var i=this;if(!this.data.model)return;t=this.buttonMeshes={};t.grip={left:r.getObjectByName("leftgrip"),right:r.getObjectByName("rightgrip")};t.menu=r.getObjectByName("menubutton");t.system=r.getObjectByName("systembutton");t.trackpad=r.getObjectByName("touchpad");t.trigger=r.getObjectByName("trigger");Object.keys(t).forEach(function(e){i.setButtonColor(e,i.data.buttonColor)});r.position.set(0,-.015,.04)},onAxisMoved:function(e){this.emitIfAxesChanged(this,this.mapping.axes,e)},updateModel:function(e,t){var r;var i;if(!this.data.model)return;i=-1!==t.indexOf("touch");if(i)return;r="up"===t?this.data.buttonColor:this.data.buttonHighlightColor;this.setButtonColor(e,r)},setButtonColor:function(e,t){var r=this.buttonMeshes;if(!r)return;if("grip"===e){r.grip.left.material.color.set(t);r.grip.right.material.color.set(t);return}r[e].material.color.set(t)}})},{"../core/component":102,"../utils/":172,"../utils/tracked-controls":178}],90:[function(e,t,r){var i=e("../constants").keyboardevent.KEYCODE_TO_CODE;var n=e("../core/component").registerComponent;var a=e("../lib/three");var o=e("../utils/");var s=o.bind;var u=o.shouldCaptureKeyEvent;var c=1e-5;var l=.2;var h=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];t.exports.Component=n("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:true},adInverted:{default:false},easing:{default:20},enabled:{default:true},fly:{default:false},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:true},wsInverted:{default:false}},init:function(){this.keys={};this.position={};this.velocity=new a.Vector3;this.onBlur=s(this.onBlur,this);this.onFocus=s(this.onFocus,this);this.onKeyDown=s(this.onKeyDown,this);this.onKeyUp=s(this.onKeyUp,this);this.onVisibilityChange=s(this.onVisibilityChange,this);this.attachVisibilityEventListeners()},tick:function(e,t){var r;var i=this.data;var n=this.el;var a;var o=this.position;var s=this.velocity;if(!s[i.adAxis]&&!s[i.wsAxis]&&d(this.keys))return;t/=1e3;this.updateVelocity(t);if(!s[i.adAxis]&&!s[i.wsAxis])return;r=n.getAttribute("position");a=this.getMovementVector(t);o.x=r.x+a.x;o.y=r.y+a.y;o.z=r.z+a.z;n.setAttribute("position",o)},remove:function(){this.removeKeyEventListeners();this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={};this.removeKeyEventListeners()},updateVelocity:function(e){var t;var r;var i;var n=this.data;var a=this.keys;var o=this.velocity;var s;var u;r=n.adAxis;s=n.wsAxis;if(e>l){o[r]=0;o[s]=0;return}0!==o[r]&&(o[r]-=o[r]*n.easing*e);0!==o[s]&&(o[s]-=o[s]*n.easing*e);Math.abs(o[r])<c&&(o[r]=0);Math.abs(o[s])<c&&(o[s]=0);if(!n.enabled)return;t=n.acceleration;if(n.adEnabled){i=n.adInverted?-1:1;(a.KeyA||a.ArrowLeft)&&(o[r]-=i*t*e);(a.KeyD||a.ArrowRight)&&(o[r]+=i*t*e)}if(n.wsEnabled){u=n.wsInverted?-1:1;(a.KeyW||a.ArrowUp)&&(o[s]-=u*t*e);(a.KeyS||a.ArrowDown)&&(o[s]+=u*t*e)}},getMovementVector:function(){var e=new a.Vector3(0,0,0);var t=new a.Euler(0,0,0,"YXZ");return function(r){var i=this.el.getAttribute("rotation");var n=this.velocity;var o;e.copy(n);e.multiplyScalar(r);if(!i)return e;o=this.data.fly?i.x:0;t.set(a.Math.degToRad(o),a.Math.degToRad(i.y),0);e.applyEuler(t);return e}}(),attachVisibilityEventListeners:function(){window.addEventListener("blur",this.onBlur);window.addEventListener("focus",this.onFocus);document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur);window.removeEventListener("focus",this.onFocus);document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown);window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown);window.removeEventListener("keyup",this.onKeyUp)},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(e){var t;if(!u(e))return;t=e.code||i[e.keyCode];-1!==h.indexOf(t)&&(this.keys[t]=true)},onKeyUp:function(e){var t;t=e.code||i[e.keyCode];delete this.keys[t]}});function d(e){var t;for(t in e)return false;return true}},{"../constants":93,"../core/component":102,"../lib/three":150,"../utils/":172}],91:[function(e,t,r){var i=e("../utils/bind");var n=e("../core/component").registerComponent;var a=e("../utils/tracked-controls");var o=a.onButtonEvent;var s=e("../utils/");var u=s.debug("components:windows-motion-controls:debug");var c=s.debug("components:windows-motion-controls:warn");var l=e("../constants").DEFAULT_HANDEDNESS;var h="https://cdn.aframe.io/controllers/microsoft/";var d={left:"left.glb",right:"right.glb",default:"universal.glb"};var p="Spatial Controller (Spatial Interaction Source) ";var f=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/;t.exports.Component=n("windows-motion-controls",{schema:{hand:{default:l},pair:{default:0},model:{default:true},hideDisconnected:{default:true}},mapping:{axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},bindMethods:function(){this.onModelError=i(this.onModelError,this);this.onModelLoaded=i(this.onModelLoaded,this);this.onControllersUpdate=i(this.onControllersUpdate,this);this.checkIfControllerPresent=i(this.checkIfControllerPresent,this);this.onAxisMoved=i(this.onAxisMoved,this)},init:function(){var e=this;var t=this.el;this.onButtonChanged=i(this.onButtonChanged,this);this.onButtonDown=function(t){o(t.detail.id,"down",e)};this.onButtonUp=function(t){o(t.detail.id,"up",e)};this.onButtonTouchStart=function(t){o(t.detail.id,"touchstart",e)};this.onButtonTouchEnd=function(t){o(t.detail.id,"touchend",e)};this.onControllerConnected=function(){e.setModelVisibility(true)};this.onControllerDisconnected=function(){e.setModelVisibility(false)};this.controllerPresent=false;this.lastControllerCheck=0;this.previousButtonValues={};this.bindMethods();this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null};this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:false};this.emitIfAxesChanged=a.emitIfAxesChanged;this.checkControllerPresentAndSetup=a.checkControllerPresentAndSetup;t.addEventListener("controllerconnected",this.onControllerConnected);t.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var e=this.el;e.addEventListener("buttonchanged",this.onButtonChanged);e.addEventListener("buttondown",this.onButtonDown);e.addEventListener("buttonup",this.onButtonUp);e.addEventListener("touchstart",this.onButtonTouchStart);e.addEventListener("touchend",this.onButtonTouchEnd);e.addEventListener("axismove",this.onAxisMoved);e.addEventListener("model-error",this.onModelError);e.addEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=true},removeEventListeners:function(){var e=this.el;e.removeEventListener("buttonchanged",this.onButtonChanged);e.removeEventListener("buttondown",this.onButtonDown);e.removeEventListener("buttonup",this.onButtonUp);e.removeEventListener("touchstart",this.onButtonTouchStart);e.removeEventListener("touchend",this.onButtonTouchEnd);e.removeEventListener("axismove",this.onAxisMoved);e.removeEventListener("model-error",this.onModelError);e.removeEventListener("model-loaded",this.onModelLoaded);this.controllerEventsActive=false},checkIfControllerPresent:function(){this.checkControllerPresentAndSetup(this,p,{hand:this.data.hand,index:this.data.pair})},play:function(){this.checkIfControllerPresent();this.addControllersUpdateListener()},pause:function(){this.removeEventListeners();this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var e=this.createControllerModelUrl();this.loadModel(e)},createControllerModelUrl:function(e){var t=this.el.components["tracked-controls"];var r=t?t.controller:null;var i="default";var n=this.data.hand;var a;if(r){n=r.hand;if(!e){var o=r.id.match(f);i=o&&o[0]||i}}a=d[n]||d.default;return h+i+"/"+a},injectTrackedControls:function(){var e=this.data;this.el.setAttribute("tracked-controls",{idPrefix:p,controller:e.pair,hand:e.hand,armModel:false});this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,false)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,false)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(e){var t=this.createControllerModelUrl(true);if(e.detail.src!==t){c("Failed to load controller model for device, attempting to load default.");this.loadModel(t)}else c("Failed to load default controller model.")},loadModel:function(e){this.el.setAttribute("gltf-model","url("+e+")")},onModelLoaded:function(e){var t=this.controllerModel=e.detail.model;var r=this.loadedMeshInfo;var i;var n;var a;var o;u("Processing model");r.buttonMeshes={};r.axisMeshes={};if(t){for(i=0;i<this.mapping.buttons.length;i++){n=this.mapping.buttonMeshNames[this.mapping.buttons[i]];if(!n){u("Skipping unknown button at index: "+i+" with mapped name: "+this.mapping.buttons[i]);continue}a=t.getObjectByName(n);if(!a){c("Missing button mesh with name: "+n);continue}o={index:i,value:s(a,"VALUE"),pressed:s(a,"PRESSED"),unpressed:s(a,"UNPRESSED")};o.value&&o.pressed&&o.unpressed?r.buttonMeshes[this.mapping.buttons[i]]=o:c("Missing button submesh under mesh with name: "+n+"(VALUE: "+!!o.value+", PRESSED: "+!!o.pressed+", UNPRESSED:"+!!o.unpressed+")")}for(i=0;i<this.mapping.axisMeshNames.length;i++){n=this.mapping.axisMeshNames[i];if(!n){u("Skipping unknown axis at index: "+i);continue}a=t.getObjectByName(n);if(!a){c("Missing axis mesh with name: "+n);continue}o={index:i,value:s(a,"VALUE"),min:s(a,"MIN"),max:s(a,"MAX")};o.value&&o.min&&o.max?r.axisMeshes[i]=o:c("Missing axis submesh under mesh with name: "+n+"(VALUE: "+!!o.value+", MIN: "+!!o.min+", MAX:"+!!o.max+")")}this.calculateRayOriginFromMesh(t);this.setModelVisibility()}u("Model load complete.");function s(e,t){for(var r=0,i=e.children.length;r<i;r++){var n=e.children[r];if(n&&n["name"]===t)return n}return}},calculateRayOriginFromMesh:function(){var e=new THREE.Quaternion;return function(t){var r;this.rayOrigin.origin.set(0,0,0);this.rayOrigin.direction.set(0,0,-1);this.rayOrigin.createdFromMesh=true;r=t.getObjectByName(this.mapping.pointingPoseMeshName);if(r){var i=t.parent;if(i){t.parent=null;t.updateMatrixWorld(true);t.parent=i}r.getWorldPosition(this.rayOrigin.origin);r.getWorldQuaternion(e);this.rayOrigin.direction.applyQuaternion(e);i&&t.updateMatrixWorld(true)}else u("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var e=new THREE.Quaternion;return function(t,r){var i=this.loadedMeshInfo.axisMeshes[t];if(!i)return;var n=i.min;var a=i.max;var o=i.value;var s=.5*r+.5;o.setRotationFromQuaternion(e.copy(n.quaternion).slerp(a.quaternion,s));o.position.lerpVectors(n.position,a.position,s)}}(),lerpButtonTransform:function(){var e=new THREE.Quaternion;return function(t,r){var i=this.loadedMeshInfo.buttonMeshes[t];if(!i)return;var n=i.unpressed;var a=i.pressed;var o=i.value;o.setRotationFromQuaternion(e.copy(n.quaternion).slerp(a.quaternion,r));o.position.lerpVectors(n.position,a.position,r)}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(e){var t=this.mapping.buttons[e.detail.id];if(t){this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(t,e.detail.state.value);this.el.emit(t+"changed",e.detail.state)}},onAxisMoved:function(e){var t=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var r=0;r<t;r++)this.lerpAxisTransform(r,e.detail.axis[r]||0);this.emitIfAxesChanged(this,this.mapping.axes,e)},setModelVisibility:function(e){var t=this.el.getObject3D("mesh");e=void 0!==e?e:this.modelVisible;this.modelVisible=e;if(!t)return;t.visible=e}})},{"../constants":93,"../core/component":102,"../utils/":172,"../utils/bind":166,"../utils/tracked-controls":178}],92:[function(e,t,r){var i=e("@tweenjs/tween.js");var n={alternate:"alternate",alternateReverse:"alternate-reverse",normal:"normal",reverse:"reverse"};var a={linear:i.Easing.Linear.None,ease:i.Easing.Cubic.InOut,"ease-in":i.Easing.Cubic.In,"ease-out":i.Easing.Cubic.Out,"ease-in-out":i.Easing.Cubic.InOut,"ease-cubic":i.Easing.Cubic.In,"ease-in-cubic":i.Easing.Cubic.In,"ease-out-cubic":i.Easing.Cubic.Out,"ease-in-out-cubic":i.Easing.Cubic.InOut,"ease-quad":i.Easing.Quadratic.InOut,"ease-in-quad":i.Easing.Quadratic.In,"ease-out-quad":i.Easing.Quadratic.Out,"ease-in-out-quad":i.Easing.Quadratic.InOut,"ease-quart":i.Easing.Quartic.InOut,"ease-in-quart":i.Easing.Quartic.In,"ease-out-quart":i.Easing.Quartic.Out,"ease-in-out-quart":i.Easing.Quartic.InOut,"ease-quint":i.Easing.Quintic.InOut,"ease-in-quint":i.Easing.Quintic.In,"ease-out-quint":i.Easing.Quintic.Out,"ease-in-out-quint":i.Easing.Quintic.InOut,"ease-sine":i.Easing.Sinusoidal.InOut,"ease-in-sine":i.Easing.Sinusoidal.In,"ease-out-sine":i.Easing.Sinusoidal.Out,"ease-in-out-sine":i.Easing.Sinusoidal.InOut,"ease-expo":i.Easing.Exponential.InOut,"ease-in-expo":i.Easing.Exponential.In,"ease-out-expo":i.Easing.Exponential.Out,"ease-in-out-expo":i.Easing.Exponential.InOut,"ease-circ":i.Easing.Circular.InOut,"ease-in-circ":i.Easing.Circular.In,"ease-out-circ":i.Easing.Circular.Out,"ease-in-out-circ":i.Easing.Circular.InOut,"ease-elastic":i.Easing.Elastic.InOut,"ease-in-elastic":i.Easing.Elastic.In,"ease-out-elastic":i.Easing.Elastic.Out,"ease-in-out-elastic":i.Easing.Elastic.InOut,"ease-back":i.Easing.Back.InOut,"ease-in-back":i.Easing.Back.In,"ease-out-back":i.Easing.Back.Out,"ease-in-out-back":i.Easing.Back.InOut,"ease-bounce":i.Easing.Bounce.InOut,"ease-in-bounce":i.Easing.Bounce.In,"ease-out-bounce":i.Easing.Bounce.Out,"ease-in-out-bounce":i.Easing.Bounce.InOut};var o={backwards:"backwards",both:"both",forwards:"forwards",none:"none"};var s={indefinite:"indefinite"};var u={attribute:"rotation",begin:"",end:"",delay:0,dur:1e3,easing:"ease",direction:n.normal,fill:o.forwards,from:void 0,repeat:0,to:void 0};t.exports.defaults=u;t.exports.directions=n;t.exports.easingFunctions=a;t.exports.fills=o;t.exports.repeats=s},{"@tweenjs/tween.js":1}],93:[function(e,t,r){t.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",animation:e("./animation"),keyboardevent:e("./keyboardevent")}},{"./animation":92,"./keyboardevent":94}],94:[function(e,t,r){t.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},{}],95:[function(e,t,r){var i=e("./a-node");var n=e("../constants/animation");var a=e("../utils/").coordinates;var o=e("./schema").parseProperty;var s=e("./a-register-element").registerElement;var u=e("@tweenjs/tween.js");var c=e("../lib/three");var l=e("../utils/");var h=l.bind;var d=l.entity.getComponentProperty;var p=n.defaults;var f=n.directions;var v=n.easingFunctions;var m=n.fills;var g=n.repeats;var y=a.isCoordinates;var A=l.debug("core:a-animation:warn");var M=false;t.exports.AAnimation=s("a-animation",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.bindMethods();this.isRunning=false;this.partialSetAttribute=function(){};this.tween=null;if(!M){A("<a-animation> has been deprecated and will be replaced by the animation component: https://www.npmjs.com/package/aframe-animation-component");M=true}}},attachedCallback:{value:function(){this.el=this.parentNode;this.handleMixinUpdate();this.update();this.load()}},attributeChangedCallback:{value:function(e,t,r){if(!this.hasLoaded||!this.isRunning)return;this.stop();this.handleMixinUpdate();this.update()}},detachedCallback:{value:function(){if(!this.isRunning)return;this.stop()}},getTween:{value:function(){var e=this;var t=e.data;var r=e.el;var i;var n=t.attribute;var a=parseInt(t.delay,10);var o=d(r,n);var s=e.getDirection(t.direction);var c=v[t.easing];var l=t.fill;var p;var y=t.repeat===g.indefinite?Infinity:0;var A;var M;var x=false;i=E(r,n,t.from||e.initialValue,t.to,o);p=i.from;A=i.to;e.partialSetAttribute=i.partialSetAttribute;void 0===e.count&&(e.count=Infinity===y?0:parseInt(t.repeat,10));isNaN(a)&&(a=0);e.initialValue=e.initialValue||w(o);Infinity===y&&l===m.forwards&&-1!==[f.alternate,f.alternateReverse].indexOf(t.direction)&&(x=true);if(s===f.reverse){M=A;A=w(p);p=w(M)}-1!==[m.backwards,m.both].indexOf(l)&&e.partialSetAttribute(p);return new u.Tween(w(p)).to(A,t.dur).delay(a).easing(c).repeat(y).yoyo(x).onUpdate(function(){e.partialSetAttribute(this)}).onComplete(h(e.onCompleted,e))}},update:{value:function(){var e=this.data;"infinite"===e.repeat&&console.warn("Using 'infinite' as 'repeat' value is invalid.  Use 'indefinite' instead.");if(""!==e.begin&&!isNaN(e.begin)){console.warn("Using 'begin' to specify a delay is deprecated. Use 'delay' instead.");e.delay=e.begin;e.begin=""}var t=e.begin;var r=e.end;this.evt&&this.removeEventListeners(this.evt);this.evt={begin:t,end:r};this.addEventListeners(this.evt);if(""===t){this.stop();this.start()}},writable:window.debug},onCompleted:{value:function(){var e=this.data;this.isRunning=false;-1!==[m.backwards,m.none].indexOf(e.fill)&&this.partialSetAttribute(this.initialValue);if(0===this.count){this.count=void 0;this.emit("animationend");return}this.isRunning=false;this.count--;this.start()}},start:{value:function(){var e=this;if(!this.el.hasLoaded){this.el.addEventListener("loaded",function(){e.start()});return}if(this.isRunning||!this.el.isPlaying)return;this.tween=this.getTween();this.isRunning=true;this.tween.start();this.emit("animationstart")},writable:true},stop:{value:function(){var e=this.tween;if(!e)return;e.stop();this.isRunning=false;-1!==[m.backwards,m.none].indexOf(this.data.fill)&&this.partialSetAttribute(this.initialValue);this.emit("animationstop")},writable:true},getDirection:{value:function(e){if(e===f.alternate){this.prevDirection=this.prevDirection===f.normal?f.reverse:f.normal;return this.prevDirection}if(e===f.alternateReverse){this.prevDirection=this.prevDirection===f.reverse?f.normal:f.reverse;return this.prevDirection}return e}},bindMethods:{value:function(){this.start=h(this.start,this);this.stop=h(this.stop,this);this.onStateAdded=h(this.onStateAdded,this);this.onStateRemoved=h(this.onStateRemoved,this)}},addEventListeners:{value:function(e){var t=this.el;var r=this;l.splitString(e.begin).forEach(function(e){t.addEventListener(e,r.start)});l.splitString(e.end).forEach(function(e){t.addEventListener(e,r.stop)});""===e.begin&&t.addEventListener("play",this.start);t.addEventListener("pause",this.stop);t.addEventListener("stateadded",this.onStateAdded);t.addEventListener("stateremoved",this.onStateRemoved)}},removeEventListeners:{value:function(e){var t=this.el;var r=this.start;var i=this.stop;l.splitString(e.begin).forEach(function(e){t.removeEventListener(e,r)});l.splitString(e.end).forEach(function(e){t.removeEventListener(e,i)});t.removeEventListener("stateadded",this.onStateAdded);t.removeEventListener("stateremoved",this.onStateRemoved)}},onStateAdded:{value:function(e){e.detail===this.data.begin&&this.start()},writable:true},onStateRemoved:{value:function(e){e.detail===this.data.begin&&this.stop()},writable:true},handleMixinUpdate:{value:function(){var e={};var t;var r;var i;i=document.querySelector("#"+this.getAttribute("mixin"));r=i?l.getElData(i,p):{};t=l.getElData(this,p);l.extend(e,p,r,t);this.data=e}}})});function w(e){return l.extend({},e)}function E(e,t,r,i,n){var s=t.split(".");var u;var l;var h;var p;var f={};var v;var m={};2===s.length?g()?E():A():i&&y(i)?M():-1!==["true","false"].indexOf(i)?w():isNaN(i)?E():T();return{from:f,partialSetAttribute:v,to:m};function g(){var t=s[0];var r=s[1];var i=e.components[t];var n=i&&i.schema;return n&&n[r]&&"color"===n[r].type}function A(){p=s[0];h=s[1];l=e.components[p];if(!l){e.setAttribute(p,"");l=e.components[p]}u=l.schema;f[t]=void 0===r?d(e,t):r;f[t]=o(f[t],u[h]);m[t]=o(i,u[h]);v=function(r){if(!(t in r))return;e.setAttribute(p,h,r[t])}}function M(){f=r?a.parse(r):n;m=a.parse(i);v=function(r){e.setAttribute(t,r)}}function w(){f[t]=void 0!==r&&x(r);f[t]=b(f[t]);m[t]=b(x(i));v=function(r){e.setAttribute(t,!!r[t])}}function E(){f=new c.Color(r||e.getAttribute(t));m=new c.Color(i);v=function(r){s.length>1&&e.setAttribute(s[0],s[1],N(r));e.setAttribute(t,N(r))}}function T(){f[t]=void 0===r?parseFloat(e.getAttribute(t)):parseFloat(r);m[t]=parseFloat(i);v=function(r){e.setAttribute(t,r[t])}}}t.exports.getAnimationValues=E;function x(e){if("true"===e)return true;return false}function b(e){return e?1:0}function T(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function L(e){return Math.floor(255*Math.min(Math.abs(e),1))}function N(e){return"#"+["r","g","b"].map(function(t){return T(L(e[t]))}).join("")}},{"../constants/animation":92,"../lib/three":150,"../utils/":172,"./a-node":100,"./a-register-element":101,"./schema":110,"@tweenjs/tween.js":1}],96:[function(e,t,r){var i=e("./a-node");var n=e("../utils/bind");var a=e("../utils/debug");var o=e("./a-register-element").registerElement;var s=e("../lib/three");var u=new s.FileLoader;var c=a("core:a-assets:warn");t.exports=o("a-assets",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.isAssets=true;this.fileLoader=u;this.timeout=null}},attachedCallback:{value:function(){var e=this;var t;var r=[];var i;var a;var o;var u;var d;if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");u=this.querySelectorAll("img");for(t=0;t<u.length;t++){o=h(u[t]);r.push(new Promise(function(e,r){s.Cache.files[u[t].getAttribute("src")]=o;o.onload=e;o.onerror=r}))}a=this.querySelectorAll("audio, video");for(t=0;t<a.length;t++){i=h(a[t]);i.src||i.srcObject||c("Audio/video asset has neither `src` nor `srcObject` attributes.");r.push(l(i))}Promise.all(r).then(n(this.load,this));d=parseInt(this.getAttribute("timeout"),10)||3e3;this.timeout=setTimeout(function(){if(e.hasLoaded)return;c("Asset loading timed out in ",d,"ms");e.emit("timeout");e.load()},d)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){i.prototype.load.call(this,null,function e(t){return t.isAssetItem&&t.hasAttribute("src")})}}})});o("a-asset-item",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.data=null;this.isAssetItem=true}},attachedCallback:{value:function(){var e=this;var t=this.getAttribute("src");u.setResponseType(this.getAttribute("response-type")||f(t));u.load(t,function t(r){e.data=r;setTimeout(function t(){i.prototype.load.call(e)})},function t(r){e.emit("progress",{loadedBytes:r.loaded,totalBytes:r.total,xhr:r})},function t(r){e.emit("error",{xhr:r})})}}})});function l(e){if(!e.hasAttribute("autoplay")&&"auto"!==e.getAttribute("preload"))return;return new Promise(function(t,r){if(4===e.readyState)return t();if(e.error)return r();e.addEventListener("loadeddata",i,false);e.addEventListener("progress",i,false);e.addEventListener("error",r,false);function i(){var r=0;for(var i=0;i<e.buffered.length;i++)r+=e.buffered.end(i)-e.buffered.start(i);if(r>=e.duration){s.Cache.files[e.getAttribute("src")]=e;t()}}})}function h(e){var t=d(e);if(t.tagName&&"video"===t.tagName.toLowerCase()){t.setAttribute("playsinline","");t.setAttribute("webkit-playsinline","")}if(t!==e){e.parentNode.appendChild(t);e.parentNode.removeChild(e)}return t}function d(e){var t;var r;if(e.hasAttribute("crossorigin"))return e;r=e.getAttribute("src");if(null!==r){if(-1===r.indexOf("://"))return e;if(p(r)===window.location.host)return e}c('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',r);e.crossOrigin="anonymous";t=e.cloneNode(true);return t}function p(e){var t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0];return t.substring(0,t.indexOf(":"))}function f(e){var t=e.lastIndexOf(".");if(t>=0){var r=e.slice(t,e.length);if(".gltf"===r||".glb"===r)return"arraybuffer"}return"text"}t.exports.inferResponseType=f},{"../lib/three":150,"../utils/bind":166,"../utils/debug":168,"./a-node":100,"./a-register-element":101}],97:[function(e,t,r){var i=e("../utils/debug");var n=e("./a-register-element").registerElement;var a=i("core:cubemap:warn");t.exports=n("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var e=this.querySelectorAll("[src]");var t;var r=[];if(6===e.length){for(t=0;t<e.length;t++)r.push(e[t].getAttribute("src"));return r}a("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":168,"./a-register-element":101}],98:[function(e,t,r){var i=e("./a-node");var n=e("./component").components;var a=e("./a-register-element").registerElement;var o=e("../lib/three");var s=e("../utils/");var u;var c=s.debug("core:a-entity:debug");var l=s.debug("core:a-entity:warn");var h="__";var d=["position","rotation","scale","visible"];var p=Object.create(i.prototype,{createdCallback:{value:function(){this.components={};this.initializingComponents={};this.componentsToUpdate={};this.isEntity=true;this.isPlaying=false;this.object3D=new o.Group;this.object3D.el=this;this.object3DMap={};this.parentEl=null;this.rotationObj={};this.states=[]}},attributeChangedCallback:{value:function(e,t,r){var i=this.components[e];if(i&&i.justInitialized&&""===r){delete i.justInitialized;return}if(!i&&null===r)return;this.setEntityAttribute(e,t,r)}},attachedCallback:{value:function(){var e;var t=this.sceneEl;var r=this;this.addToParent();if(this.isScene)return;if(!t){this.load();return}e=t.querySelector("a-assets");if(e&&!e.hasLoaded){e.addEventListener("loaded",function(){r.load()});return}this.load()}},detachedCallback:{value:function(){var e;if(!this.parentEl)return;for(e in this.components)this.removeComponent(e);if(this.isScene)return;this.removeFromParent();i.prototype.detachedCallback.call(this);this.object3D.el=null}},handleMixinUpdate:{value:function(e){if(!e){this.updateComponents();return}this.updateComponent(e,this.getDOMAttribute(e))}},getObject3D:{value:function(e){return this.object3DMap[e]}},setObject3D:{value:function(e,t){var r;var i=this;if(!(t instanceof o.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");r=this.getObject3D(e);r&&this.object3D.remove(r);t.el=this;t.children.length&&t.traverse(function e(t){t.el=i});this.object3D.add(t);this.object3DMap[e]=t;this.emit("object3dset",{object:t,type:e})}},removeObject3D:{value:function(e){var t=this.getObject3D(e);if(!t){l("Tried to remove `Object3D` of type:",e,"which was not defined.");return}this.object3D.remove(t);delete this.object3DMap[e];this.emit("object3dremove",{type:e})}},getOrCreateObject3D:{value:function(e,t){var r=this.getObject3D(e);if(!r&&t){r=new t;this.setObject3D(e,r)}l("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead.");return r}},add:{value:function(e){if(!e.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(e.object3D);this.emit("child-attached",{el:e})}},addToParent:{value:function(){var e=this.parentEl=this.parentNode;if(!e||!e.add||this.attachedToParent)return;e.add(this);this.attachedToParent=true}},removeFromParent:{value:function(){var e=this.parentEl;this.parentEl.remove(this);this.attachedToParent=false;this.parentEl=this.parentNode=null;e.emit("child-detached",{el:this})}},load:{value:function(){var e=this;if(this.hasLoaded||!this.parentEl)return;i.prototype.load.call(this,function t(){if(!e.parentEl)return;e.updateComponents();(e.isScene||e.parentEl.isPlaying)&&e.play()})},writable:window.debug},remove:{value:function(e){this.object3D.remove(e.object3D)}},getChildEntities:{value:function(){var e=this.children;var t=[];for(var r=0;r<e.length;r++){var i=e[r];i instanceof u&&t.push(i)}return t}},initComponent:{value:function(e,t,r){var i;var a;var o;var u;var l;o=s.split(e,h);a=o[1];u=o[0];if(!n[u])return;l=f(this,e)||void 0!==t;if(!l&&!r)return;if(e in this.components)return;this.initComponentDependencies(u);if(a&&!n[u].multiple)throw new Error("Trying to initialize multiple components of type `"+u+"`. There can only be one component of this type per entity.");i=new n[u].Component(this,t,a);this.isPlaying&&i.play();if(!this.hasAttribute(e)){i.justInitialized=true;window.HTMLElement.prototype.setAttribute.call(this,e,"")}c("Component initialized: %s",e)},writable:window.debug},initComponentDependencies:{value:function(e){var t=this;var r=n[e];var i;var a;if(!r)return;i=n[e].dependencies;if(!i)return;for(a=0;a<i.length;a++)t.initComponent(i[a],window.HTMLElement.prototype.getAttribute.call(t,i[a])||void 0,true)}},removeComponent:{value:function(e){var t;t=this.components[e];if(!t)return;if(!t.initialized){this.addEventListener("componentinitialized",function t(r){if(r.detail.name!==e)return;this.removeComponent(e);this.removeEventListener("componentinitialized",t)});return}t.pause();t.remove();delete this.components[e];this.emit("componentremoved",t.evtDetail)},writable:window.debug},updateComponents:{value:function(){var e;var t;var r;var i;var n=this.componentsToUpdate;if(!this.hasLoaded)return;for(r=0;r<this.mixinEls.length;r++)for(i in this.mixinEls[r].componentCache)g(i)&&(n[i]=true);if(this.getExtraComponents){t=this.getExtraComponents();for(i in t)g(i)&&(n[i]=true)}for(r=0;r<this.attributes.length;++r){i=this.attributes[r].name;if(-1!==d.indexOf(i))continue;g(i)&&(n[i]=true)}for(r=0;r<d.length;r++){i=d[r];if(!this.hasAttribute(i))continue;this.updateComponent(i,this.getDOMAttribute(i))}for(i in n){e=m(this.getDOMAttribute(i),t&&t[i]);this.updateComponent(i,e);delete n[i]}},writable:window.debug},updateComponent:{value:function(e,t,r){var i=this.components[e];if(i){if(null===t&&!f(this,e)){this.removeComponent(e);return}i.updateProperties(t,r);return}this.initComponent(e,t,false)}},removeAttribute:{value:function(e,t){var r=this.components[e];r&&void 0===t&&this.removeComponent(e);if(r&&void 0!==t){r.resetProperty(t);return}"mixin"===e&&this.mixinUpdate("");window.HTMLElement.prototype.removeAttribute.call(this,e)}},play:{value:function(){var e;var t;var r;if(this.isPlaying||!this.hasLoaded)return;this.isPlaying=true;for(r in this.components)this.components[r].play();e=this.getChildEntities();for(t=0;t<e.length;t++)e[t].play();this.emit("play")},writable:true},pause:{value:function(){var e;var t;var r;if(!this.isPlaying)return;this.isPlaying=false;for(r in this.components)this.components[r].pause();e=this.getChildEntities();for(t=0;t<e.length;t++)e[t].pause();this.emit("pause")},writable:true},setEntityAttribute:{value:function(e,t,r){if(n[e]||this.components[e]){this.updateComponent(e,r);return}if("mixin"===e){if(r===this.computedMixinStr)return;this.mixinUpdate(r,t)}}},mixinUpdate:{value:function(e,t){t=t||this.getAttribute("mixin");this.updateMixins(e,t);this.updateComponents()}},setAttribute:{value:function(e,t,r){var a;var o;var u;var c;var l;c=e.indexOf(h);u=c>0?e.substring(0,c):e;if(!n[u]){"mixin"===e&&this.mixinUpdate(t);i.prototype.setAttribute.call(this,e,t);return}!this.components[e]&&this.hasAttribute(e)&&this.updateComponent(e,window.HTMLElement.prototype.getAttribute.call(this,e));if("undefined"!==typeof r&&"string"===typeof t&&t.length>0&&"string"===typeof s.styleParser.parse(t)){a={};a[t]=r;o=false}else{a=t;o=true===r}this.updateComponent(e,a,o);l=this.sceneEl&&this.sceneEl.getAttribute("debug");l&&this.components[e].flushToDOM()},writable:window.debug},flushToDOM:{value:function(e){var t=this.components;var r;var i=this.children;var n;var a;for(a in t)t[a].flushToDOM();if(!e)return;for(n=0;n<i.length;++n){r=i[n];if(!r.flushToDOM)continue;r.flushToDOM(e)}}},getAttribute:{value:function(e){var t;if("position"===e)return this.object3D.position;if("rotation"===e)return y(this);if("scale"===e)return this.object3D.scale;if("visible"===e)return this.object3D.visible;t=this.components[e];if(t)return t.data;return window.HTMLElement.prototype.getAttribute.call(this,e)},writable:window.debug},getDOMAttribute:{value:function(e){var t=this.components[e];if(t)return t.attrValue;return window.HTMLElement.prototype.getAttribute.call(this,e)},writable:window.debug},addState:{value:function(e){if(this.is(e))return;this.states.push(e);this.emit("stateadded",e)}},removeState:{value:function(e){var t=this.states.indexOf(e);if(-1===t)return;this.states.splice(t,1);this.emit("stateremoved",e)}},is:{value:function(e){return-1!==this.states.indexOf(e)}}});function f(e,t){if(e.components[t]&&e.components[t].attrValue)return true;return v(t,e.mixinEls)}function v(e,t){var r;var i=false;for(r=0;r<t.length;++r){i=t[r].hasAttribute(e);if(i)break}return i}function m(e,t){if(!t)return e;if(t.constructor===Object)return s.extend(t,s.styleParser.parse(e||{}));return e||t}function g(e){-1!==e.indexOf(h)&&(e=s.split(e,h)[0]);if(!n[e])return false;return true}function y(e){var t=o.Math.radToDeg;var r=e.object3D.rotation;var i=e.rotationObj;i.x=t(r.x);i.y=t(r.y);i.z=t(r.z);return i}u=a("a-entity",{prototype:p});t.exports=u},{"../lib/three":150,"../utils/":172,"./a-node":100,"./a-register-element":101,"./component":102}],99:[function(e,t,r){var i=e("./a-node");var n=e("./a-register-element").registerElement;var a=e("./component").components;var o=e("../utils");var s="__";t.exports=n("a-mixin",{prototype:Object.create(i.prototype,{createdCallback:{value:function(){this.componentCache={};this.id=this.getAttribute("id");this.isMixin=true}},attributeChangedCallback:{value:function(e,t,r){this.cacheAttribute(e,r)}},attachedCallback:{value:function(){this.sceneEl=this.closestScene();this.cacheAttributes();this.updateEntities();this.load()}},setAttribute:{value:function(e,t){window.HTMLElement.prototype.setAttribute.call(this,e,t);this.cacheAttribute(e,t)}},cacheAttribute:{value:function(e,t){var r;var i;i=o.split(e,s)[0];r=a[i];if(!r)return;void 0===t&&(t=window.HTMLElement.prototype.getAttribute.call(this,e));this.componentCache[e]=r.parseAttrValueForCache(t)}},getAttribute:{value:function(e){return this.componentCache[e]||window.HTMLElement.prototype.getAttribute.call(this,e)}},cacheAttributes:{value:function(){var e=this.attributes;var t;var r;for(r=0;r<e.length;r++){t=e[r].name;this.cacheAttribute(t)}}},updateEntities:{value:function(){var e;var t;var r;if(!this.sceneEl)return;t=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]");for(r=0;r<t.length;r++){e=t[r];if(!e.hasLoaded||e.isMixin)continue;e.mixinUpdate(this.id)}}}})})},{"../utils":172,"./a-node":100,"./a-register-element":101,"./component":102}],100:[function(e,t,r){var i=e("./a-register-element").registerElement;var n=e("./a-register-element").isNode;var a=e("../utils/");var o=a.debug("core:a-node:warn");var s={attributes:true};t.exports=i("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="";this.hasLoaded=false;this.isNode=true;this.mixinEls=[];this.mixinObservers={}},writable:window.debug},attachedCallback:{value:function(){var e;this.sceneEl=this.closestScene();this.sceneEl||o("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead.");this.hasLoaded=false;this.emit("nodeready",void 0,false);if(!this.isMixin){e=this.getAttribute("mixin");e&&this.updateMixins(e)}},writable:window.debug},attributeChangedCallback:{value:function(e,t,r){if(r===this.computedMixinStr)return;"mixin"!==e||this.isMixin||this.updateMixins(r,t)}},closestScene:{value:function e(){var t=this;while(t){if(t.isScene)break;t=t.parentElement}return t}},closest:{value:function e(t){var r=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;var i=this;while(i){if(r.call(i,t))break;i=i.parentElement}return i}},detachedCallback:{value:function(){this.hasLoaded=false}},load:{value:function(e,t){var r;var i;var a=this;if(this.hasLoaded)return;t=t||n;r=this.getChildren();i=r.filter(t).map(function(e){return new Promise(function t(r){if(e.hasLoaded)return r();e.addEventListener("loaded",r)})});Promise.all(i).then(function t(){a.hasLoaded=true;e&&e();a.emit("loaded",void 0,false)})},writable:true},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:function(){var e=[];var t=[];return function(r,i){var n;var o;var s;e.length=0;t.length=0;o=r?a.split(r.trim(),/\s+/):e;s=i?a.split(i.trim(),/\s+/):t;for(n=0;n<s.length;n++)-1===o.indexOf(s[n])&&this.unregisterMixin(s[n]);this.computedMixinStr="";this.mixinEls.length=0;for(n=0;n<o.length;n++)this.registerMixin(document.getElementById(o[n]));if(this.computedMixinStr){this.computedMixinStr=this.computedMixinStr.trim();window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)}}}()},registerMixin:{value:function(e){var t;var r;var i;if(!e)return;i=e.getAttribute("mixin");if(i){t=a.split(i.trim(),/\s+/);for(r=0;r<t.length;r++)this.registerMixin(document.getElementById(t[r]))}this.computedMixinStr=this.computedMixinStr+" "+e.id;this.mixinEls.push(e);this.attachMixinListener(e)}},setAttribute:{value:function(e,t){"mixin"===e&&this.updateMixins(t);window.HTMLElement.prototype.setAttribute.call(this,e,t)}},unregisterMixin:{value:function(e){var t;var r=this.mixinEls;var i;for(t=0;t<r.length;++t){i=r[t];if(e===i.id){r.splice(t,1);break}}this.removeMixinListener(e)}},removeMixinListener:{value:function(e){var t=this.mixinObservers[e];if(!t)return;t.disconnect();this.mixinObservers[e]=null}},attachMixinListener:{value:function(e){var t;var r;var i;var n=this;if(!e)return;r=e.id;t=this.mixinObservers[r];if(t)return;i=new MutationObserver(function(e){n.handleMixinUpdate(e[0].attributeName)});i.observe(e,s);this.mixinObservers[r]=i}},handleMixinUpdate:{value:function(){}},emit:{value:function(){var e={};return function(t,r,i,n){void 0===i&&(i=true);e.bubbles=!!i;e.detail=r;n&&(e=a.extend({},n,e));this.dispatchEvent(new CustomEvent(t,e))}}(),writable:window.debug}})})},{"../utils/":172,"./a-register-element":101}],101:[function(e,t,r){e("document-register-element");var i;var n;var a=t.exports.knownTags={};function o(e){a[e.toLowerCase()]=true}t.exports.isNode=function(e){return e.tagName.toLowerCase()in a||e.isNode};t.exports.registerElement=function(e,t){var r=Object.getPrototypeOf(t.prototype);var a=t;var c=i&&r===i.prototype;var l=n&&r===n.prototype;(c||l)&&o(e);if(c){a=s(t.prototype);a={prototype:Object.create(r,a)}}if(l){a=u(t.prototype);a={prototype:Object.create(r,a)}}Object.getOwnPropertyNames(a.prototype).forEach(function(e){var t=a.prototype[e];"function"===typeof t&&(t.displayName=e)});return document.registerElement(e,a)};function s(e){var t={};var r=["attachedCallback","attributeChangedCallback","createdCallback"];c(t,r,e,i.prototype);h(e,t);return t}function u(e){var t={};var r=["attachedCallback","attributeChangedCallback","createdCallback"];var a=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];c(t,r,e,i.prototype);c(t,a,e,n.prototype);h(e,t);return t}function c(e,t,r,i){t.forEach(function(t){l(e,t,r,i)})}t.exports.wrapMethods=c;function l(e,t,r,i){var n=r[t];var a=i[t];if(!n||!a)return;if(n===a)return;e[t]={value:function e(){a.apply(this,arguments);return n.apply(this,arguments)},writable:window.debug}}function h(e,t){var r=Object.getOwnPropertyNames(e);r.forEach(function(r){var i;if(!t[r]){i=Object.getOwnPropertyDescriptor(e,r);t[r]={value:e[r],writable:i.writable}}})}i=e("./a-node");n=e("./a-entity")},{"./a-entity":98,"./a-node":100,"document-register-element":11}],102:[function(e,t,r){var i=e("./schema");var n=e("./scene/scenes");var a=e("./system");var o=e("../utils/");var s=t.exports.components={};var u=i.parseProperties;var c=i.parseProperty;var l=i.process;var h=i.isSingleProperty;var d=i.stringifyProperties;var p=i.stringifyProperty;var f=o.styleParser;var v=o.debug("core:component:warn");var m=document.currentScript;var g=new RegExp("[A-Z]+");var y=t.exports.Component=function(e,t,r){var i=this;this.el=e;this.id=r;this.attrName=this.name+(r?"__"+r:"");this.evtDetail={id:this.id,name:this.name};this.initialized=false;this.el.components[this.attrName]=this;this.oldData=void 0;this.previousAttrValue=void 0;this.throttledEmitComponentChanged=o.throttle(function t(){e.emit("componentchanged",i.evtDetail,false)},200);this.updateProperties(t)};y.prototype={schema:{},init:function(){},update:function(e){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(e,t){var r=this.schema;if(h(r))return c(e,r);return u(f.parse(e),r,true,this.name,t)},stringify:function(e){var t=this.schema;if("string"===typeof e)return e;if(h(t))return p(e,t);e=d(e,t);return f.stringify(e)},updateCachedAttrValue:function(e,t){var r=this.parseAttrValueForCache(e);var i=h(this.schema);var n;if(void 0===e)return;if(!i&&!t){this.attrValue=this.attrValue?M(this.attrValue):{};for(n in r)this.attrValue[n]=r[n];return}this.attrValue=r},parseAttrValueForCache:function(e){var t;if("string"!==typeof e)return e;if(h(this.schema)){t=this.schema.parse(e);"string"===typeof t&&(t=e)}else t=f.parse(e);return t},flushToDOM:function(e){var t=e?this.data:this.attrValue;if(!t)return;window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(t))},updateProperties:function(e,t){var r=this.el;var i;var n;var a;var s=this.oldData;if(!r.hasLoaded){this.updateCachedAttrValue(e);return}i=h(this.schema);a=null!==e&&"object"===typeof this.previousAttrValue&&e===this.previousAttrValue;if(a){for(n in this.attrValue)if(!(n in e)){a=false;break}for(n in e)if(!(n in this.attrValue)){a=false;break}}this.previousAttrValue=e;e=this.parseAttrValueForCache(e);this.updateCachedAttrValue(e,t);this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,false,true));this.data=this.buildData(this.attrValue,t,false,a);if(this.initialized){if(o.deepEqual(this.oldData,this.data))return;this.oldData=w({},this.data,i);this.update(s);this.throttledEmitComponentChanged()}else{if(r.initializingComponents[this.name])return;r.initializingComponents[this.name]=true;this.init();this.initialized=true;delete r.initializingComponents[this.name];s=i&&"object"!==typeof c(void 0,this.schema)?void 0:{};this.oldData=w({},this.data,i);this.update(s);r.isPlaying&&this.play();r.emit("componentinitialized",this.evtDetail,false)}},resetProperty:function(e){if(h(this.schema))this.attrValue=void 0;else{if(!(e in this.attrValue))return;delete this.attrValue[e]}this.updateProperties(this.attrValue)},extendSchema:function(e){var t=o.extend({},s[this.name].schema);o.extend(t,e);this.schema=l(t);this.el.emit("schemachanged",{component:this.name})},buildData:function(e,t,r,i){var n;var a;var s;var l;var d;var p;var f=this.schema;var v;var m=h(f);var g=this.el.mixinEls;var y;n=e&&e.constructor===Array?e.length:void 0!==e&&null!==e;if(m)a=T(f.default)?o.clone(f.default):f.default;else{y=!t&&this.attrValue;a="object"===typeof y?M(y):{};for(v=0,l=Object.keys(f),d=l.length;v<d;v++){s=f[l[v]].default;if(void 0!==a[l[v]])continue;a[l[v]]=T(s)?o.clone(s):s}}for(v=0;v<g.length;v++){p=g[v].getAttribute(this.attrName);p&&(a=w(a,p,m))}if(n){if(m){if(true===i)return e;return c(e,f)}a=w(a,e,m)}else{if(true===i)return a;if(m)return c(a,f)}if(true===i)return a;return u(a,f,void 0,this.name,r)}};if(window.debug)var A=t.exports.registrationOrderWarnings={};t.exports.registerComponent=function(e,t){var r;var i={};document.currentScript&&document.currentScript!==m&&n.forEach(function t(r){if(r.hasLoaded)return;if(document.currentScript.compareDocumentPosition(r)===Node.DOCUMENT_POSITION_FOLLOWING)return;v("The component `"+e+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization.");window.debug&&(A[e]=true)});true===g.test(e)&&v("The component name `"+e+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+e.toLowerCase()+"`");if(-1!==e.indexOf("__"))throw new Error("The component name `"+e+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");Object.keys(t).forEach(function(e){i[e]={value:t[e],writable:true}});if(s[e])throw new Error("The component `"+e+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");r=function(e,t,r){y.call(this,e,t,r)};r.prototype=Object.create(y.prototype,i);r.prototype.name=e;r.prototype.constructor=r;r.prototype.system=a&&a.systems[e];r.prototype.play=b(r.prototype.play);r.prototype.pause=x(r.prototype.pause);s[e]={Component:r,dependencies:r.prototype.dependencies,isSingleProp:h(r.prototype.schema),multiple:r.prototype.multiple,parse:r.prototype.parse,parseAttrValueForCache:r.prototype.parseAttrValueForCache,schema:o.extend(l(r.prototype.schema,r.prototype.name)),stringify:r.prototype.stringify,type:r.prototype.type};return r};function M(e){var t={};var r;var i;for(i in e){r=e[i];t[i]=T(r)?o.clone(r):r}return t}function w(e,t,r){if(r&&(null===t||"object"!==typeof t))return t;var i=o.extend(e,t);var n;for(n in i){if(!i[n]||i[n].constructor!==Object)continue;i[n]=o.clone(i[n])}return i}function E(e){return e.tick||e.tock}function x(e){return function t(){var r=this.el.sceneEl;if(!this.isPlaying)return;e.call(this);this.isPlaying=false;if(!E(this))return;r.removeBehavior(this)}}function b(e){return function t(){var r=this.el.sceneEl;var i=this.el.isPlaying&&!this.isPlaying;if(!this.initialized||!i)return;e.call(this);this.isPlaying=true;if(!E(this))return;r.addBehavior(this)}}function T(e){return e&&(e.constructor===Object||e.constructor===Array)}},{"../utils/":172,"./scene/scenes":108,"./schema":110,"./system":112}],103:[function(e,t,r){var i=e("./schema");var n=i.process;var a=t.exports.geometries={};var o=t.exports.geometryNames=[];var s=e("../lib/three");var u=t.exports.Geometry=function(){};u.prototype={schema:{},init:function(e){this.geometry=new s.Geometry;return this.geometry},update:function(e){}};t.exports.registerGeometry=function(e,t){var r;var i={};Object.keys(t).forEach(function e(r){i[r]={value:t[r],writable:true}});if(a[e])throw new Error("The geometry `"+e+"` has been already registered");r=function(){u.call(this)};r.prototype=Object.create(u.prototype,i);r.prototype.name=e;r.prototype.constructor=r;a[e]={Geometry:r,schema:n(r.prototype.schema)};o.push(e);return r}},{"../lib/three":150,"./schema":110}],104:[function(e,t,r){var i=e("../utils/coordinates");var n=e("debug");var a=n("core:propertyTypes:warn");var o=n("core:propertyTypes:warn");var s=t.exports.propertyTypes={};var u=/[,> .[\]:]/;c("audio","",d);c("array",[],l,h);c("asset","",d);c("boolean",false,v);c("color","#FFF",p,f);c("int",0,m);c("number",0,g);c("map","",d);c("model","",d);c("selector",null,y,M);c("selectorAll",null,A,w);c("src","",E);c("string","",p,f);c("time",0,m);c("vec2",{x:0,y:0},x,i.stringify);c("vec3",{x:0,y:0,z:0},x,i.stringify);c("vec4",{x:0,y:0,z:0,w:1},x,i.stringify);function c(e,t,r,i){if("type"in s){a("Property type "+e+" is already registered.");return}s[e]={default:t,parse:r||p,stringify:i||f}}t.exports.registerPropertyType=c;function l(e){if(Array.isArray(e))return e;if(!e||"string"!==typeof e)return[];return e.split(",").map(t);function t(e){return e.trim()}}function h(e){return e.join(", ")}function d(e){var t;var r;if("string"!==typeof e)return e;r=e.match(/\url\((.+)\)/);if(r)return r[1];if("#"===e.charAt(0)){t=document.getElementById(e.substring(1));if(t){if("CANVAS"===t.tagName||"VIDEO"===t.tagName||"IMG"===t.tagName)return t;return t.getAttribute("src")}o('"'+e+'" asset not found.');return}return e}function p(e){return e}function f(e){if(null===e)return"null";return e.toString()}function v(e){return"false"!==e&&false!==e}function m(e){return parseInt(e,10)}function g(e){return parseFloat(e,10)}function y(e){if(!e)return null;if("string"!==typeof e)return e;if("#"===e[0]&&!u.test(e))return document.getElementById(e.substring(1));return document.querySelector(e)}function A(e){if(!e)return null;if("string"!==typeof e)return e;return Array.prototype.slice.call(document.querySelectorAll(e),0)}function M(e){if(e.getAttribute)return"#"+e.getAttribute("id");return f(e)}function w(e){if(e instanceof Array)return e.map(function(e){return"#"+e.getAttribute("id")}).join(", ");return f(e)}function E(e){o("`src` property type is deprecated. Use `asset` instead.");return d(e)}function x(e){return i.parse(e,this.default)}function b(e,t){if("audio"===e&&"string"!==typeof t)return false;if("array"===e&&!Array.isArray(t))return false;if("asset"===e&&"string"!==typeof t)return false;if("boolean"===e&&"boolean"!==typeof t)return false;if("color"===e&&"string"!==typeof t)return false;if("int"===e&&"number"!==typeof t)return false;if("number"===e&&"number"!==typeof t)return false;if("map"===e&&"string"!==typeof t)return false;if("model"===e&&"string"!==typeof t)return false;if("selector"===e&&"string"!==typeof t&&null!==t)return false;if("selectorAll"===e&&"string"!==typeof t&&null!==t)return false;if("src"===e&&"string"!==typeof t)return false;if("string"===e&&"string"!==typeof t)return false;if("time"===e&&"number"!==typeof t)return false;if("vec2"===e)return T(t,2);if("vec3"===e)return T(t,3);if("vec4"===e)return T(t,4);return true}t.exports.isValidDefaultValue=b;function T(e,t){if(null===e)return true;if("object"!==typeof e)return false;if(Object.keys(e).length!==t)return false;var r=e.x;var i=e.y;var n=e.z;var a=e.w;if("number"!==typeof r||"number"!==typeof i)return false;if(t>2&&"number"!==typeof n)return false;if(t>3&&"number"!==typeof a)return false;return true}t.exports.isValidDefaultCoordinate=T},{"../utils/coordinates":167,debug:8}],105:[function(e,t,r){var i=e("./metaTags").inject;var n=e("./wakelock");var a=e("../a-register-element");var o=e("./scenes");var s=e("../system").systems;var u=e("../../lib/three");var c=e("@tweenjs/tween.js");var l=e("../../utils/");var h=e("../a-entity");var d=e("../a-node");var p=e("./postMessage");var f=l.bind;var v=l.device.isIOS();var m=l.device.isMobile();var g=a.registerElement;var y=l.debug("core:a-scene:warn");t.exports.AScene=g("a-scene",{prototype:Object.create(h.prototype,{createdCallback:{value:function(){this.isIOS=v;this.isMobile=m;this.isScene=true;this.object3D=new u.Scene;var e=this;this.object3D.onAfterRender=function(t,r,i){e.isPlaying&&e.tock(e.time,e.delta,i)};this.render=f(this.render,this);this.systems={};this.systemNames=[];this.time=this.delta=0;this.init()}},init:{value:function(){this.behaviors={tick:[],tock:[]};this.hasLoaded=false;this.isPlaying=false;this.originalHTML=this.innerHTML;this.renderTarget=null;E(this);this.setupRenderer();this.resize();this.addFullScreenStyles();p(this);this.setAttribute("inspector","");this.setAttribute("keyboard-shortcuts","");this.setAttribute("screenshot","");this.setAttribute("vr-mode-ui","")},writable:true},addFullScreenStyles:{value:function(){var e=document.documentElement;e.classList.add("a-html");document.body.classList.add("a-body");this.classList.add("fullscreen")}},removeFullScreenStyles:{value:function(){var e=document.documentElement;e.classList.remove("a-html");document.body.classList.remove("a-body");this.classList.remove("fullscreen")}},attachedCallback:{value:function(){var e;var t=this;i(this);n(this);this.initSystems();e=f(this.resize,this);window.addEventListener("load",e);window.addEventListener("resize",function(){this.isIOS?setTimeout(e,100):e()});this.play();o.push(this);this.onVRPresentChangeBound=f(this.onVRPresentChange,this);window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound);this.enterVRBound=function(){t.enterVR()};this.exitVRBound=function(){t.exitVR()};this.exitVRTrueBound=function(){t.exitVR(true)};this.pointerRestrictedBound=function(){t.pointerRestricted()};this.pointerUnrestrictedBound=function(){t.pointerUnrestricted()};window.addEventListener("vrdisplayactivate",this.enterVRBound);window.addEventListener("vrdisplaydeactivate",this.exitVRBound);window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound);window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound);window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)},writable:window.debug},initSystems:{value:function(){Object.keys(s).forEach(f(this.initSystem,this))}},initSystem:{value:function(e){if(this.systems[e])return;this.systems[e]=new s[e](this);this.systemNames.push(e)}},detachedCallback:{value:function(){var e=o.indexOf(this);o.splice(e,1);window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound);window.removeEventListener("vrdisplayactivate",this.enterVRBound);window.removeEventListener("vrdisplaydeactivate",this.exitVRBound);window.removeEventListener("vrdisplayconnect",this.enterVRBound);window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound);window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound);window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)}},addBehavior:{value:function(e){var t;var r=this.behaviors;var i;for(i in r){if(!e[i])continue;t=this.behaviors[i];-1===t.indexOf(e)&&t.push(e)}}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:l.device.checkHeadsetConnected,writable:window.debug},enterVR:{value:function(e){var t=this;var r;var i=t.renderer.vr;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(!e&&(this.checkHeadsetConnected()||this.isMobile)){r=l.device.getVRDisplay();i.setDevice(r);i.enabled=true;return r.requestPresent([{source:this.canvas}]).then(n,a)}n();return Promise.resolve();function n(){t.addState("vr-mode");t.emit("enter-vr",{target:t});t.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape");t.addFullScreenStyles();t.isMobile||t.checkHeadsetConnected()||M(t.canvas);t.resize()}function a(e){throw e&&e.message?new Error("Failed to enter VR mode (`requestPresent`): "+e.message):new Error("Failed to enter VR mode (`requestPresent`).")}},writable:true},exitVR:{value:function(e){var t=this;var r;if(!this.is("vr-mode"))return Promise.resolve("Not in VR.");w();if(!e&&(this.checkHeadsetConnected()||this.isMobile)){this.renderer.vr.enabled=false;r=l.device.getVRDisplay();return r.exitPresent().then(i,n)}i();return Promise.resolve();function i(){t.removeState("vr-mode");t.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();t.hasAttribute("embedded")&&t.removeFullScreenStyles();t.resize();t.isIOS&&l.forceCanvasResizeSafariMobile(this.canvas);t.emit("exit-vr",{target:t})}function n(e){throw e&&e.message?new Error("Failed to exit VR mode (`exitPresent`): "+e.message):new Error("Failed to exit VR mode (`exitPresent`).")}},writable:true},pointerRestricted:{value:function(){if(this.canvas){var e=this.getPointerLockElement();e&&e!==this.canvas&&document.exitPointerLock&&document.exitPointerLock();this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var e=this.getPointerLockElement();e&&e===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(e){var t=e.display||e.detail.display;if(t.isPresenting){this.enterVR(true);return}this.exitVR(true)}},getAttribute:{value:function(e){var t=this.systems[e];if(t)return t.data;return h.prototype.getAttribute.call(this,e)}},getComputedAttribute:{value:function(e){y("`getComputedAttribute` is deprecated. Use `getAttribute` instead.");this.getAttribute(e)}},getDOMAttribute:{value:function(e){var t=this.systems[e];if(t)return t.data;return h.prototype.getDOMAttribute.call(this,e)}},setAttribute:{value:function(e,t,r){var i=this.systems[e];if(i){d.prototype.setAttribute.call(this,e,t);i.updateProperties(t);return}h.prototype.setAttribute.call(this,e,t,r)}},removeBehavior:{value:function(e){var t;var r;var i=this.behaviors;var n;for(r in i){if(!e[r])continue;t=this.behaviors[r];n=t.indexOf(e);-1!==n&&t.splice(n,1)}}},resize:{value:function(){var e=this.camera;var t=this.canvas;var r=this.getAttribute("embedded")&&!this.is("vr-mode");var i;var n;var a;n=this.renderer.vr.getDevice();a=this.renderer.vr.enabled&&n&&n.isPresenting;if(!e||!t||this.is("vr-mode")&&(this.isMobile||a))return;i=A(t,r);e.aspect=i.width/i.height;e.updateProjectionMatrix();this.renderer.setSize(i.width,i.height,false)},writable:true},setupRenderer:{value:function(){var e=this;var t;var r;var i;var n={canvas:this.canvas,antialias:!m,alpha:true};this.hasAttribute("antialias")&&(n.antialias="true"===this.getAttribute("antialias"));if(this.hasAttribute("renderer")){i=this.getAttribute("renderer");r=l.styleParser.parse(i);r.antialias&&"auto"!==r.antialias&&(n.antialias="true"===r.antialias)}t=this.renderer=new u.WebGLRenderer(n);t.setPixelRatio(window.devicePixelRatio);t.sortObjects=false;this.addEventListener("camera-set-active",function(){t.vr.setPoseTarget(e.camera.el.object3D)})},writable:window.debug},play:{value:function(){var e=this;if(this.renderStarted){h.prototype.play.call(this);return}this.addEventListener("loaded",function(){h.prototype.play.call(this);if(this.camera){e(this);return}this.addEventListener("camera-set-active",function(){e(this)});function e(e){if(e.renderStarted)return;e.resize();if(e.renderer){window.performance&&window.performance.mark("render-started");e.clock=new u.Clock;e.render();e.renderStarted=true;e.emit("renderstart")}}});setTimeout(function(){h.prototype.load.call(e)})}},updateComponent:{value:function(e){if(e in s)return;h.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(e,t){var r;var i=this.systems;c.update();for(r=0;r<this.behaviors.tick.length;r++){if(!this.behaviors.tick[r].el.isPlaying)continue;this.behaviors.tick[r].tick(e,t)}for(r=0;r<this.systemNames.length;r++){if(!i[this.systemNames[r]].tick)continue;i[this.systemNames[r]].tick(e,t)}}},tock:{value:function(e,t,r){var i;var n=this.systems;for(i=0;i<this.behaviors.tock.length;i++){if(!this.behaviors.tock[i].el.isPlaying)continue;this.behaviors.tock[i].tock(e,t,r)}for(i=0;i<this.systemNames.length;i++){if(!n[this.systemNames[i]].tock)continue;n[this.systemNames[i]].tock(e,t,r)}}},render:{value:function(){this.delta=1e3*this.clock.getDelta();var e=this.renderer;this.time=1e3*this.clock.elapsedTime;this.isPlaying&&this.tick(this.time,this.delta);e.animate(this.render);e.render(this.object3D,this.camera,this.renderTarget)},writable:true}})});function A(e,t){if(t)return{height:e.parentElement.offsetHeight,width:e.parentElement.offsetWidth};return{height:window.innerHeight,width:window.innerWidth}}function M(e){var t=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;t.apply(e)}function w(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function E(e){var t;t=document.createElement("canvas");t.classList.add("a-canvas");t.dataset.aframeCanvas=true;e.appendChild(t);document.addEventListener("fullscreenchange",r);document.addEventListener("mozfullscreenchange",r);document.addEventListener("webkitfullscreenchange",r);t.addEventListener("touchmove",function(e){e.preventDefault()});e.canvas=t;e.emit("render-target-loaded",{target:t});setTimeout(f(e.resize,e),0);function r(){var t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;t||e.exitVR();document.activeElement.blur();document.body.focus()}}t.exports.setupCanvas=E},{"../../lib/three":150,"../../utils/":172,"../a-entity":98,"../a-node":100,"../a-register-element":101,"../system":112,"./metaTags":106,"./postMessage":107,"./scenes":108,"./wakelock":109,"@tweenjs/tween.js":1}],106:[function(e,t,r){var i=e("../../constants/");var n=e("../../utils").extend;var a=t.exports.MOBILE_HEAD_TAGS=[s({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui"}),s({name:"mobile-web-app-capable",content:"yes"}),s({name:"theme-color",content:"black"})];var o=[s({name:"apple-mobile-web-app-capable",content:"yes"}),s({name:"apple-mobile-web-app-status-bar-style",content:"black"}),u({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function s(e){return{tagName:"meta",attributes:e,exists:function(){return document.querySelector('meta[name="'+e.name+'"]')}}}function u(e){return{tagName:"link",attributes:e,exists:function(){return document.querySelector('link[rel="'+e.rel+'"]')}}}t.exports.inject=function e(t){var r=document.head;var i=r.querySelector("script");var n;var s=[];a.forEach(u);t.isIOS&&o.forEach(u);return s;function u(e){if(!e||e.exists())return;n=c(e);if(!n)return;i?i.parentNode.insertBefore(n,i):r.appendChild(n);s.push(n)}};function c(e){if(!e||!e.tagName)return;var t=document.createElement(e.tagName);t.setAttribute(i.AFRAME_INJECTED,"");return n(t,e.attributes)}},{"../../constants/":93,"../../utils":172}],107:[function(e,t,r){var i=e("../../utils/bind");var n=e("../../utils/").isIframed;t.exports=function e(t){if(!n())return;window.addEventListener("message",i(a,t))};function a(e){var t=this;if(!e.data)return;switch(e.data.type){case"vr":switch(e.data.data){case"enter":t.enterVR();break;case"exit":t.exitVR();break}}}},{"../../utils/":172,"../../utils/bind":166}],108:[function(e,t,r){t.exports=[]},{}],109:[function(e,t,r){var i=e("../../../vendor/wakelock/wakelock");t.exports=function e(t){if(!t.isMobile)return;var r=t.wakelock=new i;t.addEventListener("enter-vr",function(){r.request()});t.addEventListener("exit-vr",function(){r.release()})}},{"../../../vendor/wakelock/wakelock":182}],110:[function(e,t,r){var i=e("../utils/");var n=e("./propertyTypes");var a=i.debug;var o=n.isValidDefaultValue;var s=n.propertyTypes;var u=a("core:schema:warn");function c(e){if("type"in e)return"string"===typeof e.type;return"default"in e}t.exports.isSingleProperty=c;t.exports.process=function(e,t){var r;if(c(e))return l(e,t);for(r in e)e[r]=l(e[r],t);return e};function l(e,t){var r=e.default;var i;var n;var a=e.type;e.type?"bool"===e.type?a="boolean":"float"===e.type&&(a="number"):a=void 0===r||"boolean"!==typeof r&&"number"!==typeof r?Array.isArray(r)?"array":"string":typeof r;n=s[a];n||u("Unknown property type for component `"+t+"`: "+a);i=!!e.parse;e.parse=e.parse||n.parse;e.stringify=e.stringify||n.stringify;e.type=a;"default"in e?i||o(a,r)||u("Default value `"+r+"` does not match type `"+a+"` in component `"+t+"`"):e.default=n.default;return e}t.exports.processPropertyDefinition=l;t.exports.parseProperties=function(){var e=[];return function(t,r,i,n,a){var o;var s;var c;var l;e.length=0;for(s in i?t:r)e.push(s);if(null===t||"object"!==typeof t)return t;for(s in t)r[s]||a||u("Unknown property `"+s+"` for component/system `"+n+"`.");for(o=0;o<e.length;o++){s=e[o];c=r[s];l=t[s];if(!r[s])return;t[s]=h(l,c)}return t}}();function h(e,t){if(void 0===e||null===e||""===e){e=t.default;Array.isArray(e)&&(e=e.slice())}return t.parse(e,t.default)}t.exports.parseProperty=h;t.exports.stringifyProperties=function(e,t){var r;var i;var n;var a={};var o;for(r in e){i=t[r];n=e[r];o=n;if("object"===typeof o){o=d(n,i);i||u("Unknown component property: "+r)}a[r]=o}return a};function d(e,t){if("object"!==typeof e)return e;if(!t||null===e)return JSON.stringify(e);return t.stringify(e)}t.exports.stringifyProperty=d},{"../utils/":172,"./propertyTypes":104}],111:[function(e,t,r){var i=e("./schema");var n=i.process;var a=t.exports.shaders={};var o=t.exports.shaderNames=[];var s=e("../lib/three");var u=e("../utils");var c={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"};var l=t.exports.Shader=function(){};l.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(e){this.attributes=this.initVariables(e,"attribute");this.uniforms=this.initVariables(e,"uniform");this.material=new(this.raw?s.RawShaderMaterial:s.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader});return this.material},initVariables:function(e,t){var r;var i=this.schema;var n={};var a;for(r in i){if(i[r].is!==t)continue;a=c[i[r].type];n[r]={type:a,value:void 0}}return n},update:function(e){this.updateVariables(e,"attribute");this.updateVariables(e,"uniform")},updateVariables:function(e,t){var r;var i;var n=this.schema;var a;a="uniform"===t?this.uniforms:this.attributes;for(r in e){if(!n[r]||n[r].is!==t)continue;if("map"===n[r].type){if(!a[r]||a[r].value===e[r])continue;i="_texture_"+r;this.setMapOnTextureLoad(a,r,i);u.material.updateMapMaterialFromData(i,r,this,e);continue}a[r].value=this.parseValue(n[r].type,e[r]);a[r].needsUpdate=true}},parseValue:function(e,t){var r;switch(e){case"vec2":return new s.Vector2(t.x,t.y);case"vec3":return new s.Vector3(t.x,t.y,t.z);case"vec4":return new s.Vector4(t.x,t.y,t.z,t.w);case"color":r=new s.Color(t);return new s.Vector3(r.r,r.g,r.b);case"map":return s.ImageUtils.loadTexture(t);default:return t}},setMapOnTextureLoad:function(e,t,r){var i=this;this.el.addEventListener("materialtextureloaded",function(){e[t].value=i.material[r];e[t].needsUpdate=true})}};t.exports.registerShader=function(e,t){var r;var i={};Object.keys(t).forEach(function(e){i[e]={value:t[e],writable:true}});if(a[e])throw new Error("The shader "+e+" has been already registered");r=function(){l.call(this)};r.prototype=Object.create(l.prototype,i);r.prototype.name=e;r.prototype.constructor=r;a[e]={Shader:r,schema:n(r.prototype.schema)};o.push(e);return r}},{"../lib/three":150,"../utils":172,"./schema":110}],112:[function(e,t,r){var i=e("./component");var n=e("./schema");var a=e("../utils/");var o=n.parseProperties;var s=n.parseProperty;var u=n.process;var c=n.isSingleProperty;var l=a.styleParser;var h=t.exports.systems={};var d=t.exports.System=function(e){var t=i&&i.components[this.name];this.el=e;this.sceneEl=e;t&&(t.Component.prototype.system=this);this.buildData();this.init();this.update({})};d.prototype={schema:{},init:function(){},update:function(e){},updateProperties:function(e){var t=this.data;if(!Object.keys(n).length)return;this.buildData(e);this.update(t)},buildData:function(e){var t=this.schema;if(!Object.keys(t).length)return;e=e||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name);c(t)?this.data=s(e,t):this.data=o(l.parse(e)||{},t)},tick:void 0,tock:void 0,play:function(){},pause:function(){}};t.exports.registerSystem=function(e,t){var r;var i;var n={};var o=a.findAllScenes(document);Object.keys(t).forEach(function(e){n[e]={value:t[e],writable:true}});if(h[e])throw new Error("The system `"+e+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");i=function(e){d.call(this,e)};i.prototype=Object.create(d.prototype,n);i.prototype.name=e;i.prototype.constructor=i;i.prototype.schema=a.extend(u(i.prototype.schema));h[e]=i;for(r=0;r<o.length;r++)o[r].initSystem(e)}},{"../utils/":172,"./component":102,"./schema":110}],113:[function(e,t,r){e("./pivot")},{"./pivot":114}],114:[function(e,t,r){var i=e("../../core/component").registerComponent;var n=e("../../lib/three");var a=new n.Vector3;var o=new n.Vector3;i("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var e=this.data;var t=this.el;var r=t.object3D.parent;var i=t.object3D;var s=new n.Group;a.copy(i.position);o.copy(i.rotation);r.remove(i);s.add(i);r.add(s);t.object3D=s;i.position.set(-1*e.x,-1*e.y,-1*e.z);s.position.set(e.x+a.x,e.y+a.y,e.z+a.z);s.rotation.copy(i.rotation);i.rotation.set(0,0,0)}})},{"../../core/component":102,"../../lib/three":150}],115:[function(e,t,r){var i=e("../../core/component").components;var n=e("../../core/shader").shaders;var a=e("../../utils/");var o={};Object.keys(i.material.schema).forEach(s);Object.keys(n.standard.schema).forEach(s);function s(e){var t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();"fog"===e&&(t="material-fog");"visible"===e&&(t="material-visible");o[t]="material."+e}t.exports=function e(){return{defaultComponents:{material:{}},mappings:a.extend({},o)}}},{"../../core/component":102,"../../core/shader":111,"../../utils/":172}],116:[function(e,t,r){e("./primitives/a-camera");e("./primitives/a-collada-model");e("./primitives/a-cursor");e("./primitives/a-curvedimage");e("./primitives/a-gltf-model");e("./primitives/a-image");e("./primitives/a-light");e("./primitives/a-link");e("./primitives/a-obj-model");e("./primitives/a-sky");e("./primitives/a-sound");e("./primitives/a-text");e("./primitives/a-video");e("./primitives/a-videosphere");e("./primitives/meshPrimitives")},{"./primitives/a-camera":118,"./primitives/a-collada-model":119,"./primitives/a-cursor":120,"./primitives/a-curvedimage":121,"./primitives/a-gltf-model":122,"./primitives/a-image":123,"./primitives/a-light":124,"./primitives/a-link":125,"./primitives/a-obj-model":126,"./primitives/a-sky":127,"./primitives/a-sound":128,"./primitives/a-text":129,"./primitives/a-video":130,"./primitives/a-videosphere":131,"./primitives/meshPrimitives":132}],117:[function(e,t,r){var i=e("../../core/a-entity");var n=e("../../core/component").components;var a=e("../../core/a-register-element").registerElement;var o=e("../../utils/");var s=o.debug;var u=o.entity.setComponentProperty;var c=s("extras:primitives:debug");var l=s("extras:primitives:warn");var h=t.exports.primitives={};t.exports.registerPrimitive=function e(t,r){t=t.toLowerCase();c("Registering <%s>",t);r.defaultAttributes&&l("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var s=a(t,{prototype:Object.create(i.prototype,{defaultComponentsFromPrimitive:{value:r.defaultComponents||r.defaultAttributes||{}},deprecated:{value:r.deprecated||null},deprecatedMappings:{value:r.deprecatedMappings||{}},mappings:{value:r.mappings||{}},createdCallback:{value:function(){r.deprecated&&console.warn(r.deprecated);this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var e=this.mappings;var t=this;Object.keys(e).forEach(function r(i){var a;i!==i.toLowerCase()&&l("Mapping keys should be specified in lower case. The mapping key "+i+" may not be recognized");if(n[i]){a=e[i].replace(".","-");e[a]=e[i];delete e[i];console.warn("The primitive "+t.tagName.toLowerCase()+" has a mapping collision. The attribute "+i+" has the same name as a registered component and has been renamed to "+a)}})}},getExtraComponents:{value:function(){var e;var t;var r;var i;var n;var a;var s=this;t=o.clone(this.defaultComponentsFromPrimitive);n=this.getAttribute("mixin");if(n){n=n.trim().split(" ");n.forEach(function e(r){var i=s.sceneEl.querySelector("#"+r).componentCache;Object.keys(i).forEach(function e(r){t[r]=u(t[r],i[r])})})}for(r=0;r<this.attributes.length;r++){e=this.attributes[r];i=this.mappings[e.name];if(i){a=o.entity.getComponentPropertyPath(i);if(a.constructor===Array){t[a[0]]=t[a[0]]||{};t[a[0]][a[1]]=e.value.trim()}else t[a]=e.value.trim();continue}}return t;function u(e,t){if(c(e))return l(t);if(c(t))return l(e);if(h(e)&&h(t))return o.extendDeep(e,t);return l(t)}function c(e){return"undefined"===typeof e}function l(e){if(h(e))return o.extendDeep({},e);return e}function h(e){return null!==e&&e.constructor===Object}}},attributeChangedCallback:{value:function(e,t,r){var i=this.mappings[e];e in this.deprecatedMappings&&console.warn(this.deprecatedMappings[e]);if(!e||!i)return;u(this,i,r)}}})});h[t]=s;return s};function d(e,t){var r=n[e].schema;Object.keys(r).map(function(r){var i=r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();void 0!==t[i]&&(i=e+"-"+r);t[i]=e+"."+r})}function p(e,r,i){i=i||{};Object.keys(r).map(function e(t){d(t,i)});t.exports.registerPrimitive(e,o.extendDeep({},null,{defaultComponents:r,mappings:i}))}t.exports.definePrimitive=p},{"../../core/a-entity":98,"../../core/a-register-element":101,"../../core/component":102,"../../utils/":172}],118:[function(e,t,r){var i=e("../primitives").registerPrimitive;i("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{y:1.6}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},{"../primitives":117}],119:[function(e,t,r){var i=e("../primitives").registerPrimitive;i("a-collada-model",{mappings:{src:"collada-model"}})},{"../primitives":117}],120:[function(e,t,r){var i=e("../getMeshMixin");var n=e("../primitives").registerPrimitive;var a=e("../../../utils/");n("a-cursor",a.extendDeep({},i(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":172,"../getMeshMixin":115,"../primitives":117}],121:[function(e,t,r){var i=e("../getMeshMixin");var n=e("../primitives").registerPrimitive;var a=e("../../../utils/");n("a-curvedimage",a.extendDeep({},i(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:true,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:true,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":172,"../getMeshMixin":115,"../primitives":117}],122:[function(e,t,r){var i=e("../primitives").registerPrimitive;i("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":117}],123:[function(e,t,r){var i=e("../getMeshMixin");var n=e("../primitives").registerPrimitive;var a=e("../../../utils/");n("a-image",a.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:true}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":172,"../getMeshMixin":115,"../primitives":117}],124:[function(e,t,r){var i=e("../primitives").registerPrimitive;i("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},{"../primitives":117}],125:[function(e,t,r){var i=e("../primitives").registerPrimitive;i("a-link",{defaultComponents:{},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":117}],126:[function(e,t,r){var i=e("../getMeshMixin")();var n=e("../primitives").registerPrimitive;var a=e("../../../utils/");n("a-obj-model",a.extendDeep({},i,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":172,"../getMeshMixin":115,"../primitives":117}],127:[function(e,t,r){var i=e("../getMeshMixin");var n=e("../primitives").registerPrimitive;var a=e("../../../utils/");var o=e("./meshPrimitives");n("a-sky",a.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"sphere",radius:5e3,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:true},scale:"-1 1 1"},mappings:a.extendDeep({},o["a-sphere"].prototype.mappings)}))},{"../../../utils/":172,"../getMeshMixin":115,"../primitives":117,"./meshPrimitives":132}],128:[function(e,t,r){var i=e("../primitives").registerPrimitive;i("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":117}],129:[function(e,t,r){var i=e("../primitives").definePrimitive;i("a-text",{text:{anchor:"align",width:5}})},{"../primitives":117}],130:[function(e,t,r){var i=e("../getMeshMixin");var n=e("../primitives").registerPrimitive;var a=e("../../../utils/");n("a-video",a.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:true}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":172,"../getMeshMixin":115,"../primitives":117}],131:[function(e,t,r){var i=e("../getMeshMixin");var n=e("../primitives").registerPrimitive;var a=e("../../../utils/");n("a-videosphere",a.extendDeep({},i(),{defaultComponents:{geometry:{primitive:"sphere",radius:5e3,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:true},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":172,"../getMeshMixin":115,"../primitives":117}],132:[function(e,t,r){var i=e("../getMeshMixin");var n=e("../../../core/geometry").geometries;var a=e("../../../core/geometry").geometryNames;var o=e("../primitives").registerPrimitive;var s=e("../../../utils/");var u=t.exports={};a.forEach(function e(t){var r=n[t];var a=c(t);var l={};Object.keys(r.schema).forEach(function e(t){l[c(t)]="geometry."+t});var h="a-"+a;var d=o(h,s.extendDeep({},i(),{defaultComponents:{geometry:{primitive:t}},mappings:l}));u[h]=d});function c(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{"../../../core/geometry":103,"../../../utils/":172,"../getMeshMixin":115,"../primitives":117}],133:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");i("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(e){this.geometry=new n.BoxGeometry(e.width,e.height,e.depth,e.segmentsWidth,e.segmentsHeight,e.segmentsDepth)}})},{"../core/geometry":103,"../lib/three":150}],134:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");var a=n.Math.degToRad;i("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new n.CircleGeometry(e.radius,e.segments,a(e.thetaStart),a(e.thetaLength))}})},{"../core/geometry":103,"../lib/three":150}],135:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");var a=n.Math.degToRad;i("cone",{schema:{height:{default:1,min:0},openEnded:{default:false},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new n.CylinderGeometry(e.radiusTop,e.radiusBottom,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,a(e.thetaStart),a(e.thetaLength))}})},{"../core/geometry":103,"../lib/three":150}],136:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");var a=n.Math.degToRad;i("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:false},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new n.CylinderGeometry(e.radius,e.radius,e.height,e.segmentsRadial,e.segmentsHeight,e.openEnded,a(e.thetaStart),a(e.thetaLength))}})},{"../core/geometry":103,"../lib/three":150}],137:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");i("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new n.DodecahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":103,"../lib/three":150}],138:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");i("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new n.IcosahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":103,"../lib/three":150}],139:[function(e,t,r){e("./box.js");e("./circle.js");e("./cone.js");e("./cylinder.js");e("./dodecahedron.js");e("./icosahedron.js");e("./octahedron.js");e("./plane.js");e("./ring.js");e("./sphere.js");e("./tetrahedron.js");e("./torus.js");e("./torusKnot.js");e("./triangle.js")},{"./box.js":133,"./circle.js":134,"./cone.js":135,"./cylinder.js":136,"./dodecahedron.js":137,"./icosahedron.js":138,"./octahedron.js":140,"./plane.js":141,"./ring.js":142,"./sphere.js":143,"./tetrahedron.js":144,"./torus.js":145,"./torusKnot.js":146,"./triangle.js":147}],140:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");i("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new n.OctahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":103,"../lib/three":150}],141:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");i("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(e){this.geometry=new n.PlaneGeometry(e.width,e.height,e.segmentsWidth,e.segmentsHeight)}})},{"../core/geometry":103,"../lib/three":150}],142:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");var a=n.Math.degToRad;i("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(e){this.geometry=new n.RingGeometry(e.radiusInner,e.radiusOuter,e.segmentsTheta,e.segmentsPhi,a(e.thetaStart),a(e.thetaLength))}})},{"../core/geometry":103,"../lib/three":150}],143:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");var a=n.Math.degToRad;i("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(e){this.geometry=new n.SphereGeometry(e.radius,e.segmentsWidth,e.segmentsHeight,a(e.phiStart),a(e.phiLength),a(e.thetaStart),a(e.thetaLength))}})},{"../core/geometry":103,"../lib/three":150}],144:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");i("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(e){this.geometry=new n.TetrahedronGeometry(e.radius,e.detail)}})},{"../core/geometry":103,"../lib/three":150}],145:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");var a=n.Math.degToRad;i("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(e){this.geometry=new n.TorusGeometry(e.radius,2*e.radiusTubular,e.segmentsRadial,e.segmentsTubular,a(e.arc))}})},{"../core/geometry":103,"../lib/three":150}],146:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");i("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(e){this.geometry=new n.TorusKnotGeometry(e.radius,2*e.radiusTubular,e.segmentsTubular,e.segmentsRadial,e.p,e.q)}})},{"../core/geometry":103,"../lib/three":150}],147:[function(e,t,r){var i=e("../core/geometry").registerGeometry;var n=e("../lib/three");var a=new n.Quaternion;var o=new n.Vector3(0,0,1);var s=new n.Vector2;var u=new n.Vector2;var c=new n.Vector2;i("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(e){var t;var r;var i;var l;var h;var d;i=new n.Triangle;i.a.set(e.vertexA.x,e.vertexA.y,e.vertexA.z);i.b.set(e.vertexB.x,e.vertexB.y,e.vertexB.z);i.c.set(e.vertexC.x,e.vertexC.y,e.vertexC.z);r=i.normal();a.setFromUnitVectors(r,o);l=i.a.clone().applyQuaternion(a);h=i.b.clone().applyQuaternion(a);d=i.c.clone().applyQuaternion(a);s.set(Math.min(l.x,h.x,d.x),Math.min(l.y,h.y,d.y));u.set(Math.max(l.x,h.x,d.x),Math.max(l.y,h.y,d.y));c.set(0,0).subVectors(u,s);l=(new n.Vector2).subVectors(l,s).divide(c);h=(new n.Vector2).subVectors(h,s).divide(c);d=(new n.Vector2).subVectors(d,s).divide(c);t=this.geometry=new n.Geometry;t.vertices.push(i.a);t.vertices.push(i.b);t.vertices.push(i.c);t.faces.push(new n.Face3(0,1,2,r));t.faceVertexUvs[0]=[[l,h,d]]}})},{"../core/geometry":103,"../lib/three":150}],148:[function(e,t,r){window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices;var i=e("webvr-polyfill");window.webvrpolyfill=new i({BUFFER_SCALE:1,CARDBOARD_UI_DISABLED:true,ROTATE_INSTRUCTIONS_DISABLED:true});var n=e("./utils/");var a=n.debug;var o=a("A-Frame:error");var s=a("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&s("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML.");"file:"===window.location.protocol&&o("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server.");window.Promise=window.Promise||e("promise-polyfill");n.device.isIOSOlderThan10(window.navigator.userAgent)&&(window.WebVRConfig.BUFFER_SCALE=1/window.devicePixelRatio);e("present");if(n.device.isBrowserEnvironment){e("./style/aframe.css");e("./style/rStats.css")}var u=e("./core/scene/a-scene").AScene;var c=e("./core/component").components;var l=e("./core/component").registerComponent;var h=e("./core/geometry").registerGeometry;var d=e("./extras/primitives/primitives").registerPrimitive;var p=e("./core/shader").registerShader;var f=e("./core/system").registerSystem;var v=e("./core/shader").shaders;var m=e("./core/system").systems;var g=window.THREE=e("./lib/three");var y=window.TWEEN=e("@tweenjs/tween.js");var A=e("../package");e("./components/index");e("./geometries/index");e("./shaders/index");e("./systems/index");var M=e("./core/a-node");var w=e("./core/a-entity");e("./core/a-animation");e("./core/a-assets");e("./core/a-cubemap");e("./core/a-mixin");e("./extras/components/");e("./extras/primitives/");console.log("A-Frame Version: 0.8.2 (Date 2018-04-15, Commit #b20527f)");console.log("three Version:",A.dependencies["three"]);console.log("WebVR Polyfill Version:",A.dependencies["webvr-polyfill"]);t.exports=window.AFRAME={AComponent:e("./core/component").Component,AEntity:w,ANode:M,AScene:u,components:c,geometries:e("./core/geometry").geometries,registerComponent:l,registerElement:e("./core/a-register-element").registerElement,registerGeometry:h,registerPrimitive:d,registerShader:p,registerSystem:f,primitives:{getMeshMixin:e("./extras/primitives/getMeshMixin"),primitives:e("./extras/primitives/primitives").primitives},scenes:e("./core/scene/scenes"),schema:e("./core/schema"),shaders:v,systems:m,THREE:g,TWEEN:y,utils:n,version:A.version}},{"../package":51,"./components/index":60,"./core/a-animation":95,"./core/a-assets":96,"./core/a-cubemap":97,"./core/a-entity":98,"./core/a-mixin":99,"./core/a-node":100,"./core/a-register-element":101,"./core/component":102,"./core/geometry":103,"./core/scene/a-scene":105,"./core/scene/scenes":108,"./core/schema":110,"./core/shader":111,"./core/system":112,"./extras/components/":113,"./extras/primitives/":116,"./extras/primitives/getMeshMixin":115,"./extras/primitives/primitives":117,"./geometries/index":139,"./lib/three":150,"./shaders/index":152,"./style/aframe.css":157,"./style/rStats.css":158,"./systems/index":161,"./utils/":172,"@tweenjs/tween.js":1,present:31,"promise-polyfill":33,"webvr-polyfill":46}],149:[function(e,t,r){window.aframeStats=function(e){var t=null;var r=e;var i={te:{caption:"Entities"},lt:{caption:"Load Time"}};var n=[{caption:"A-Frame",values:["te","lt"]}];function a(){t("te").set(o());window.performance.getEntriesByName&&t("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function o(){var e=r.querySelectorAll("*");Array.prototype.slice.call(e).filter(function(e){return e.isEntity});return e.length}function s(){}function u(){}function c(e){t=e}return{update:a,start:s,end:u,attach:c,values:i,groups:n,fractions:[]}};"object"===typeof t&&(t.exports={aframeStats:window.aframeStats})},{}],150:[function(e,t,i){(function(r){var i=r.THREE=e("three");i.TextureLoader&&(i.TextureLoader.prototype.crossOrigin="anonymous");i.ImageLoader&&(i.ImageLoader.prototype.crossOrigin="anonymous");i.Cache&&(i.Cache.enabled=true);e("three/examples/js/loaders/GLTFLoader");e("three/examples/js/loaders/OBJLoader");e("three/examples/js/loaders/MTLLoader");e("three/examples/js/loaders/ColladaLoader");i.ColladaLoader.prototype.crossOrigin="anonymous";i.GLTFLoader.prototype.crossOrigin="anonymous";i.MTLLoader.prototype.crossOrigin="anonymous";i.OBJLoader.prototype.crossOrigin="anonymous";t.exports=i}).call(this,"undefined"!==typeof r?r:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{three:40,"three/examples/js/loaders/ColladaLoader":41,"three/examples/js/loaders/GLTFLoader":42,"three/examples/js/loaders/MTLLoader":43,"three/examples/js/loaders/OBJLoader":44}],151:[function(e,t,r){var i=e("../core/shader").registerShader;var n=e("../lib/three");var a=e("../utils/");t.exports.Shader=i("flat",{schema:{color:{type:"color"},fog:{default:true},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:false},wireframeLinewidth:{default:2}},init:function(e){this.textureSrc=null;this.material=new n.MeshBasicMaterial(o(e));a.material.updateMap(this,e)},update:function(e){this.updateMaterial(e);a.material.updateMap(this,e)},updateMaterial:function(e){var t=this.material;e=o(e);Object.keys(e).forEach(function(r){t[r]=e[r]})}});function o(e){return{fog:e.fog,color:new n.Color(e.color),wireframe:e.wireframe,wireframeLinewidth:e.wireframeLinewidth}}},{"../core/shader":111,"../lib/three":150,"../utils/":172}],152:[function(e,t,r){e("./flat");e("./standard");e("./sdf");e("./msdf");e("./ios10hls")},{"./flat":151,"./ios10hls":153,"./msdf":154,"./sdf":155,"./standard":156}],153:[function(e,t,r){var i=e("../core/shader").registerShader;t.exports.Shader=i("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join("\n")})},{"../core/shader":111}],154:[function(e,t,r){var i=e("../core/shader").registerShader;t.exports.Shader=i("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:true},opacity:{type:"number",is:"uniform",default:1}},raw:true,vertexShader:["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","uniform sampler2D map;","uniform vec3 color;","uniform float opacity;","uniform float alphaTest;","uniform bool negate;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","void main() {","  vec3 sample = texture2D(map, vUV).rgb;","  if (negate) {","    sample = 1.0 - sample;","  }","  float sigDist = median(sample.r, sample.g, sample.b) - 0.5;","  float alpha = clamp(sigDist/fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  if (isBigEnough <= BIG_ENOUGH && alpha < alphaTest) { discard; return; }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join("\n")})},{"../core/shader":111}],155:[function(e,t,r){var i=e("../core/shader").registerShader;t.exports.Shader=i("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:true,vertexShader:["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","uniform sampler2D map;","uniform vec3 color;","uniform float opacity;","uniform float alphaTest;","varying vec2 vUV;","#ifdef GL_OES_standard_derivatives","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#else","float aastep(float value, float afwidth) {","  return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","}","#endif","void main() {","#ifdef GL_OES_standard_derivatives","  vec2 uv = vUV;","  vec4 texColor = texture2D(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  else if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture2D(map, box.xy).a, width)","      + contour(texture2D(map, box.zw).a, width)","      + contour(texture2D(map, box.xw).a, width)","      + contour(texture2D(map, box.zy).a, width)","    )) / 3.0;","  }","  if (isBigEnough <= BIG_ENOUGH && alpha < alphaTest) { discard; return; }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","#else","  vec4 texColor = texture2D(map, vUV);","  float value = texColor.a;","  float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","  float alpha = aastep(value, afwidth);","  float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","  if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","  alpha = alpha * ratio + (1.0 - ratio) * value;","  if (ratio < 1.0)","    if (alpha <= DISCARD_ALPHA) { discard; return; }","#endif","  gl_FragColor = vec4(color, opacity * alpha);","}"].join("\n")})},{"../core/shader":111}],156:[function(e,t,r){var i=e("../core/shader").registerShader;var n=e("../lib/three");var a=e("../utils/");var o=new n.CubeTextureLoader;var s={};t.exports.Shader=i("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:true},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:false},wireframeLinewidth:{default:2}},init:function(e){this.material=new n.MeshStandardMaterial(u(e));a.material.updateMap(this,e);e.normalMap&&a.material.updateDistortionMap("normal",this,e);e.displacementMap&&a.material.updateDistortionMap("displacement",this,e);e.ambientOcclusionMap&&a.material.updateDistortionMap("ambientOcclusion",this,e);e.metalnessMap&&a.material.updateDistortionMap("metalness",this,e);e.roughnessMap&&a.material.updateDistortionMap("roughness",this,e);this.updateEnvMap(e)},update:function(e){this.updateMaterial(e);a.material.updateMap(this,e);e.normalMap&&a.material.updateDistortionMap("normal",this,e);e.displacementMap&&a.material.updateDistortionMap("displacement",this,e);e.ambientOcclusionMap&&a.material.updateDistortionMap("ambientOcclusion",this,e);e.metalnessMap&&a.material.updateDistortionMap("metalness",this,e);e.roughnessMap&&a.material.updateDistortionMap("roughness",this,e);this.updateEnvMap(e)},updateMaterial:function(e){var t=this.material;e=u(e);Object.keys(e).forEach(function(r){t[r]=e[r]})},updateEnvMap:function(e){var t=this;var r=this.material;var i=e.envMap;var u=e.sphericalEnvMap;if(!i&&!u||this.isLoadingEnvMap){r.envMap=null;r.needsUpdate=true;return}this.isLoadingEnvMap=true;if(u){this.el.sceneEl.systems.material.loadTexture(u,{src:u},function e(i){t.isLoadingEnvMap=false;i.mapping=n.SphericalReflectionMapping;r.envMap=i;a.material.handleTextureEvents(t.el,i);r.needsUpdate=true});return}if(s[i]){s[i].then(function(e){t.isLoadingEnvMap=false;r.envMap=e;a.material.handleTextureEvents(t.el,e);r.needsUpdate=true});return}s[i]=new Promise(function(e){a.srcLoader.validateCubemapSrc(i,function i(n){o.load(n,function(i){t.isLoadingEnvMap=false;r.envMap=i;a.material.handleTextureEvents(t.el,i);e(i)})})})}});function u(e){var t={color:new n.Color(e.color),emissive:new n.Color(e.emissive),emissiveIntensity:e.emissiveIntensity,fog:e.fog,metalness:e.metalness,roughness:e.roughness,wireframe:e.wireframe,wireframeLinewidth:e.wireframeLinewidth};e.normalMap&&(t.normalScale=e.normalScale);e.ambientOcclusionMap&&(t.aoMapIntensity=e.ambientOcclusionMapIntensity);if(e.displacementMap){t.displacementScale=e.displacementScale;t.displacementBias=e.displacementBias}return t}},{"../core/shader":111,"../lib/three":150,"../utils/":172}],157:[function(e,t,r){var i=".a-html{bottom:0;left:0;position:fixed;right:0;top:0}.a-body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}.a-canvas.a-grab-cursor:active,.a-grabbing{cursor:grabbing;cursor:-moz-grabbing;cursor:-webkit-grabbing}a-scene.fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-vr.embedded{right:5px;bottom:5px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff}.a-enter-vr-button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20245.82%20141.73%22%3E%3Cdefs%3E%3Cstyle%3E.a%7Bfill%3A%23fff%3Bfill-rule%3Aevenodd%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Ctitle%3Emask%3C%2Ftitle%3E%3Cpath%20class%3D%22a%22%20d%3D%22M175.56%2C111.37c-22.52%2C0-40.77-18.84-40.77-42.07S153%2C27.24%2C175.56%2C27.24s40.77%2C18.84%2C40.77%2C42.07S198.08%2C111.37%2C175.56%2C111.37ZM26.84%2C69.31c0-23.23%2C18.25-42.07%2C40.77-42.07s40.77%2C18.84%2C40.77%2C42.07-18.26%2C42.07-40.77%2C42.07S26.84%2C92.54%2C26.84%2C69.31ZM27.27%2C0C11.54%2C0%2C0%2C12.34%2C0%2C28.58V110.9c0%2C16.24%2C11.54%2C30.83%2C27.27%2C30.83H99.57c2.17%2C0%2C4.19-1.83%2C5.4-3.7L116.47%2C118a8%2C8%2C0%2C0%2C1%2C12.52-.18l11.51%2C20.34c1.2%2C1.86%2C3.22%2C3.61%2C5.39%2C3.61h72.29c15.74%2C0%2C27.63-14.6%2C27.63-30.83V28.58C245.82%2C12.34%2C233.93%2C0%2C218.19%2C0H27.27Z%22%2F%3E%3C%2Fsvg%3E) 50% 50%/70% 70% no-repeat rgba(0,0,0,.35);border:0;bottom:0;cursor:pointer;min-width:50px;min-height:30px;padding-right:5%;padding-top:4%;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999}.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#666}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:\"Insert phone into Cardboard holder.\";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}";e("browserify-css").createStyle(i,{href:"src/style/aframe.css"});t.exports=i},{"browserify-css":5}],158:[function(e,t,r){var i=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";e("browserify-css").createStyle(i,{href:"src/style/rStats.css"});t.exports=i},{"browserify-css":5}],159:[function(e,t,r){var i=e("../utils/bind");var n=e("../constants/");var a=e("../core/system").registerSystem;var o="data-aframe-default-camera";t.exports.System=a("camera",{init:function(){this.activeCameraEl=null;this.sceneEl.addEventListener("loaded",i(this.setupDefaultCamera,this))},setupDefaultCamera:function(){var e=this.sceneEl;var t;if(e.camera&&!e.camera.el.getAttribute("camera").spectator){e.emit("camera-ready",{cameraEl:e.camera.el});return}t=document.createElement("a-entity");t.setAttribute("camera",{active:true});t.setAttribute("wasd-controls","");t.setAttribute("look-controls","");t.setAttribute(n.AFRAME_INJECTED,"");t.setAttribute("position",{x:0,y:n.DEFAULT_CAMERA_HEIGHT,z:0});e.appendChild(t);e.addEventListener("enter-vr",this.removeDefaultOffset);e.addEventListener("exit-vr",this.addDefaultOffset);e.emit("camera-ready",{cameraEl:t})},disableActiveCamera:function(){var e=this.sceneEl.querySelectorAll("[camera]");var t=e[e.length-1];t.setAttribute("camera","active",true)},setActiveCamera:function(e){var t;var r;var i;var n;var a=this.activeCameraEl;var u=this.sceneEl;n=e.getObject3D("camera");if(!n||e===this.activeCameraEl)return;var c=u.querySelector("["+o+"]");var l=c&&c.querySelector("[camera]");e!==l&&s(u);this.activeCameraEl=e;this.activeCameraEl.play();u.camera=n;a&&a.setAttribute("camera","active",false);r=u.querySelectorAll("[camera]");for(i=0;i<r.length;i++){t=r[i];if(!t.isEntity||e===t)continue;t.setAttribute("camera","active",false);t.pause()}u.emit("camera-set-active",{cameraEl:e})},setSpectatorCamera:function(e){var t;var r=this.spectatorCameraEl;var i=this.sceneEl;var n;t=e.getObject3D("camera");if(!t||e===this.spectatorCameraEl)return;r&&r.setAttribute("camera","spectator",false);n=this.spectatorCameraEl=e;n.setAttribute("camera","active",false);n.play();i.emit("camera-set-spectator",{cameraEl:e})},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},tock:function(){var e;var t=this.sceneEl;var r=t.renderer.vr.enabled;if(!this.spectatorCameraEl||t.isMobile)return;e=this.spectatorCameraEl.components.camera.camera;t.renderer.vr.enabled=false;t.renderer.render(t.object3D,e);t.renderer.vr.enabled=r}});function s(e){var t;var r=e.camera;if(!r)return;t=e.querySelector("["+o+"]");if(!t)return;e.removeChild(t)}},{"../constants/":93,"../core/system":112,"../utils/bind":166}],160:[function(e,t,r){var i=e("../core/geometry").geometries;var n=e("../core/system").registerSystem;var a=e("../lib/three");t.exports.System=n("geometry",{init:function(){this.cache={};this.cacheCount={}},clearCache:function(){this.cache={};this.cacheCount={}},getOrCreateGeometry:function(e){var t=this.cache;var r;var i;if(e.skipCache)return o(e);i=this.hash(e);r=t[i];u(this.cacheCount,i);if(r)return r;r=o(e);t[i]=r;return r},unuseGeometry:function(e){var t=this.cache;var r=this.cacheCount;var i;var n;if(e.skipCache)return;n=this.hash(e);if(!t[n])return;s(r,n);if(r[n]>0)return;i=t[n];i.dispose();delete t[n];delete r[n]},hash:function(e){return JSON.stringify(e)}});function o(e){var t=e.primitive;var r=i[t]&&i[t].Geometry;var n=new r;if(!r)throw new Error("Unknown geometry `"+t+"`");n.init(e);return c(n.geometry,e.buffer)}function s(e,t){e[t]--}function u(e,t){e[t]=void 0===e[t]?1:e[t]+1}function c(e,t){var r;if(!t)return e;r=(new a.BufferGeometry).fromGeometry(e);r.metadata={type:e.type,parameters:e.parameters||{}};e.dispose();return r}},{"../core/geometry":103,"../core/system":112,"../lib/three":150}],161:[function(e,t,r){e("./camera");e("./geometry");e("./light");e("./material");e("./shadow");e("./tracked-controls")},{"./camera":159,"./geometry":160,"./light":162,"./material":163,"./shadow":164,"./tracked-controls":165}],162:[function(e,t,r){var i=e("../core/system").registerSystem;var n=e("../utils/bind");var a=e("../constants/");var o="data-aframe-default-light";t.exports.System=i("light",{schema:{defaultLightsEnabled:{default:true}},init:function(){this.defaultLights=false;this.userDefinedLights=false;this.sceneEl.addEventListener("loaded",n(this.setupDefaultLights,this))},registerLight:function(e){if(!e.hasAttribute(o)){this.removeDefaultLights();this.userDefinedLights=true}},removeDefaultLights:function(){var e;var t=this.sceneEl;if(!this.defaultLights)return;e=document.querySelectorAll("["+o+"]");for(var r=0;r<e.length;r++)t.removeChild(e[r]);this.defaultLights=false},setupDefaultLights:function(){var e=this.sceneEl;var t;var r;if(this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled)return;t=document.createElement("a-entity");t.setAttribute("light",{color:"#BBB",type:"ambient"});t.setAttribute(o,"");t.setAttribute(a.AFRAME_INJECTED,"");e.appendChild(t);r=document.createElement("a-entity");r.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:true});r.setAttribute("position",{x:-.5,y:1,z:1});r.setAttribute(o,"");r.setAttribute(a.AFRAME_INJECTED,"");e.appendChild(r);this.defaultLights=true}})},{"../constants/":93,"../core/system":112,"../utils/bind":166}],163:[function(e,t,r){var i=e("../core/system").registerSystem;var n=e("../lib/three");var a=e("../utils/");var o=e("../utils/material").isHLS;var s=a.bind;var u=a.debug;var c=u("components:texture:error");var l=new n.TextureLoader;var h=u("components:texture:warn");l.setCrossOrigin("anonymous");t.exports.System=i("material",{init:function(){this.materials={};this.textureCounts={};this.textureCache={};this.sceneEl.addEventListener("materialtextureloaded",s(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(e,t,r){var i=this;if("CANVAS"===e.tagName){this.loadCanvas(e,t,r);return}if("VIDEO"===e.tagName){e.src||e.srcObject||e.childElementCount||h("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes.");this.loadVideo(e,t,r);return}a.srcLoader.validateSrc(e,n,o);function n(e){i.loadImage(e,t,r)}function o(e){i.loadVideo(e,t,r)}},loadImage:function(e,t,r){var i=this.hash(t);var n=this.textureCache;if(n[i]){n[i].then(r);return}n[i]=p(e,t);n[i].then(r)},loadCanvas:function(e,t,r){e.readyState=2;e.HAVE_CURRENT_DATA=2;this.loadVideo(e,t,r)},loadVideo:function(e,t,r){var i;var a;var s=this.textureCache;var u;var c;function l(e){e.texture.needsUpdate=true;r(e.texture,e.videoEl)}if("string"!==typeof e){u=e;i=this.hashVideo(t,u);if(s[i]){s[i].then(l);return}m(u)}u=u||v(e,t.width,t.height);i=this.hashVideo(t,u);if(s[i]){s[i].then(l);return}a=new n.VideoTexture(u);a.minFilter=n.LinearFilter;f(a,t);if(this.sceneEl.isIOS&&o(u.src||u.getAttribute("src"),u.type||u.getAttribute("type"))){a.format=n.RGBAFormat;a.needsCorrectionBGRA=true;a.flipY=false;a.needsCorrectionFlipY=true}c={texture:a,videoEl:u};s[i]=Promise.resolve(c);l(c)},hash:function(e){if(e.src.tagName){e=a.extendDeep({},e);e.src=e.src.src}return JSON.stringify(e)},hashVideo:function(e,t){return d(e,t)},registerMaterial:function(e){this.materials[e.uuid]=e},unregisterMaterial:function(e){delete this.materials[e.uuid];var t=this.textureCounts;Object.keys(e).filter(function(t){return e[t]&&e[t].isTexture}).forEach(function(r){t[e[r].uuid]--;t[e[r].uuid]<=0&&e[r].dispose()})},updateMaterials:function(e){var t=this.materials;Object.keys(t).forEach(function(e){t[e].needsUpdate=true})},onMaterialTextureLoaded:function(e){this.textureCounts[e.detail.texture.uuid]||(this.textureCounts[e.detail.texture.uuid]=0);this.textureCounts[e.detail.texture.uuid]++}});function d(e,t){var r;var i=t.getAttribute("id");var n;var a;if(i)return i;n="";a=e||{};for(r=0;r<t.attributes.length;r++)a[t.attributes[r].name]=t.attributes[r].value;Object.keys(a).sort().forEach(function(e){n+=e+":"+a[e]+";"});return n}function p(e,t){return new Promise(r);function r(r,i){var a="string"!==typeof e;function o(e){f(e,t);e.needsUpdate=true;r(e)}if(a){o(new n.Texture(e));return}l.load(e,o,function(){},function(e){c("`$s` could not be fetched (Error code: %s; Response: %s)",e.status,e.statusText)})}}function f(e,t){var r=t.offset||{x:0,y:0};var i=t.repeat||{x:1,y:1};var a=t.npot||false;if(a){e.wrapS=n.ClampToEdgeWrapping;e.wrapT=n.ClampToEdgeWrapping;e.magFilter=n.LinearFilter;e.minFilter=n.LinearFilter}if(1!==i.x||1!==i.y){e.wrapS=n.RepeatWrapping;e.wrapT=n.RepeatWrapping;e.repeat.set(i.x,i.y)}0===r.x&&0===r.y||e.offset.set(r.x,r.y)}function v(e,t,r){var i=document.createElement("video");i.width=t;i.height=r;i.setAttribute("playsinline","");i.setAttribute("webkit-playsinline","");i.autoplay=true;i.loop=true;i.crossOrigin="anonymous";i.addEventListener("error",function(){h("`$s` is not a valid video",e)},true);i.src=e;return i}function m(e){e.autoplay=e.hasAttribute("autoplay")&&"false"!==e.getAttribute("autoplay");e.controls=e.hasAttribute("controls")&&"false"!==e.getAttribute("controls");"false"===e.getAttribute("loop")&&e.removeAttribute("loop");"false"===e.getAttribute("preload")&&(e.preload="none");e.crossOrigin=e.crossOrigin||"anonymous";e.setAttribute("playsinline","");e.setAttribute("webkit-playsinline","");return e}},{"../core/system":112,"../lib/three":150,"../utils/":172,"../utils/material":173}],164:[function(e,t,r){var i=e("../core/system").registerSystem;var n=e("../lib/three");var a={basic:n.BasicShadowMap,pcf:n.PCFShadowMap,pcfsoft:n.PCFSoftShadowMap};t.exports.System=i("shadow",{schema:{autoUpdate:{default:true},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var e=this.sceneEl;var t=this.data;this.shadowMapEnabled=false;if(!e.renderer)return;e.renderer.shadowMap.type=a[t.type];e.renderer.shadowMap.autoUpdate=t.autoUpdate;this.setShadowMapEnabled(this.shadowMapEnabled)},setShadowMapEnabled:function(e){var t=this.sceneEl.renderer;this.shadowMapEnabled=e;t&&(t.shadowMap.enabled=e)}})},{"../core/system":112,"../lib/three":150}],165:[function(e,t,r){var i=e("../core/system").registerSystem;var n=e("../utils");t.exports.System=i("tracked-controls",{init:function(){var e=this;this.controllers=[];this.updateControllerList(navigator.getGamepads&&navigator.getGamepads());this.throttledUpdateControllerList=n.throttle(this.updateControllerList,500,this);if(!navigator.getVRDisplays)return;this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(t){t.length&&(e.vrDisplay=t[0])})})},tick:function(){var e;e=navigator.getGamepads&&navigator.getGamepads();this.throttledUpdateControllerList(e)},updateControllerList:function(e){var t=this.controllers;var r;var i;var n;if(!e)return;n=t.length;t.length=0;for(i=0;i<e.length;++i){r=e[i];r&&r.pose&&t.push(r)}t.length!==n&&this.el.emit("controllersupdated",void 0,false)}})},{"../core/system":112,"../utils":172}],166:[function(e,t,r){t.exports=function e(t,r){return function(e){return function i(){var n=e.concat(Array.prototype.slice.call(arguments,0));return t.apply(r,n)}}(Array.prototype.slice.call(arguments,2))}},{}],167:[function(e,t,r){var i=e("./debug");var n=e("object-assign");var a=i("utils:coordinates:warn");var o=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;t.exports.regex=o;function s(e,t){var r;var i;if(e&&e instanceof Object){if(t){e.x=void 0===e.x?t.x:e.x;e.y=void 0===e.y?t.y:e.y;e.z=void 0===e.z?t.z:e.z;e.w=void 0===e.w?t.w:e.w}return l(e)}if(null===e||void 0===e)return"object"===typeof t?n({},t):t;r=e.trim().replace(/\s+/g," ").split(" ");i={};i.x=r[0]||t&&t.x;i.y=r[1]||t&&t.y;i.z=r[2]||t&&t.z;i.w=r[3]||t&&t.w;return l(i)}t.exports.parse=s;function u(e){if("object"!==typeof e)return e;return[e.x,e.y,e.z,e.w].join(" ").trim()}t.exports.stringify=u;function c(e){return o.test(e)}t.exports.isCoordinates=c;t.exports.isCoordinate=function(e){a("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`");return c(e)};function l(e){var t;for(t in e){if(void 0===e[t]){delete e[t];continue}e[t].constructor===String&&(e[t]=parseFloat(e[t],10))}return e}t.exports.toVector3=function(e){return new THREE.Vector3(e.x,e.y,e.z)}},{"./debug":168,"object-assign":25}],168:[function(e,t,r){(function(r){var i=e("debug");var n=e("object-assign");var a={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};var o=function(e){var t=i(e);t.color=u(e);return t};n(o,i);function s(e){var t=e.split(":");return t[t.length-1]}function u(e){var t=s(e);var r=a.colors&&a.colors[t];return r||null}function c(){try{return window.localStorage}catch(e){}}var l=c();l&&(parseInt(l.logs,10)||"true"===l.logs)?o.enable("*"):o.enable("*:error,*:info,*:warn");r.browser&&(window.logs=o);t.exports=o}).call(this,e("_process"))},{_process:32,debug:8,"object-assign":25}],169:[function(e,t,r){(function(e){var r;var i;var n="Cardboard VRDisplay";navigator.getVRDisplays&&navigator.getVRDisplays().then(function(e){r=e.length&&e[0];i=r.displayName===n});function a(){return r}t.exports.getVRDisplay=a;function o(){return!!a()}t.exports.checkHeadsetConnected=o;function s(){var e=a();if(u()||h())return false;return e&&e.capabilities.hasPosition}t.exports.checkHasPositionalTracking=s;var u=function(){var e=false;(function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=true);(l()||c()||d())&&(e=true)})(window.navigator.userAgent||window.navigator.vendor||window.opera);return function(){return e}}();t.exports.isMobile=u;function c(e){var t=e||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(t)}t.exports.isTablet=c;function l(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}t.exports.isIOS=l;function h(){return/SamsungBrowser.+Mobile VR/i.test(window.navigator.userAgent)}t.exports.isGearVR=h;function d(){return/R7 Build/.test(window.navigator.userAgent)}t.exports.isR7=d;t.exports.isLandscape=function(){var e=window.orientation;d()&&(e+=90);return 90===e||-90===e};t.exports.isIOSOlderThan10=function(e){return/(iphone|ipod|ipad).*os.(7|8|9)/i.test(e)};t.exports.isBrowserEnvironment=!!(!e||e.browser);t.exports.isNodeEnvironment=!t.exports.isBrowserEnvironment;t.exports.PolyfillControls=function e(t){var n;window.VRFrameData&&(n=new window.VRFrameData);this.update=function(){var e;if(!r||!i)return;r.getFrameData(n);e=n.pose;null!==e.orientation&&t.quaternion.fromArray(e.orientation);null!==e.position?t.position.fromArray(e.position):t.position.set(0,0,0)}}}).call(this,e("_process"))},{_process:32}],170:[function(e,t,r){var i={};function n(e,t){t=t||".";i[t]||(i[t]={});-1!==e.indexOf(t)?i[t][e]=e.split(t):i[t][e]=e;return i[t][e]}t.exports.getComponentPropertyPath=n;t.exports.propertyPathCache=i;t.exports.getComponentProperty=function(e,t,r){var i;r=r||".";if(-1!==t.indexOf(r)){i=n(t,r);if(i.constructor===String)return e.getAttribute(i);return e.getAttribute(i[0])[i[1]]}return e.getAttribute(t)};t.exports.setComponentProperty=function(e,t,r,i){var a;i=i||".";if(-1!==t.indexOf(i)){a=n(t,i);a.constructor===String?e.setAttribute(a,r):e.setAttribute(a[0],a[1],r);return}e.setAttribute(t,r)}},{}],171:[function(e,t,r){t.exports=function e(t){var r=t.style.width;var i=t.style.height;t.style.width=parseInt(r,10)+1+"px";t.style.height=parseInt(i,10)+1+"px";setTimeout(function(){t.style.width=r;t.style.height=i},200)}},{}],172:[function(e,t,r){var i=e("./debug");var n=e("deep-assign");var a=e("./device");var o=e("object-assign");var s=e("./object-pool");var u=i("utils:warn");t.exports.bind=e("./bind");t.exports.coordinates=e("./coordinates");t.exports.debug=i;t.exports.device=a;t.exports.entity=e("./entity");t.exports.forceCanvasResizeSafariMobile=e("./forceCanvasResizeSafariMobile");t.exports.material=e("./material");t.exports.objectPool=s;t.exports.split=e("./split").split;t.exports.styleParser=e("./styleParser");t.exports.trackedControls=e("./tracked-controls");t.exports.checkHeadsetConnected=function(){u("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`");return a.checkHeadsetConnected(arguments)};t.exports.isGearVR=function(){u("`utils.isGearVR` has moved to `utils.device.isGearVR`");return a.isGearVR(arguments)};t.exports.isIOS=function(){u("`utils.isIOS` has moved to `utils.device.isIOS`");return a.isIOS(arguments)};t.exports.isMobile=function(){u("`utils.isMobile has moved to `utils.device.isMobile`");return a.isMobile(arguments)};t.exports.throttle=function(e,r,i){var n;i&&(e=t.exports.bind(e,i));return function(){var t=Date.now();var i="undefined"===typeof n?r:t-n;if("undefined"===typeof n||i>=r){n=t;e.apply(null,arguments)}}};t.exports.throttleTick=function(e,r,i){var n;i&&(e=t.exports.bind(e,i));return function(t,i){var a="undefined"===typeof n?i:t-n;if("undefined"===typeof n||a>=r){n=t;e(t,a)}}};t.exports.debounce=function(e,t,r){var i;return function(){var n=this;var a=arguments;var o=function(){i=null;r||e.apply(n,a)};var s=r&&!i;clearTimeout(i);i=setTimeout(o,t);s&&e.apply(n,a)}};t.exports.extend=o;t.exports.extendDeep=n;t.exports.clone=function(e){return JSON.parse(JSON.stringify(e))};var c=function(){var e=s.createPool(function(){return[]});return function(t,r){var i;var n;var a;var o;var s;var u;if(void 0===t||void 0===r||null===t||null===r||!(t&&r&&t.constructor===Object&&r.constructor===Object||t.constructor===Array&&r.constructor===Array))return t===r;n=e.use();a=e.use();n.length=0;a.length=0;for(i in t)n.push(i);for(i in r)a.push(i);if(n.length!==a.length){e.recycle(n);e.recycle(a);return false}for(o=0;o<n.length;++o){s=t[n[o]];u=r[n[o]];if("object"===typeof s||"object"===typeof u||Array.isArray(s)&&Array.isArray(u)){if(s===u)continue;if(!c(s,u)){e.recycle(n);e.recycle(a);return false}}else if(s!==u){e.recycle(n);e.recycle(a);return false}}e.recycle(n);e.recycle(a);return true}}();t.exports.deepEqual=c;t.exports.diff=function(){var e=[];return function(t,r,i){var n;var a;var o;var s;var u;var l;var h;s=i||{};e.length=0;for(u in t)e.push(u);if(!r)return s;for(o in r)-1===e.indexOf(o)&&e.push(o);for(l=0;l<e.length;l++){u=e[l];n=t[u];a=r[u];h=n&&a&&n.constructor===Object&&a.constructor===Object;(h&&!c(n,a)||!h&&n!==a)&&(s[u]=a)}return s}}();t.exports.shouldCaptureKeyEvent=function(e){if(e.metaKey)return false;return document.activeElement===document.body};t.exports.splitString=function(e,t){"undefined"===typeof t&&(t=" ");var r=new RegExp(t,"g");e=(e||"").replace(r,t);return e.split(t)};t.exports.getElData=function(e,t){t=t||{};var r={};Object.keys(t).forEach(i);function i(t){e.hasAttribute(t)&&(r[t]=e.getAttribute(t))}return r};t.exports.getUrlParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)");var r=t.exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))};t.exports.isIframed=function(){return window.top!==window.self};t.exports.findAllScenes=function(e){var t=[];var r=e.getElementsByTagName("*");for(var i=0,n=r.length;i<n;i++)r[i].isScene&&t.push(r[i]);return t};t.exports.srcLoader=e("./src-loader")},{"./bind":166,"./coordinates":167,"./debug":168,"./device":169,"./entity":170,"./forceCanvasResizeSafariMobile":171,"./material":173,"./object-pool":174,"./split":175,"./src-loader":176,"./styleParser":177,"./tracked-controls":178,"deep-assign":10,"object-assign":25}],173:[function(e,t,r){var i=e("../lib/three");var n=["application/x-mpegurl","application/vnd.apple.mpegurl"];t.exports.updateMapMaterialFromData=function(e,t,r,n){var o=r.el;var s=r.material;var u=n[t];r.materialSrcs||(r.materialSrcs={});if(!u){delete r.materialSrcs[e];l(null);return}if(u===r.materialSrcs[e])return;r.materialSrcs[e]=u;u instanceof i.Texture?l(u):o.sceneEl.systems.material.loadTexture(u,{src:u,repeat:n.repeat,offset:n.offset,npot:n.npot},c);function c(t){if(r.materialSrcs[e]!==u)return;l(t)}function l(t){s[e]=t;s.needsUpdate=true;a(o,t)}};t.exports.updateMap=function(e,r){return t.exports.updateMapMaterialFromData("map","src",e,r)};t.exports.updateDistortionMap=function(e,t,r){var i=e;"ambientOcclusion"===e&&(i="ao");var n=t.el;var o=t.material;var s=r[e+"Map"];var u={};u.src=s;u.offset=r[e+"TextureOffset"];u.repeat=r[e+"TextureRepeat"];u.wrap=r[e+"TextureWrap"];if(s){if(s===t[e+"TextureSrc"])return;t[e+"TextureSrc"]=s;n.sceneEl.systems.material.loadTexture(s,u,c);return}if(!o.map)return;c(null);function c(e){o[i+"Map"]=e;o.needsUpdate=true;a(n,e)}};function a(e,t){if(!t)return;e.emit("materialtextureloaded",{src:t.image,texture:t});if(!t.image||"VIDEO"!==t.image.tagName)return;t.image.addEventListener("loadeddata",function r(){if(!e.components||!e.components.material)return;t.needsCorrectionBGRA&&t.needsCorrectionFlipY&&-1!==["standard","flat"].indexOf(e.components.material.data.shader)&&e.setAttribute("material","shader","ios10hls");e.emit("materialvideoloadeddata",{src:t.image,texture:t})});t.image.addEventListener("ended",function r(){e.emit("materialvideoended",{src:t.image,texture:t})})}t.exports.handleTextureEvents=a;t.exports.isHLS=function(e,t){if(t&&n.includes(t.toLowerCase()))return true;if(e&&e.toLowerCase().indexOf(".m3u8")>0)return true;return false}},{"../lib/three":150}],174:[function(e,t,r){var i=Object.freeze(Object.create(null));function n(){return{}}t.exports.createPool=function e(t){var r=[];var o=null;t=t||n;function s(){var e;null!==o&&o!==r.length||c(r.length||5);e=r[o];r[o++]=i;a(e);return e}function u(e){if(!(e instanceof Object))return;if(null===o||-1===o){r[r.length]=e;return}r[--o]=e}function c(e){var i;var n;e=void 0===e?r.length:e;e>0&&null==o&&(o=0);if(e>0){i=r.length;r.length+=Number(e);for(n=i;n<r.length;n++)r[n]=t()}return r.length}function l(){return r.length}return{grow:c,pool:r,recycle:u,size:l,use:s}};function a(e){var t;if(!(e.constructor===Object))return;for(t in e)e[t]=void 0}t.exports.clearObject=a},{}],175:[function(e,t,r){t.exports.split=function(){var e={};return function(t,r){r in e||(e[r]={});if(t in e[r])return e[r][t];e[r][t]=t.split(r);return e[r][t]}}()},{}],176:[function(e,t,r){var i=e("./debug");var n=i("utils:src-loader:warn");function a(e,t,r){u(e,function i(n){if(n){t(e);return}r(e)})}function o(e,t){var r;var i="";var o;var u;var c=[];for(o=0;o<5;o++)i+="(url\\((?:[^\\)]+)\\),\\s*)";i+="(url\\((?:[^\\)]+)\\)\\s*)";u=e.match(new RegExp(i));function h(e){c.push(e);6===c.length&&t(c)}if(u){for(o=1;o<7;o++)a(s(u[o]),h);return}r=l(e);if(!r)return;if("A-CUBEMAP"===r.tagName&&r.srcs)return t(r.srcs);n('Selector "%s" does not point to <a-cubemap>',e)}function s(e){var t=e.match(/\url\((.+)\)/);if(!t)return;return t[1]}function u(e,t){var r;if(e.tagName){t("IMG"===e.tagName);return}r=new XMLHttpRequest;r.open("HEAD",e);r.addEventListener("load",function(i){var n;if(r.status>=200&&r.status<300){n=r.getResponseHeader("Content-Type");null==n?c(e,t):n.startsWith("image")?t(true):t(false)}else c(e,t);r.abort()});r.send()}function c(e,t){var r=new Image;r.addEventListener("load",i);function i(){t(true)}r.addEventListener("error",n);function n(){t(false)}r.src=e}function l(e){try{var t=document.querySelector(e);t||n('No element was found matching the selector: "%s"',e);return t}catch(t){n('"%s" is not a valid selector',e);return}}t.exports={parseUrl:s,validateSrc:a,validateCubemapSrc:o}},{"./debug":168}],177:[function(e,t,r){var i=e("style-attr");t.exports.parse=function(e){var t;if("string"!==typeof e)return e;t=i.parse(e);if(t[""])return e;return a(t)};t.exports.stringify=function(e){if("string"===typeof e)return e;return i.stringify(e)};function n(e){return e.replace(/-([a-z])/g,t);function t(e){return e[1].toUpperCase()}}t.exports.toCamelCase=n;function a(e){var t=Object.keys(e);var r={};t.forEach(function(t){var i=n(t);r[i]=e[t]});return r}t.exports.transformKeysToCamelCase=a},{"style-attr":35}],178:[function(e,t,r){var i=e("./split").split;var n=e("../constants").DEFAULT_HANDEDNESS;var a=["x","y","z","w"];var o=2;t.exports.checkControllerPresentAndSetup=function(e,t,r){var i=e.el;var n=s(e,t,r);e.controllerPresent&&!e.controllerEventsActive&&e.addEventListeners();if(n===e.controllerPresent)return n;e.controllerPresent=n;if(n){e.injectTrackedControls();e.addEventListeners();i.emit("controllerconnected",{name:e.name,component:e})}else{e.removeEventListeners();i.emit("controllerdisconnected",{name:e.name,component:e})}};function s(e,t,r){var i;var n=e.el.sceneEl;var a;var o=r.index||0;if(!t)return false;a=n&&n.systems["tracked-controls"];if(!a)return false;i=a.controllers;if(!i.length)return false;return!!u(i,null,t,r.hand,o)}t.exports.isControllerPresent=s;function u(e,t,r,a,s){var u;var c;var l;var h;var d;var p=0;var f;var v=s||0;r&&r.indexOf("|")>=0&&(c=i(r,"|"));for(l=0;l<e.length;l++){u=e[l];if(c){d=false;for(h=0;h<c.length;h++){f=c[h];if(f&&u.id.startsWith(f)){d=true;break}}if(!d)continue}else if(r&&u.id.indexOf(r))continue;if(!r&&u.id!==t)continue;if(a&&u.hand&&a!==u.hand)continue;a&&!u.hand&&(v=o*s+(a===n?0:1));if(p===v)return u;++p}return}t.exports.findMatchingController=u;t.exports.emitIfAxesChanged=function(e,t,r){var i;var n;var o;var s;var u;for(n in t){i=t[n];o=false;for(u=0;u<i.length;u++)r.detail.changed[i[u]]&&(o=true);if(!o)continue;s={};for(u=0;u<i.length;u++)s[a[u]]=r.detail.axis[i[u]];e.el.emit(n+"moved",s)}};t.exports.onButtonEvent=function(e,t,r,i){var n=i?r.mapping[i]:r.mapping;var a=n.buttons[e];r.el.emit(a+t);r.updateModel&&r.updateModel(a,t)}},{"../constants":93,"./split":175}],179:[function(e,t,r){window.glStats=function(){var e=null;var t=0,r=0,i=0,n=0,a=0,o=0,s=0;function u(e,t){return function(){t.apply(this,arguments);e.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=u(WebGLRenderingContext.prototype.drawArrays,function(){t++;arguments[0]==this.POINTS?o+=arguments[2]:a+=arguments[2]});WebGLRenderingContext.prototype.drawElements=u(WebGLRenderingContext.prototype.drawElements,function(){r++;n+=arguments[1]/3;a+=arguments[1]});WebGLRenderingContext.prototype.useProgram=u(WebGLRenderingContext.prototype.useProgram,function(){i++});WebGLRenderingContext.prototype.bindTexture=u(WebGLRenderingContext.prototype.bindTexture,function(){s++});var c={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}};var l=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}];var h=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function d(){e("allcalls").set(t+r);e("drawElements").set(r);e("drawArrays").set(t);e("bindTexture").set(s);e("useProgram").set(i);e("glfaces").set(n);e("glvertices").set(a);e("glpoints").set(o)}function p(){t=0;r=0;i=0;n=0;a=0;o=0;s=0}function f(){}function v(t){e=t}return{update:d,start:p,end:f,attach:v,values:c,groups:l,fractions:h}};window.threeStats=function(e){var t=null;var r={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.faces":{caption:"Faces",over:1e3},"renderer.info.render.points":{caption:"Points"},"renderer.info.render.vertices":{caption:"Vertices"}};var i=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.faces","renderer.info.render.points","renderer.info.render.vertices"]}];var n=[];function a(){t("renderer.info.memory.geometries").set(e.info.memory.geometries);t("renderer.info.programs").set(e.info.programs.length);t("renderer.info.memory.textures").set(e.info.memory.textures);t("renderer.info.render.calls").set(e.info.render.calls);t("renderer.info.render.faces").set(e.info.render.faces);t("renderer.info.render.points").set(e.info.render.points);t("renderer.info.render.vertices").set(e.info.render.vertices)}function o(){}function s(){}function u(e){t=e}return{update:a,start:o,end:s,attach:u,values:r,groups:i,fractions:n}};window.BrowserStats=function(){var e=null;var t=0,r=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0});0===performance.memory.totalJSHeapSize&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var i={memory:{caption:"Used Memory",average:true,avgMs:1e3,over:22},total:{caption:"Total Memory"}};var n=[{caption:"Browser",values:["memory","total"]}];var a=[{base:"total",steps:["memory"]}];var o=Math.log(1024);function s(e){var t=100;var r=Math.floor(Math.log(e)/o);return Math.round(e*t/Math.pow(1024,r))/t}function u(){t=s(performance.memory.usedJSHeapSize);r=s(performance.memory.totalJSHeapSize);e("memory").set(t);e("total").set(r)}function c(){t=0}function l(){}function h(t){e=t}return{update:u,start:c,end:l,attach:h,values:i,groups:n,fractions:a}};"object"===typeof t&&(t.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],180:[function(e,t,r){"use strict";(function(){"performance"in window==false&&(window.performance={});var e=window.performance;if("now"in e==false){var t=Date.now();e.timing&&e.timing.navigationStart&&(t=e.timing.navigationStart);e.now=function e(){return Date.now()-t}}e.mark||(e.mark=function(){});e.measure||(e.measure=function(){})})();window.rStats=function e(t){function r(e,t){var r=Object.keys(e);for(var i=0,n=r.length;i<n;i++)t(r[i])}function i(e){var t=document.createElement("link");t.href=e;t.rel="stylesheet";t.type="text/css";document.getElementsByTagName("head")[0].appendChild(t)}var n=t||{};var a=n.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"];var o="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300";var s=(n.CSSPath?n.CSSPath:"")+"rStats.css";var u=n.css||[o,s];u.forEach(function(e){i(e)});n.values||(n.values={});var c,l,h=10,d=200;var p={};function f(e,t,r){var i=r||{};var n=document.createElement("canvas"),a=n.getContext("2d"),o=0,s=0;var u=i.color?i.color:"#666666";var c=document.createElement("canvas"),l=c.getContext("2d");c.width=1;c.height=2*h;l.fillStyle="#444444";l.fillRect(0,0,1,2*h);l.fillStyle=u;l.fillRect(0,h,1,h);l.fillStyle="#ffffff";l.globalAlpha=.5;l.fillRect(0,h,1,1);l.globalAlpha=1;var p=document.createElement("canvas"),f=p.getContext("2d");p.width=1;p.height=2*h;f.fillStyle="#444444";f.fillRect(0,0,1,2*h);f.fillStyle="#b70000";f.fillRect(0,h,1,h);f.globalAlpha=.5;f.fillStyle="#ffffff";f.fillRect(0,h,1,1);f.globalAlpha=1;function v(){n.width=d;n.height=h;n.style.width=n.width+"px";n.style.height=n.height+"px";n.className="rs-canvas";e.appendChild(n);a.fillStyle="#444444";a.fillRect(0,0,n.width,n.height)}function m(e,t){s+=.1*(e-s);o*=.99;s>o&&(o=s);a.drawImage(n,1,0,n.width-1,n.height,0,0,n.width-1,n.height);t?a.drawImage(p,n.width-1,n.height-s*n.height/o-h):a.drawImage(c,n.width-1,n.height-s*n.height/o-h)}v();return{draw:m}}function v(e,t){var i=document.createElement("canvas"),n=i.getContext("2d");function o(){i.width=d;i.height=h*t;i.style.width=i.width+"px";i.style.height=i.height+"px";i.className="rs-canvas";e.appendChild(i);n.fillStyle="#444444";n.fillRect(0,0,i.width,i.height)}function s(e){n.drawImage(i,1,0,i.width-1,i.height,0,0,i.width-1,i.height);var t=0;r(e,function(r){var o=e[r]*i.height;n.fillStyle=a[r];n.fillRect(i.width-1,t,1,o);t+=o})}o();return{draw:s}}function m(e,t){var r=e,i,a=0,o=0,s=0,u=0,c=performance.now(),h=0,d=document.createElement("div"),p=document.createElement("span"),v=document.createElement("div"),m=document.createTextNode(""),g=n?n.values[r.toLowerCase()]:null,y=new f(d,r,g),A=false;p.className="rs-counter-id";p.textContent=g&&g.caption?g.caption:r;v.className="rs-counter-value";v.appendChild(m);d.appendChild(p);d.appendChild(v);t?t.div.appendChild(d):l.appendChild(d);i=performance.now();function M(e){if(g&&g.average){u+=e;h++;var t=performance.now();if(t-c>=(g.avgMs||1e3)){s=u/h;u=0;c=t;h=0}}}function w(){i=performance.now();n.userTimingAPI&&performance.mark(r+"-start");A=true}function E(){a=performance.now()-i;if(n.userTimingAPI){performance.mark(r+"-end");A&&performance.measure(r,r+"-start",r+"-end")}M(a)}function x(){E();w()}function b(){var e=g&&g.average?s:a;m.nodeValue=Math.round(100*e)/100;var t=g&&(g.below&&a<g.below||g.over&&a>g.over);y.draw(a,t);d.className=t?"rs-counter-base alarm":"rs-counter-base"}function T(){var e=performance.now();var t=e-i;o++;if(t>1e3){a=g&&false===g.interpolate?o:1e3*o/t;o=0;i=e;M(a)}}function L(e){a=e;M(a)}return{set:L,start:w,tick:x,end:E,frame:T,value:function(){return a},draw:b}}function g(){var e=0;function t(t){e=t}return{set:t,value:function(){return e}}}function y(e){var t=e.toLowerCase();void 0===t&&(t="default");if(p[t])return p[t];var i=null;n&&n.groups&&r(n.groups,function(e){var r=n.groups[parseInt(e,10)];i||-1===r.values.indexOf(t.toLowerCase())||(i=r)});var a=new m(t,i);p[t]=a;return a}function A(){if(n.plugins){n.values||(n.values={});n.groups||(n.groups=[]);n.fractions||(n.fractions=[]);for(var e=0;e<n.plugins.length;e++){n.plugins[e].attach(y);r(n.plugins[e].values,function(t){n.values[t]=n.plugins[e].values[t]});n.groups=n.groups.concat(n.plugins[e].groups);n.fractions=n.fractions.concat(n.plugins[e].fractions)}}else n.plugins={};c=document.createElement("div");c.className="rs-base";l=document.createElement("div");l.className="rs-container";l.style.height="auto";c.appendChild(l);document.body.appendChild(c);if(!n)return;n.groups&&r(n.groups,function(e){var t=n.groups[parseInt(e,10)];var r=document.createElement("div");r.className="rs-group";t.div=r;var i=document.createElement("h1");i.textContent=t.caption;i.addEventListener("click",function(e){this.classList.toggle("hidden");e.preventDefault()}.bind(r));l.appendChild(i);l.appendChild(r)});n.fractions&&r(n.fractions,function(e){var t=n.fractions[parseInt(e,10)];var i=document.createElement("div");i.className="rs-fraction";var o=document.createElement("div");o.className="rs-legend";var s=0;r(n.fractions[e].steps,function(t){var r=document.createElement("p");r.textContent=n.fractions[e].steps[t];r.style.color=a[s];o.appendChild(r);s++});i.appendChild(o);i.style.height=s*h+"px";t.div=i;var u=new v(i,s);t.graph=u;l.appendChild(i)})}function M(){r(n.plugins,function(e){n.plugins[e].update()});r(p,function(e){p[e].draw()});n&&n.fractions&&r(n.fractions,function(e){var t=n.fractions[parseInt(e,10)];var i=[];var a=p[t.base.toLowerCase()];if(a){a=a.value();r(n.fractions[e].steps,function(t){var r=n.fractions[e].steps[parseInt(t,10)].toLowerCase();var o=p[r];o&&i.push(o.value()/a)})}t.graph.draw(i)})}A();return function(e){if(e)return y(e);return{element:c,update:M}}};"object"===typeof t&&(t.exports=window.rStats)},{}],181:[function(e,t,r){var i={};i.base64=function(e,t){return"data:"+e+";base64,"+t};i.isMobile=function(){var e=false;(function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=true)})(navigator.userAgent||navigator.vendor||window.opera);return e};i.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)};i.isIFrame=function(){try{return window.self!==window.top}catch(e){return true}};i.appendQueryParameter=function(e,t,r){var i=e.indexOf("?")<0?"?":"&";e+=i+t+"="+r;return e};i.getQueryParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),r=t.exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))};i.isLandscapeMode=function(){return 90==window.orientation||-90==window.orientation};t.exports=i},{}],182:[function(e,t,r){var i=e("./util.js");function n(){var e=document.createElement("video");e.addEventListener("ended",function(){e.play()});this.request=function(){if(e.paused){e.src=i.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw==");e.play()}};this.release=function(){e.pause();e.src=""}}function a(){var e=null;this.request=function(){e||(e=setInterval(function(){window.location.href="/";setTimeout(window.stop,0)},15e3))};this.release=function(){if(e){clearInterval(e);e=null}}}function o(){var e=navigator.userAgent||navigator.vendor||window.opera;return e.match(/iPhone/i)||e.match(/iPod/i)?a:n}t.exports=o()},{"./util.js":181}]},{},[148])(148)})}).call(r,i(40),i(299).setImmediate)},299:function(e,t,r){(function(e){var i="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window;var n=Function.prototype.apply;t.setTimeout=function(){return new a(n.call(setTimeout,i,arguments),clearTimeout)};t.setInterval=function(){return new a(n.call(setInterval,i,arguments),clearInterval)};t.clearTimeout=t.clearInterval=function(e){e&&e.close()};function a(e,t){this._id=e;this._clearFn=t}a.prototype.unref=a.prototype.ref=function(){};a.prototype.close=function(){this._clearFn.call(i,this._id)};t.enroll=function(e,t){clearTimeout(e._idleTimeoutId);e._idleTimeout=t};t.unenroll=function(e){clearTimeout(e._idleTimeoutId);e._idleTimeout=-1};t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function t(){e._onTimeout&&e._onTimeout()},t))};r(300);t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate;t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(t,r(40))},300:function(e,t,r){(function(e,t){(function(e,r){"use strict";if(e.setImmediate)return;var i=1;var n={};var a=false;var o=e.document;var s;function u(e){"function"!==typeof e&&(e=new Function(""+e));var t=new Array(arguments.length-1);for(var r=0;r<t.length;r++)t[r]=arguments[r+1];var a={callback:e,args:t};n[i]=a;s(i);return i++}function c(e){delete n[e]}function l(e){var t=e.callback;var i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(r,i);break}}function h(e){if(a)setTimeout(h,0,e);else{var t=n[e];if(t){a=true;try{l(t)}finally{c(e);a=false}}}}function d(){s=function(e){t.nextTick(function(){h(e)})}}function p(){if(e.postMessage&&!e.importScripts){var t=true;var r=e.onmessage;e.onmessage=function(){t=false};e.postMessage("","*");e.onmessage=r;return t}}function f(){var t="setImmediate$"+Math.random()+"$";var r=function(r){r.source===e&&"string"===typeof r.data&&0===r.data.indexOf(t)&&h(+r.data.slice(t.length))};e.addEventListener?e.addEventListener("message",r,false):e.attachEvent("onmessage",r);s=function(r){e.postMessage(t+r,"*")}}function v(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;h(t)};s=function(t){e.port2.postMessage(t)}}function m(){var e=o.documentElement;s=function(t){var r=o.createElement("script");r.onreadystatechange=function(){h(t);r.onreadystatechange=null;e.removeChild(r);r=null};e.appendChild(r)}}function g(){s=function(e){setTimeout(h,0,e)}}var y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e;"[object process]"==={}.toString.call(e.process)?d():p()?f():e.MessageChannel?v():o&&"onreadystatechange"in o.createElement("script")?m():g();y.setImmediate=u;y.clearImmediate=c})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(t,r(40),r(74))},301:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Scene=t.Entity=t.options=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(e,i.key,i)}}return function(t,r,i){r&&e(t.prototype,r);i&&e(t,i);return t}}();var a=r(1);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=["children","events","primitive"];var d=function e(t){return-1===h.indexOf(t)};var p={runSetAttributeOnUpdates:true};t.options=p;function f(e,t,r){if("className"===r)e.setAttribute("class",t.className);else{if(t[r]&&t[r].constructor===Function)return;e.setAttribute(r,t[r])}}function v(e,t,r){var i;if(!r||t===r)return;for(i in r){if(!d(i))continue;f(e,r,i)}if(t)for(i in t){if(!d(i))continue;void 0===r[i]&&e.removeAttribute(i)}}var m=t.Entity=function(e){l(t,e);function t(){var e;var r,i,n;u(this,t);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=(r=(i=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),i),i.initEntity=function(e){var t=i.props;var r;if(!e)return;i.el=e;if(t.events)for(r in t.events)A(e,r,t.events[r]);v(e,null,t);t._ref&&t._ref(e)},r),c(i,n)}n(t,[{key:"componentDidUpdate",value:function e(t,r){var i=this.el;var n=this.props;y(i,t.events,n.events);p.runSetAttributeOnUpdates&&v(i,t,n)}},{key:"componentWillUnmount",value:function e(){var t=this.el;var r=this.props;var i;if(r.events)for(i in r.events)M(t,i,r.events[i])}},{key:"render",value:function e(){var t=this.props;var r=this.isScene?"a-scene":t.primitive||"a-entity";var n;var a={};for(n in t)-1===["className","id","mixin"].indexOf(n)&&0!==n.indexOf("data-")||(a[n]=t[n]);return o.default.createElement(r,i({ref:this.initEntity},a),t.children)}}]);return t}(o.default.Component);var g=t.Scene=function(e){l(t,e);function t(e){u(this,t);var r=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.isScene=true;return r}return t}(m);function y(e,t,r){var i;if(!t||!r||t===r)return;for(i in r){if(t[i]===r[i])continue;t[i]&&M(e,i,t[i]);A(e,i,r[i])}for(i in t)r[i]||M(e,i,t[i])}function A(e,t,r){var i;var n;if(!r)return;r.constructor===Function&&(r=[r]);for(n=0;n<r.length;n++)e.addEventListener(t,r[n])}function M(e,t,r){var i;var n;if(!r)return;r.constructor===Function&&(r=[r]);for(n=0;n<r.length;n++)e.removeEventListener(t,r[n])}},302:function(e,t,r){var i=r(303);if("undefined"===typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("particle-system",{schema:{preset:{type:"string",default:"",oneOf:["default","dust","snow","rain"]},maxAge:{type:"number"},positionSpread:{type:"vec3"},type:{type:"number"},rotationAxis:{type:"string"},rotationAngle:{type:"number"},accelerationValue:{type:"vec3"},accelerationSpread:{type:"vec3"},velocityValue:{type:"vec3"},velocitySpread:{type:"vec3"},color:{type:"array"},size:{type:"number"},direction:{type:"number"},duration:{type:"number"},particleCount:{type:"number"},texture:{type:"asset"},randomize:{type:"boolean"},opacity:{type:"number"},maxParticleCount:{type:"number",default:25e4},blending:{type:"number",default:THREE.AdditiveBlending,oneOf:[THREE.NoBlending,THREE.NormalBlending,THREE.AdditiveBlending,THREE.SubtractiveBlending,THREE.MultiplyBlending]},enabled:{type:"boolean",default:true}},init:function(){this.presets=[];this.presets["default"]={maxAge:0!==this.data.maxAge?this.data.maxAge:6,positionSpread:0!==this.data.positionSpread.x||0!==this.data.positionSpread.y||0!==this.data.positionSpread.z?this.data.positionSpread:{x:0,y:0,z:0},type:0!==this.data.type?this.data.type:i.distributions.BOX,rotationAxis:""!==this.data.rotationAxis?this.data.rotationAxis:"x",rotationAngle:0!==this.data.rotationAngle?this.data.rotationAngle:0,accelerationValue:0!==this.data.accelerationValue.x||0!==this.data.accelerationValue.y||0!==this.data.accelerationValue.z?this.data.accelerationValue:{x:0,y:-10,z:0},accelerationSpread:0!==this.data.accelerationSpread.x||0!==this.data.accelerationSpread.y||0!==this.data.accelerationSpread.z?this.data.accelerationSpread:{x:10,y:0,z:10},velocityValue:0!==this.data.velocityValue.x||0!==this.data.velocityValue.y||0!==this.data.velocityValue.z?this.data.velocityValue:{x:0,y:25,z:0},velocitySpread:0!==this.data.velocitySpread.x||0!==this.data.velocitySpread.y||0!==this.data.velocitySpread.z?this.data.velocitySpread:{x:10,y:7.5,z:10},color:this.data.color.length?this.data.color:["#0000FF","#FF0000"],size:0!==this.data.size?this.data.size:1,opacity:{value:0!=this.data.opacity?this.data.opacity:1},direction:0!==this.data.direction?this.data.direction:1,duration:0!=this.data.duration?this.data.duration:null,particleCount:0!==this.data.particleCount?this.data.particleCount:1e3,texture:""!==this.data.texture?this.data.texture:"https://cdn.rawgit.com/IdeaSpaceVR/aframe-particle-system-component/master/dist/images/star2.png",randomize:false};this.presets["dust"]={maxAge:0!==this.data.maxAge?this.data.maxAge:20,positionSpread:0!==this.data.positionSpread.x||0!==this.data.positionSpread.y||0!==this.data.positionSpread.z?this.data.positionSpread:{x:100,y:100,z:100},type:0!==this.data.type?this.data.type:i.distributions.BOX,rotationAxis:""!==this.data.rotationAxis?this.data.rotationAxis:"x",rotationAngle:0!==this.data.rotationAngle?this.data.rotationAngle:3.14,accelerationValue:0!==this.data.accelerationValue.x||0!==this.data.accelerationValue.y||0!==this.data.accelerationValue.z?this.data.accelerationValue:{x:0,y:0,z:0},accelerationSpread:0!==this.data.accelerationSpread.x||0!==this.data.accelerationSpread.y||0!==this.data.accelerationSpread.z?this.data.accelerationSpread:{x:0,y:0,z:0},velocityValue:0!==this.data.velocityValue.x||0!==this.data.velocityValue.y||0!==this.data.velocityValue.z?this.data.velocityValue:{x:1,y:.3,z:1},velocitySpread:0!==this.data.velocitySpread.x||0!==this.data.velocitySpread.y||0!==this.data.velocitySpread.z?this.data.velocitySpread:{x:.5,y:1,z:.5},color:this.data.color.length?this.data.color:["#FFFFFF"],size:0!==this.data.size?this.data.size:1,opacity:{value:0!=this.data.opacity?this.data.opacity:1},direction:0!==this.data.direction?this.data.direction:1,duration:0!=this.data.duration?this.data.duration:null,particleCount:0!==this.data.particleCount?this.data.particleCount:100,texture:""!==this.data.texture?this.data.texture:"https://cdn.rawgit.com/IdeaSpaceVR/aframe-particle-system-component/master/dist/images/smokeparticle.png",randomize:false};this.presets["snow"]={maxAge:0!==this.data.maxAge?this.data.maxAge:20,positionSpread:0!==this.data.positionSpread.x||0!==this.data.positionSpread.y||0!==this.data.positionSpread.z?this.data.positionSpread:{x:100,y:100,z:100},type:0!==this.data.type?this.data.type:i.distributions.BOX,rotationAxis:""!==this.data.rotationAxis?this.data.rotationAxis:"x",rotationAngle:0!==this.data.rotationAngle?this.data.rotationAngle:3.14,accelerationValue:0!==this.data.accelerationValue.x||0!==this.data.accelerationValue.y||0!==this.data.accelerationValue.z?this.data.accelerationValue:{x:0,y:0,z:0},accelerationSpread:0!==this.data.accelerationSpread.x||0!==this.data.accelerationSpread.y||0!==this.data.accelerationSpread.z?this.data.accelerationSpread:{x:.2,y:0,z:.2},velocityValue:0!==this.data.velocityValue.x||0!==this.data.velocityValue.y||0!==this.data.velocityValue.z?this.data.velocityValue:{x:0,y:8,z:0},velocitySpread:0!==this.data.velocitySpread.x||0!==this.data.velocitySpread.y||0!==this.data.velocitySpread.z?this.data.velocitySpread:{x:2,y:0,z:2},color:this.data.color.length?this.data.color:["#FFFFFF"],size:0!==this.data.size?this.data.size:1,opacity:{value:0!=this.data.opacity?this.data.opacity:1},direction:0!==this.data.direction?this.data.direction:1,duration:0!=this.data.duration?this.data.duration:null,particleCount:0!==this.data.particleCount?this.data.particleCount:200,texture:""!==this.data.texture?this.data.texture:"https://cdn.rawgit.com/IdeaSpaceVR/aframe-particle-system-component/master/dist/images/smokeparticle.png",randomize:false};this.presets["rain"]={maxAge:0!==this.data.maxAge?this.data.maxAge:1,positionSpread:0!==this.data.positionSpread.x||0!==this.data.positionSpread.y||0!==this.data.positionSpread.z?this.data.positionSpread:{x:100,y:100,z:100},type:0!==this.data.type?this.data.type:i.distributions.BOX,rotationAxis:""!==this.data.rotationAxis?this.data.rotationAxis:"x",rotationAngle:0!==this.data.rotationAngle?this.data.rotationAngle:3.14,accelerationValue:0!==this.data.accelerationValue.x||0!==this.data.accelerationValue.y||0!==this.data.accelerationValue.z?this.data.accelerationValue:{x:0,y:3,z:0},accelerationSpread:0!==this.data.accelerationSpread.x||0!==this.data.accelerationSpread.y||0!==this.data.accelerationSpread.z?this.data.accelerationSpread:{x:2,y:1,z:2},velocityValue:0!==this.data.velocityValue.x||0!==this.data.velocityValue.y||0!==this.data.velocityValue.z?this.data.velocityValue:{x:0,y:75,z:0},velocitySpread:0!==this.data.velocitySpread.x||0!==this.data.velocitySpread.y||0!==this.data.velocitySpread.z?this.data.velocitySpread:{x:10,y:50,z:10},color:this.data.color.length?this.data.color:["#FFFFFF"],size:0!==this.data.size?this.data.size:.4,opacity:{value:0!=this.data.opacity?this.data.opacity:1},direction:0!==this.data.direction?this.data.direction:1,duration:0!=this.data.duration?this.data.duration:null,particleCount:0!==this.data.particleCount?this.data.particleCount:1e3,texture:""!==this.data.texture?this.data.texture:"https://cdn.rawgit.com/IdeaSpaceVR/aframe-particle-system-component/master/dist/images/raindrop.png",randomize:false}},update:function(e){this.particleGroup&&this.el.removeObject3D("particle-system");""!=this.data.preset&&this.data.preset in this.presets?this.initParticleSystem(this.presets[this.data.preset]):this.initParticleSystem(this.presets["default"]);true===this.data.enabled?this.startParticles():this.stopParticles()},tick:function(e,t){this.particleGroup.tick(t/1e3)},remove:function(){if(!this.particleGroup)return;this.el.removeObject3D("particle-system")},startParticles:function(){this.particleGroup.emitters.forEach(function(e){e.enable()})},stopParticles:function(){this.particleGroup.emitters.forEach(function(e){e.disable()})},initParticleSystem:function(e){var t=new THREE.TextureLoader;var r=t.load(e.texture,function(e){return e},function(e){console.log(e.loaded/e.total*100+"% loaded")},function(e){console.log("An error occurred")});this.particleGroup=new i.Group({texture:{value:r},maxParticleCount:this.data.maxParticleCount,blending:this.data.blending});var n=new i.Emitter({maxAge:{value:e.maxAge},type:{value:e.type},position:{spread:new THREE.Vector3(e.positionSpread.x,e.positionSpread.y,e.positionSpread.z),randomize:e.randomize},rotation:{axis:"x"==e.rotationAxis?new THREE.Vector3(1,0,0):"y"==e.rotationAxis?new THREE.Vector3(0,1,0):"z"==e.rotationAxis?new THREE.Vector3(0,0,1):new THREE.Vector3(0,1,0),angle:e.rotationAngle,static:true},acceleration:{value:new THREE.Vector3(e.accelerationValue.x,e.accelerationValue.y,e.accelerationValue.z),spread:new THREE.Vector3(e.accelerationSpread.x,e.accelerationSpread.y,e.accelerationSpread.z)},velocity:{value:new THREE.Vector3(e.velocityValue.x,e.velocityValue.y,e.velocityValue.z),spread:new THREE.Vector3(e.velocitySpread.x,e.velocitySpread.y,e.velocitySpread.z)},color:{value:e.color.map(function(e){return new THREE.Color(e)})},size:{value:e.size},direction:{value:e.direction},duration:e.duration,opacity:e.opacity,particleCount:e.particleCount});this.particleGroup.addEmitter(n);this.particleGroup.mesh.frustumCulled=false;this.el.setObject3D("particle-system",this.particleGroup.mesh)}})},303:function(e,t,r){var i,n;var a={distributions:{BOX:1,SPHERE:2,DISC:3},valueOverLifetimeLength:4};true;!(i=a,n="function"===typeof i?i.call(t,r,t,e):i,void 0!==n&&(e.exports=n));a.TypedArrayHelper=function(e,t,r,i){"use strict";this.componentSize=r||1;this.size=t||1;this.TypedArrayConstructor=e||Float32Array;this.array=new e(t*this.componentSize);this.indexOffset=i||0};a.TypedArrayHelper.constructor=a.TypedArrayHelper;a.TypedArrayHelper.prototype.setSize=function(e,t){"use strict";var r=this.array.length;t||(e*=this.componentSize);if(e<r)return this.shrink(e);if(e>r)return this.grow(e);console.info("TypedArray is already of size:",e+".","Will not resize.")};a.TypedArrayHelper.prototype.shrink=function(e){"use strict";this.array=this.array.subarray(0,e);this.size=e;return this};a.TypedArrayHelper.prototype.grow=function(e){"use strict";var t=this.array,r=new this.TypedArrayConstructor(e);r.set(t);this.array=r;this.size=e;return this};a.TypedArrayHelper.prototype.splice=function(e,t){"use strict";e*=this.componentSize;t*=this.componentSize;var r=[],i=this.array,n=i.length;for(var a=0;a<n;++a)(a<e||a>=t)&&r.push(i[a]);this.setFromArray(0,r);return this};a.TypedArrayHelper.prototype.setFromArray=function(e,t){"use strict";var r=t.length,i=e+r;i>this.array.length?this.grow(i):i<this.array.length&&this.shrink(i);this.array.set(t,this.indexOffset+e);return this};a.TypedArrayHelper.prototype.setVec2=function(e,t){"use strict";return this.setVec2Components(e,t.x,t.y)};a.TypedArrayHelper.prototype.setVec2Components=function(e,t,r){"use strict";var i=this.array,n=this.indexOffset+e*this.componentSize;i[n]=t;i[n+1]=r;return this};a.TypedArrayHelper.prototype.setVec3=function(e,t){"use strict";return this.setVec3Components(e,t.x,t.y,t.z)};a.TypedArrayHelper.prototype.setVec3Components=function(e,t,r,i){"use strict";var n=this.array,a=this.indexOffset+e*this.componentSize;n[a]=t;n[a+1]=r;n[a+2]=i;return this};a.TypedArrayHelper.prototype.setVec4=function(e,t){"use strict";return this.setVec4Components(e,t.x,t.y,t.z,t.w)};a.TypedArrayHelper.prototype.setVec4Components=function(e,t,r,i,n){"use strict";var a=this.array,o=this.indexOffset+e*this.componentSize;a[o]=t;a[o+1]=r;a[o+2]=i;a[o+3]=n;return this};a.TypedArrayHelper.prototype.setMat3=function(e,t){"use strict";return this.setFromArray(this.indexOffset+e*this.componentSize,t.elements)};a.TypedArrayHelper.prototype.setMat4=function(e,t){"use strict";return this.setFromArray(this.indexOffset+e*this.componentSize,t.elements)};a.TypedArrayHelper.prototype.setColor=function(e,t){"use strict";return this.setVec3Components(e,t.r,t.g,t.b)};a.TypedArrayHelper.prototype.setNumber=function(e,t){"use strict";this.array[this.indexOffset+e*this.componentSize]=t;return this};a.TypedArrayHelper.prototype.getValueAtIndex=function(e){"use strict";return this.array[this.indexOffset+e]};a.TypedArrayHelper.prototype.getComponentValueAtIndex=function(e){"use strict";return this.array.subarray(this.indexOffset+e*this.componentSize)};a.ShaderAttribute=function(e,t,r){"use strict";var i=a.ShaderAttribute.typeSizeMap;this.type="string"===typeof e&&i.hasOwnProperty(e)?e:"f";this.componentSize=i[this.type];this.arrayType=r||Float32Array;this.typedArray=null;this.bufferAttribute=null;this.dynamicBuffer=!!t;this.updateMin=0;this.updateMax=0};a.ShaderAttribute.constructor=a.ShaderAttribute;a.ShaderAttribute.typeSizeMap={f:1,v2:2,v3:3,v4:4,c:3,m3:9,m4:16};a.ShaderAttribute.prototype.setUpdateRange=function(e,t){"use strict";this.updateMin=Math.min(e*this.componentSize,this.updateMin*this.componentSize);this.updateMax=Math.max(t*this.componentSize,this.updateMax*this.componentSize)};a.ShaderAttribute.prototype.flagUpdate=function(){"use strict";var e=this.bufferAttribute,t=e.updateRange;t.offset=this.updateMin;t.count=Math.min(this.updateMax-this.updateMin+this.componentSize,this.typedArray.array.length);e.needsUpdate=true};a.ShaderAttribute.prototype.resetUpdateRange=function(){"use strict";this.updateMin=0;this.updateMax=0};a.ShaderAttribute.prototype.resetDynamic=function(){"use strict";this.bufferAttribute.dynamic=this.dynamicBuffer};a.ShaderAttribute.prototype.splice=function(e,t){"use strict";this.typedArray.splice(e,t);this.forceUpdateAll()};a.ShaderAttribute.prototype.forceUpdateAll=function(){"use strict";this.bufferAttribute.array=this.typedArray.array;this.bufferAttribute.updateRange.offset=0;this.bufferAttribute.updateRange.count=-1;this.bufferAttribute.dynamic=false;this.bufferAttribute.needsUpdate=true};a.ShaderAttribute.prototype._ensureTypedArray=function(e){"use strict";if(null!==this.typedArray&&this.typedArray.size===e*this.componentSize)return;null!==this.typedArray&&this.typedArray.size!==e?this.typedArray.setSize(e):null===this.typedArray&&(this.typedArray=new a.TypedArrayHelper(this.arrayType,e,this.componentSize))};a.ShaderAttribute.prototype._createBufferAttribute=function(e){"use strict";this._ensureTypedArray(e);if(null!==this.bufferAttribute){this.bufferAttribute.array=this.typedArray.array;this.bufferAttribute.needsUpdate=true;return}this.bufferAttribute=new THREE.BufferAttribute(this.typedArray.array,this.componentSize);this.bufferAttribute.dynamic=this.dynamicBuffer};a.ShaderAttribute.prototype.getLength=function(){"use strict";if(null===this.typedArray)return 0;return this.typedArray.array.length};a.shaderChunks={defines:["#define PACKED_COLOR_SIZE 256.0","#define PACKED_COLOR_DIVISOR 255.0"].join("\n"),uniforms:["uniform float deltaTime;","uniform float runTime;","uniform sampler2D texture;","uniform vec4 textureAnimation;","uniform float scale;"].join("\n"),attributes:["attribute vec4 acceleration;","attribute vec3 velocity;","attribute vec4 rotation;","attribute vec3 rotationCenter;","attribute vec4 params;","attribute vec4 size;","attribute vec4 angle;","attribute vec4 color;","attribute vec4 opacity;"].join("\n"),varyings:["varying vec4 vColor;","#ifdef SHOULD_ROTATE_TEXTURE","    varying float vAngle;","#endif","#ifdef SHOULD_CALCULATE_SPRITE","    varying vec4 vSpriteSheet;","#endif"].join("\n"),branchAvoidanceFunctions:["float when_gt(float x, float y) {","    return max(sign(x - y), 0.0);","}","float when_lt(float x, float y) {","    return min( max(1.0 - sign(x - y), 0.0), 1.0 );","}","float when_eq( float x, float y ) {","    return 1.0 - abs( sign( x - y ) );","}","float when_ge(float x, float y) {","  return 1.0 - when_lt(x, y);","}","float when_le(float x, float y) {","  return 1.0 - when_gt(x, y);","}","float and(float a, float b) {","    return a * b;","}","float or(float a, float b) {","    return min(a + b, 1.0);","}"].join("\n"),unpackColor:["vec3 unpackColor( in float hex ) {","   vec3 c = vec3( 0.0 );","   float r = mod( (hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float g = mod( (hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float b = mod( hex, PACKED_COLOR_SIZE );","   c.r = r / PACKED_COLOR_DIVISOR;","   c.g = g / PACKED_COLOR_DIVISOR;","   c.b = b / PACKED_COLOR_DIVISOR;","   return c;","}"].join("\n"),unpackRotationAxis:["vec3 unpackRotationAxis( in float hex ) {","   vec3 c = vec3( 0.0 );","   float r = mod( (hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float g = mod( (hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float b = mod( hex, PACKED_COLOR_SIZE );","   c.r = r / PACKED_COLOR_DIVISOR;","   c.g = g / PACKED_COLOR_DIVISOR;","   c.b = b / PACKED_COLOR_DIVISOR;","   c *= vec3( 2.0 );","   c -= vec3( 1.0 );","   return c;","}"].join("\n"),floatOverLifetime:["float getFloatOverLifetime( in float positionInTime, in vec4 attr ) {","    highp float value = 0.0;","    float deltaAge = positionInTime * float( VALUE_OVER_LIFETIME_LENGTH - 1 );","    float fIndex = 0.0;","    float shouldApplyValue = 0.0;","    value += attr[ 0 ] * when_eq( deltaAge, 0.0 );","","    for( int i = 0; i < VALUE_OVER_LIFETIME_LENGTH - 1; ++i ) {","       fIndex = float( i );","       shouldApplyValue = and( when_gt( deltaAge, fIndex ), when_le( deltaAge, fIndex + 1.0 ) );","       value += shouldApplyValue * mix( attr[ i ], attr[ i + 1 ], deltaAge - fIndex );","    }","","    return value;","}"].join("\n"),colorOverLifetime:["vec3 getColorOverLifetime( in float positionInTime, in vec3 color1, in vec3 color2, in vec3 color3, in vec3 color4 ) {","    vec3 value = vec3( 0.0 );","    value.x = getFloatOverLifetime( positionInTime, vec4( color1.x, color2.x, color3.x, color4.x ) );","    value.y = getFloatOverLifetime( positionInTime, vec4( color1.y, color2.y, color3.y, color4.y ) );","    value.z = getFloatOverLifetime( positionInTime, vec4( color1.z, color2.z, color3.z, color4.z ) );","    return value;","}"].join("\n"),paramFetchingFunctions:["float getAlive() {","   return params.x;","}","float getAge() {","   return params.y;","}","float getMaxAge() {","   return params.z;","}","float getWiggle() {","   return params.w;","}"].join("\n"),forceFetchingFunctions:["vec4 getPosition( in float age ) {","   return modelViewMatrix * vec4( position, 1.0 );","}","vec3 getVelocity( in float age ) {","   return velocity * age;","}","vec3 getAcceleration( in float age ) {","   return acceleration.xyz * age;","}"].join("\n"),rotationFunctions:["#ifdef SHOULD_ROTATE_PARTICLES","   mat4 getRotationMatrix( in vec3 axis, in float angle) {","       axis = normalize(axis);","       float s = sin(angle);","       float c = cos(angle);","       float oc = 1.0 - c;","","       return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,","                   oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,","                   oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,","                   0.0,                                0.0,                                0.0,                                1.0);","   }","","   vec3 getRotation( in vec3 pos, in float positionInTime ) {","      if( rotation.y == 0.0 ) {","           return pos;","      }","","      vec3 axis = unpackRotationAxis( rotation.x );","      vec3 center = rotationCenter;","      vec3 translated;","      mat4 rotationMatrix;","      float angle = 0.0;","      angle += when_eq( rotation.z, 0.0 ) * rotation.y;","      angle += when_gt( rotation.z, 0.0 ) * mix( 0.0, rotation.y, positionInTime );","      translated = rotationCenter - pos;","      rotationMatrix = getRotationMatrix( axis, angle );","      return center - vec3( rotationMatrix * vec4( translated, 0.0 ) );","   }","#endif"].join("\n"),rotateTexture:["    vec2 vUv = vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y );","","    #ifdef SHOULD_ROTATE_TEXTURE","       float x = gl_PointCoord.x - 0.5;","       float y = 1.0 - gl_PointCoord.y - 0.5;","       float c = cos( -vAngle );","       float s = sin( -vAngle );","       vUv = vec2( c * x + s * y + 0.5, c * y - s * x + 0.5 );","    #endif","","    #ifdef SHOULD_CALCULATE_SPRITE","        float framesX = vSpriteSheet.x;","        float framesY = vSpriteSheet.y;","        float columnNorm = vSpriteSheet.z;","        float rowNorm = vSpriteSheet.w;","        vUv.x = gl_PointCoord.x * framesX + columnNorm;","        vUv.y = 1.0 - (gl_PointCoord.y * framesY + rowNorm);","    #endif","","    vec4 rotatedTexture = texture2D( texture, vUv );"].join("\n")};a.shaders={vertex:[a.shaderChunks.defines,a.shaderChunks.uniforms,a.shaderChunks.attributes,a.shaderChunks.varyings,THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,THREE.ShaderChunk.fog_pars_vertex,a.shaderChunks.branchAvoidanceFunctions,a.shaderChunks.unpackColor,a.shaderChunks.unpackRotationAxis,a.shaderChunks.floatOverLifetime,a.shaderChunks.colorOverLifetime,a.shaderChunks.paramFetchingFunctions,a.shaderChunks.forceFetchingFunctions,a.shaderChunks.rotationFunctions,"void main() {","    highp float age = getAge();","    highp float alive = getAlive();","    highp float maxAge = getMaxAge();","    highp float positionInTime = (age / maxAge);","    highp float isAlive = when_gt( alive, 0.0 );","    #ifdef SHOULD_WIGGLE_PARTICLES","        float wiggleAmount = positionInTime * getWiggle();","        float wiggleSin = isAlive * sin( wiggleAmount );","        float wiggleCos = isAlive * cos( wiggleAmount );","    #endif","    vec3 vel = getVelocity( age );","    vec3 accel = getAcceleration( age );","    vec3 force = vec3( 0.0 );","    vec3 pos = vec3( position );","    float drag = 1.0 - (positionInTime * 0.5) * acceleration.w;","    force += vel;","    force *= drag;","    force += accel * age;","    pos += force;","    #ifdef SHOULD_WIGGLE_PARTICLES","        pos.x += wiggleSin;","        pos.y += wiggleCos;","        pos.z += wiggleSin;","    #endif","    #ifdef SHOULD_ROTATE_PARTICLES","        pos = getRotation( pos, positionInTime );","    #endif","    vec4 mvPos = modelViewMatrix * vec4( pos, 1.0 );","    highp float pointSize = getFloatOverLifetime( positionInTime, size ) * isAlive;","    #ifdef HAS_PERSPECTIVE","        float perspective = scale / length( mvPos.xyz );","    #else","        float perspective = 1.0;","    #endif","    float pointSizePerspective = pointSize * perspective;","    #ifdef COLORIZE","       vec3 c = isAlive * getColorOverLifetime(","           positionInTime,","           unpackColor( color.x ),","           unpackColor( color.y ),","           unpackColor( color.z ),","           unpackColor( color.w )","       );","    #else","       vec3 c = vec3(1.0);","    #endif","    float o = isAlive * getFloatOverLifetime( positionInTime, opacity );","    vColor = vec4( c, o );","    #ifdef SHOULD_ROTATE_TEXTURE","        vAngle = isAlive * getFloatOverLifetime( positionInTime, angle );","    #endif","    #ifdef SHOULD_CALCULATE_SPRITE","        float framesX = textureAnimation.x;","        float framesY = textureAnimation.y;","        float loopCount = textureAnimation.w;","        float totalFrames = textureAnimation.z;","        float frameNumber = mod( (positionInTime * loopCount) * totalFrames, totalFrames );","        float column = floor(mod( frameNumber, framesX ));","        float row = floor( (frameNumber - column) / framesX );","        float columnNorm = column / framesX;","        float rowNorm = row / framesY;","        vSpriteSheet.x = 1.0 / framesX;","        vSpriteSheet.y = 1.0 / framesY;","        vSpriteSheet.z = columnNorm;","        vSpriteSheet.w = rowNorm;","    #endif","    gl_PointSize = pointSizePerspective;","    gl_Position = projectionMatrix * mvPos;",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.fog_vertex,"}"].join("\n"),fragment:[a.shaderChunks.uniforms,THREE.ShaderChunk.common,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,a.shaderChunks.varyings,a.shaderChunks.branchAvoidanceFunctions,"void main() {","    vec3 outgoingLight = vColor.xyz;","    ","    #ifdef ALPHATEST","       if ( vColor.w < float(ALPHATEST) ) discard;","    #endif",a.shaderChunks.rotateTexture,THREE.ShaderChunk.logdepthbuf_fragment,"    outgoingLight = vColor.xyz * rotatedTexture.xyz;","    gl_FragColor = vec4( outgoingLight.xyz, rotatedTexture.w * vColor.w );",THREE.ShaderChunk.fog_fragment,"}"].join("\n")};a.utils={types:{BOOLEAN:"boolean",STRING:"string",NUMBER:"number",OBJECT:"object"},ensureTypedArg:function(e,t,r){"use strict";return typeof e===t?e:r},ensureArrayTypedArg:function(e,t,r){"use strict";if(Array.isArray(e)){for(var i=e.length-1;i>=0;--i)if(typeof e[i]!==t)return r;return e}return this.ensureTypedArg(e,t,r)},ensureInstanceOf:function(e,t,r){"use strict";return void 0!==t&&e instanceof t?e:r},ensureArrayInstanceOf:function(e,t,r){"use strict";if(Array.isArray(e)){for(var i=e.length-1;i>=0;--i)if(void 0!==t&&e[i]instanceof t===false)return r;return e}return this.ensureInstanceOf(e,t,r)},ensureValueOverLifetimeCompliance:function(e,t,r){"use strict";t=t||3;r=r||3;false===Array.isArray(e._value)&&(e._value=[e._value]);false===Array.isArray(e._spread)&&(e._spread=[e._spread]);var i=this.clamp(e._value.length,t,r),n=this.clamp(e._spread.length,t,r),a=Math.max(i,n);e._value.length!==a&&(e._value=this.interpolateArray(e._value,a));e._spread.length!==a&&(e._spread=this.interpolateArray(e._spread,a))},interpolateArray:function(e,t){"use strict";var r=e.length,i=["function"===typeof e[0].clone?e[0].clone():e[0]],n=(r-1)/(t-1);for(var a=1;a<t-1;++a){var o=a*n,s=Math.floor(o),u=Math.ceil(o),c=o-s;i[a]=this.lerpTypeAgnostic(e[s],e[u],c)}i.push("function"===typeof e[r-1].clone?e[r-1].clone():e[r-1]);return i},clamp:function(e,t,r){"use strict";return Math.max(t,Math.min(e,r))},zeroToEpsilon:function(e,t){"use strict";var r=1e-5,i=e;i=t?Math.random()*r*10:r;e<0&&e>-r&&(i=-i);return i},lerpTypeAgnostic:function(e,t,r){"use strict";var i=this.types,n;if(typeof e===i.NUMBER&&typeof t===i.NUMBER)return e+(t-e)*r;if(e instanceof THREE.Vector2&&t instanceof THREE.Vector2){n=e.clone();n.x=this.lerp(e.x,t.x,r);n.y=this.lerp(e.y,t.y,r);return n}if(e instanceof THREE.Vector3&&t instanceof THREE.Vector3){n=e.clone();n.x=this.lerp(e.x,t.x,r);n.y=this.lerp(e.y,t.y,r);n.z=this.lerp(e.z,t.z,r);return n}if(e instanceof THREE.Vector4&&t instanceof THREE.Vector4){n=e.clone();n.x=this.lerp(e.x,t.x,r);n.y=this.lerp(e.y,t.y,r);n.z=this.lerp(e.z,t.z,r);n.w=this.lerp(e.w,t.w,r);return n}if(e instanceof THREE.Color&&t instanceof THREE.Color){n=e.clone();n.r=this.lerp(e.r,t.r,r);n.g=this.lerp(e.g,t.g,r);n.b=this.lerp(e.b,t.b,r);return n}console.warn("Invalid argument types, or argument types do not match:",e,t)},lerp:function(e,t,r){"use strict";return e+(t-e)*r},roundToNearestMultiple:function(e,t){"use strict";var r=0;if(0===t)return e;r=Math.abs(e)%t;if(0===r)return e;if(e<0)return-(Math.abs(e)-r);return e+t-r},arrayValuesAreEqual:function(e){"use strict";for(var t=0;t<e.length-1;++t)if(e[t]!==e[t+1])return false;return true},randomFloat:function(e,t){"use strict";return e+t*(Math.random()-.5)},randomVector3:function(e,t,r,i,n){"use strict";var a=r.x+(Math.random()*i.x-.5*i.x),o=r.y+(Math.random()*i.y-.5*i.y),s=r.z+(Math.random()*i.z-.5*i.z);if(n){a=.5*-n.x+this.roundToNearestMultiple(a,n.x);o=.5*-n.y+this.roundToNearestMultiple(o,n.y);s=.5*-n.z+this.roundToNearestMultiple(s,n.z)}e.typedArray.setVec3Components(t,a,o,s)},randomColor:function(e,t,r,i){"use strict";var n=r.r+Math.random()*i.x,a=r.g+Math.random()*i.y,o=r.b+Math.random()*i.z;n=this.clamp(n,0,1);a=this.clamp(a,0,1);o=this.clamp(o,0,1);e.typedArray.setVec3Components(t,n,a,o)},randomColorAsHex:function(){"use strict";var e=new THREE.Color;return function(t,r,i,n){var a=i.length,o=[];for(var s=0;s<a;++s){var u=n[s];e.copy(i[s]);e.r+=Math.random()*u.x-.5*u.x;e.g+=Math.random()*u.y-.5*u.y;e.b+=Math.random()*u.z-.5*u.z;e.r=this.clamp(e.r,0,1);e.g=this.clamp(e.g,0,1);e.b=this.clamp(e.b,0,1);o.push(e.getHex())}t.typedArray.setVec4Components(r,o[0],o[1],o[2],o[3])}}(),randomVector3OnSphere:function(e,t,r,i,n,a,o,s){"use strict";var u=2*Math.random()-1,c=6.2832*Math.random(),l=Math.sqrt(1-u*u),h=this.randomFloat(i,n),d=0,p=0,f=0;o&&(h=Math.round(h/o)*o);d=l*Math.cos(c)*h;p=l*Math.sin(c)*h;f=u*h;d*=a.x;p*=a.y;f*=a.z;d+=r.x;p+=r.y;f+=r.z;e.typedArray.setVec3Components(t,d,p,f)},seededRandom:function(e){var t=1e4*Math.sin(e);return t-(0|t)},randomVector3OnDisc:function(e,t,r,i,n,a,o){"use strict";var s=6.2832*Math.random(),u=Math.abs(this.randomFloat(i,n)),c=0,l=0,h=0;o&&(u=Math.round(u/o)*o);c=Math.cos(s)*u;l=Math.sin(s)*u;c*=a.x;l*=a.y;c+=r.x;l+=r.y;h+=r.z;e.typedArray.setVec3Components(t,c,l,h)},randomDirectionVector3OnSphere:function(){"use strict";var e=new THREE.Vector3;return function(t,r,i,n,a,o,s,u){e.copy(o);e.x-=i;e.y-=n;e.z-=a;e.normalize().multiplyScalar(-this.randomFloat(s,u));t.typedArray.setVec3Components(r,e.x,e.y,e.z)}}(),randomDirectionVector3OnDisc:function(){"use strict";var e=new THREE.Vector3;return function(t,r,i,n,a,o,s,u){e.copy(o);e.x-=i;e.y-=n;e.z-=a;e.normalize().multiplyScalar(-this.randomFloat(s,u));t.typedArray.setVec3Components(r,e.x,e.y,0)}}(),getPackedRotationAxis:function(){"use strict";var e=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Color,i=new THREE.Vector3(1,1,1);return function(n,a){e.copy(n).normalize();t.copy(a).normalize();e.x+=.5*-a.x+Math.random()*a.x;e.y+=.5*-a.y+Math.random()*a.y;e.z+=.5*-a.z+Math.random()*a.z;e.normalize().add(i).multiplyScalar(.5);r.setRGB(e.x,e.y,e.z);return r.getHex()}}()};a.Group=function(e){"use strict";var t=a.utils,r=t.types;e=t.ensureTypedArg(e,r.OBJECT,{});e.texture=t.ensureTypedArg(e.texture,r.OBJECT,{});this.uuid=THREE.Math.generateUUID();this.fixedTimeStep=t.ensureTypedArg(e.fixedTimeStep,r.NUMBER,.016);this.texture=t.ensureInstanceOf(e.texture.value,THREE.Texture,null);this.textureFrames=t.ensureInstanceOf(e.texture.frames,THREE.Vector2,new THREE.Vector2(1,1));this.textureFrameCount=t.ensureTypedArg(e.texture.frameCount,r.NUMBER,this.textureFrames.x*this.textureFrames.y);this.textureLoop=t.ensureTypedArg(e.texture.loop,r.NUMBER,1);this.textureFrames.max(new THREE.Vector2(1,1));this.hasPerspective=t.ensureTypedArg(e.hasPerspective,r.BOOLEAN,true);this.colorize=t.ensureTypedArg(e.colorize,r.BOOLEAN,true);this.maxParticleCount=t.ensureTypedArg(e.maxParticleCount,r.NUMBER,null);this.blending=t.ensureTypedArg(e.blending,r.NUMBER,THREE.AdditiveBlending);this.transparent=t.ensureTypedArg(e.transparent,r.BOOLEAN,true);this.alphaTest=parseFloat(t.ensureTypedArg(e.alphaTest,r.NUMBER,0));this.depthWrite=t.ensureTypedArg(e.depthWrite,r.BOOLEAN,false);this.depthTest=t.ensureTypedArg(e.depthTest,r.BOOLEAN,true);this.fog=t.ensureTypedArg(e.fog,r.BOOLEAN,true);this.scale=t.ensureTypedArg(e.scale,r.NUMBER,300);this.emitters=[];this.emitterIDs=[];this._pool=[];this._poolCreationSettings=null;this._createNewWhenPoolEmpty=0;this._attributesNeedRefresh=false;this._attributesNeedDynamicReset=false;this.particleCount=0;this.uniforms={texture:{type:"t",value:this.texture},textureAnimation:{type:"v4",value:new THREE.Vector4(this.textureFrames.x,this.textureFrames.y,this.textureFrameCount,Math.max(Math.abs(this.textureLoop),1))},fogColor:{type:"c",value:null},fogNear:{type:"f",value:10},fogFar:{type:"f",value:200},fogDensity:{type:"f",value:.5},deltaTime:{type:"f",value:0},runTime:{type:"f",value:0},scale:{type:"f",value:this.scale}};this.defines={HAS_PERSPECTIVE:this.hasPerspective,COLORIZE:this.colorize,VALUE_OVER_LIFETIME_LENGTH:a.valueOverLifetimeLength,SHOULD_ROTATE_TEXTURE:false,SHOULD_ROTATE_PARTICLES:false,SHOULD_WIGGLE_PARTICLES:false,SHOULD_CALCULATE_SPRITE:this.textureFrames.x>1||this.textureFrames.y>1};this.attributes={position:new a.ShaderAttribute("v3",true),acceleration:new a.ShaderAttribute("v4",true),velocity:new a.ShaderAttribute("v3",true),rotation:new a.ShaderAttribute("v4",true),rotationCenter:new a.ShaderAttribute("v3",true),params:new a.ShaderAttribute("v4",true),size:new a.ShaderAttribute("v4",true),angle:new a.ShaderAttribute("v4",true),color:new a.ShaderAttribute("v4",true),opacity:new a.ShaderAttribute("v4",true)};this.attributeKeys=Object.keys(this.attributes);this.attributeCount=this.attributeKeys.length;this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.shaders.vertex,fragmentShader:a.shaders.fragment,blending:this.blending,transparent:this.transparent,alphaTest:this.alphaTest,depthWrite:this.depthWrite,depthTest:this.depthTest,defines:this.defines,fog:this.fog});this.geometry=new THREE.BufferGeometry;this.mesh=new THREE.Points(this.geometry,this.material);null===this.maxParticleCount&&console.warn("SPE.Group: No maxParticleCount specified. Adding emitters after rendering will probably cause errors.")};a.Group.constructor=a.Group;a.Group.prototype._updateDefines=function(){"use strict";var e=this.emitters,t=e.length-1,r,i=this.defines;for(t;t>=0;--t){r=e[t];i.SHOULD_CALCULATE_SPRITE||(i.SHOULD_ROTATE_TEXTURE=i.SHOULD_ROTATE_TEXTURE||!!Math.max(Math.max.apply(null,r.angle.value),Math.max.apply(null,r.angle.spread)));i.SHOULD_ROTATE_PARTICLES=i.SHOULD_ROTATE_PARTICLES||!!Math.max(r.rotation.angle,r.rotation.angleSpread);i.SHOULD_WIGGLE_PARTICLES=i.SHOULD_WIGGLE_PARTICLES||!!Math.max(r.wiggle.value,r.wiggle.spread)}this.material.needsUpdate=true};a.Group.prototype._applyAttributesToGeometry=function(){"use strict";var e=this.attributes,t=this.geometry,r=t.attributes,i,n;for(var a in e)if(e.hasOwnProperty(a)){i=e[a];n=r[a];n?n.array=i.typedArray.array:t.addAttribute(a,i.bufferAttribute);i.bufferAttribute.needsUpdate=true}this.geometry.setDrawRange(0,this.particleCount)};a.Group.prototype.addEmitter=function(e){"use strict";if(e instanceof a.Emitter===false){console.error("`emitter` argument must be instance of SPE.Emitter. Was provided with:",e);return}if(this.emitterIDs.indexOf(e.uuid)>-1){console.error("Emitter already exists in this group. Will not add again.");return}if(null!==e.group){console.error("Emitter already belongs to another group. Will not add to requested group.");return}var t=this.attributes,r=this.particleCount,i=r+e.particleCount;this.particleCount=i;null!==this.maxParticleCount&&this.particleCount>this.maxParticleCount&&console.warn("SPE.Group: maxParticleCount exceeded. Requesting",this.particleCount,"particles, can support only",this.maxParticleCount);e._calculatePPSValue(e.maxAge._value+e.maxAge._spread);e._setBufferUpdateRanges(this.attributeKeys);e._setAttributeOffset(r);e.group=this;e.attributes=this.attributes;for(var n in t)t.hasOwnProperty(n)&&t[n]._createBufferAttribute(null!==this.maxParticleCount?this.maxParticleCount:this.particleCount);for(var o=r;o<i;++o){e._assignPositionValue(o);e._assignForceValue(o,"velocity");e._assignForceValue(o,"acceleration");e._assignAbsLifetimeValue(o,"opacity");e._assignAbsLifetimeValue(o,"size");e._assignAngleValue(o);e._assignRotationValue(o);e._assignParamsValue(o);e._assignColorValue(o)}this._applyAttributesToGeometry();this.emitters.push(e);this.emitterIDs.push(e.uuid);this._updateDefines(e);this.material.needsUpdate=true;this.geometry.needsUpdate=true;this._attributesNeedRefresh=true;return this};a.Group.prototype.removeEmitter=function(e){"use strict";var t=this.emitterIDs.indexOf(e.uuid);if(e instanceof a.Emitter===false){console.error("`emitter` argument must be instance of SPE.Emitter. Was provided with:",e);return}if(-1===t){console.error("Emitter does not exist in this group. Will not remove.");return}var r=e.attributeOffset,i=r+e.particleCount,n=this.attributes.params.typedArray;for(var o=r;o<i;++o){n.array[4*o]=0;n.array[4*o+1]=0}this.emitters.splice(t,1);this.emitterIDs.splice(t,1);for(var s in this.attributes)this.attributes.hasOwnProperty(s)&&this.attributes[s].splice(r,i);this.particleCount-=e.particleCount;e._onRemove();this._attributesNeedRefresh=true};a.Group.prototype.getFromPool=function(){"use strict";var e=this._pool,t=this._createNewWhenPoolEmpty;if(e.length)return e.pop();if(t)return new a.Emitter(this._poolCreationSettings);return null};a.Group.prototype.releaseIntoPool=function(e){"use strict";if(e instanceof a.Emitter===false){console.error("Argument is not instanceof SPE.Emitter:",e);return}e.reset();this._pool.unshift(e);return this};a.Group.prototype.getPool=function(){"use strict";return this._pool};a.Group.prototype.addPool=function(e,t,r){"use strict";var i;this._poolCreationSettings=t;this._createNewWhenPoolEmpty=!!r;for(var n=0;n<e;++n){i=Array.isArray(t)?new a.Emitter(t[n]):new a.Emitter(t);this.addEmitter(i);this.releaseIntoPool(i)}return this};a.Group.prototype._triggerSingleEmitter=function(e){"use strict";var t=this.getFromPool(),r=this;if(null===t){console.log("SPE.Group pool ran out.");return}if(e instanceof THREE.Vector3){t.position.value.copy(e);t.position.value=t.position.value}t.enable();setTimeout(function(){t.disable();r.releaseIntoPool(t)},1e3*Math.max(t.duration,t.maxAge.value+t.maxAge.spread));return this};a.Group.prototype.triggerPoolEmitter=function(e,t){"use strict";if("number"===typeof e&&e>1)for(var r=0;r<e;++r)this._triggerSingleEmitter(t);else this._triggerSingleEmitter(t);return this};a.Group.prototype._updateUniforms=function(e){"use strict";this.uniforms.runTime.value+=e;this.uniforms.deltaTime.value=e};a.Group.prototype._resetBufferRanges=function(){"use strict";var e=this.attributeKeys,t=this.attributeCount-1,r=this.attributes;for(t;t>=0;--t)r[e[t]].resetUpdateRange()};a.Group.prototype._updateBuffers=function(e){"use strict";var t=this.attributeKeys,r=this.attributeCount-1,i=this.attributes,n=e.bufferUpdateRanges,a,o,s;for(r;r>=0;--r){a=t[r];o=n[a];s=i[a];s.setUpdateRange(o.min,o.max);s.flagUpdate()}};a.Group.prototype.tick=function(e){"use strict";var t=this.emitters,r=t.length,i=e||this.fixedTimeStep,n=this.attributeKeys,a,o=this.attributes;this._updateUniforms(i);this._resetBufferRanges();if(0===r&&false===this._attributesNeedRefresh&&false===this._attributesNeedDynamicReset)return;for(var a=0,s;a<r;++a){s=t[a];s.tick(i);this._updateBuffers(s)}if(true===this._attributesNeedDynamicReset){a=this.attributeCount-1;for(a;a>=0;--a)o[n[a]].resetDynamic();this._attributesNeedDynamicReset=false}if(true===this._attributesNeedRefresh){a=this.attributeCount-1;for(a;a>=0;--a)o[n[a]].forceUpdateAll();this._attributesNeedRefresh=false;this._attributesNeedDynamicReset=true}};a.Group.prototype.dispose=function(){"use strict";this.geometry.dispose();this.material.dispose();return this};a.Emitter=function(e){"use strict";var t=a.utils,r=t.types,i=a.valueOverLifetimeLength;e=t.ensureTypedArg(e,r.OBJECT,{});e.position=t.ensureTypedArg(e.position,r.OBJECT,{});e.velocity=t.ensureTypedArg(e.velocity,r.OBJECT,{});e.acceleration=t.ensureTypedArg(e.acceleration,r.OBJECT,{});e.radius=t.ensureTypedArg(e.radius,r.OBJECT,{});e.drag=t.ensureTypedArg(e.drag,r.OBJECT,{});e.rotation=t.ensureTypedArg(e.rotation,r.OBJECT,{});e.color=t.ensureTypedArg(e.color,r.OBJECT,{});e.opacity=t.ensureTypedArg(e.opacity,r.OBJECT,{});e.size=t.ensureTypedArg(e.size,r.OBJECT,{});e.angle=t.ensureTypedArg(e.angle,r.OBJECT,{});e.wiggle=t.ensureTypedArg(e.wiggle,r.OBJECT,{});e.maxAge=t.ensureTypedArg(e.maxAge,r.OBJECT,{});e.onParticleSpawn&&console.warn("onParticleSpawn has been removed. Please set properties directly to alter values at runtime.");this.uuid=THREE.Math.generateUUID();this.type=t.ensureTypedArg(e.type,r.NUMBER,a.distributions.BOX);this.position={_value:t.ensureInstanceOf(e.position.value,THREE.Vector3,new THREE.Vector3),_spread:t.ensureInstanceOf(e.position.spread,THREE.Vector3,new THREE.Vector3),_spreadClamp:t.ensureInstanceOf(e.position.spreadClamp,THREE.Vector3,new THREE.Vector3),_distribution:t.ensureTypedArg(e.position.distribution,r.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false),_radius:t.ensureTypedArg(e.position.radius,r.NUMBER,10),_radiusScale:t.ensureInstanceOf(e.position.radiusScale,THREE.Vector3,new THREE.Vector3(1,1,1)),_distributionClamp:t.ensureTypedArg(e.position.distributionClamp,r.NUMBER,0)};this.velocity={_value:t.ensureInstanceOf(e.velocity.value,THREE.Vector3,new THREE.Vector3),_spread:t.ensureInstanceOf(e.velocity.spread,THREE.Vector3,new THREE.Vector3),_distribution:t.ensureTypedArg(e.velocity.distribution,r.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)};this.acceleration={_value:t.ensureInstanceOf(e.acceleration.value,THREE.Vector3,new THREE.Vector3),_spread:t.ensureInstanceOf(e.acceleration.spread,THREE.Vector3,new THREE.Vector3),_distribution:t.ensureTypedArg(e.acceleration.distribution,r.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)};this.drag={_value:t.ensureTypedArg(e.drag.value,r.NUMBER,0),_spread:t.ensureTypedArg(e.drag.spread,r.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)};this.wiggle={_value:t.ensureTypedArg(e.wiggle.value,r.NUMBER,0),_spread:t.ensureTypedArg(e.wiggle.spread,r.NUMBER,0)};this.rotation={_axis:t.ensureInstanceOf(e.rotation.axis,THREE.Vector3,new THREE.Vector3(0,1,0)),_axisSpread:t.ensureInstanceOf(e.rotation.axisSpread,THREE.Vector3,new THREE.Vector3),_angle:t.ensureTypedArg(e.rotation.angle,r.NUMBER,0),_angleSpread:t.ensureTypedArg(e.rotation.angleSpread,r.NUMBER,0),_static:t.ensureTypedArg(e.rotation.static,r.BOOLEAN,false),_center:t.ensureInstanceOf(e.rotation.center,THREE.Vector3,this.position._value.clone()),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)};this.maxAge={_value:t.ensureTypedArg(e.maxAge.value,r.NUMBER,2),_spread:t.ensureTypedArg(e.maxAge.spread,r.NUMBER,0)};this.color={_value:t.ensureArrayInstanceOf(e.color.value,THREE.Color,new THREE.Color),_spread:t.ensureArrayInstanceOf(e.color.spread,THREE.Vector3,new THREE.Vector3),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)};this.opacity={_value:t.ensureArrayTypedArg(e.opacity.value,r.NUMBER,1),_spread:t.ensureArrayTypedArg(e.opacity.spread,r.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)};this.size={_value:t.ensureArrayTypedArg(e.size.value,r.NUMBER,1),_spread:t.ensureArrayTypedArg(e.size.spread,r.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)};this.angle={_value:t.ensureArrayTypedArg(e.angle.value,r.NUMBER,0),_spread:t.ensureArrayTypedArg(e.angle.spread,r.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)};this.particleCount=t.ensureTypedArg(e.particleCount,r.NUMBER,100);this.duration=t.ensureTypedArg(e.duration,r.NUMBER,null);this.isStatic=t.ensureTypedArg(e.isStatic,r.BOOLEAN,false);this.activeMultiplier=t.ensureTypedArg(e.activeMultiplier,r.NUMBER,1);this.direction=t.ensureTypedArg(e.direction,r.NUMBER,1);this.alive=t.ensureTypedArg(e.alive,r.BOOLEAN,true);this.particlesPerSecond=0;this.activationIndex=0;this.attributeOffset=0;this.attributeEnd=0;this.age=0;this.activeParticleCount=0;this.group=null;this.attributes=null;this.paramsArray=null;this.resetFlags={position:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,false)||t.ensureTypedArg(e.radius.randomise,r.BOOLEAN,false),velocity:t.ensureTypedArg(e.velocity.randomise,r.BOOLEAN,false),acceleration:t.ensureTypedArg(e.acceleration.randomise,r.BOOLEAN,false)||t.ensureTypedArg(e.drag.randomise,r.BOOLEAN,false),rotation:t.ensureTypedArg(e.rotation.randomise,r.BOOLEAN,false),rotationCenter:t.ensureTypedArg(e.rotation.randomise,r.BOOLEAN,false),size:t.ensureTypedArg(e.size.randomise,r.BOOLEAN,false),color:t.ensureTypedArg(e.color.randomise,r.BOOLEAN,false),opacity:t.ensureTypedArg(e.opacity.randomise,r.BOOLEAN,false),angle:t.ensureTypedArg(e.angle.randomise,r.BOOLEAN,false)};this.updateFlags={};this.updateCounts={};this.updateMap={maxAge:"params",position:"position",velocity:"velocity",acceleration:"acceleration",drag:"acceleration",wiggle:"params",rotation:"rotation",size:"size",color:"color",opacity:"opacity",angle:"angle"};for(var n in this.updateMap)if(this.updateMap.hasOwnProperty(n)){this.updateCounts[this.updateMap[n]]=0;this.updateFlags[this.updateMap[n]]=false;this._createGetterSetters(this[n],n)}this.bufferUpdateRanges={};this.attributeKeys=null;this.attributeCount=0;t.ensureValueOverLifetimeCompliance(this.color,i,i);t.ensureValueOverLifetimeCompliance(this.opacity,i,i);t.ensureValueOverLifetimeCompliance(this.size,i,i);t.ensureValueOverLifetimeCompliance(this.angle,i,i)};a.Emitter.constructor=a.Emitter;a.Emitter.prototype._createGetterSetters=function(e,t){"use strict";var r=this;for(var i in e)if(e.hasOwnProperty(i)){var n=i.replace("_","");Object.defineProperty(e,n,{get:function(e){return function(){return this[e]}}(i),set:function(e){return function(i){var n=r.updateMap[t],o=this[e],s=a.valueOverLifetimeLength;if("_rotationCenter"===e){r.updateFlags.rotationCenter=true;r.updateCounts.rotationCenter=0}else if("_randomise"===e)r.resetFlags[n]=i;else{r.updateFlags[n]=true;r.updateCounts[n]=0}r.group._updateDefines();this[e]=i;Array.isArray(o)&&a.utils.ensureValueOverLifetimeCompliance(r[t],s,s)}}(i)})}};a.Emitter.prototype._setBufferUpdateRanges=function(e){"use strict";this.attributeKeys=e;this.attributeCount=e.length;for(var t=this.attributeCount-1;t>=0;--t)this.bufferUpdateRanges[e[t]]={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY}};a.Emitter.prototype._calculatePPSValue=function(e){"use strict";var t=this.particleCount;this.duration?this.particlesPerSecond=t/(e<this.duration?e:this.duration):this.particlesPerSecond=t/e};a.Emitter.prototype._setAttributeOffset=function(e){this.attributeOffset=e;this.activationIndex=e;this.activationEnd=e+this.particleCount};a.Emitter.prototype._assignValue=function(e,t){"use strict";switch(e){case"position":this._assignPositionValue(t);break;case"velocity":case"acceleration":this._assignForceValue(t,e);break;case"size":case"opacity":this._assignAbsLifetimeValue(t,e);break;case"angle":this._assignAngleValue(t);break;case"params":this._assignParamsValue(t);break;case"rotation":this._assignRotationValue(t);break;case"color":this._assignColorValue(t);break}};a.Emitter.prototype._assignPositionValue=function(e){"use strict";var t=a.distributions,r=a.utils,i=this.position,n=this.attributes.position,o=i._value,s=i._spread,u=i._distribution;switch(u){case t.BOX:r.randomVector3(n,e,o,s,i._spreadClamp);break;case t.SPHERE:r.randomVector3OnSphere(n,e,o,i._radius,i._spread.x,i._radiusScale,i._spreadClamp.x,i._distributionClamp||this.particleCount);break;case t.DISC:r.randomVector3OnDisc(n,e,o,i._radius,i._spread.x,i._radiusScale,i._spreadClamp.x);break}};a.Emitter.prototype._assignForceValue=function(e,t){"use strict";var r=a.distributions,i=a.utils,n=this[t],o=n._value,s=n._spread,u=n._distribution,c,l,h,d,p;switch(u){case r.BOX:i.randomVector3(this.attributes[t],e,o,s);break;case r.SPHERE:c=this.attributes.position.typedArray.array;p=3*e;l=c[p];h=c[p+1];d=c[p+2];i.randomDirectionVector3OnSphere(this.attributes[t],e,l,h,d,this.position._value,n._value.x,n._spread.x);break;case r.DISC:c=this.attributes.position.typedArray.array;p=3*e;l=c[p];h=c[p+1];d=c[p+2];i.randomDirectionVector3OnDisc(this.attributes[t],e,l,h,d,this.position._value,n._value.x,n._spread.x);break}if("acceleration"===t){var f=i.clamp(i.randomFloat(this.drag._value,this.drag._spread),0,1);this.attributes.acceleration.typedArray.array[4*e+3]=f}};a.Emitter.prototype._assignAbsLifetimeValue=function(e,t){"use strict";var r=this.attributes[t].typedArray,i=this[t],n=a.utils,o;if(n.arrayValuesAreEqual(i._value)&&n.arrayValuesAreEqual(i._spread)){o=Math.abs(n.randomFloat(i._value[0],i._spread[0]));r.setVec4Components(e,o,o,o,o)}else r.setVec4Components(e,Math.abs(n.randomFloat(i._value[0],i._spread[0])),Math.abs(n.randomFloat(i._value[1],i._spread[1])),Math.abs(n.randomFloat(i._value[2],i._spread[2])),Math.abs(n.randomFloat(i._value[3],i._spread[3])))};a.Emitter.prototype._assignAngleValue=function(e){"use strict";var t=this.attributes.angle.typedArray,r=this.angle,i=a.utils,n;if(i.arrayValuesAreEqual(r._value)&&i.arrayValuesAreEqual(r._spread)){n=i.randomFloat(r._value[0],r._spread[0]);t.setVec4Components(e,n,n,n,n)}else t.setVec4Components(e,i.randomFloat(r._value[0],r._spread[0]),i.randomFloat(r._value[1],r._spread[1]),i.randomFloat(r._value[2],r._spread[2]),i.randomFloat(r._value[3],r._spread[3]))};a.Emitter.prototype._assignParamsValue=function(e){"use strict";this.attributes.params.typedArray.setVec4Components(e,this.isStatic?1:0,0,Math.abs(a.utils.randomFloat(this.maxAge._value,this.maxAge._spread)),a.utils.randomFloat(this.wiggle._value,this.wiggle._spread))};a.Emitter.prototype._assignRotationValue=function(e){"use strict";this.attributes.rotation.typedArray.setVec3Components(e,a.utils.getPackedRotationAxis(this.rotation._axis,this.rotation._axisSpread),a.utils.randomFloat(this.rotation._angle,this.rotation._angleSpread),this.rotation._static?0:1);this.attributes.rotationCenter.typedArray.setVec3(e,this.rotation._center)};a.Emitter.prototype._assignColorValue=function(e){"use strict";a.utils.randomColorAsHex(this.attributes.color,e,this.color._value,this.color._spread)};a.Emitter.prototype._resetParticle=function(e){"use strict";var t=this.resetFlags,r=this.updateFlags,i=this.updateCounts,n=this.attributeKeys,a,o;for(var s=this.attributeCount-1;s>=0;--s){a=n[s];o=r[a];if(true===t[a]||true===o){this._assignValue(a,e);this._updateAttributeUpdateRange(a,e);if(true===o&&i[a]===this.particleCount){r[a]=false;i[a]=0}else true==o&&++i[a]}}};a.Emitter.prototype._updateAttributeUpdateRange=function(e,t){"use strict";var r=this.bufferUpdateRanges[e];r.min=Math.min(t,r.min);r.max=Math.max(t,r.max)};a.Emitter.prototype._resetBufferRanges=function(){"use strict";var e=this.bufferUpdateRanges,t=this.bufferUpdateKeys,r=this.bufferUpdateCount-1,i;for(r;r>=0;--r){i=t[r];e[i].min=Number.POSITIVE_INFINITY;e[i].max=Number.NEGATIVE_INFINITY}};a.Emitter.prototype._onRemove=function(){"use strict";this.particlesPerSecond=0;this.attributeOffset=0;this.activationIndex=0;this.activeParticleCount=0;this.group=null;this.attributes=null;this.paramsArray=null;this.age=0};a.Emitter.prototype._decrementParticleCount=function(){"use strict";--this.activeParticleCount};a.Emitter.prototype._incrementParticleCount=function(){"use strict";++this.activeParticleCount};a.Emitter.prototype._checkParticleAges=function(e,t,r,i){"use strict";for(var n=t-1,a,o,s,u;n>=e;--n){a=4*n;u=r[a];if(0===u)continue;s=r[a+1];o=r[a+2];if(1===this.direction){s+=i;if(s>=o){s=0;u=0;this._decrementParticleCount()}}else{s-=i;if(s<=0){s=o;u=0;this._decrementParticleCount()}}r[a]=u;r[a+1]=s;this._updateAttributeUpdateRange("params",n)}};a.Emitter.prototype._activateParticles=function(e,t,r,i){"use strict";var n=this.direction;for(var a=e,o,s;a<t;++a){o=4*a;if(0!=r[o]&&1!==this.particleCount)continue;this._incrementParticleCount();r[o]=1;this._resetParticle(a);s=i*(a-e);r[o+1]=-1===n?r[o+2]-s:s;this._updateAttributeUpdateRange("params",a)}};a.Emitter.prototype.tick=function(e){"use strict";if(this.isStatic)return;null===this.paramsArray&&(this.paramsArray=this.attributes.params.typedArray.array);var t=this.attributeOffset,r=t+this.particleCount,i=this.paramsArray,n=this.particlesPerSecond*this.activeMultiplier*e,a=this.activationIndex;this._resetBufferRanges();this._checkParticleAges(t,r,i,e);if(false===this.alive){this.age=0;return}if(null!==this.duration&&this.age>this.duration){this.alive=false;this.age=0;return}var o=1===this.particleCount?a:0|a,s=Math.min(o+n,this.activationEnd),u=s-this.activationIndex|0,c=u>0?e/u:0;this._activateParticles(o,s,i,c);this.activationIndex+=n;this.activationIndex>r&&(this.activationIndex=t);this.age+=e};a.Emitter.prototype.reset=function(e){"use strict";this.age=0;this.alive=false;if(true===e){var t=this.attributeOffset,r=t+this.particleCount,i=this.paramsArray,n=this.attributes.params.bufferAttribute;for(var a=r-1,o;a>=t;--a){o=4*a;i[o]=0;i[o+1]=0}n.updateRange.offset=0;n.updateRange.count=-1;n.needsUpdate=true}return this};a.Emitter.prototype.enable=function(){"use strict";this.alive=true;return this};a.Emitter.prototype.disable=function(){"use strict";this.alive=false;return this};a.Emitter.prototype.remove=function(){"use strict";null!==this.group?this.group.removeEmitter(this):console.error("Emitter does not belong to a group, cannot remove.");return this}},304:function(e,t,r){var i=r(305);AFRAME.anime=i;if("undefined"===typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var n=new THREE.Color;var a=new THREE.Color;var o=AFRAME.utils;var s=o.entity.getComponentProperty;var u=o.entity.setComponentProperty;var c={};var l="color";var h="position";var d="rotation";var p="scale";var f="components";var v="object3D";AFRAME.registerComponent("animation",{schema:{autoplay:{default:true},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},from:{default:""},loop:{default:0,parse:function(e){if(true===e||"true"===e)return true;if(false===e||"false"===e)return false;return parseInt(e,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},to:{default:""},type:{default:""},isRawProperty:{default:false}},multiple:true,init:function(){var e=this;this.eventDetail={name:this.attrName};this.time=0;this.animation=null;this.animationIsPlaying=false;this.onStartEvent=this.onStartEvent.bind(this);this.beginAnimation=this.beginAnimation.bind(this);this.pauseAnimation=this.pauseAnimation.bind(this);this.resumeAnimation=this.resumeAnimation.bind(this);this.fromColor={};this.toColor={};this.targets={};this.targetsArray=[];this.config={complete:function(){e.animationIsPlaying=false;e.el.emit("animationcomplete",e.eventDetail)}}},update:function(){var e=this.config;var t=this.data;this.animationIsPlaying=false;if(!t.property)return;e.autoplay=false;e.direction=t.dir;e.duration=t.dur;e.easing=t.easing;e.elasticity=t.elasticity;e.loop=t.loop;this.createAndStartAnimation()},tick:function(e,t){if(!this.animationIsPlaying)return;this.time+=t;this.animation.tick(this.time)},remove:function(){this.pauseAnimation();this.removeEventListeners()},pause:function(){this.paused=true;this.pausedWasPlaying=true;this.pauseAnimation();this.removeEventListeners()},play:function(){if(!this.paused)return;this.paused=false;this.addEventListeners();if(this.pausedWasPlaying){this.resumeAnimation();this.pausedWasPlaying=false}},createAndStartAnimation:function(){var e=this.data;this.updateConfig();this.animationIsPlaying=false;this.animation=i(this.config);this.removeEventListeners();this.addEventListeners();if(!e.autoplay||e.startEvents&&e.startEvents.length)return;if(e.delay){setTimeout(this.beginAnimation,e.delay);return}this.beginAnimation()},beginAnimation:function(){this.updateConfig();this.time=0;this.animation.seek(0);this.animationIsPlaying=true;this.stopRelatedAnimations();this.el.emit("animationbegin",this.eventDetail)},pauseAnimation:function(){this.animationIsPlaying=false},resumeAnimation:function(){this.animationIsPlaying=true},onStartEvent:function(){if(this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()},updateConfigForRawColor:function(){var e=this.config;var t=this.data;var r=this.el;var i;var n;var a;i=t.from||M(r,t.property);a=t.to;this.setColorConfig(i,a);i=this.fromColor;a=this.toColor;this.targetsArray.length=0;this.targetsArray.push(i);e.targets=this.targetsArray;for(n in a)e[n]=a[n];e.update=function(){var e={};e.r=i.r;e.g=i.g;e.b=i.b;return function(i){var n;n=i.animatables[0].target;if(n.r===e.r&&n.g===e.g&&n.b===e.b)return;w(r,t.property,n,t.type)}}()},updateConfigForDefault:function(){var e=this.config;var t=this.data;var r=this.el;var i;var n;var a;var o;var c;i=t.from||(x(t)?M(r,t.property):s(r,t.property));c=t.to;o=!isNaN(i||c);if(o){i=parseFloat(i);c=parseFloat(c)}else{i=i?i.toString():i;c=c?c.toString():c}a="true"===c||"false"===c;if(a){i="true"===t.from?1:0;c="true"===t.to?1:0}this.targets.aframeProperty=i;e.targets=this.targets;e.aframeProperty=c;e.update=function(){var e=i;return function(i){var n;n=i.animatables[0].target.aframeProperty;if(n===e)return;e=n;a&&(n=n>=1);x(t)?w(r,t.property,n,t.type):u(r,t.property,n)}}()},updateConfigForVector:function(){var e=this.config;var t=this.data;var r=this.el;var i;var n;var a;n=t.from?AFRAME.utils.coordinates.parse(t.from):s(r,t.property);a=AFRAME.utils.coordinates.parse(t.to);if(t.property===d){g(n);g(a)}this.targetsArray.length=0;this.targetsArray.push(n);e.targets=this.targetsArray;for(i in a)e[i]=a[i];if(t.property===h||t.property===d||t.property===p){e.update=function(){var e={};e.x=n.x;e.y=n.y;e.z=n.z;return function(i){var n=i.animatables[0].target;if(n.x===e.x&&n.y===e.y&&n.z===e.z)return;e.x=n.x;e.y=n.y;e.z=n.z;r.object3D[t.property].set(n.x,n.y,n.z)}}();return}e.update=function(){var e={};e.x=n.x;e.y=n.y;e.z=n.z;return function(i){var n=i.animations[0].target;if(n.x===e.x&&n.y===e.y&&n.z===e.z)return;e.x=n.x;e.y=n.y;e.z=n.z;u(r,t.property,n)}}()},updateConfig:function(){var e;e=m(this.el,this.data.property);x(this.data)&&this.data.type===l?this.updateConfigForRawColor():"vec2"===e||"vec3"===e||"vec4"===e?this.updateConfigForVector():this.updateConfigForDefault()},stopRelatedAnimations:function(){var e;var t;for(t in this.el.components){e=this.el.components[t];if(t===this.attrName)continue;if("animation"!==e.name)continue;if(e.data.property!==this.data.property)continue;e.animationIsPlaying=false}},addEventListeners:function(){var e=this.data;var t=this.el;y(t,e.startEvents,this.onStartEvent);y(t,e.pauseEvents,this.pauseAnimation);y(t,e.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var e=this.data;var t=this.el;A(t,e.startEvents,this.onStartEvent);A(t,e.pauseEvents,this.pauseAnimation);A(t,e.resumeEvents,this.resumeAnimation)},setColorConfig:function(e,t){n.set(e);a.set(t);e=this.fromColor;t=this.toColor;e.r=n.r;e.g=n.g;e.b=n.b;t.r=a.r;t.g=a.g;t.b=a.b}});function m(e,t){var r;var i;var n;var a;n=t.split(".");i=n[0];a=n[1];r=e.components[i]||AFRAME.components[i];if(!r)return null;if(a&&!r.schema[a])return null;if(a)return r.schema[a].type;return r.schema.type}function g(e){e.x=THREE.Math.degToRad(e.x);e.y=THREE.Math.degToRad(e.y);e.z=THREE.Math.degToRad(e.z)}function y(e,t,r){var i;for(i=0;i<t.length;i++)e.addEventListener(t[i],r)}function A(e,t,r){var i;for(i=0;i<t.length;i++)e.removeEventListener(t[i],r)}function M(e,t){var r;var i;var n;i=E(t);n=e;for(r=0;r<i.length;r++)n=n[i[r]];return n}function w(e,t,r,i){var n;var a;var o;var s;a=E(t);s=e;for(n=0;n<a.length-1;n++)s=s[a[n]];o=a[a.length-1];if(i===l){if("r"in s[o]){s[o].r=r.r;s[o].g=r.g;s[o].b=r.b}else{s[o].x=r.r;s[o].y=r.g;s[o].z=r.b}return}s[o]=r}function E(e){if(e in c)return c[e];c[e]=e.split(".");return c[e]}function x(e){return e.isRawProperty||e.property.startsWith(f)||e.property.startsWith(v)}},305:function(e,t,r){(function(r){var i,n,a;var o={scope:{}};o.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){if(r.get||r.set)throw new TypeError("ES3 does not support getters and setters.");e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value)};o.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof r&&null!=r?r:e};o.global=o.getGlobal(this);o.SYMBOL_PREFIX="jscomp_symbol_";o.initSymbol=function(){o.initSymbol=function(){};o.global.Symbol||(o.global.Symbol=o.Symbol)};o.symbolCounter_=0;o.Symbol=function(e){return o.SYMBOL_PREFIX+(e||"")+o.symbolCounter_++};o.initSymbolIterator=function(){o.initSymbol();var e=o.global.Symbol.iterator;e||(e=o.global.Symbol.iterator=o.global.Symbol("iterator"));"function"!=typeof Array.prototype[e]&&o.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return o.arrayIterator(this)}});o.initSymbolIterator=function(){}};o.arrayIterator=function(e){var t=0;return o.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})};o.iteratorPrototype=function(e){o.initSymbolIterator();e={next:e};e[o.global.Symbol.iterator]=function(){return this};return e};o.array=o.array||{};o.iteratorFromArray=function(e,t){o.initSymbolIterator();e instanceof String&&(e+="");var r=0,i={next:function(){if(r<e.length){var n=r++;return{value:t(n,e[n]),done:!1}}i.next=function(){return{done:!0,value:void 0}};return i.next()}};i[Symbol.iterator]=function(){return i};return i};o.polyfill=function(e,t,r,i){if(t){r=o.global;e=e.split(".");for(i=0;i<e.length-1;i++){var n=e[i];n in r||(r[n]={});r=r[n]}e=e[e.length-1];i=r[e];t=t(i);t!=i&&null!=t&&o.defineProperty(r,e,{configurable:!0,writable:!0,value:t})}};o.polyfill("Array.prototype.keys",function(e){return e||function(){return o.iteratorFromArray(this,function(e){return e})}},"es6-impl","es3");var s=this;(function(r,o){!(n=[],i=o,a="function"===typeof i?i.apply(t,n):i,void 0!==a&&(e.exports=a))})(this,function(){function e(e){if(!P.col(e))try{return document.querySelectorAll(e)}catch(e){}}function t(e,t){for(var r=e.length,i=2<=arguments.length?arguments[1]:void 0,n=[],a=0;a<r;a++)if(a in e){var o=e[a];t.call(i,o,a,e)&&n.push(o)}return n}function r(e){return e.reduce(function(e,t){return e.concat(P.arr(t)?r(t):t)},[])}function i(t){if(P.arr(t))return t;P.str(t)&&(t=e(t)||t);return t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t]}function n(e,t){return e.some(function(e){return e===t})}function a(e){var t={},r;for(r in e)t[r]=e[r];return t}function o(e,t){var r=a(e),i;for(i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function u(e,t){var r=a(e),i;for(i in t)r[i]=P.und(e[i])?t[i]:e[i];return r}function c(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,r,i){return t+t+r+r+i+i});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);e=parseInt(t[1],16);var r=parseInt(t[2],16),t=parseInt(t[3],16);return"rgba("+e+","+r+","+t+",1)"}function l(e){function t(e,t,r){0>r&&(r+=1);1<r&&--r;return r<1/6?e+6*(t-e)*r:.5>r?t:r<2/3?e+(t-e)*(2/3-r)*6:e}var r=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e);e=parseInt(r[1])/360;var i=parseInt(r[2])/100,n=parseInt(r[3])/100,r=r[4]||1;if(0==i)n=i=e=n;else{var a=.5>n?n*(1+i):n+i-n*i,o=2*n-a,n=t(o,a,e+1/3),i=t(o,a,e);e=t(o,a,e-1/3)}return"rgba("+255*n+","+255*i+","+255*e+","+r+")"}function h(e){if(e=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e))return e[2]}function d(e){if(-1<e.indexOf("translate")||"perspective"===e)return"px";if(-1<e.indexOf("rotate")||-1<e.indexOf("skew"))return"deg"}function p(e,t){return P.fnc(e)?e(t.target,t.id,t.total):e}function f(e,t){if(t in e.style)return getComputedStyle(e).getPropertyValue(t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())||"0"}function v(e,t){if(P.dom(e)&&n(z,t))return"transform";if(P.dom(e)&&(e.getAttribute(t)||P.svg(e)&&e[t]))return"attribute";if(P.dom(e)&&"transform"!==t&&f(e,t))return"css";if(null!=e[t])return"object"}function m(e,r){var i=d(r),i=-1<r.indexOf("scale")?1:0+i;e=e.style.transform;if(!e)return i;for(var n=[],a=[],o=[],s=/(\w+)\((.+?)\)/g;n=s.exec(e);)a.push(n[1]),o.push(n[2]);e=t(o,function(e,t){return a[t]===r});return e.length?e[0]:i}function g(e,t){switch(v(e,t)){case"transform":return m(e,t);case"css":return f(e,t);case"attribute":return e.getAttribute(t)}return e[t]||0}function y(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=h(e)||0;t=parseFloat(t);e=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return t+e+i;case"-":return t-e+i;case"*":return t*e+i}}function A(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function M(e){e=e.points;for(var t=0,r,i=0;i<e.numberOfItems;i++){var n=e.getItem(i);0<i&&(t+=A(r,n));r=n}return t}function w(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return 2*Math.PI*e.getAttribute("r");case"rect":return 2*e.getAttribute("width")+2*e.getAttribute("height");case"line":return A({x:e.getAttribute("x1"),y:e.getAttribute("y1")},{x:e.getAttribute("x2"),y:e.getAttribute("y2")});case"polyline":return M(e);case"polygon":var t=e.points;return M(e)+A(t.getItem(t.numberOfItems-1),t.getItem(0))}}function E(e,t){function r(r){r=void 0===r?0:r;return e.el.getPointAtLength(1<=t+r?t+r:0)}var i=r(),n=r(-1),a=r(1);switch(e.property){case"x":return i.x;case"y":return i.y;case"angle":return 180*Math.atan2(a.y-n.y,a.x-n.x)/Math.PI}}function x(e,t){var r=/-?\d*\.?\d+/g,i;i=P.pth(e)?e.totalLength:e;if(P.col(i))if(P.rgb(i)){var n=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(i);i=n?"rgba("+n[1]+",1)":i}else i=P.hex(i)?c(i):P.hsl(i)?l(i):void 0;else n=(n=h(i))?i.substr(0,i.length-n.length):i,i=t&&!/\s/g.test(i)?n+t:n;i+="";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:P.str(e)||t?i.split(r):[]}}function b(e){e=e?r(P.arr(e)?e.map(i):i(e)):[];return t(e,function(e,t,r){return r.indexOf(e)===t})}function T(e){var t=b(e);return t.map(function(e,r){return{target:e,id:r,total:t.length}})}function L(e,t){var r=a(t);if(P.arr(e)){var n=e.length;2!==n||P.obj(e[0])?P.fnc(t.duration)||(r.duration=t.duration/n):e={value:e}}return i(e).map(function(e,r){r=r?0:t.delay;e=P.obj(e)&&!P.pth(e)?e:{value:e};P.und(e.delay)&&(e.delay=r);return e}).map(function(e){return u(e,r)})}function N(e,t){var r={},i;for(i in e){var n=p(e[i],t);P.arr(n)&&(n=n.map(function(e){return p(e,t)}),1===n.length&&(n=n[0]));r[i]=n}r.duration=parseFloat(r.duration);r.delay=parseFloat(r.delay);return r}function D(e){return P.arr(e)?U.apply(this,e):B[e]}function C(e,t){var r;return e.tweens.map(function(i){i=N(i,t);var n=i.value,a=g(t.target,e.name),o=r?r.to.original:a,o=P.arr(n)?n[0]:o,s=y(P.arr(n)?n[1]:n,o),a=h(s)||h(o)||h(a);i.from=x(o,a);i.to=x(s,a);i.start=r?r.end:e.offset;i.end=i.start+i.delay+i.duration;i.easing=D(i.easing);i.elasticity=(1e3-Math.min(Math.max(i.elasticity,1),999))/1e3;i.isPath=P.pth(n);i.isColor=P.col(i.from.original);i.isColor&&(i.round=1);return r=i})}function S(e,i){return t(r(e.map(function(e){return i.map(function(t){var r=v(e.target,t.name);if(r){var i=C(t,e);t={type:r,property:t.name,animatable:e,tweens:i,duration:i[i.length-1].end,delay:i[0].delay}}else t=void 0;return t})})),function(e){return!P.und(e)})}function I(e,t,r,i){var n="delay"===e;return t.length?(n?Math.min:Math.max).apply(Math,t.map(function(t){return t[e]})):n?i.delay:r.offset+i.delay+i.duration}function _(e){var t=o(j,e),r=o(R,e),i=T(e.targets),n=[],a=u(t,r),s;for(s in e)a.hasOwnProperty(s)||"targets"===s||n.push({name:s,offset:a.offset,tweens:L(e[s],r)});e=S(i,n);return u(t,{children:[],animatables:i,animations:e,duration:I("duration",e,t,r),delay:I("delay",e,t,r)})}function O(e){function r(){return window.Promise&&new Promise(function(e){return h=e})}function i(e){return p.reversed?p.duration-e:e}function n(e){for(var r=0,i={},n=p.animations,a=n.length;r<a;){var o=n[r],s=o.animatable,u=o.tweens,c=u.length-1,l=u[c];c&&(l=t(u,function(t){return e<t.end})[0]||l);for(var u=Math.min(Math.max(e-l.start-l.delay,0),l.duration)/l.duration,h=isNaN(u)?1:l.easing(u,l.elasticity),u=l.to.strings,d=l.round,c=[],v=void 0,v=l.to.numbers.length,m=0;m<v;m++){var g=void 0,g=l.to.numbers[m],y=l.from.numbers[m],g=l.isPath?E(l.value,h*g):y+h*(g-y);d&&(l.isColor&&2<m||(g=Math.round(g*d)/d));c.push(g)}if(l=u.length)for(v=u[0],h=0;h<l;h++)d=u[h+1],m=c[h],isNaN(m)||(v=d?v+(m+d):v+(m+" "));else v=c[0];F[o.type](s.target,o.property,v,i,s.id);o.currentValue=v;r++}if(r=Object.keys(i).length)for(n=0;n<r;n++)k||(k=f(document.body,"transform")?"transform":"-webkit-transform"),p.animatables[n].target.style[k]=i[n].join(" ");p.currentTime=e;p.progress=e/p.duration*100}function a(e){p[e]&&p[e](p)}function o(){p.remaining&&!0!==p.remaining&&p.remaining--}function s(e){var t=p.duration,s=p.offset,f=s+p.delay,v=p.currentTime,m=p.reversed,g=i(e);if(p.children.length){var y=p.children,A=y.length;if(g>=p.currentTime)for(var M=0;M<A;M++)y[M].seek(g);else for(;A--;)y[A].seek(g)}(g>=f||!t)&&(p.began||(p.began=!0,a("begin")),a("run"));g>s&&g<t?n(g):(g<=s&&0!==v&&(n(0),m&&o()),g>=t&&v!==t||!t)&&(n(t),m||o());a("update");e>=t&&(p.remaining?(c=u,"alternate"===p.direction&&(p.reversed=!p.reversed)):(p.pause(),p.completed||(p.completed=!0,a("complete"),"Promise"in window&&(h(),d=r()))),l=0)}e=void 0===e?{}:e;var u,c,l=0,h=null,d=r(),p=_(e);p.reset=function(){var e=p.direction,t=p.loop;p.currentTime=0;p.progress=0;p.paused=!0;p.began=!1;p.completed=!1;p.reversed="reverse"===e;p.remaining="alternate"===e&&1===t?2:t;n(0);for(e=p.children.length;e--;)p.children[e].reset()};p.tick=function(e){u=e;c||(c=u);s((l+u-c)*O.speed)};p.seek=function(e){s(i(e))};p.pause=function(){var e=G.indexOf(p);-1<e&&G.splice(e,1);p.paused=!0};p.play=function(){p.paused&&(p.paused=!1,c=0,l=i(p.currentTime),G.push(p),H||V())};p.reverse=function(){p.reversed=!p.reversed;c=0;l=i(p.currentTime)};p.restart=function(){p.pause();p.reset();p.play()};p.finished=d;p.reset();p.autoplay&&p.play();return p}var j={update:void 0,begin:void 0,run:void 0,complete:void 0,loop:1,direction:"normal",autoplay:!0,offset:0},R={duration:1e3,delay:0,easing:"easeOutElastic",elasticity:500,round:0},z="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skewX skewY perspective".split(" "),k,P={arr:function(e){return Array.isArray(e)},obj:function(e){return-1<Object.prototype.toString.call(e).indexOf("Object")},pth:function(e){return P.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},dom:function(e){return e.nodeType||P.svg(e)},str:function(e){return"string"===typeof e},fnc:function(e){return"function"===typeof e},und:function(e){return"undefined"===typeof e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return P.hex(e)||P.rgb(e)||P.hsl(e)}},U=function(){function e(e,t,r){return(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e}return function(t,r,i,n){if(0<=t&&1>=t&&0<=i&&1>=i){var a=new Float32Array(11);if(t!==r||i!==n)for(var o=0;11>o;++o)a[o]=e(.1*o,t,i);return function(o){if(t===r&&i===n)return o;if(0===o)return 0;if(1===o)return 1;for(var s=0,u=1;10!==u&&a[u]<=o;++u)s+=.1;--u;var u=s+(o-a[u])/(a[u+1]-a[u])*.1,c=3*(1-3*i+3*t)*u*u+2*(3*i-6*t)*u+3*t;if(.001<=c){for(s=0;4>s;++s){c=3*(1-3*i+3*t)*u*u+2*(3*i-6*t)*u+3*t;if(0===c)break;var l=e(u,t,i)-o,u=u-l/c}o=u}else if(0===c)o=u;else{var u=s,s=s+.1,h=0;do{l=u+(s-u)/2,c=e(l,t,i)-o,0<c?s=l:u=l}while(1e-7<Math.abs(c)&&10>++h);o=l}return e(o,r,n)}}}}(),B=function(){function e(e,t){return 0===e||1===e?e:-Math.pow(2,10*(e-1))*Math.sin(2*(e-1-t/(2*Math.PI)*Math.asin(1))*Math.PI/t)}var t="Quad Cubic Quart Quint Sine Expo Circ Back Elastic".split(" "),r={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],e],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(t,r){return 1-e(1-t,r)}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(t,r){return.5>t?e(2*t,r)/2:1-e(-2*t+2,r)/2}]},i={linear:U(.25,.25,.75,.75)},n={},a;for(a in r)n.type=a,r[n.type].forEach(function(e){return function(r,n){i["ease"+e.type+t[n]]=P.fnc(r)?r:U.apply(s,r)}}(n)),n={type:n.type};return i}(),F={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){i[n]||(i[n]=[]);i[n].push(t+"("+r+")")}},G=[],H=0,V=function(){function e(){H=requestAnimationFrame(t)}function t(t){var r=G.length;if(r){for(var i=0;i<r;)G[i]&&G[i].tick(t),i++;e()}else cancelAnimationFrame(H),H=0}return e}();O.version="2.2.0";O.speed=1;O.running=G;O.remove=function(e){e=b(e);for(var t=G.length;t--;)for(var r=G[t],i=r.animations,a=i.length;a--;)n(e,i[a].animatable.target)&&(i.splice(a,1),i.length||r.pause())};O.getValue=g;O.path=function(t,r){var i=P.str(t)?e(t)[0]:t,n=r||100;return function(e){return{el:i,property:e,totalLength:w(i)*(n/100)}}};O.setDashoffset=function(e){var t=w(e);e.setAttribute("stroke-dasharray",t);return t};O.bezier=U;O.easings=B;O.timeline=function(e){var t=O(e);t.pause();t.duration=0;t.add=function(r){t.children.forEach(function(e){e.began=!0;e.completed=!0});i(r).forEach(function(r){var i=u(r,o(R,e||{}));i.targets=i.targets||e.targets;r=t.duration;var n=i.offset;i.autoplay=!1;i.direction=t.direction;i.offset=P.und(n)?r:y(n,r);t.began=!0;t.completed=!0;t.seek(i.offset);i=O(i);i.began=!0;i.completed=!0;i.duration>r&&(t.duration=i.duration);t.children.push(i)});t.seek(0);t.reset();t.autoplay&&t.restart();return t};return t};O.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};return O})}).call(t,r(40))}},[294]);return{page:t.default}});